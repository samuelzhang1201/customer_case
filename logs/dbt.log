[0m14:50:16.932375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAA10>]}


============================== 14:50:16.935375 | 16040dd4-dfa5-4647-80c6-cc380ce7ef52 ==============================
[0m14:50:16.935375 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:16.935375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:17.001884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16040dd4-dfa5-4647-80c6-cc380ce7ef52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4ED7E080>]}
[0m14:50:17.002884 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-xaitn6h6'
[0m14:50:17.004883 [info ] [MainThread]: Updating lock file in file path: C:\Users\Samuel\Desktop\customer360\integration_tests/package-lock.yml
[0m14:50:17.005883 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-fst6ucu3'
[0m14:50:17.006883 [info ] [MainThread]: Installing ../
[0m14:50:17.006883 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:50:17.007883 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:50:20.607498 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:50:20.609500 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:50:20.612003 [debug] [MainThread]: Command `dbt deps` failed at 14:50:20.612003 after 3.72 seconds
[0m14:50:20.612003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EE63C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EEB0460>]}
[0m14:50:20.613008 [debug] [MainThread]: Flushing usage events
[0m14:50:57.146162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836AA40>]}


============================== 14:50:57.148463 | 4c6152b5-76b0-4004-9902-1d15f3881478 ==============================
[0m14:50:57.148463 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:57.149467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:57.650768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACE0>]}
[0m14:50:57.709781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C83236A0>]}
[0m14:50:57.709781 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:50:57.719918 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:57.720917 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:57.721918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C84793F0>]}
[0m14:50:58.471639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8CD00A0>]}
[0m14:50:58.516341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.517343 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:50:58.517343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8C79450>]}
[0m14:50:58.518343 [info ] [MainThread]: 
[0m14:50:58.519341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:58.520343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:50:58.526337 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:50:58.527338 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:50:58.527338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.577381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:50:58.578343 [debug] [ThreadPool]: On list_dbt: Close
[0m14:50:58.580343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:50:58.584342 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.585343 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:50:58.585343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.632050 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.632050 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.633044 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:58.635042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:50:58.639047 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.640004 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.640004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:58.692968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.692968 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.692968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:58.696005 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.696005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C89A5120>]}
[0m14:50:58.697007 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:58.697007 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.697007 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.698052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.698052 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.699048 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.699048 [debug] [MainThread]: On master: Close
[0m14:50:58.700049 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:50:58.701011 [info ] [MainThread]: 
[0m14:50:58.703010 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:50:58.703010 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:50:58.704009 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:50:58.704009 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:50:58.705010 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:50:58.705010 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:50:58.706010 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:50:58.706010 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:50:58.706010 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:50:58.706010 => 14:50:58.706010
[0m14:50:58.707010 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:50:58.707010 => 14:50:58.707010
[0m14:50:58.707010 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:50:58.708009 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:50:58.729514 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.731514 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.731514 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:50:58.731514 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:50:58.732515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:58.732515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:58.779976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.779976 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.780976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */

    create table "dbt"."public"."contacts" ("id" text,"username" text,"name" text,"gender" text,"address" text,"mail" text,"birthdate" date,"_loaded_at_utc" timestamp)
  
[0m14:50:58.786975 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.808979 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.809978 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:50:58.810979 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:50:58.814486 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:50:58.814486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.815487 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.815487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */

    create table "dbt"."public"."transactions" ("contact_id" text,"id" text,"transaction_date" text,"amount" float8,"item_count" integer,"category" text,"_loaded_at_utc" timestamp)
  
[0m14:50:58.826488 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.826488 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.827487 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.903536 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.924202 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.925162 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:50:58.927161 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:50:58.927161 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:50:58.939580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.940581 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:50:58.708009 => 14:50:58.940581
[0m14:50:58.941583 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.941583 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:50:58.942544 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.943543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>]}
[0m14:50:58.943543 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.944543 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.24s]
[0m14:50:58.944543 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.945543 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:50:58.945543 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:50:58.716514 => 14:50:58.945543
[0m14:50:58.946542 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:50:58.947542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.947542 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:50:58.948542 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:50:58.949542 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.949542 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.949542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:58.999545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.999545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:59.000545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:59.001545 [debug] [MainThread]: On master: Close
[0m14:50:59.001545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:50:59.003545 [info ] [MainThread]: 
[0m14:50:59.003545 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:50:59.004545 [debug] [MainThread]: Command end result
[0m14:50:59.010545 [info ] [MainThread]: 
[0m14:50:59.011545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:59.011545 [info ] [MainThread]: 
[0m14:50:59.012545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:50:59.013048 [debug] [MainThread]: Command `dbt seed` succeeded at 14:50:59.013048 after 1.91 seconds
[0m14:50:59.013048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8A4C3D0>]}
[0m14:50:59.014051 [debug] [MainThread]: Flushing usage events
[0m14:51:24.176973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323A920>]}


============================== 14:51:24.179971 | 2fa63a5f-3852-4337-baad-b6d425277112 ==============================
[0m14:51:24.179971 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:24.179971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:24.246481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa63a5f-3852-4337-baad-b6d425277112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323ABF0>]}
[0m14:51:25.112111 [debug] [MainThread]: Command `dbt clean` succeeded at 14:51:25.112111 after 0.97 seconds
[0m14:51:25.113112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A32935E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A31ABBE0>]}
[0m14:51:25.113112 [debug] [MainThread]: Flushing usage events
[0m14:51:39.842730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2B60>]}


============================== 14:51:39.845780 | 543031ae-e66a-4e6e-b09b-952668fb6dc9 ==============================
[0m14:51:39.845780 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:39.846768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:39.965249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028018B52E00>]}
[0m14:51:40.021249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010BBB0>]}
[0m14:51:40.022249 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:51:40.023249 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:51:40.024249 [debug] [MainThread]: Command `dbt build` failed at 14:51:40.024249 after 0.23 seconds
[0m14:51:40.024249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028020109A20>]}
[0m14:51:40.024249 [debug] [MainThread]: Flushing usage events
[0m14:51:56.581142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CABC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CA950>]}


============================== 14:51:56.584142 | b2c1ab68-d4d0-4adb-8a84-847e14914495 ==============================
[0m14:51:56.584142 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:56.585143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:56.651146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c1ab68-d4d0-4adb-8a84-847e14914495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CAC20>]}
[0m14:51:56.653148 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-n8fu7w2e'
[0m14:51:56.654147 [info ] [MainThread]: Installing ../
[0m14:51:56.655654 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:51:56.655654 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:51:59.866336 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:51:59.868336 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:51:59.870337 [debug] [MainThread]: Command `dbt deps` failed at 14:51:59.870337 after 3.33 seconds
[0m14:51:59.870337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D857820>]}
[0m14:51:59.871335 [debug] [MainThread]: Flushing usage events
[0m14:52:15.039154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAA70>]}


============================== 14:52:15.043155 | e9d1782c-893b-4ddc-8c25-8b50a44d7c63 ==============================
[0m14:52:15.043155 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:15.043155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:52:15.164375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAD10>]}
[0m14:52:15.225976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>]}
[0m14:52:15.226977 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:15.236976 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:15.236976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:52:15.237976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988315E0E0>]}
[0m14:52:15.984447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988384C0D0>]}
[0m14:52:16.030900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BDC90>]}
[0m14:52:16.030900 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:16.031900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BD630>]}
[0m14:52:16.032900 [info ] [MainThread]: 
[0m14:52:16.033900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:16.034900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:16.040901 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:16.041901 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:16.041901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.111840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:16.112840 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:16.114840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:16.118840 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.118840 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:16.118840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.190391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.191391 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.191391 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:16.194391 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:16.194391 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:16.195391 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:16.199391 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.199391 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.199391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:16.300178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.300178 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.301170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:16.303178 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:16.304170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837C67D0>]}
[0m14:52:16.305174 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:16.305174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.306170 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.306170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.306170 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.307175 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.308175 [debug] [MainThread]: On master: Close
[0m14:52:16.308175 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:16.309176 [info ] [MainThread]: 
[0m14:52:16.311180 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:16.311180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:16.312171 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:16.312171 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:16.314140 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:16.314140 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:16.314140 => 14:52:16.314140
[0m14:52:16.315139 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:16.315139 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:16.315139 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:16.315139 => 14:52:16.315139
[0m14:52:16.326141 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:16.336140 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.338392 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:16.341396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.341396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:16.341396 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:16.342395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:16.396399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.397400 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.397400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:16.403403 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.425399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.426400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:16.427399 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:16.427399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.431399 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:16.431399 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.441399 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.442399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.443400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.444400 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:16.316139 => 14:52:16.444400
[0m14:52:16.444400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:16.445400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019883320820>]}
[0m14:52:16.445400 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.13s]
[0m14:52:16.446399 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:16.447399 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.547349 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.547349 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:16.549334 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:16.550332 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.552370 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.554342 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.554342 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:16.336140 => 14:52:16.554342
[0m14:52:16.555826 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:16.556329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988354D8D0>]}
[0m14:52:16.557371 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:52:16.557371 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:16.558337 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.559336 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.559336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:16.623125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.623125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.624125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.625126 [debug] [MainThread]: On master: Close
[0m14:52:16.625126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:16.625126 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:52:16.627125 [info ] [MainThread]: 
[0m14:52:16.627125 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m14:52:16.628128 [debug] [MainThread]: Command end result
[0m14:52:16.634124 [info ] [MainThread]: 
[0m14:52:16.635124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:16.635124 [info ] [MainThread]: 
[0m14:52:16.636124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:52:16.636124 [debug] [MainThread]: Command `dbt seed` succeeded at 14:52:16.636124 after 1.64 seconds
[0m14:52:16.637124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837FB5B0>]}
[0m14:52:16.637124 [debug] [MainThread]: Flushing usage events
[0m14:52:24.451658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62B90>]}


============================== 14:52:24.454627 | 5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f ==============================
[0m14:52:24.454627 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:24.455626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:52:24.576755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752B7E2E00>]}
[0m14:52:24.636591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532DA8880>]}
[0m14:52:24.637592 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:24.647731 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:24.731036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:24.732003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:24.736003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532FD80D0>]}
[0m14:52:24.743536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4B50>]}
[0m14:52:24.743536 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:24.745536 [info ] [MainThread]: 
[0m14:52:24.745536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:24.747536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:24.753536 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:24.754536 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:24.754536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.825083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:24.826083 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:24.828046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:24.832046 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.832046 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:24.832046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.982175 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:24.982175 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.982175 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:24.985175 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:24.989174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.990211 [debug] [MainThread]: On master: BEGIN
[0m14:52:24.990211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:25.058461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.059927 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.060938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:25.063937 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:25.064935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532F8F850>]}
[0m14:52:25.064935 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:25.064935 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.065935 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.065935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.065935 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.067181 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.068222 [debug] [MainThread]: On master: Close
[0m14:52:25.068222 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:25.069227 [info ] [MainThread]: 
[0m14:52:25.071692 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:25.072196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:25.072196 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.073201 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m14:52:25.073201 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m14:52:25.074203 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:25.074203 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m14:52:25.075202 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:25.075202 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:25.076201 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m14:52:25.076201 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:25.076201 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:25.076201 => 14:52:25.076201
[0m14:52:25.077201 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.077201 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:25.077201 => 14:52:25.077201
[0m14:52:25.078201 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:25.089245 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.090238 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:25.111234 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.112237 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:25.115201 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.115201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:25.115201 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:25.116388 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:25.116388 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 14:52:25.078201 => 14:52:25.116388
[0m14:52:25.117834 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.127885 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.128895 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.129880 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m14:52:25.129880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:25.169847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.171351 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.171351 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:25.177365 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.199355 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.199355 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:25.200355 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:25.204391 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:25.214356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.214356 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.215357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.215357 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.215357 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.216357 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:25.217362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.218358 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:25.090238 => 14:52:25.217362
[0m14:52:25.218358 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:25.219357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753307C130>]}
[0m14:52:25.219357 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m14:52:25.220358 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:25.220358 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.221356 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m14:52:25.222356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m14:52:25.222356 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.222356 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.255356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.321096 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.326092 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.326092 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.327096 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:25.327096 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m14:52:25.329062 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 14:52:25.317059 => 14:52:25.328094
[0m14:52:25.329062 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.331060 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.331060 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:25.331060 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:25.333598 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.333598 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.333598 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.334594 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m14:52:25.334594 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.334594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.336561 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.336561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.337558 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:25.102201 => 14:52:25.337558
[0m14:52:25.339561 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 14:52:25.117834 => 14:52:25.338561
[0m14:52:25.339561 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:25.339561 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m14:52:25.340559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753301FE50>]}
[0m14:52:25.340559 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m14:52:25.342039 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m14:52:25.342039 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m14:52:25.342900 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:25.342900 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.344238 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.344238 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.344238 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m14:52:25.345281 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m14:52:25.345281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m14:52:25.346281 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m14:52:25.346281 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.347282 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.350283 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.354281 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.355278 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 14:52:25.347282 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 14:52:25.350283 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.356245 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.358249 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.359249 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.360249 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.361355 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.361355 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m14:52:25.361355 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m14:52:25.362400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:25.362400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:25.386938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.386938 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.387938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.388938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.389938 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 14:52:25.329062 => 14:52:25.389938
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m14:52:25.391938 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m14:52:25.391938 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.392979 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.392979 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m14:52:25.393987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m14:52:25.393987 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.397973 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.398974 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 14:52:25.394973 => 14:52:25.398974
[0m14:52:25.399941 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.400940 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m14:52:25.403227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.419271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.420273 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.420273 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.421271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.422272 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 14:52:25.357250 => 14:52:25.422272
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m14:52:25.424270 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m14:52:25.425234 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.491827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.491827 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.491827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.493827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.494826 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 14:52:25.399941 => 14:52:25.494826
[0m14:52:25.494826 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m14:52:25.495827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m14:52:25.496826 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m14:52:25.496826 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.497825 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m14:52:25.497825 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m14:52:25.498828 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m14:52:25.549823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.550822 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.550822 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.551823 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.552823 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 14:52:25.358249 => 14:52:25.552823
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m14:52:25.554822 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.21s]
[0m14:52:25.554822 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.555823 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m14:52:25.556915 [info ] [Thread-1 (]: 9 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m14:52:25.556915 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m14:52:25.557893 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.557893 [info ] [Thread-3 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m14:52:25.558861 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.558861 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.558861 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.559865 [info ] [Thread-1 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m14:52:25.559865 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m14:52:25.560861 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.560861 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.561859 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m14:52:25.561859 [info ] [Thread-3 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m14:52:25.562863 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m14:52:25.563864 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.563864 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.563864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:25.622412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.623412 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.624412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.624412 [debug] [MainThread]: On master: Close
[0m14:52:25.625412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m14:52:25.626413 [info ] [MainThread]: 
[0m14:52:25.627412 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:52:25.628413 [debug] [MainThread]: Command end result
[0m14:52:25.634489 [info ] [MainThread]: 
[0m14:52:25.635489 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:25.635489 [info ] [MainThread]: 
[0m14:52:25.635489 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m14:52:25.636489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.636489 [info ] [MainThread]: 
[0m14:52:25.637488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m14:52:25.637488 [info ] [MainThread]: 
[0m14:52:25.637488 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m14:52:25.638488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.638488 [info ] [MainThread]: 
[0m14:52:25.638488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m14:52:25.639488 [info ] [MainThread]: 
[0m14:52:25.639488 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m14:52:25.640491 [debug] [MainThread]: Command `dbt build` failed at 14:52:25.640491 after 1.24 seconds
[0m14:52:25.640491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753302F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4370>]}
[0m14:52:25.641489 [debug] [MainThread]: Flushing usage events
[0m15:05:12.345559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2B90>]}


============================== 15:05:12.347051 | beb80a8b-4487-4867-a7e0-bf551d511955 ==============================
[0m15:05:12.347051 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:05:12.347051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:12.456333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F4EC2E00>]}
[0m15:05:12.519283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>]}
[0m15:05:12.519283 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:05:12.519283 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:12.608952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC6280D0>]}
[0m15:05:12.613571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC534B50>]}
[0m15:05:12.613571 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:05:12.613571 [info ] [MainThread]: 
[0m15:05:12.613571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:12.613571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:05:12.613571 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:05:12.613571 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:05:12.613571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:12.959520 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:12.959520 [debug] [ThreadPool]: On list_dbt: Close
[0m15:05:12.959520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:05:12.975142 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:12.975142 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:05:12.975142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:05:13.085332 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.085332 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.085332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:13.179562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:13.179562 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5DF850>]}
[0m15:05:13.179562 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.195192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: Close
[0m15:05:13.195192 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:05:13.195192 [info ] [MainThread]: 
[0m15:05:13.195192 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:05:13.195192 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:05:13.195192 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.195192 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:05:13.195192 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:05:13.195192 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m15:05:13.202565 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:05:13.203552 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:05:13.204358 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m15:05:13.204358 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:05:13.204945 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:05:13.205488 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.205488 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.205488 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.214468 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.214468 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:05:13.214468 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:05:13.229243 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 15:05:13.205488 => 15:05:13.229243
[0m15:05:13.229243 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.241002 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.241002 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.241002 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:05:13.241002 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:05:13.253563 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.253563 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:13.254609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:13.255344 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.255344 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m15:05:13.255344 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:13.304252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.304252 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.304252 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:05:13.307253 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.323367 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:05:13.323367 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.339033 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:05:13.339033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:05:13.214468 => 15:05:13.339033
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:05:13.339033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC7100D0>]}
[0m15:05:13.339033 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:05:13.339033 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:05:13.339033 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.354661 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.339033 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:05:13.389962 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.449962 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.450958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:05:13.450958 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.451975 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:05:13.451975 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.452924 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:05:13.452924 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:05:13.229243 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 15:05:13.241002 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:05:13.454923 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m15:05:13.454923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5348B0>]}
[0m15:05:13.470617 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m15:05:13.454923 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.25s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:05:13.470617 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.470617 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:05:13.470617 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:05:13.470617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:05:13.470617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:05:13.470617 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.470617 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.470617 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.486256 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:05:13.487873 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:05:13.487873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:13.487873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.514769 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.514769 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:05:13.454923 => 15:05:13.520290
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:05:13.521194 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m15:05:13.521194 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.521194 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:05:13.521194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:05:13.521194 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:05:13.521194 => 15:05:13.521194
[0m15:05:13.521194 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:05:13.533648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:05:13.486256 => 15:05:13.575078
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:05:13.575078 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.10s]
[0m15:05:13.587031 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.588038 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:05:13.588038 [info ] [Thread-3 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:05:13.589036 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.614868 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.614868 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.628065 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:05:13.521194 => 15:05:13.627025
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:05:13.628202 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.11s]
[0m15:05:13.628202 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:05:13.470617 => 15:05:13.654607
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:05:13.654607 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.18s]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [info ] [Thread-3 (]: 9 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [info ] [Thread-2 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [info ] [Thread-1 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:05:13.654607 [info ] [Thread-2 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:05:13.666999 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:05:13.668478 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.668478 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.668478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:13.738351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.738351 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.739349 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.740348 [debug] [MainThread]: On master: Close
[0m15:05:13.740348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:05:13.742352 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m15:05:13.742352 [info ] [MainThread]: 
[0m15:05:13.742352 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m15:05:13.744352 [debug] [MainThread]: Command end result
[0m15:05:13.748314 [info ] [MainThread]: 
[0m15:05:13.748314 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:13.750809 [info ] [MainThread]: 
[0m15:05:13.750809 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m15:05:13.751793 [debug] [MainThread]: Command `dbt build` failed at 15:05:13.751793 after 1.46 seconds
[0m15:05:13.751793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3ACFD0>]}
[0m15:05:13.751793 [debug] [MainThread]: Flushing usage events
[0m15:08:11.365873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302B30>]}


============================== 15:08:11.368871 | 54b902e5-2b69-44fd-b815-34c8b9264ae1 ==============================
[0m15:08:11.368871 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:08:11.368871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:11.485997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F8022E00>]}
[0m15:08:11.541504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF54A440>]}
[0m15:08:11.542504 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:08:11.551504 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:08:11.624371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:11.625625 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__sources.yml
[0m15:08:11.862219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB563E0>]}
[0m15:08:11.870261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB10B80>]}
[0m15:08:11.871251 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:08:11.872261 [info ] [MainThread]: 
[0m15:08:11.873252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:11.874254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:08:11.875470 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:08:11.875470 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:08:11.875470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:11.943675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:08:11.945677 [debug] [ThreadPool]: On list_dbt: Close
[0m15:08:11.946675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:08:11.950639 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:11.950639 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:08:11.951639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:12.015577 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.016613 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:12.016613 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:08:12.018615 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:08:12.019614 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:08:12.020617 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:08:12.023578 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.024577 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.024577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:12.103158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.103158 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.103158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:12.106157 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:12.107157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB11120>]}
[0m15:08:12.107157 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:12.108157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.108157 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.109157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.109157 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.109157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.110187 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.110187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.110187 [debug] [MainThread]: On master: Close
[0m15:08:12.111157 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:08:12.112176 [info ] [MainThread]: 
[0m15:08:12.113181 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:08:12.114180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:08:12.114180 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.115181 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:08:12.115181 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:08:12.116185 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:08:12.116185 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:08:12.117183 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:08:12.118181 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:08:12.118181 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:08:12.118181 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:08:12.119182 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.119182 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.119182 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.125180 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.125180 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:08:12.126213 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:08:12.136397 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:08:12.120181 => 15:08:12.136397
[0m15:08:12.147396 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.148397 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.151396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.151396 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:08:12.160478 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.161479 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:08:12.161479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.163472 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:08:12.163472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.201758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.239089 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.239089 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:08:12.240089 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:08:12.244089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:08:12.244089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.245089 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.254090 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.254090 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:08:12.255092 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.255092 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.257132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.257132 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:08:12.126213 => 15:08:12.257132
[0m15:08:12.258137 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:08:12.258137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFBF2110>]}
[0m15:08:12.259091 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:08:12.260128 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:08:12.260128 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.260128 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.261092 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:08:12.296092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.311601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:08:12.343602 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.357633 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.357633 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.358636 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:08:12.358636 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:08:12.363635 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.364642 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:08:12.358636 => 15:08:12.364642
[0m15:08:12.365640 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.366636 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.367635 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:08:12.367635 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.368962 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:08:12.368962 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:08:12.370451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.370451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.371457 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.371457 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.372834 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.372834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.373840 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:08:12.138396 => 15:08:12.373840
[0m15:08:12.374840 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:08:12.151396 => 15:08:12.374840
[0m15:08:12.375842 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:08:12.375842 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:08:12.376841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF6857E0>]}
[0m15:08:12.376841 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:08:12.377842 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m15:08:12.378348 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m15:08:12.379391 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:08:12.380356 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.380894 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.380894 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.381994 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:08:12.381994 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.383652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:08:12.386159 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.387159 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.390249 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.391626 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:08:12.383652 => 15:08:12.391626
[0m15:08:12.391626 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.391626 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:08:12.387159 => 15:08:12.391626
[0m15:08:12.395163 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.395163 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.396161 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.397701 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.397701 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:08:12.398709 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.398709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:12.398709 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:08:12.399706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.419738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.420743 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.420743 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.421709 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.422724 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:08:12.365640 => 15:08:12.422724
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:08:12.424730 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.11s]
[0m15:08:12.424730 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.425764 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.425764 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:08:12.426770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:08:12.426770 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:08:12.427765 => 15:08:12.428943
[0m15:08:12.428943 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:08:12.428943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:08:12.393120 => 15:08:12.450221
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:08:12.461687 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m15:08:12.462801 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.476617 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.476617 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.488278 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:08:12.396161 => 15:08:12.476617
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:08:12.489320 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.11s]
[0m15:08:12.490319 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.491430 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:08:12.491430 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:08:12.492474 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:08:12.524026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.525014 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.525014 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.526010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.528010 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:08:12.428943 => 15:08:12.527010
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:08:12.529010 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:08:12.530011 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.530011 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:08:12.531013 [info ] [Thread-3 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:08:12.532014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:08:12.532014 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:08:12.534012 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:08:12.535012 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:08:12.532014 => 15:08:12.535012
[0m15:08:12.535012 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:08:12.556015 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:08:12.557014 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.558015 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:08:12.558015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.619534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.620531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.620531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.638188 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.638188 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.679037 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:08:12.682035 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.682035 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:08:12.683038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:08:12.684073 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:08:12.536013 => 15:08:12.684073
[0m15:08:12.684073 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:08:12.685043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD08B50>]}
[0m15:08:12.685043 [info ] [Thread-3 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.15s]
[0m15:08:12.686098 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:08:12.687082 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.687082 [info ] [Thread-1 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.688255 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:08:12.688255 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:08:12.693015 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.693015 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.694409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:12.869924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: Close
[0m15:08:12.869924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'model.customer360.stg_web__transactions' was properly closed.
[0m15:08:12.869924 [info ] [MainThread]: 
[0m15:08:12.869924 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m15:08:12.869924 [debug] [MainThread]: Command end result
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.886575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.891511 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:08:12.891511 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:08:12.892581 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:08:12.893264 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=5 TOTAL=13
[0m15:08:12.895546 [debug] [MainThread]: Command `dbt build` failed at 15:08:12.894731 after 1.57 seconds
[0m15:08:12.895546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD23640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD22560>]}
[0m15:08:12.895546 [debug] [MainThread]: Flushing usage events
[0m15:10:41.613814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2B00>]}


============================== 15:10:41.615800 | 2d75deeb-6ca3-4d86-9c99-d4931798420a ==============================
[0m15:10:41.615800 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:41.616800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:41.734048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B2E00>]}
[0m15:10:41.789052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B0A90>]}
[0m15:10:41.790052 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:41.799052 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:41.872555 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading customer360: staging\salesforce\_sf__sources.yaml - Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |           - name: id
    13 |             tests:
    14 |               - unique
    15 |                   config:
    16 |                     severity: error
    17 |                     error_if: ">5"
    18 |                     wan_if: ">0"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 15, column 25
[0m15:10:41.875523 [debug] [MainThread]: Command `dbt build` failed at 15:10:41.875523 after 0.32 seconds
[0m15:10:41.875523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955900>]}
[0m15:10:41.876524 [debug] [MainThread]: Flushing usage events
[0m15:10:57.883356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702B30>]}


============================== 15:10:57.886396 | 46a2d78d-ca8a-4129-8441-48188a34100b ==============================
[0m15:10:57.886396 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:57.887396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:58.004875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A5382E00>]}
[0m15:10:58.061391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC94A440>]}
[0m15:10:58.062391 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:58.068548 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:58.144533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:58.145541 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\_sf__sources.yaml
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACF480D0>]}
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACA84A60>]}
[0m15:10:58.369115 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:10:58.369115 [info ] [MainThread]: 
[0m15:10:58.384902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:58.385935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:10:58.391939 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:10:58.392931 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:10:58.392931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.450320 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:10:58.451320 [debug] [ThreadPool]: On list_dbt: Close
[0m15:10:58.453320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:10:58.456895 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.456895 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:10:58.457893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.656881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.657881 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.657881 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:58.659881 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:10:58.660881 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:10:58.661881 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:10:58.664881 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.665881 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.665881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:58.731882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.731882 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.732882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:58.734880 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:58.735880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2E9E0>]}
[0m15:10:58.736880 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:58.736880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.736880 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.737880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.737880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.738880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.739883 [debug] [MainThread]: On master: Close
[0m15:10:58.739883 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:10:58.739883 [info ] [MainThread]: 
[0m15:10:58.742260 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:10:58.743254 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:10:58.743254 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.744253 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:10:58.744253 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:10:58.745252 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:10:58.744253 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:10:58.746251 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:10:58.746251 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:10:58.747251 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:10:58.747251 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:10:58.748251 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.748251 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.749252 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.749252 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:10:58.761762 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.761762 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:10:58.781761 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.783762 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:10:58.749252 => 15:10:58.783762
[0m15:10:58.783762 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:10:58.786761 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.786761 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.787761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:58.787761 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:10:58.797761 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.797761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:58.798762 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.798762 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:10:58.799763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:10:58.847071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.848165 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.848165 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:10:58.854104 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:58.876522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.876522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:10:58.877523 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:10:58.881523 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.890522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.892522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.892522 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:10:58.761762 => 15:10:58.892522
[0m15:10:58.893522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:10:58.893522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2EA10>]}
[0m15:10:58.894521 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:10:58.895522 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:10:58.895522 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.896521 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:10:58.896521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:10:58.897522 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.901523 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.902522 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:10:58.897522 => 15:10:58.902522
[0m15:10:58.902522 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.904523 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:10:58.905525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.912521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.912521 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.913521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:10:58.914521 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.915521 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:10:58.787761 => 15:10:58.915521
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:10:58.917521 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.17s]
[0m15:10:58.918523 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.918523 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.918523 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:10:58.919522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:10:58.919522 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.923521 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.923521 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:10:58.920522 => 15:10:58.923521
[0m15:10:58.924678 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.924678 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:10:58.924678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:10:58.902522 => 15:10:58.954393
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:10:58.954393 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.06s]
[0m15:10:58.961540 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.961540 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.962572 [info ] [Thread-1 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:10:58.963226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:10:58.963226 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:10:58.963226 => 15:10:58.963226
[0m15:10:58.963226 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:10:58.963226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.975923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.975923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.976885 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:10:58.981883 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:59.028189 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:59.118039 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.119039 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:59.119039 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.120040 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:10:59.120040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.122041 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.123041 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:10:58.963226 => 15:10:59.123041
[0m15:10:59.124041 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:10:59.124041 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:10:59.125040 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:10:59.125040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:10:59.126446 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.125040 [warn ] [Thread-1 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.16s]
[0m15:10:59.127453 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.127453 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:59.128451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.128451 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.129451 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:10:59.129451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:10:59.130490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.131485 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:10:58.924678 => 15:10:59.131485
[0m15:10:59.132491 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:10:58.781761 => 15:10:59.132491
[0m15:10:59.135487 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.135487 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:10:59.135487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:10:59.136486 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:10:59.132491 => 15:10:59.136486
[0m15:10:59.136486 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:10:59.137483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD1229E0>]}
[0m15:10:59.137483 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.138491 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.22s]
[0m15:10:59.138491 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.39s]
[0m15:10:59.140531 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.141533 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:59.141533 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:10:59.141533 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:10:59.142529 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.142529 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:10:59.143532 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:10:59.143532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:10:59.144533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.144533 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:10:59.146533 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:10:59.147531 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:10:59.145533 => 15:10:59.147531
[0m15:10:59.147531 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:10:59.168372 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:10:59.169372 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.170384 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:10:59.170384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:10:59.139533 => 15:10:59.189386
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:10:59.201625 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m15:10:59.201625 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.202662 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:10:59.203671 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:10:59.203671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now model.customer360.stg_web__transactions)
[0m15:10:59.204676 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:10:59.207632 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:10:59.207632 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:10:59.204676 => 15:10:59.207632
[0m15:10:59.208671 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:10:59.211664 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:10:59.212664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.233631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.234630 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.234630 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.241799 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:10:59.245799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.250799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.250799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.251799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.251799 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.256311 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:10:59.259310 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.259310 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:10:59.260310 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.261311 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:10:59.147531 => 15:10:59.261311
[0m15:10:59.261311 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:10:59.262310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACCDEC20>]}
[0m15:10:59.262310 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m15:10:59.263311 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:10:59.385228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.385228 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.386261 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.393264 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:10:59.395262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.396263 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:10:59.396263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.398259 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.402262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.403262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.403262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.404262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.405266 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:10:59.406260 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.406260 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:10:59.408263 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.409266 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:10:59.208671 => 15:10:59.409266
[0m15:10:59.409266 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:10:59.410261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC9021D0>]}
[0m15:10:59.410261 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.21s]
[0m15:10:59.411261 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:10:59.412232 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.413230 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:10:59.413230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:10:59.414229 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:10:59.416229 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.417229 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:10:59.414229 => 15:10:59.416229
[0m15:10:59.417229 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:10:59.430233 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:10:59.432232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.525334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.526334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.526334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:10:59.528334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:10:59.530333 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.530333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:10:59.531334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.532334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.532334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.533333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.533333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.535334 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:10:59.537335 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.538334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:10:59.538334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:10:59.539334 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:10:59.417229 => 15:10:59.539334
[0m15:10:59.540338 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:10:59.540338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD122230>]}
[0m15:10:59.541338 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:59.541338 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.542338 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.543338 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.543338 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:10:59.543338 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.545338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:10:59.548338 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.548338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.551338 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.552342 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:10:59.545338 => 15:10:59.552342
[0m15:10:59.552342 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.553340 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:10:59.549338 => 15:10:59.552342
[0m15:10:59.554850 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.555855 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.556855 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.557855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.557855 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.558855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:10:59.558855 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:10:59.559855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.559855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.609855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.609855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.610855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.611855 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.612855 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:10:59.553340 => 15:10:59.612855
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:10:59.614856 [error] [Thread-2 (]: 11 of 13 FAIL 1 not_null_contacts_joined_with_transactions_id .................. [[31mFAIL 1[0m in 0.07s]
[0m15:10:59.615857 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.646858 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.647861 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.647861 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.649859 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.650858 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:10:59.555855 => 15:10:59.650858
[0m15:10:59.650858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:10:59.651858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:10:59.651858 [error] [Thread-3 (]: 12 of 13 FAIL 9 unique_contacts_joined_with_transactions_id .................... [[31mFAIL 9[0m in 0.11s]
[0m15:10:59.652891 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.652891 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:10:59.654431 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:10:59.654431 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:10:59.655467 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.656483 [debug] [MainThread]: On master: BEGIN
[0m15:10:59.656483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:59.709166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: Close
[0m15:10:59.709166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:10:59.709166 [info ] [MainThread]: 
[0m15:10:59.721608 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m15:10:59.723654 [debug] [MainThread]: Command end result
[0m15:10:59.730656 [info ] [MainThread]: 
[0m15:10:59.731651 [info ] [MainThread]: [31mCompleted with 2 errors and 1 warning:[0m
[0m15:10:59.731651 [info ] [MainThread]: 
[0m15:10:59.732649 [error] [MainThread]: [31mFailure in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.732649 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:10:59.733653 [info ] [MainThread]: 
[0m15:10:59.733653 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:10:59.734653 [info ] [MainThread]: 
[0m15:10:59.734653 [error] [MainThread]: [31mFailure in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.735649 [error] [MainThread]:   Got 9 results, configured to fail if != 0
[0m15:10:59.735649 [info ] [MainThread]: 
[0m15:10:59.736655 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:10:59.736655 [info ] [MainThread]: 
[0m15:10:59.736655 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:10:59.737649 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:10:59.737649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:10:59.738649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]: Done. PASS=9 WARN=1 ERROR=2 SKIP=1 TOTAL=13
[0m15:10:59.740657 [debug] [MainThread]: Command `dbt build` failed at 15:10:59.739691 after 1.91 seconds
[0m15:10:59.740657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC902050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC901FC0>]}
[0m15:10:59.740657 [debug] [MainThread]: Flushing usage events
[0m15:14:58.020660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762B60>]}


============================== 15:14:58.023660 | bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d ==============================
[0m15:14:58.023660 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:14:58.024660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:14:58.142954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5402E00>]}
[0m15:14:58.194143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC9ABBB0>]}
[0m15:14:58.194143 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:14:58.194143 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m15:14:58.458762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCEB6920>]}
[0m15:14:58.459867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCAE4B20>]}
[0m15:14:58.459867 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:14:58.459867 [info ] [MainThread]: 
[0m15:14:58.459867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:58.459867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:14:58.476102 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:14:58.477133 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:14:58.477133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.556767 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:14:58.557766 [debug] [ThreadPool]: On list_dbt: Close
[0m15:14:58.558767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:14:58.562766 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.563767 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:14:58.563767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.636275 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.636275 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.636275 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:58.639275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:14:58.644278 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.644278 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.645276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:58.729756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.729756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.730758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:58.733756 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:14:58.734756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCB8F850>]}
[0m15:14:58.734756 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:58.735756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.735756 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.735756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.736756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.737756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.737756 [debug] [MainThread]: On master: Close
[0m15:14:58.738757 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:14:58.738757 [info ] [MainThread]: 
[0m15:14:58.740757 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:14:58.740757 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:14:58.741757 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.741757 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:14:58.742756 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:14:58.743757 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:14:58.742756 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:14:58.743757 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:14:58.744757 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:14:58.744757 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:14:58.745756 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:14:58.745756 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.745756 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.746757 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.746757 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:14:58.758756 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.758756 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:14:58.777758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.779761 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:14:58.746757 => 15:14:58.779761
[0m15:14:58.780760 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:14:58.783760 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.783760 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.784760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:58.784760 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:14:58.794262 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.795265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:14:58.796267 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.796267 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:14:58.796267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:58.857266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.858267 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.858267 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:14:58.864265 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.887269 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.887269 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.888268 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:14:58.888268 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.889268 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:14:58.889268 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:14:58.893268 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:14:58.901774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.901774 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.902774 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.928774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.976774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:14:58.998406 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:14:58.758756 => 15:14:58.998406
[0m15:14:58.998406 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:14:58.998406 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:14:58.998406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF17820>]}
[0m15:14:58.998406 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.26s]
[0m15:14:58.998406 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:14:58.998406 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:14:58.998406 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.014032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.014032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.016845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:14:58.784760 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:14:58.778757 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:14:59.017630 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:14:58.998406 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:14:59.017630 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:14:59.017630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF31930>]}
[0m15:14:59.017630 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:14:59.017630 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:14:59.017630 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:59.017630 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:14:59.017630 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.017630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:14:59.017630 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.017630 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:14:59.017630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.017630 [info ] [Thread-2 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:14:59.030174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:14:59.031180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:14:59.031539 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.031539 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.031539 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.043480 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.044916 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.044916 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.044916 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:14:59.017630 => 15:14:59.077266
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:14:59.083459 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m15:14:59.084464 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.084464 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.084464 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:14:59.085464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:14:59.085464 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.089464 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.089464 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:14:59.086463 => 15:14:59.089464
[0m15:14:59.090464 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.092464 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.092464 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.093464 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:14:59.093464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.111972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.111972 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.111972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.112972 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.114972 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:14:59.031539 => 15:14:59.113972
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:14:59.115972 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.10s]
[0m15:14:59.116973 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.143972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.143972 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.144972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.145972 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.146972 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:14:59.043480 => 15:14:59.146972
[0m15:14:59.146972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:14:59.147972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:14:59.148974 [warn ] [Thread-2 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.12s]
[0m15:14:59.148974 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.149973 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:14:59.149973 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:14:59.150973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:14:59.151973 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:14:59.153972 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:14:59.154972 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:14:59.151973 => 15:14:59.153972
[0m15:14:59.154972 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:14:59.175972 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:14:59.176972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.176972 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.177972 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.177972 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:14:59.178972 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.178972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.179975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.180978 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:14:59.090464 => 15:14:59.180978
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:14:59.182975 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:14:59.183976 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.183976 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:14:59.184976 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:14:59.184976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:14:59.185976 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:14:59.187975 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:14:59.188976 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:14:59.185976 => 15:14:59.188976
[0m15:14:59.188976 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:14:59.192975 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:14:59.192975 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.194478 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:14:59.194478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.228482 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.229482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.229482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.236482 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.240482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.241482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:14:59.241482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.244484 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.244484 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:14:59.245482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.250482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.250482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.251482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.251482 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.255481 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:14:59.258481 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.259482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:14:59.261483 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.262482 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:14:59.154972 => 15:14:59.261483
[0m15:14:59.262482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:14:59.263482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076320>]}
[0m15:14:59.263482 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m15:14:59.264483 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:14:59.266482 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.266482 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.267483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.274482 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:14:59.276481 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.276481 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:14:59.277481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.279483 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.279483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:14:59.280487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.281487 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.282486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.282486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.283486 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.285486 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:14:59.285486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.286486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:14:59.287487 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.288486 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:14:59.189976 => 15:14:59.288486
[0m15:14:59.289486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:14:59.289486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076A10>]}
[0m15:14:59.290486 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.10s]
[0m15:14:59.290486 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:14:59.291488 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.292487 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:14:59.292487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:14:59.293486 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:14:59.296558 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.296558 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:14:59.293486 => 15:14:59.296558
[0m15:14:59.297559 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:14:59.307676 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.307676 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.310179 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:14:59.310179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.410550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.411552 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.411552 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:14:59.413550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:14:59.415549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.416550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:14:59.417550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.418550 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.419550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.421550 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:14:59.423549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.423549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:14:59.424550 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:14:59.425549 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:14:59.297559 => 15:14:59.425549
[0m15:14:59.425549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:14:59.426550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD07AE90>]}
[0m15:14:59.426550 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:59.427550 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.428550 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.428550 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.429550 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:14:59.429550 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:14:59.430550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:14:59.431550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:14:59.431550 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.431550 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.435550 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.438550 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.439550 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:14:59.431550 => 15:14:59.438550
[0m15:14:59.439550 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:14:59.435550 => 15:14:59.439550
[0m15:14:59.439550 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.440550 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.441550 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.444550 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.444550 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.445550 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:14:59.445550 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.445550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.446551 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:14:59.446551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.504055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.504055 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.505055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.506055 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.507055 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:14:59.440550 => 15:14:59.507055
[0m15:14:59.507055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:14:59.508055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:14:59.509056 [warn ] [Thread-2 (]: 11 of 13 WARN 1 not_null_contacts_joined_with_transactions_id .................. [[33mWARN 1[0m in 0.08s]
[0m15:14:59.509056 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.542054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.543055 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.543055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.545055 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.546055 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:14:59.442550 => 15:14:59.546055
[0m15:14:59.546055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:14:59.547054 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:14:59.547054 [warn ] [Thread-3 (]: 12 of 13 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.12s]
[0m15:14:59.548055 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.549057 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:14:59.549057 [info ] [Thread-1 (]: 13 of 13 START sql table model public.customers ................................ [RUN]
[0m15:14:59.550055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:14:59.550055 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m15:14:59.599564 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:14:59.600565 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 15:14:59.551055 => 15:14:59.600565
[0m15:14:59.600565 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m15:14:59.603565 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m15:14:59.604565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.698081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.698081 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.699083 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:14:59.707080 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.709080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.709080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:14:59.710080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.711080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.712080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.712080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.713080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.715080 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:14:59.715080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.716080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:14:59.716080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.717080 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 15:14:59.601565 => 15:14:59.717080
[0m15:14:59.718080 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m15:14:59.718080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD156AD0>]}
[0m15:14:59.719080 [info ] [Thread-1 (]: 13 of 13 OK created sql table model public.customers ........................... [[32mSELECT 11[0m in 0.17s]
[0m15:14:59.720081 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:14:59.721081 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.721081 [debug] [MainThread]: On master: BEGIN
[0m15:14:59.721081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:59.787084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.787084 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.787084 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.788083 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.788083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.788083 [debug] [MainThread]: On master: Close
[0m15:14:59.789083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:14:59.791083 [info ] [MainThread]: 
[0m15:14:59.791083 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m15:14:59.793083 [debug] [MainThread]: Command end result
[0m15:14:59.798588 [info ] [MainThread]: 
[0m15:14:59.798588 [info ] [MainThread]: [33mCompleted with 3 warnings:[0m
[0m15:14:59.799589 [info ] [MainThread]: 
[0m15:14:59.799589 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:14:59.800589 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:14:59.800589 [info ] [MainThread]: 
[0m15:14:59.800589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:14:59.801589 [info ] [MainThread]: 
[0m15:14:59.801589 [warn ] [MainThread]: [33mWarning in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.801589 [warn ] [MainThread]: Got 1 result, configured to warn if >0
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.802589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.803590 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.803590 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:14:59.804590 [info ] [MainThread]: 
[0m15:14:59.804590 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:14:59.805590 [info ] [MainThread]: 
[0m15:14:59.805590 [info ] [MainThread]: Done. PASS=10 WARN=3 ERROR=0 SKIP=0 TOTAL=13
[0m15:14:59.806589 [debug] [MainThread]: Command `dbt build` succeeded at 15:14:59.806589 after 1.84 seconds
[0m15:14:59.807590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC8A3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD064610>]}
[0m15:14:59.807590 [debug] [MainThread]: Flushing usage events
[0m15:23:13.674580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82B30>]}


============================== 15:23:13.676967 | a202ad70-273e-41a2-8106-2ac270eb246f ==============================
[0m15:23:13.676967 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:23:13.677935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:13.785735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E33942E00>]}
[0m15:23:13.851843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>]}
[0m15:23:13.851843 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:23:13.860843 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\salesforce\_sf__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\web\_web__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\stg_sf__contacts.sql
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m15:23:14.121897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B339660>]}
[0m15:23:14.129402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2B1600>]}
[0m15:23:14.130728 [info ] [MainThread]: Found 2 seeds, 10 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:23:14.131734 [info ] [MainThread]: 
[0m15:23:14.132733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:14.133733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:23:14.139733 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:23:14.139733 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:23:14.140733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.193986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:23:14.194986 [debug] [ThreadPool]: On list_dbt: Close
[0m15:23:14.195987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:23:14.200067 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.200067 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:23:14.201055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.277752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.277752 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.278752 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:23:14.280751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:23:14.285750 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.285750 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.286753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:14.396798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.397798 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.397798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:14.401301 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:23:14.403304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F1C60>]}
[0m15:23:14.403304 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:14.403304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.404304 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.404304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.405304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.406304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.406304 [debug] [MainThread]: On master: Close
[0m15:23:14.407304 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:23:14.407304 [info ] [MainThread]: 
[0m15:23:14.409304 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:23:14.410304 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:23:14.410304 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.410304 [info ] [Thread-1 (]: 1 of 16 START seed file public.contacts ........................................ [RUN]
[0m15:23:14.411304 [info ] [Thread-2 (]: 2 of 16 START seed file public.transactions .................................... [RUN]
[0m15:23:14.412355 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:23:14.411304 [info ] [Thread-3 (]: 3 of 16 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:23:14.413435 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:23:14.413435 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:23:14.414473 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:23:14.414473 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:23:14.415441 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:23:14.414473 => 15:23:14.414473
[0m15:23:14.415441 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.415441 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:23:14.415441 => 15:23:14.415441
[0m15:23:14.416440 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:23:14.426438 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.427441 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:23:14.437474 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.437474 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:23:14.437474 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:23:14.416440 => 15:23:14.437474
[0m15:23:14.437474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:14.450125 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.450125 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.450125 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:23:14.462624 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.462624 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:23:14.463667 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.463667 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:23:14.464382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:14.512974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.512974 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.513976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:23:14.518973 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.540942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.541942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:23:14.542942 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:23:14.546941 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:23:14.555942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.555942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.556942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.556942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.557942 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.557942 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:23:14.558942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.559941 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:23:14.427441 => 15:23:14.559941
[0m15:23:14.559941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:23:14.560942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AE9E0>]}
[0m15:23:14.560942 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:23:14.561942 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:23:14.561942 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.562951 [info ] [Thread-1 (]: 4 of 16 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:23:14.562951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:23:14.563943 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.567942 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.568945 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.598947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.646459 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.646459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:23:14.661459 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:23:14.563943 => 15:23:14.661459
[0m15:23:14.664459 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.664459 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.665460 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:23:14.667460 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:23:14.669460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.669460 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:23:14.670462 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:23:14.672464 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.672464 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.673462 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.674460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.674460 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.675460 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:23:14.437474 => 15:23:14.675460
[0m15:23:14.676459 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:23:14.450125 => 15:23:14.676459
[0m15:23:14.677459 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:23:14.677459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:23:14.678461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F4310>]}
[0m15:23:14.678461 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:23:14.679460 [info ] [Thread-2 (]: 2 of 16 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:23:14.679460 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:23:14.679460 [info ] [Thread-3 (]: 3 of 16 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:23:14.680784 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.680784 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.681794 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.681794 [info ] [Thread-2 (]: 5 of 16 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:23:14.682792 [info ] [Thread-3 (]: 6 of 16 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.683793 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:23:14.686801 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.687800 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.691800 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.692800 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:23:14.683793 => 15:23:14.691800
[0m15:23:14.692800 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.694819 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.694819 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:23:14.687800 => 15:23:14.694819
[0m15:23:14.695980 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.696989 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.697987 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.697987 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:23:14.697987 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.698989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.698989 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:23:14.699987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.725532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.726530 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.726530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.727529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.728530 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:23:14.665460 => 15:23:14.728530
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:23:14.730530 [info ] [Thread-1 (]: 4 of 16 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m15:23:14.731530 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.731530 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.732532 [info ] [Thread-1 (]: 7 of 16 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:23:14.733534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:23:14.733534 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.736531 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.737532 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:23:14.733534 => 15:23:14.737532
[0m15:23:14.737532 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.739665 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:23:14.739665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:23:14.692800 => 15:23:14.744338
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:23:14.744338 [info ] [Thread-2 (]: 5 of 16 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.06s]
[0m15:23:14.744338 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.782655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.782655 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.783772 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.784422 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.784422 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:23:14.695980 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:23:14.784422 [warn ] [Thread-3 (]: 6 of 16 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m15:23:14.784422 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.784422 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [info ] [Thread-2 (]: 8 of 16 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:23:14.784422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:23:14.784422 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:23:14.784422 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:23:14.784422 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:23:14.816535 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:23:14.817535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.818535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.819537 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.819537 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.820535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.821535 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:23:14.737532 => 15:23:14.821535
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:23:14.823535 [info ] [Thread-1 (]: 7 of 16 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:23:14.824535 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.884536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.885536 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.885536 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:23:14.892543 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:23:14.897540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.897540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:23:14.898540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.900540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.900540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:23:14.901540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.906050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.907051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.911051 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:23:14.914050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.914050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:23:14.916133 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:14.916133 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:23:14.784422 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m15:23:14.916133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AF7F0>]}
[0m15:23:14.916133 [info ] [Thread-2 (]: 8 of 16 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.13s]
[0m15:23:14.916133 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:23:14.916133 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:23:14.916133 [info ] [Thread-3 (]: 9 of 16 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:23:14.916133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:23:14.916133 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:23:14.916133 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:23:14.916133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.986656 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.986656 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.987662 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:23:14.993661 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:23:14.996660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.996660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:23:14.997660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.999660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.038166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.038166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.039166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.040167 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.041166 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:23:15.042166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.042166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:23:15.044168 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.045168 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:23:14.916133 => 15:23:15.045168
[0m15:23:15.046295 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:23:15.046295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B451CF0>]}
[0m15:23:15.046295 [info ] [Thread-3 (]: 9 of 16 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 101[0m in 0.13s]
[0m15:23:15.046295 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:23:15.046295 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:23:15.046295 [info ] [Thread-1 (]: 11 of 16 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:23:15.046295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:23:15.046295 [info ] [Thread-3 (]: 12 of 16 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:23:15.046295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:23:15.046295 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:23:15.046295 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.046295 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.046295 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.063040 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:23:15.046295 => 15:23:15.062038
[0m15:23:15.063547 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:23:15.046295 => 15:23:15.063040
[0m15:23:15.063547 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.064470 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:23:15.046295 => 15:23:15.063547
[0m15:23:15.064470 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.066513 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.066513 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.068512 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.070509 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.070509 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.071508 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:23:15.071508 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.071508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.072509 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.073507 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:23:15.073507 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:23:15.073507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.074476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.122017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.122017 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.122017 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.123078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.124020 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:23:15.064470 => 15:23:15.124020
[0m15:23:15.125020 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:23:15.126018 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:23:15.126018 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m15:23:15.127025 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.151287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.152287 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.152287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:23:15.153287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.154288 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:23:15.067510 => 15:23:15.154288
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:23:15.156287 [info ] [Thread-1 (]: 11 of 16 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m15:23:15.157656 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.181701 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.182704 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.182704 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.183696 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.185700 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:23:15.068512 => 15:23:15.184701
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:23:15.186741 [info ] [Thread-3 (]: 12 of 16 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m15:23:15.187741 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.187741 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.188741 [info ] [Thread-2 (]: 13 of 16 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:23:15.189744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now model.customer360.contacts_joined_with_transactions)
[0m15:23:15.189744 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:23:15.191741 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.192743 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:23:15.189744 => 15:23:15.192743
[0m15:23:15.192743 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:23:15.204216 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:23:15.205216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.310792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:23:15.192743 => 15:23:15.312169
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:23:15.312169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B54FF10>]}
[0m15:23:15.312169 [info ] [Thread-2 (]: 13 of 16 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.12s]
[0m15:23:15.327795 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.327795 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [info ] [Thread-3 (]: 14 of 16 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:23:15.328875 [info ] [Thread-1 (]: 15 of 16 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:23:15.343885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.328875 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.343885 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:23:15.345088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.391471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.392470 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.392470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.394473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.395471 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:23:15.328875 => 15:23:15.395471
[0m15:23:15.395471 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:23:15.396470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:23:15.396470 [info ] [Thread-3 (]: 14 of 16 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:23:15.397490 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.427158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.436048 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.436800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.436800 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:23:15.328875 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:23:15.436800 [warn ] [Thread-1 (]: 15 of 16 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.11s]
[0m15:23:15.436800 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.436800 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:23:15.436800 [info ] [Thread-2 (]: 16 of 16 START sql table model public.customers ................................ [RUN]
[0m15:23:15.436800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:23:15.436800 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m15:23:15.436800 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:23:15.436800 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 15:23:15.436800 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m15:23:15.449651 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m15:23:15.451656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.511277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.512277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.512277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:23:15.533277 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:23:15.536277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.536277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:23:15.537277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.539277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.541277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.542278 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.544277 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:23:15.544277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.545277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:23:15.546279 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.547277 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 15:23:15.436800 => 15:23:15.547277
[0m15:23:15.547277 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m15:23:15.548278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B12E950>]}
[0m15:23:15.548278 [info ] [Thread-2 (]: 16 of 16 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.11s]
[0m15:23:15.549278 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:23:15.550277 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.550277 [debug] [MainThread]: On master: BEGIN
[0m15:23:15.551280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:15.610495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.611490 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.612490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.612490 [debug] [MainThread]: On master: Close
[0m15:23:15.613490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:23:15.614493 [info ] [MainThread]: 
[0m15:23:15.615490 [info ] [MainThread]: Finished running 2 seeds, 10 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m15:23:15.617490 [debug] [MainThread]: Command end result
[0m15:23:15.623491 [info ] [MainThread]: 
[0m15:23:15.624489 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:23:15.624489 [info ] [MainThread]: 
[0m15:23:15.625498 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:23:15.625498 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.626496 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.627491 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:23:15.627491 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:23:15.628491 [info ] [MainThread]: 
[0m15:23:15.628491 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:23:15.629495 [info ] [MainThread]: 
[0m15:23:15.629495 [info ] [MainThread]: Done. PASS=14 WARN=2 ERROR=0 SKIP=0 TOTAL=16
[0m15:23:15.630461 [debug] [MainThread]: Command `dbt build` succeeded at 15:23:15.630461 after 2.01 seconds
[0m15:23:15.630461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B275780>]}
[0m15:23:15.631458 [debug] [MainThread]: Flushing usage events
[0m15:30:34.852339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7FD784580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780C22DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780C22B30>]}


============================== 15:30:34.854339 | 0aa6c457-0e5b-4485-8581-d9a0c4ac6a10 ==============================
[0m15:30:34.854339 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:30:34.855339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:30:34.968993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F9832E00>]}
[0m15:30:35.034556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780E6A440>]}
[0m15:30:35.035558 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:30:35.044557 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:30:35.123024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:35.123024 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\_sf__stg.yaml
[0m15:30:35.232672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78126C0D0>]}
[0m15:30:35.248298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7810616F0>]}
[0m15:30:35.248298 [info ] [MainThread]: Found 2 seeds, 12 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:30:35.248298 [info ] [MainThread]: 
[0m15:30:35.248298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:35.248298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:30:35.264826 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:30:35.264826 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:30:35.265994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:35.320245 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:30:35.321246 [debug] [ThreadPool]: On list_dbt: Close
[0m15:30:35.323245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:30:35.326244 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:30:35.327244 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:30:35.327244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:35.373870 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.373870 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:30:35.373870 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:30:35.376869 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:30:35.377871 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:30:35.377871 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:30:35.381869 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.382636 [debug] [MainThread]: On master: BEGIN
[0m15:30:35.382636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:35.428144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.428144 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.429144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:35.432144 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:30:35.433144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7812DD4E0>]}
[0m15:30:35.433144 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:35.434144 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.434144 [debug] [MainThread]: On master: BEGIN
[0m15:30:35.434144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.435145 [debug] [MainThread]: On master: COMMIT
[0m15:30:35.435145 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.435145 [debug] [MainThread]: On master: COMMIT
[0m15:30:35.436144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.436144 [debug] [MainThread]: On master: Close
[0m15:30:35.436144 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:30:35.437144 [info ] [MainThread]: 
[0m15:30:35.439144 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:30:35.440144 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:30:35.440144 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.440144 [info ] [Thread-1 (]: 1 of 18 START seed file public.contacts ........................................ [RUN]
[0m15:30:35.441144 [info ] [Thread-2 (]: 2 of 18 START seed file public.transactions .................................... [RUN]
[0m15:30:35.441144 [info ] [Thread-3 (]: 3 of 18 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:30:35.442144 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:30:35.443146 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:30:35.443146 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:30:35.444145 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:30:35.444145 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:30:35.444145 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.445144 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:30:35.445144 => 15:30:35.445144
[0m15:30:35.445144 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:30:35.445144 => 15:30:35.445144
[0m15:30:35.457144 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.458144 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:30:35.458144 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:30:35.469144 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:30:35.445144 => 15:30:35.468144
[0m15:30:35.480144 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.480144 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.483147 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.483147 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:30:35.493147 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.493147 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:30:35.494147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:35.494147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:35.495147 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.495147 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:30:35.496149 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:35.544745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.544745 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.545748 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:30:35.550745 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:30:35.573748 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.574746 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:30:35.574746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.575746 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.575746 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:30:35.575746 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:30:35.579745 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:30:35.588752 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:30:35.589751 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:30:35.589751 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.636999 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.668764 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:30:35.686852 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.686852 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.687811 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:30:35.687811 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:30:35.688811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.689967 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:30:35.458144 => 15:30:35.689967
[0m15:30:35.689967 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:30:35.689967 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:30:35.689967 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:30:35.689967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7813AFF70>]}
[0m15:30:35.689967 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:30:35.689967 [info ] [Thread-1 (]: 1 of 18 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.25s]
[0m15:30:35.689967 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.689967 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:30:35.689967 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:30:35.689967 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.697472 [info ] [Thread-1 (]: 4 of 18 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:30:35.697472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:30:35.697472 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.697472 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.697472 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.697472 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:30:35.469144 => 15:30:35.697472
[0m15:30:35.697472 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:30:35.484147 => 15:30:35.697472
[0m15:30:35.705477 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.706055 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:30:35.706055 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:30:35.707131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C781330EB0>]}
[0m15:30:35.707131 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:30:35.697472 => 15:30:35.707131
[0m15:30:35.707131 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:30:35.707131 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.707131 [info ] [Thread-2 (]: 2 of 18 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m15:30:35.707131 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.707131 [info ] [Thread-3 (]: 3 of 18 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m15:30:35.707131 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:30:35.707131 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.707131 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.707131 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.707131 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.707131 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:30:35.715245 [info ] [Thread-2 (]: 5 of 18 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:30:35.716252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:35.715245 [info ] [Thread-3 (]: 6 of 18 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:30:35.716588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:30:35.716588 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:30:35.716588 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.716588 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.716588 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.716588 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.716588 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:30:35.716588 => 15:30:35.716588
[0m15:30:35.716588 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:30:35.716588 => 15:30:35.716588
[0m15:30:35.716588 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.716588 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.730141 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.730141 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.730141 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.730141 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.730141 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:30:35.730141 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:30:35.730141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:35.730141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:35.785451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.786452 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.786452 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:30:35.787841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.788845 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:30:35.707131 => 15:30:35.788845
[0m15:30:35.788845 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:30:35.789844 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:30:35.790844 [info ] [Thread-1 (]: 4 of 18 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m15:30:35.791846 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.791846 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.792845 [info ] [Thread-1 (]: 7 of 18 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:30:35.792845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:30:35.793845 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.795845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.797348 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:30:35.793845 => 15:30:35.797348
[0m15:30:35.798352 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.799353 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.800352 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.800352 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:30:35.801353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:35.806352 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.806352 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.806352 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:35.807352 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.809353 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:30:35.716588 => 15:30:35.809353
[0m15:30:35.809353 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:30:35.810352 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:30:35.811353 [info ] [Thread-2 (]: 5 of 18 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.09s]
[0m15:30:35.811353 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.845352 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.845352 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.846352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:35.847353 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.848352 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:30:35.730141 => 15:30:35.848352
[0m15:30:35.849352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:30:35.849352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:30:35.850352 [warn ] [Thread-3 (]: 6 of 18 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.13s]
[0m15:30:35.851352 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.851352 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:30:35.852353 [info ] [Thread-2 (]: 8 of 18 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:30:35.853353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:30:35.853353 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:30:35.855352 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:30:35.856352 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:30:35.853353 => 15:30:35.856352
[0m15:30:35.856352 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:30:35.878352 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:30:35.879353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.879353 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.880354 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.880354 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:30:35.881352 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:35.881352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:35.882352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.883357 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:30:35.798352 => 15:30:35.883357
[0m15:30:35.884355 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:30:35.884355 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:30:35.885355 [info ] [Thread-1 (]: 7 of 18 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:30:35.885355 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.938862 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.938862 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.939862 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:30:35.946863 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:30:35.951863 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.951863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:30:35.952864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:35.954862 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.954862 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:30:35.955862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:35.960863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:30:35.960863 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.960863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:30:35.961862 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.965863 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:30:35.968927 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.968927 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:30:35.968927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:35.968927 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:30:35.857352 => 15:30:35.968927
[0m15:30:35.968927 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m15:30:35.968927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7814B8D90>]}
[0m15:30:35.968927 [info ] [Thread-2 (]: 8 of 18 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m15:30:35.968927 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:30:35.968927 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.968927 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.968927 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m15:30:35.968927 [info ] [Thread-1 (]: 10 of 18 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m15:30:35.968927 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m15:30:35.968927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m15:30:35.968927 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.968927 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.968927 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.968927 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.985211 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 15:30:35.968927 => 15:30:35.985211
[0m15:30:35.986216 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.986216 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 15:30:35.968927 => 15:30:35.986216
[0m15:30:35.986216 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.986216 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.986216 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.986216 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.986216 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.986216 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m15:30:35.986216 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m15:30:35.986216 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:35.986216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.039784 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.039784 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:36.039784 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m15:30:36.040783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.042785 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 15:30:35.986216 => 15:30:36.041785
[0m15:30:36.042785 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m15:30:36.042785 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m15:30:36.043784 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m15:30:36.044785 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:36.068989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.068989 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:36.068989 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.070989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.071988 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 15:30:35.986216 => 15:30:36.071988
[0m15:30:36.071988 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m15:30:36.071988 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m15:30:36.072988 [info ] [Thread-1 (]: 10 of 18 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m15:30:36.073989 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:36.074989 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:30:36.074989 [info ] [Thread-2 (]: 11 of 18 START sql table model public.stg_web__transactions .................... [RUN]
[0m15:30:36.075989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m15:30:36.075989 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:30:36.080987 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:30:36.080987 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:30:36.076989 => 15:30:36.080987
[0m15:30:36.081988 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:30:36.083991 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:30:36.084991 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.084991 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:30:36.085991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.131499 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.131499 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.132498 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:30:36.139380 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:30:36.142380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.142380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:30:36.143380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.145379 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.145379 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:30:36.145379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.147380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:30:36.147380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.147380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:30:36.148380 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.150379 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:30:36.151380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.151380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:30:36.152438 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:36.153443 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:30:36.081988 => 15:30:36.153443
[0m15:30:36.154444 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:30:36.154444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7814C6530>]}
[0m15:30:36.155444 [info ] [Thread-2 (]: 11 of 18 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m15:30:36.156445 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:30:36.156445 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.157444 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.157444 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.158444 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:30:36.158444 [info ] [Thread-3 (]: 13 of 18 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:30:36.158444 [info ] [Thread-2 (]: 14 of 18 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:30:36.159443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:30:36.159443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:30:36.160445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:30:36.160445 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.161443 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.161443 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.164444 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.169443 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.172445 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.173451 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:30:36.161443 => 15:30:36.173451
[0m15:30:36.173451 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.174444 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:30:36.164444 => 15:30:36.173451
[0m15:30:36.174444 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:30:36.169443 => 15:30:36.174444
[0m15:30:36.176443 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.176443 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.176443 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.178443 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.179443 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.180443 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.181443 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:30:36.181443 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.182444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.182444 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.182444 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:30:36.183448 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:30:36.183448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:36.184447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.229005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.229005 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.230005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:36.231005 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.232005 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:30:36.174444 => 15:30:36.231005
[0m15:30:36.232005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:30:36.232005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:30:36.233005 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.07s]
[0m15:30:36.234006 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.259006 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.259006 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.259006 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:30:36.261007 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.262006 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:30:36.177444 => 15:30:36.262006
[0m15:30:36.262006 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:30:36.263005 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:30:36.264006 [info ] [Thread-3 (]: 13 of 18 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.10s]
[0m15:30:36.265007 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.288346 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.288346 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.289347 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.290347 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.291634 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:30:36.179443 => 15:30:36.291634
[0m15:30:36.291634 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:30:36.291634 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:30:36.291634 [info ] [Thread-2 (]: 14 of 18 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.13s]
[0m15:30:36.291634 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.291634 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:30:36.291634 [info ] [Thread-1 (]: 15 of 18 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:30:36.291634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now model.customer360.contacts_joined_with_transactions)
[0m15:30:36.291634 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:30:36.297638 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.297638 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:30:36.291634 => 15:30:36.297638
[0m15:30:36.297638 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:30:36.303309 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.303309 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.303309 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:30:36.303309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.359043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.359043 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.360043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:30:36.362045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:30:36.364043 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.364043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:30:36.365043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.366045 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:30:36.366045 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.367043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:30:36.367666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.370050 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:30:36.372051 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.372051 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:30:36.373051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:30:36.374051 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:30:36.297638 => 15:30:36.374051
[0m15:30:36.374051 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:30:36.375051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C781527460>]}
[0m15:30:36.375051 [info ] [Thread-1 (]: 15 of 18 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m15:30:36.376051 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:30:36.377052 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.377052 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.377052 [info ] [Thread-2 (]: 16 of 18 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:30:36.378052 [info ] [Thread-3 (]: 17 of 18 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:30:36.378052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:30:36.379051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:30:36.379051 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.380051 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.383053 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.385056 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.386056 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:30:36.380051 => 15:30:36.386056
[0m15:30:36.387055 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:30:36.383053 => 15:30:36.386056
[0m15:30:36.387055 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.387055 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.389053 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.390055 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.391054 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.391054 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.392054 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:30:36.392054 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:30:36.392054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.393054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:36.438917 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.438917 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.439917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:36.440917 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.441917 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:30:36.387055 => 15:30:36.441917
[0m15:30:36.442917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:30:36.442917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:30:36.443918 [info ] [Thread-2 (]: 16 of 18 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:30:36.444918 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.467917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.467917 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.468917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.469919 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.470919 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:30:36.389053 => 15:30:36.470919
[0m15:30:36.471917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:30:36.471917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:30:36.472918 [warn ] [Thread-3 (]: 17 of 18 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.09s]
[0m15:30:36.472918 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.473919 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:30:36.473919 [info ] [Thread-1 (]: 18 of 18 START sql table model public.customers ................................ [RUN]
[0m15:30:36.474918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:30:36.475918 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m15:30:36.477918 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:30:36.478917 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 15:30:36.475918 => 15:30:36.478917
[0m15:30:36.478917 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m15:30:36.481917 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:30:36.482920 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.482920 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m15:30:36.482920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.530427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.530427 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.531428 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:30:36.538157 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:30:36.540160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.541160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:30:36.541160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.544160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.544160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:30:36.545160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.546163 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:30:36.547162 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.547162 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:30:36.548162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.549161 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:30:36.550160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.550160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:30:36.552162 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:36.552162 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 15:30:36.479918 => 15:30:36.552162
[0m15:30:36.553162 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m15:30:36.553162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7812B2A70>]}
[0m15:30:36.554161 [info ] [Thread-1 (]: 18 of 18 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m15:30:36.555161 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:30:36.556161 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:36.556161 [debug] [MainThread]: On master: BEGIN
[0m15:30:36.557162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:36.599037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.599037 [debug] [MainThread]: On master: COMMIT
[0m15:30:36.599037 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:36.599037 [debug] [MainThread]: On master: COMMIT
[0m15:30:36.599037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.599037 [debug] [MainThread]: On master: Close
[0m15:30:36.599037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:30:36.599037 [info ] [MainThread]: 
[0m15:30:36.608688 [info ] [MainThread]: Finished running 2 seeds, 12 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m15:30:36.611000 [debug] [MainThread]: Command end result
[0m15:30:36.611000 [info ] [MainThread]: 
[0m15:30:36.611000 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:30:36.618309 [info ] [MainThread]: 
[0m15:30:36.618813 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:30:36.618813 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:30:36.618813 [info ] [MainThread]: 
[0m15:30:36.618813 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:30:36.618813 [info ] [MainThread]: 
[0m15:30:36.618813 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:30:36.618813 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:30:36.622043 [info ] [MainThread]: 
[0m15:30:36.622043 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:30:36.623049 [info ] [MainThread]: 
[0m15:30:36.623474 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=0 SKIP=0 TOTAL=18
[0m15:30:36.624008 [debug] [MainThread]: Command `dbt build` succeeded at 15:30:36.624008 after 1.81 seconds
[0m15:30:36.624008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7FD784580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78150C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7810574F0>]}
[0m15:30:36.624008 [debug] [MainThread]: Flushing usage events
[0m15:35:14.133851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D7E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AB90>]}


============================== 15:35:14.136851 | 02522713-1f07-4b31-a648-6a1f64acb74e ==============================
[0m15:35:14.136851 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:35:14.137850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:14.260872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AE30>]}
[0m15:35:14.318379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB37F850>]}
[0m15:35:14.319379 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:35:14.329584 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:35:14.409096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:14.410096 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__sources.yml
[0m15:35:14.669665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB980100>]}
[0m15:35:14.677637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4CAD70>]}
[0m15:35:14.677637 [info ] [MainThread]: Found 2 seeds, 12 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:35:14.678667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4CABC0>]}
[0m15:35:14.679666 [info ] [MainThread]: 
[0m15:35:14.680628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:14.681627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:35:14.687627 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:35:14.687627 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:35:14.687627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:14.740342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.740342 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:35:14.741387 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:35:14.743388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:35:14.744390 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:35:14.744390 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:35:14.748386 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:14.749348 [debug] [MainThread]: On master: BEGIN
[0m15:35:14.749348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:14.794540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.794540 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:14.795547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:14.798585 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:35:14.799585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4C9420>]}
[0m15:35:14.799585 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:14.799585 [debug] [MainThread]: On master: Close
[0m15:35:14.800587 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:35:14.801547 [info ] [MainThread]: 
[0m15:35:14.802568 [debug] [Thread-1 (]: Began running node source.customer360.web.transactions
[0m15:35:14.803573 [info ] [Thread-1 (]: 1 of 1 START freshness of web.transactions ..................................... [RUN]
[0m15:35:14.804573 [debug] [Thread-1 (]: Acquiring new postgres connection 'source.customer360.web.transactions'
[0m15:35:14.804573 [debug] [Thread-1 (]: Began compiling node source.customer360.web.transactions
[0m15:35:14.804573 [debug] [Thread-1 (]: Timing info for source.customer360.web.transactions (compile): 15:35:14.804573 => 15:35:14.804573
[0m15:35:14.805572 [debug] [Thread-1 (]: Began executing node source.customer360.web.transactions
[0m15:35:14.805572 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.806571 [debug] [Thread-1 (]: On source.customer360.web.transactions: BEGIN
[0m15:35:14.806571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:14.851574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.851574 [debug] [Thread-1 (]: On source.customer360.web.transactions: COMMIT
[0m15:35:14.852574 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.852574 [debug] [Thread-1 (]: On source.customer360.web.transactions: COMMIT
[0m15:35:14.853574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:35:14.858574 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.859574 [debug] [Thread-1 (]: On source.customer360.web.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "source.customer360.web.transactions"} */
select
      max(_loaded_at_utc) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."public"."transactions"
    
  
[0m15:35:14.860575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:35:14.861575 [debug] [Thread-1 (]: On source.customer360.web.transactions: Close
[0m15:35:14.861575 [debug] [Thread-1 (]: Timing info for source.customer360.web.transactions (execute): 15:35:14.805572 => 15:35:14.861575
[0m15:35:14.862575 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of web.transactions ............................... [[31mERROR STALE[0m in 0.06s]
[0m15:35:14.863574 [debug] [Thread-1 (]: Finished running node source.customer360.web.transactions
[0m15:35:14.863574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:14.863574 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:35:14.865078 [debug] [MainThread]: Connection 'source.customer360.web.transactions' was properly closed.
[0m15:35:14.870081 [info ] [MainThread]: 
[0m15:35:14.870081 [info ] [MainThread]: Done.
[0m15:35:14.872082 [debug] [MainThread]: Command `dbt source freshness` failed at 15:35:14.871082 after 0.78 seconds
[0m15:35:14.872082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D7E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB882EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB6506A0>]}
[0m15:35:14.872082 [debug] [MainThread]: Flushing usage events
[0m15:49:38.135680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A2767220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5A5EDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5A5EB30>]}


============================== 15:49:38.135680 | 6fa245b3-eca7-46bc-bd90-1319916dcad0 ==============================
[0m15:49:38.135680 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:49:38.135680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s stg_web__transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:38.254965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fa245b3-eca7-46bc-bd90-1319916dcad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49E6F0AC0>]}
[0m15:49:38.325835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fa245b3-eca7-46bc-bd90-1319916dcad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5CA2440>]}
[0m15:49:38.325835 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:49:38.338304 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:49:38.417073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:49:38.418074 [debug] [MainThread]: Partial parsing: added file: customer360://macros\value_above_zero.sql
[0m15:49:38.418074 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__stg.yaml
[0m15:49:38.590716 [error] [MainThread]: Encountered an error:
Compilation Error in test value_above_zero_stg_web__transactions_amount (models\staging\web\_web__stg.yaml)
  macro 'dbt_macro__test_value_above_zero' takes no keyword argument 'column_name'
[0m15:49:38.590716 [debug] [MainThread]: Command `dbt test` failed at 15:49:38.590716 after 0.50 seconds
[0m15:49:38.590716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A2767220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A606A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A607AFB0>]}
[0m15:49:38.590716 [debug] [MainThread]: Flushing usage events
[0m15:50:29.566413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A972B42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A5AEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A5AEB90>]}


============================== 15:50:29.568412 | a57a03aa-d284-4691-9eba-6c473c7483ae ==============================
[0m15:50:29.568412 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:50:29.569412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s stg_web__transactions', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:29.689920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A93290AC0>]}
[0m15:50:29.747090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A7ED390>]}
[0m15:50:29.748090 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:50:29.757090 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:50:29.832013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:50:29.832013 [debug] [MainThread]: Partial parsing: added file: customer360://macros\value_above_zero.sql
[0m15:50:29.833014 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__stg.yaml
[0m15:50:30.021388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AD600D0>]}
[0m15:50:30.029389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AC839D0>]}
[0m15:50:30.029389 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m15:50:30.030389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AAC7790>]}
[0m15:50:30.031388 [info ] [MainThread]: 
[0m15:50:30.032388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:30.033388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:50:30.039388 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:30.039388 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:50:30.040388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:30.086783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.087783 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:30.088783 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:30.090783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:50:30.091783 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:50:30.091783 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:50:30.095784 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.096784 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.096784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:30.141966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.141966 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.142967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:30.145965 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:30.146965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9ACAA410>]}
[0m15:50:30.146965 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:30.147966 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.147966 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.147966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.148965 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.148965 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.148965 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.149966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:30.149966 [debug] [MainThread]: On master: Close
[0m15:50:30.150966 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:50:30.150966 [info ] [MainThread]: 
[0m15:50:30.153386 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.153386 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.154388 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.154388 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_web__transactions_id ............................ [RUN]
[0m15:50:30.155387 [info ] [Thread-2 (]: 2 of 4 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:50:30.155387 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_web__transactions_id .............................. [RUN]
[0m15:50:30.156387 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m15:50:30.156387 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m15:50:30.157387 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.unique_stg_web__transactions_id.5518387fef'
[0m15:50:30.157387 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.157387 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.158386 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.166388 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.170386 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.174386 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.175386 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:50:30.158386 => 15:50:30.175386
[0m15:50:30.175386 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:50:30.167388 => 15:50:30.175386
[0m15:50:30.176387 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:50:30.171386 => 15:50:30.176387
[0m15:50:30.176387 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.177386 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.177386 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.185400 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.187387 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.189386 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.189386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.190387 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:50:30.190387 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.190387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:30.191387 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.191387 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:50:30.192387 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:50:30.192387 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:30.192387 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:30.236909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.236909 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.237910 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:30.238910 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.239910 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:50:30.177386 => 15:50:30.239910
[0m15:50:30.240909 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:50:30.240909 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:50:30.241910 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m15:50:30.241910 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.242911 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.242911 [info ] [Thread-1 (]: 4 of 4 START test value_above_zero_stg_web__transactions_amount ................ [RUN]
[0m15:50:30.243911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m15:50:30.243911 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.245985 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 15:50:30.244910 => 15:50:30.245985
[0m15:50:30.245985 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.245985 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m15:50:30.245985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:30.269975 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.270977 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.270977 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:50:30.272977 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.273978 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:50:30.186388 => 15:50:30.273978
[0m15:50:30.273978 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:50:30.274977 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:50:30.274977 [info ] [Thread-2 (]: 2 of 4 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.12s]
[0m15:50:30.275976 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.299838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.299838 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.300837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:30.301837 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.302837 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:50:30.187387 => 15:50:30.302837
[0m15:50:30.302837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:50:30.303837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:50:30.304838 [info ] [Thread-3 (]: 3 of 4 PASS unique_stg_web__transactions_id .................................... [[32mPASS[0m in 0.15s]
[0m15:50:30.305002 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.450470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.451470 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.451470 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m15:50:30.452470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.453470 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 15:50:30.245985 => 15:50:30.453470
[0m15:50:30.454471 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m15:50:30.454471 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m15:50:30.455470 [info ] [Thread-1 (]: 4 of 4 PASS value_above_zero_stg_web__transactions_amount ...................... [[32mPASS[0m in 0.21s]
[0m15:50:30.456735 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.457791 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.457791 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.457791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:30.504287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.504287 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.504287 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.504287 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.504287 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:30.504287 [debug] [MainThread]: On master: Close
[0m15:50:30.504287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m15:50:30.504287 [info ] [MainThread]: 
[0m15:50:30.504287 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:50:30.509977 [debug] [MainThread]: Command end result
[0m15:50:30.517023 [info ] [MainThread]: 
[0m15:50:30.518024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:30.518024 [info ] [MainThread]: 
[0m15:50:30.518024 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:50:30.519023 [debug] [MainThread]: Command `dbt test` succeeded at 15:50:30.519023 after 0.99 seconds
[0m15:50:30.520023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A972B42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AD01F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AE3FCD0>]}
[0m15:50:30.520023 [debug] [MainThread]: Flushing usage events
[0m15:50:48.614704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0A9C5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DCC2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DCC2BC0>]}


============================== 15:50:48.617710 | 93af4816-6c4a-4c30-8470-2dabf12e99cc ==============================
[0m15:50:48.617710 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:50:48.618709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:50:48.739138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D069C2E00>]}
[0m15:50:48.797138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DF09930>]}
[0m15:50:48.798136 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:50:48.807137 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:50:48.885079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:48.885079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:48.889079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E14CA00>]}
[0m15:50:48.897079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E05F400>]}
[0m15:50:48.897079 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m15:50:48.899079 [info ] [MainThread]: 
[0m15:50:48.900080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:48.901080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:50:48.907079 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:50:48.907079 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:50:48.908079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:48.956591 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:50:48.957591 [debug] [ThreadPool]: On list_dbt: Close
[0m15:50:48.959591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:50:48.962589 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:48.963590 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:50:48.963590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:49.009687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.009687 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:49.009687 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:49.012686 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:50:49.013688 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:50:49.013688 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:50:49.017688 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.017688 [debug] [MainThread]: On master: BEGIN
[0m15:50:49.018686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:49.063197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.064197 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.064197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:49.067196 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:49.068198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1A21D0>]}
[0m15:50:49.069198 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:49.069198 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.069198 [debug] [MainThread]: On master: BEGIN
[0m15:50:49.070197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.070197 [debug] [MainThread]: On master: COMMIT
[0m15:50:49.070197 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.071198 [debug] [MainThread]: On master: COMMIT
[0m15:50:49.071198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.072198 [debug] [MainThread]: On master: Close
[0m15:50:49.072198 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:50:49.073197 [info ] [MainThread]: 
[0m15:50:49.075196 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:50:49.075196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:50:49.076197 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.076197 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m15:50:49.077198 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m15:50:49.077198 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:50:49.078197 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:50:49.078197 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:50:49.079198 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:50:49.079198 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:50:49.080197 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:50:49.080197 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.080197 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:50:49.080197 => 15:50:49.080197
[0m15:50:49.081197 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:50:49.081197 => 15:50:49.081197
[0m15:50:49.093196 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.094197 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:50:49.094197 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:50:49.105196 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:50:49.081197 => 15:50:49.105196
[0m15:50:49.106196 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.116196 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.119197 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.129199 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.129199 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:50:49.130200 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:50:49.130200 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:49.131200 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:49.131200 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.132199 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:50:49.132199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:49.178024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.179024 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.179024 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:50:49.185023 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:50:49.208024 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.209045 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:50:49.210026 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:50:49.213024 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:50:49.214024 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.223024 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:50:49.223024 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.224029 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.224029 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:50:49.225030 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:50:49.226028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.227029 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:50:49.094197 => 15:50:49.227029
[0m15:50:49.228028 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:50:49.228028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E22BC10>]}
[0m15:50:49.231029 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:50:49.231029 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:50:49.260162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.329321 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.329321 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:50:49.330262 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.330262 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:50:49.331261 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.331671 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:50:49.332717 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:50:49.333718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:50:49.333718 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.333718 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:50:49.338676 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.338676 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:50:49.340180 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:50:49.333718 => 15:50:49.340180
[0m15:50:49.341181 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:50:49.341181 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.342181 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.343180 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.344179 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:50:49.344179 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.345180 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:50:49.345180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.345180 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.345180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.347181 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:50:49.119197 => 15:50:49.347181
[0m15:50:49.348180 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:50:49.104196 => 15:50:49.348180
[0m15:50:49.348180 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:50:49.348180 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:50:49.350179 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:50:49.350179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1E02B0>]}
[0m15:50:49.351181 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:50:49.352180 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:50:49.353180 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.353180 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:50:49.354180 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.355180 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.355180 [info ] [Thread-3 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:50:49.356180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:50:49.355180 [info ] [Thread-2 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:50:49.356180 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.357180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:50:49.360179 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.360179 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.365181 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.365181 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:50:49.357180 => 15:50:49.365181
[0m15:50:49.366180 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:50:49.361180 => 15:50:49.366180
[0m15:50:49.366180 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.367181 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.369181 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.371179 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.371179 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.372179 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:50:49.372179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.373180 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.373180 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:50:49.374179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.393180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.393180 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.394181 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:50:49.395180 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.396180 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:50:49.342181 => 15:50:49.396180
[0m15:50:49.396180 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:50:49.397179 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:50:49.398179 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.06s]
[0m15:50:49.398179 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.399180 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.399180 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:50:49.400179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:50:49.400179 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.403179 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.404180 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:50:49.400179 => 15:50:49.404180
[0m15:50:49.404180 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.406181 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.407179 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.407179 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:50:49.407179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.423179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.424183 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.424183 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:49.425182 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.426183 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:50:49.367181 => 15:50:49.426183
[0m15:50:49.427182 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:50:49.427182 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:50:49.428183 [info ] [Thread-3 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m15:50:49.429183 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.483072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.484072 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.484072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.485072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.486072 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:50:49.405180 => 15:50:49.486072
[0m15:50:49.487072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:50:49.487072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:50:49.488072 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:50:49.489072 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.556673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.556673 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.557675 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.558674 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.559673 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:50:49.369181 => 15:50:49.559673
[0m15:50:49.559673 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:50:49.560673 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:50:49.561673 [warn ] [Thread-2 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.20s]
[0m15:50:49.561673 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.562674 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:50:49.563674 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:50:49.563674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:50:49.564674 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:50:49.566673 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:50:49.567673 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:50:49.564674 => 15:50:49.566673
[0m15:50:49.567673 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:50:49.588673 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:50:49.589673 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.590674 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:50:49.590674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.636247 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.637248 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.637248 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:50:49.644754 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.663669 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:50:49.666668 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.667668 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:50:49.669669 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:49.670668 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:50:49.567673 => 15:50:49.670668
[0m15:50:49.670668 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:50:49.671668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E368400>]}
[0m15:50:49.672670 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m15:50:49.672670 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:50:49.673669 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.673669 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.674670 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m15:50:49.674670 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m15:50:49.675669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m15:50:49.675669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m15:50:49.676669 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.676669 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.679668 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.682668 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.682668 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 15:50:49.676669 => 15:50:49.682668
[0m15:50:49.683669 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 15:50:49.679668 => 15:50:49.683669
[0m15:50:49.683669 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.683669 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.685670 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.687669 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.687669 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.688668 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.688668 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m15:50:49.689669 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m15:50:49.689669 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.689669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.741181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.742181 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.742181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m15:50:49.743183 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.744181 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 15:50:49.684669 => 15:50:49.744181
[0m15:50:49.745181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m15:50:49.745181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m15:50:49.746181 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m15:50:49.747181 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.776689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.776689 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.777691 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.778689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.779689 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 15:50:49.685670 => 15:50:49.779689
[0m15:50:49.779689 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m15:50:49.780689 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m15:50:49.781690 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.11s]
[0m15:50:49.781690 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.782691 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:50:49.783690 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m15:50:49.783690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m15:50:49.784689 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:50:49.787689 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:50:49.788689 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:50:49.784689 => 15:50:49.787689
[0m15:50:49.788689 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:50:49.791690 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:50:49.791690 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.792690 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:50:49.792690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.945413 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.945413 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.946412 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:50:49.954412 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:50:49.788689 => 15:50:49.955648
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:50:49.955648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E05C880>]}
[0m15:50:49.955648 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.17s]
[0m15:50:49.955648 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:50:49.971273 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.971273 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.971273 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.971273 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:50:49.971273 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:50:49.971273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:50:49.971273 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:50:49.971273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:50:49.971273 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.971273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:50:49.971273 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.971273 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.971273 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.971273 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.986899 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.987687 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:50:49.971273 => 15:50:49.987687
[0m15:50:49.988693 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:50:49.971273 => 15:50:49.987687
[0m15:50:49.988832 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:50:49.971273 => 15:50:49.988832
[0m15:50:49.988832 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.988832 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.988832 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.988832 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.994505 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.994505 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.994505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.994505 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.994505 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.994505 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:50:49.994505 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:50:49.994505 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:50:49.994505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.994505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.994505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:50.046341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.047342 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:50.047342 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:50.048342 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.049341 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:50:49.988832 => 15:50:50.049341
[0m15:50:50.049341 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:50:50.050341 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:50:50.051341 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m15:50:50.052342 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:50.052342 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.053342 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m15:50:50.053342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m15:50:50.054342 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.057341 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.058341 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 15:50:50.054342 => 15:50:50.058341
[0m15:50:50.058341 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.060342 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.061498 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.061498 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m15:50:50.061498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:50.061498 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.061498 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:50.061498 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:50:50.077880 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.078980 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:50:49.988832 => 15:50:50.078980
[0m15:50:50.078980 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:50:50.078980 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:50:50.078980 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m15:50:50.078980 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:50.101616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.101616 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:50.101616 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:50.113574 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.114589 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:50:49.994505 => 15:50:50.114589
[0m15:50:50.115582 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:50:50.115582 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:50:50.116578 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.15s]
[0m15:50:50.117677 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:50.141377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.141377 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m15:50:50.141377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.141377 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 15:50:50.059341 => 15:50:50.141377
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m15:50:50.141377 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m15:50:50.141377 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.141377 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:50:50.141377 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:50:50.154359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m15:50:50.154359 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:50:50.155122 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.155122 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:50:50.155122 => 15:50:50.155122
[0m15:50:50.155122 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:50:50.169944 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.170945 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.170945 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:50:50.171944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:50.218959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.219960 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.219960 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:50:50.222750 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:50.224759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.225759 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:50:50.225759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.226760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:50:50.227760 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.227760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:50:50.228759 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.230760 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:50:50.232759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.233759 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:50:50.233759 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:50.234760 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:50:50.155122 => 15:50:50.234760
[0m15:50:50.235760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:50:50.236760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E3977F0>]}
[0m15:50:50.236760 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m15:50:50.237769 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:50:50.238816 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.238816 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.239820 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:50:50.240820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:50:50.239820 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:50:50.240820 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.241821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:50:50.244819 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.244819 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.247821 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.248821 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:50:50.241821 => 15:50:50.248821
[0m15:50:50.248821 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.249820 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:50:50.244819 => 15:50:50.249820
[0m15:50:50.250821 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.251821 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.253820 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.253820 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.254820 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:50:50.254820 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.254820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:50.255821 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:50:50.255821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:50.303196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.304197 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.304197 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:50.306197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.307198 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:50:50.249820 => 15:50:50.307198
[0m15:50:50.307198 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:50:50.308197 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:50:50.308197 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:50:50.309197 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.333198 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.334199 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.334199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:50.335199 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.337199 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:50:50.251821 => 15:50:50.337199
[0m15:50:50.337199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:50:50.337199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:50:50.338702 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m15:50:50.338702 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.339708 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:50:50.340708 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m15:50:50.340708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:50:50.341707 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m15:50:50.344707 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:50:50.345707 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 15:50:50.341707 => 15:50:50.344707
[0m15:50:50.345707 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m15:50:50.348706 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:50:50.348706 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.349706 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m15:50:50.349706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:50.394067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.394067 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.394067 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.420312 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:50:50.420312 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.422317 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:50:50.423316 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.423316 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:50:50.424417 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:50.425422 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 15:50:50.345707 => 15:50:50.425422
[0m15:50:50.426422 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m15:50:50.426422 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E330E80>]}
[0m15:50:50.427423 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.09s]
[0m15:50:50.427423 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:50:50.429422 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:50.429422 [debug] [MainThread]: On master: BEGIN
[0m15:50:50.429422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:50.475928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.476928 [debug] [MainThread]: On master: COMMIT
[0m15:50:50.476928 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:50.477928 [debug] [MainThread]: On master: COMMIT
[0m15:50:50.477928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.477928 [debug] [MainThread]: On master: Close
[0m15:50:50.478930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:50.478930 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:50:50.480930 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:50:50.480930 [info ] [MainThread]: 
[0m15:50:50.480930 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m15:50:50.482928 [debug] [MainThread]: Command end result
[0m15:50:50.489928 [info ] [MainThread]: 
[0m15:50:50.489928 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:50:50.490932 [info ] [MainThread]: 
[0m15:50:50.490932 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:50:50.491929 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:50:50.491929 [info ] [MainThread]: 
[0m15:50:50.492552 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:50:50.492552 [info ] [MainThread]: 
[0m15:50:50.493558 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:50:50.493558 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:50:50.493558 [info ] [MainThread]: 
[0m15:50:50.494557 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:50:50.494557 [info ] [MainThread]: 
[0m15:50:50.494557 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m15:50:50.495558 [debug] [MainThread]: Command `dbt build` succeeded at 15:50:50.495558 after 1.92 seconds
[0m15:50:50.496557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0A9C5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E333FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1A21D0>]}
[0m15:50:50.496557 [debug] [MainThread]: Flushing usage events
[0m19:25:20.266485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E832F5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86582D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86582B00>]}


============================== 19:25:20.269497 | 177c24ff-7987-48b3-9f4a-4afc32bc9351 ==============================
[0m19:25:20.269497 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:25:20.270501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:20.390088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF202E00>]}
[0m19:25:20.452142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF200A90>]}
[0m19:25:20.453142 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:25:20.463227 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:25:20.547243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:20.548746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:20.551765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86A13EB0>]}
[0m19:25:20.559912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8691AC20>]}
[0m19:25:20.560914 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:25:20.560914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8691AF20>]}
[0m19:25:20.562914 [info ] [MainThread]: 
[0m19:25:20.562914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:20.564914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:25:20.570896 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:20.571901 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:25:20.571901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:20.624915 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:25:20.624915 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:20.624915 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:20.627914 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:25:20.628914 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:25:20.629417 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:25:20.633143 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:20.634143 [debug] [MainThread]: On master: BEGIN
[0m19:25:20.634143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:20.682822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:20.683608 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:20.683608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:20.683608 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:25:20.688613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E869BBBE0>]}
[0m19:25:20.688613 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:20.689628 [debug] [MainThread]: On master: Close
[0m19:25:20.689628 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:25:20.690621 [info ] [MainThread]: 
[0m19:25:20.690621 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:25:20.690621 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:25:20.690621 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:25:20.690621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:25:20.690621 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:25:20.690621 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:25:20.690621 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:25:20.690621 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:25:20.690621 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:25:20.701834 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:25:20.702833 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:25:20.701834 => 19:25:20.702833
[0m19:25:20.703834 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:25:20.702833 => 19:25:20.703834
[0m19:25:20.704833 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:25:20.704833 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:25:20.705834 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:25:20.696928 => 19:25:20.704833
[0m19:25:20.705834 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:25:20.705834 => 19:25:20.705834
[0m19:25:20.705834 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:25:20.705834 => 19:25:20.705834
[0m19:25:20.706833 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:25:20.707834 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:25:20.707834 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:25:20.708833 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:25:20.707834 => 19:25:20.707834
[0m19:25:20.708833 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.708833 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.710165 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:25:20.710165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:25:20.711183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:25:20.711183 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.712182 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.712182 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.713182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:25:20.722211 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:25:20.728714 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:25:20.728714 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.732739 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:25:20.732739 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:25:20.713182 => 19:25:20.732739
[0m19:25:20.733739 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:25:20.722211 => 19:25:20.732739
[0m19:25:20.733739 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.733739 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:25:20.729719 => 19:25:20.733739
[0m19:25:20.734739 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.734739 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:25:20.734739 => 19:25:20.734739
[0m19:25:20.735740 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.735740 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:25:20.735740 => 19:25:20.735740
[0m19:25:20.736739 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.736739 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:25:20.736739 => 19:25:20.736739
[0m19:25:20.737741 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.737741 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.739243 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.739746 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.739746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:25:20.740745 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:25:20.741248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:25:20.741248 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.742252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:25:20.742252 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.747252 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:25:20.747252 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:25:20.749758 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:25:20.752821 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:25:20.753821 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:25:20.742252 => 19:25:20.753821
[0m19:25:20.753821 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:25:20.747252 => 19:25:20.753821
[0m19:25:20.754823 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.754823 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:25:20.750821 => 19:25:20.754823
[0m19:25:20.754823 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.755822 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:25:20.755822 => 19:25:20.755822
[0m19:25:20.755822 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:25:20.756821 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:25:20.755822 => 19:25:20.755822
[0m19:25:20.756821 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.757821 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:25:20.757821 => 19:25:20.757821
[0m19:25:20.757821 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.758820 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.759827 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:25:20.759827 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.759827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:25:20.760794 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:25:20.760794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:25:20.762076 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.762076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:25:20.762076 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.765077 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:25:20.765077 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:25:20.768584 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:25:20.771593 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:25:20.771593 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:25:20.763076 => 19:25:20.771593
[0m19:25:20.772593 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.772593 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:25:20.766580 => 19:25:20.772593
[0m19:25:20.772593 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:25:20.772593 => 19:25:20.772593
[0m19:25:20.773593 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:25:20.769087 => 19:25:20.773593
[0m19:25:20.773593 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.774594 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.774594 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:25:20.775593 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:25:20.774594 => 19:25:20.774594
[0m19:25:20.775593 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.776593 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:25:20.775593 => 19:25:20.775593
[0m19:25:20.776593 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.777593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:25:20.777593 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:25:20.778593 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.779096 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.779599 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.779599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:25:20.783137 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:25:20.783137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:25:20.784136 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.784136 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.789643 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:25:20.789643 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:25:20.779599 => 19:25:20.789643
[0m19:25:20.792699 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:25:20.792699 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.793700 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:25:20.784136 => 19:25:20.793700
[0m19:25:20.793700 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:25:20.793700 => 19:25:20.793700
[0m19:25:20.794701 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:25:20.789643 => 19:25:20.794701
[0m19:25:20.794701 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.795699 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.795699 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.796698 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:25:20.795699 => 19:25:20.795699
[0m19:25:20.796698 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.797698 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:25:20.796698 => 19:25:20.796698
[0m19:25:20.797698 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.798699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:25:20.799206 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.799708 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:25:20.799708 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.800677 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.800677 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:25:20.803732 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:25:20.804732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:25:20.804732 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:25:20.805732 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.805732 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:25:20.800677 => 19:25:20.805732
[0m19:25:20.808734 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:25:20.811745 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:25:20.811745 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.812745 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:25:20.805732 => 19:25:20.812745
[0m19:25:20.812745 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:25:20.812745 => 19:25:20.812745
[0m19:25:20.812745 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:25:20.809240 => 19:25:20.812745
[0m19:25:20.813746 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:25:20.813746 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.814745 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.814745 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:25:20.814745 => 19:25:20.814745
[0m19:25:20.815745 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.815745 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:25:20.815745 => 19:25:20.815745
[0m19:25:20.816744 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:25:20.816744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:25:20.817747 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.818745 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.821756 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:25:20.821756 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:25:20.819250 => 19:25:20.821756
[0m19:25:20.822755 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.822755 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:25:20.822755 => 19:25:20.822755
[0m19:25:20.823755 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.824755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:20.824755 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:25:20.824755 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:25:20.825755 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:25:20.825755 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:25:20.827756 [debug] [MainThread]: Command end result
[0m19:25:20.834766 [debug] [MainThread]: Command `dbt compile` succeeded at 19:25:20.834766 after 0.61 seconds
[0m19:25:20.834766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E832F5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF200A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86B2A9B0>]}
[0m19:25:20.835765 [debug] [MainThread]: Flushing usage events
[0m19:25:45.786036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024456607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459902D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459902AD0>]}


============================== 19:25:45.789541 | c229fbb9-cd2a-441f-81a4-5e479f52ce34 ==============================
[0m19:25:45.789541 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:25:45.789541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:25:45.911775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452662E00>]}
[0m19:25:45.969608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452660A90>]}
[0m19:25:45.970612 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:25:45.979623 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:25:46.060743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:46.060743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:46.060743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459D93F40>]}
[0m19:25:46.076270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459C9AF20>]}
[0m19:25:46.076270 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:25:46.077275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459C9B0D0>]}
[0m19:25:46.078781 [info ] [MainThread]: 
[0m19:25:46.079787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:46.080775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:25:46.087810 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:46.087810 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:25:46.087810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:46.142783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:25:46.142783 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:46.143776 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:46.145746 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:25:46.146773 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:25:46.147745 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:25:46.151542 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:46.151542 [debug] [MainThread]: On master: BEGIN
[0m19:25:46.151542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:46.200610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:46.201611 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:46.201611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:46.205611 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:25:46.206610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459D3BBB0>]}
[0m19:25:46.206610 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:46.207609 [debug] [MainThread]: On master: Close
[0m19:25:46.207609 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:25:46.209117 [info ] [MainThread]: 
[0m19:25:46.210741 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:25:46.211748 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:25:46.211748 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:25:46.211748 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:25:46.212748 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:25:46.213747 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:25:46.213747 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:25:46.213747 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:25:46.214747 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:25:46.219936 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:25:46.220584 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:25:46.219936 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:25:46.220584 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:25:46.220584 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:25:46.214747 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:25:46.220584 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:25:46.220584 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:25:46.220584 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.220584 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.228596 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:25:46.228596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:25:46.229645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:25:46.229645 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.230703 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.230703 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.230703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:25:46.241262 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:25:46.247631 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:25:46.248628 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.251158 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:25:46.252165 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:25:46.230703 => 19:25:46.252165
[0m19:25:46.252165 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:25:46.241262 => 19:25:46.252165
[0m19:25:46.253166 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.253166 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:25:46.249132 => 19:25:46.253166
[0m19:25:46.253166 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.254163 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:25:46.254163 => 19:25:46.254163
[0m19:25:46.254163 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.255162 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:25:46.254163 => 19:25:46.254163
[0m19:25:46.255162 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.256165 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:25:46.256165 => 19:25:46.256165
[0m19:25:46.256165 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.257164 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.257164 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.257164 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.258667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:25:46.258667 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:25:46.260088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:25:46.260088 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.261096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:25:46.261096 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.266094 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:25:46.266094 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:25:46.268599 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:25:46.272118 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:25:46.272118 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:25:46.261096 => 19:25:46.272118
[0m19:25:46.273118 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:25:46.266094 => 19:25:46.273118
[0m19:25:46.273118 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:25:46.269605 => 19:25:46.273118
[0m19:25:46.274119 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.274119 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.274119 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:25:46.275118 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.275118 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.276117 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.276117 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.277117 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.277117 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:25:46.278623 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.278623 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.279629 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:25:46.280134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:25:46.280134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:25:46.281140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:25:46.281140 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.282140 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.282140 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:25:46.285140 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:25:46.287651 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:25:46.290661 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:25:46.290661 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:25:46.282140 => 19:25:46.290661
[0m19:25:46.291665 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.291665 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:25:46.285645 => 19:25:46.291665
[0m19:25:46.292671 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:25:46.287651 => 19:25:46.291665
[0m19:25:46.292671 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:25:46.292671 => 19:25:46.292671
[0m19:25:46.292671 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.293670 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:25:46.293670 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.294670 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:25:46.294670 => 19:25:46.294670
[0m19:25:46.294670 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:25:46.294670 => 19:25:46.294670
[0m19:25:46.295701 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.295701 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.296700 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:25:46.296700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:25:46.297707 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.297707 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.298706 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.299241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:25:46.299777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:25:46.302811 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:25:46.302811 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.302811 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.308810 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:25:46.309347 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:25:46.299777 => 19:25:46.309347
[0m19:25:46.311926 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:25:46.311926 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.312924 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:25:46.303812 => 19:25:46.311926
[0m19:25:46.312924 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:25:46.312924 => 19:25:46.312924
[0m19:25:46.313895 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:25:46.309347 => 19:25:46.312924
[0m19:25:46.313895 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.314895 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.314895 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.314895 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:25:46.314895 => 19:25:46.314895
[0m19:25:46.315894 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.315894 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:25:46.315894 => 19:25:46.315894
[0m19:25:46.316894 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.316894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:25:46.317894 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.317894 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:25:46.318894 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.319399 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.319904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:25:46.322909 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:25:46.322909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:25:46.323910 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:25:46.323910 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.324910 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:25:46.319904 => 19:25:46.323910
[0m19:25:46.326941 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:25:46.330015 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:25:46.330015 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.331062 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:25:46.324910 => 19:25:46.331062
[0m19:25:46.331062 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:25:46.331062 => 19:25:46.331062
[0m19:25:46.332049 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:25:46.326941 => 19:25:46.332049
[0m19:25:46.332049 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:25:46.333049 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.333049 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.334049 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:25:46.334049 => 19:25:46.334049
[0m19:25:46.334049 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.335050 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:25:46.334049 => 19:25:46.334049
[0m19:25:46.335050 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:25:46.336049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:25:46.337051 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.337051 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.340590 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:25:46.341126 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:25:46.338050 => 19:25:46.341126
[0m19:25:46.341126 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.341126 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:25:46.341126 => 19:25:46.341126
[0m19:25:46.342161 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.343162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:46.343162 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:25:46.343162 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:25:46.344162 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:25:46.344162 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:25:46.346167 [debug] [MainThread]: Command end result
[0m19:25:46.353279 [debug] [MainThread]: Command `dbt compile` succeeded at 19:25:46.352307 after 0.61 seconds
[0m19:25:46.353279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024456607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452660A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459EA90C0>]}
[0m19:25:46.353279 [debug] [MainThread]: Flushing usage events
[0m19:26:09.159893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D019CA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CFA2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CFA2B00>]}


============================== 19:26:09.159893 | de58b3af-ba12-4cd9-be15-2060fc471555 ==============================
[0m19:26:09.159893 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:26:09.159893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m19:26:09.294542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D12E00>]}
[0m19:26:09.351574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D10A90>]}
[0m19:26:09.352570 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:26:09.362542 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:26:09.445579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:09.445579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:09.449578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D433EB0>]}
[0m19:26:09.457571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D33AF80>]}
[0m19:26:09.458573 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:26:09.458573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D33B0D0>]}
[0m19:26:09.460574 [info ] [MainThread]: 
[0m19:26:09.461573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:26:09.462602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:26:09.469543 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:26:09.469543 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:26:09.469543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:09.531010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:26:09.532009 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:26:09.532009 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:26:09.534011 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:26:09.535009 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:26:09.536011 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:26:09.540046 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:09.540046 [debug] [MainThread]: On master: BEGIN
[0m19:26:09.540046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:09.604480 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:26:09.605483 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:09.605483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:09.608447 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:26:09.610447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D3DBBE0>]}
[0m19:26:09.610447 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:09.610447 [debug] [MainThread]: On master: Close
[0m19:26:09.611447 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:26:09.612448 [info ] [MainThread]: 
[0m19:26:09.614447 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:26:09.614447 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:26:09.615447 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:26:09.615447 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:26:09.616447 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:26:09.616447 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:26:09.617447 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:26:09.617447 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:26:09.618447 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:26:09.622448 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:26:09.624447 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:26:09.623447 => 19:26:09.624447
[0m19:26:09.625447 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:26:09.624447 => 19:26:09.625447
[0m19:26:09.625447 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:26:09.626447 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:26:09.626447 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:26:09.618447 => 19:26:09.626447
[0m19:26:09.627451 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:26:09.626447 => 19:26:09.626447
[0m19:26:09.627451 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:26:09.627451 => 19:26:09.627451
[0m19:26:09.627451 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:26:09.628446 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:26:09.629445 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:26:09.629445 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:26:09.629445 => 19:26:09.629445
[0m19:26:09.630445 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.630445 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.631445 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:26:09.631445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:26:09.632445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:26:09.632445 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.633448 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.633448 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.633448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:26:09.643483 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:26:09.649486 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:26:09.649486 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.650487 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:26:09.634447 => 19:26:09.650487
[0m19:26:09.653485 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:26:09.653485 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:26:09.643483 => 19:26:09.653485
[0m19:26:09.654483 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.654483 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.655481 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:26:09.650487 => 19:26:09.655481
[0m19:26:09.655481 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:26:09.655481 => 19:26:09.655481
[0m19:26:09.656481 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:26:09.655481 => 19:26:09.655481
[0m19:26:09.656481 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.657476 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.657476 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.658481 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:26:09.658481 => 19:26:09.658481
[0m19:26:09.658481 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.658481 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.659483 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.660477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:26:09.660477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:26:09.660477 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:26:09.661478 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.661478 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.662483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:26:09.666483 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:26:09.669483 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:26:09.669483 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:26:09.670483 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:26:09.662483 => 19:26:09.670483
[0m19:26:09.672446 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:26:09.673446 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:26:09.666483 => 19:26:09.673446
[0m19:26:09.673446 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.674447 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.674447 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:26:09.670483 => 19:26:09.674447
[0m19:26:09.674447 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:26:09.674447 => 19:26:09.674447
[0m19:26:09.675446 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:26:09.675446 => 19:26:09.675446
[0m19:26:09.675446 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:26:09.676446 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.677446 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.677446 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:26:09.677446 => 19:26:09.677446
[0m19:26:09.677446 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.678447 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.679446 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:26:09.679446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:26:09.680446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:26:09.680446 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:26:09.680446 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.681446 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.681446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:26:09.684446 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:26:09.687447 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:26:09.687447 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:26:09.688446 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:26:09.682446 => 19:26:09.687447
[0m19:26:09.690446 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:26:09.690446 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:26:09.684446 => 19:26:09.690446
[0m19:26:09.691446 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.691446 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.692446 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:26:09.692446 => 19:26:09.692446
[0m19:26:09.692446 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:26:09.688446 => 19:26:09.692446
[0m19:26:09.692446 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:26:09.692446 => 19:26:09.692446
[0m19:26:09.693469 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.693469 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:26:09.694472 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.694472 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.695457 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:26:09.695457 => 19:26:09.695457
[0m19:26:09.695457 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.696468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:26:09.696468 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:26:09.697467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:26:09.697467 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.698454 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.698454 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.701455 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:26:09.701455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:26:09.706449 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:26:09.707447 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.707447 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:26:09.698454 => 19:26:09.707447
[0m19:26:09.710592 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:26:09.710592 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:26:09.702463 => 19:26:09.710592
[0m19:26:09.711594 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.711594 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.711594 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:26:09.707447 => 19:26:09.711594
[0m19:26:09.712871 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:26:09.711594 => 19:26:09.711594
[0m19:26:09.712871 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:26:09.712871 => 19:26:09.712871
[0m19:26:09.712871 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.713879 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.714876 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.714876 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:26:09.714876 => 19:26:09.714876
[0m19:26:09.714876 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.715875 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:26:09.715875 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.716878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:26:09.716878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:26:09.716878 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.716878 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.716878 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:26:09.716878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:26:09.716878 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:26:09.716878 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:26:09.716878 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.716878 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:26:09.716878 => 19:26:09.716878
[0m19:26:09.725699 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:26:09.725699 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:26:09.716878 => 19:26:09.725699
[0m19:26:09.725699 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.725699 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:26:09.729621 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:26:09.716878 => 19:26:09.725699
[0m19:26:09.729621 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.729621 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.729621 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.729621 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.729621 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:26:09.729621 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.732819 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.733167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:26:09.733167 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:26:09.733167 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:26:09.733167 => 19:26:09.733167
[0m19:26:09.733167 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:26:09.733167 => 19:26:09.733167
[0m19:26:09.733167 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:26:09.742729 [debug] [MainThread]: Command end result
[0m19:26:09.748736 [debug] [MainThread]: Command `dbt compile` succeeded at 19:26:09.748736 after 0.62 seconds
[0m19:26:09.749738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D019CA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D10A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D5484F0>]}
[0m19:26:09.749738 [debug] [MainThread]: Flushing usage events
[0m19:27:55.309772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385AEE7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E1E2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E1E2B90>]}


============================== 19:27:55.313754 | 3af57065-a8e8-4a16-8450-7cf07e8ff4e4 ==============================
[0m19:27:55.313754 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:27:55.313754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:55.438661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023856F42E00>]}
[0m19:27:55.496183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E428880>]}
[0m19:27:55.497183 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:27:55.506193 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:27:55.587800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:55.587800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:55.592303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E66C9D0>]}
[0m19:27:55.595580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E57F3D0>]}
[0m19:27:55.595580 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:27:55.602084 [info ] [MainThread]: 
[0m19:27:55.603100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:55.603100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:27:55.610754 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:27:55.610754 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:27:55.612257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:55.663880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:27:55.664880 [debug] [ThreadPool]: On list_dbt: Close
[0m19:27:55.666881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:27:55.670880 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:27:55.670880 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:27:55.671880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:55.717763 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.718763 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:27:55.718763 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:27:55.720763 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:27:55.722772 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:27:55.722772 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:27:55.726305 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.727809 [debug] [MainThread]: On master: BEGIN
[0m19:27:55.727809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:55.777248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.777248 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.778248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:55.781248 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:27:55.782752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E6BE1A0>]}
[0m19:27:55.782752 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:55.782752 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.783690 [debug] [MainThread]: On master: BEGIN
[0m19:27:55.784194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.784194 [debug] [MainThread]: On master: COMMIT
[0m19:27:55.784194 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.785196 [debug] [MainThread]: On master: COMMIT
[0m19:27:55.785196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:55.785196 [debug] [MainThread]: On master: Close
[0m19:27:55.786197 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:27:55.786197 [info ] [MainThread]: 
[0m19:27:55.789196 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m19:27:55.789196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m19:27:55.789196 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.790196 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m19:27:55.790196 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m19:27:55.791197 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m19:27:55.791197 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:27:55.792197 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:27:55.793204 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m19:27:55.793204 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m19:27:55.794207 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m19:27:55.794207 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.795207 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 19:27:55.794207 => 19:27:55.794207
[0m19:27:55.795207 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 19:27:55.795207 => 19:27:55.795207
[0m19:27:55.807755 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.807755 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m19:27:55.808756 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m19:27:55.817769 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:27:55.795207 => 19:27:55.817769
[0m19:27:55.830290 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:55.830290 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.832792 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:55.833722 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m19:27:55.842906 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.842906 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m19:27:55.842906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:55.842906 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:27:55.842906 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.842906 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m19:27:55.842906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:27:55.894739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.895743 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:55.895743 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m19:27:55.925241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.926241 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:55.926241 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m19:27:55.928747 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:27:55.939244 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:27:55.951977 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:56.017941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m19:27:56.017941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.046793 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:56.047794 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:56.047794 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m19:27:56.048794 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m19:27:56.048794 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m19:27:56.052802 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m19:27:56.053806 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m19:27:56.054805 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m19:27:56.062813 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m19:27:56.063773 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:56.064276 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m19:27:56.065279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m19:27:56.065279 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:56.065279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m19:27:56.066280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.067280 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 19:27:55.808756 => 19:27:56.067280
[0m19:27:56.067280 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.068279 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.068279 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m19:27:56.069279 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 19:27:55.817769 => 19:27:56.069279
[0m19:27:56.070279 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:27:55.834226 => 19:27:56.070279
[0m19:27:56.071279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E57CD30>]}
[0m19:27:56.071279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m19:27:56.071279 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m19:27:56.072782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E6B34F0>]}
[0m19:27:56.072279 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.28s]
[0m19:27:56.073786 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m19:27:56.074786 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m19:27:56.073786 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m19:27:56.075786 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.075786 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m19:27:56.076785 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m19:27:56.076785 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m19:27:56.077785 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:56.077785 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.078786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:27:56.078786 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.078786 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m19:27:56.079785 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.079785 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m19:27:56.080787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:27:56.085865 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.086864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:27:56.086864 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.086864 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.090865 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.090865 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:27:56.080787 => 19:27:56.090865
[0m19:27:56.094873 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.095875 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.096873 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:27:56.087865 => 19:27:56.095875
[0m19:27:56.097873 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.098874 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:27:56.090865 => 19:27:56.098874
[0m19:27:56.098874 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.099873 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.099873 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.101874 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.104128 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.104128 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m19:27:56.105132 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.106132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.106132 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.106132 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m19:27:56.107131 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m19:27:56.107131 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.107131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.155696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.155696 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.156697 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.157696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.158696 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:27:56.096873 => 19:27:56.158696
[0m19:27:56.158696 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m19:27:56.159696 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m19:27:56.159696 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m19:27:56.160696 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.160696 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.162201 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m19:27:56.162201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:27:56.163205 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.166224 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.166224 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:27:56.163205 => 19:27:56.166224
[0m19:27:56.167224 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.169224 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.169224 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.169224 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m19:27:56.169224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.188044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.189044 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.189044 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.190044 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.192045 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:27:56.099873 => 19:27:56.191044
[0m19:27:56.192549 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m19:27:56.192549 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m19:27:56.193052 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m19:27:56.194568 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.222122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.223127 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.223127 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.224211 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.226211 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:27:56.101874 => 19:27:56.226211
[0m19:27:56.226211 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m19:27:56.226211 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m19:27:56.227714 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m19:27:56.228719 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.228719 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m19:27:56.229719 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m19:27:56.229719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m19:27:56.230717 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:27:56.233224 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:27:56.233728 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:27:56.230717 => 19:27:56.233728
[0m19:27:56.234295 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:27:56.256318 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m19:27:56.256318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.257317 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.257317 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.258317 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m19:27:56.258317 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.258317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.260318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.261319 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:27:56.167224 => 19:27:56.261319
[0m19:27:56.261319 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m19:27:56.262318 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m19:27:56.262821 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m19:27:56.263827 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.308400 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.308400 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.309400 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m19:27:56.345822 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:27:56.349822 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.350822 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m19:27:56.350822 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.352834 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.353837 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m19:27:56.353837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.358836 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m19:27:56.359836 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.359836 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m19:27:56.360838 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.364260 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m19:27:56.367263 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.368263 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m19:27:56.369265 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:56.371263 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:27:56.234295 => 19:27:56.370264
[0m19:27:56.371263 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m19:27:56.372263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E8962F0>]}
[0m19:27:56.372766 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m19:27:56.373771 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:27:56.373771 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.373771 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.374770 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m19:27:56.375770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:27:56.374770 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m19:27:56.375770 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.376770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:27:56.379770 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.379770 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.382784 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.383952 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:27:56.376770 => 19:27:56.383952
[0m19:27:56.383952 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.384956 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:27:56.380770 => 19:27:56.383952
[0m19:27:56.385956 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.385956 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.387955 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.388956 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.388956 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m19:27:56.388956 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.389956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.389956 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m19:27:56.390956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.438195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.438195 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.438195 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m19:27:56.438195 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.438195 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:27:56.384956 => 19:27:56.438195
[0m19:27:56.442200 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m19:27:56.442200 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m19:27:56.443225 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m19:27:56.444215 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.463110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.463110 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.463110 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.472116 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.473126 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:27:56.386956 => 19:27:56.473126
[0m19:27:56.474182 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m19:27:56.474182 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m19:27:56.475510 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m19:27:56.476527 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.476527 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m19:27:56.477527 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m19:27:56.477527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m19:27:56.478527 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:27:56.480526 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:27:56.482030 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:27:56.478527 => 19:27:56.482030
[0m19:27:56.482030 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m19:27:56.484539 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m19:27:56.485539 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.485539 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m19:27:56.486539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.534672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.534672 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.535674 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m19:27:56.544775 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m19:27:56.548775 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.548775 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m19:27:56.548775 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.550775 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.550775 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m19:27:56.552278 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.553752 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m19:27:56.554255 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.554255 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m19:27:56.555259 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.556259 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m19:27:56.557258 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.557258 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m19:27:56.559259 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:56.560258 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:27:56.482030 => 19:27:56.560258
[0m19:27:56.560258 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m19:27:56.561258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E7A4F70>]}
[0m19:27:56.561258 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m19:27:56.562763 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m19:27:56.562763 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.563768 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.563768 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.563768 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m19:27:56.564768 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m19:27:56.565768 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m19:27:56.565768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:27:56.566768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:27:56.566768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:27:56.567767 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.567767 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.567767 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.569767 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.573803 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.573803 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.573803 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:27:56.568767 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:27:56.569767 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.573803 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:27:56.573803 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.583079 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.583079 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.586109 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.587110 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.588109 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.588109 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m19:27:56.589109 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.589109 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.589109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.590109 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m19:27:56.590109 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m19:27:56.591109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.591109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.640555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.640555 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.640555 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.642058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.644095 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:27:56.573803 => 19:27:56.643061
[0m19:27:56.644626 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m19:27:56.644626 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m19:27:56.645630 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m19:27:56.646631 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.646631 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.647630 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m19:27:56.647630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:27:56.648630 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.652134 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.653138 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:27:56.648630 => 19:27:56.653138
[0m19:27:56.653642 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.654645 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.655646 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.655646 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m19:27:56.656646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.672755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.672755 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.675461 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:27:56.677465 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.678465 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:27:56.583079 => 19:27:56.678465
[0m19:27:56.678465 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m19:27:56.679465 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m19:27:56.679465 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m19:27:56.680466 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.704236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.704236 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.704236 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.704236 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:27:56.586109 => 19:27:56.704236
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m19:27:56.704236 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m19:27:56.712243 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.737227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.737227 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.737227 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m19:27:56.737227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.737227 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:27:56.653642 => 19:27:56.737227
[0m19:27:56.737227 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m19:27:56.742090 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m19:27:56.743096 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m19:27:56.744123 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.744303 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:27:56.745307 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m19:27:56.745307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m19:27:56.746307 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:27:56.748306 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.749306 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:27:56.746307 => 19:27:56.749306
[0m19:27:56.749306 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:27:56.760812 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.760812 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.762315 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m19:27:56.762822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.810970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.812475 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.812475 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m19:27:56.814503 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:56.817506 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.817506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m19:27:56.817506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.819506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m19:27:56.819506 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.819506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m19:27:56.820507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.823013 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m19:27:56.825083 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.825083 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m19:27:56.826083 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:56.827083 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:27:56.749306 => 19:27:56.827083
[0m19:27:56.827083 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m19:27:56.828083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E8B1EA0>]}
[0m19:27:56.828083 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m19:27:56.829141 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:27:56.830141 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.830141 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.830141 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m19:27:56.831141 [info ] [Thread-2 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m19:27:56.831141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:27:56.832140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:27:56.832859 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.832859 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.835334 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.838334 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.839336 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:27:56.832859 => 19:27:56.839336
[0m19:27:56.840335 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.841839 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.841839 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:27:56.836335 => 19:27:56.841839
[0m19:27:56.842842 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.842842 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.844861 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.844861 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m19:27:56.845862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.845862 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.845862 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m19:27:56.846861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.897265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.897265 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.898267 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.899266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.901265 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:27:56.840335 => 19:27:56.900266
[0m19:27:56.901265 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m19:27:56.902265 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m19:27:56.902769 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m19:27:56.903773 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.926909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.926909 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.927909 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.929417 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.930417 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:27:56.842842 => 19:27:56.930417
[0m19:27:56.930417 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m19:27:56.931919 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m19:27:56.932923 [warn ] [Thread-2 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m19:27:56.932923 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.933934 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:27:56.934946 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m19:27:56.934946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m19:27:56.935945 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:27:56.937946 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:27:56.938945 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:27:56.935945 => 19:27:56.938945
[0m19:27:56.938945 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:27:56.941946 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m19:27:56.943135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:56.944140 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m19:27:56.944140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.993842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.994844 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:56.994844 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m19:27:57.003529 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m19:27:57.006597 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.006597 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m19:27:57.007597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:57.009598 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.009598 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m19:27:57.010597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:57.012100 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m19:27:57.012100 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.013103 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m19:27:57.013103 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.014605 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m19:27:57.015603 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.015603 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m19:27:57.017602 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:57.018602 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:27:56.939945 => 19:27:57.018602
[0m19:27:57.018602 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m19:27:57.019602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E84B8B0>]}
[0m19:27:57.020603 [info ] [Thread-3 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m19:27:57.020603 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:27:57.022106 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.022106 [debug] [MainThread]: On master: BEGIN
[0m19:27:57.023110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:57.072696 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.073200 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.073200 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.073200 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.074203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.074203 [debug] [MainThread]: On master: Close
[0m19:27:57.075202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:57.075202 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:27:57.077203 [info ] [MainThread]: 
[0m19:27:57.077203 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m19:27:57.079203 [debug] [MainThread]: Command end result
[0m19:27:57.085285 [info ] [MainThread]: 
[0m19:27:57.086285 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m19:27:57.086285 [info ] [MainThread]: 
[0m19:27:57.087287 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m19:27:57.087287 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m19:27:57.088287 [info ] [MainThread]: 
[0m19:27:57.088287 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m19:27:57.089287 [info ] [MainThread]: 
[0m19:27:57.089287 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m19:27:57.090288 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m19:27:57.090288 [info ] [MainThread]: 
[0m19:27:57.090288 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m19:27:57.091287 [info ] [MainThread]: 
[0m19:27:57.091287 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m19:27:57.092790 [debug] [MainThread]: Command `dbt build` succeeded at 19:27:57.092790 after 1.82 seconds
[0m19:27:57.092790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385AEE7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E428880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E94F4F0>]}
[0m19:27:57.092790 [debug] [MainThread]: Flushing usage events
[0m19:28:50.915873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A372F42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F2B30>]}


============================== 19:28:50.918878 | ea74ddd7-828a-4d16-b197-a1f6126272a0 ==============================
[0m19:28:50.918878 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:28:50.918878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --target cloud', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:50.920875 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'integration_tests' does not have a target named 'cloud'. The valid target names for this profile are:
   - local
[0m19:28:50.921874 [debug] [MainThread]: Command `dbt compile` failed at 19:28:50.921874 after 0.05 seconds
[0m19:28:50.922879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A372F42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F1FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F3910>]}
[0m19:28:50.922879 [debug] [MainThread]: Flushing usage events
[0m19:32:55.963510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E6A34580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D32CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D32A70>]}


============================== 19:32:55.979635 | 265761cd-f7e8-41f5-828a-3e2ccee509b9 ==============================
[0m19:32:55.979635 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:32:55.980109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile --target cloud', 'send_anonymous_usage_stats': 'True'}
[0m19:32:55.980109 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'integration_tests' does not have a target named 'cloud'. The valid target names for this profile are:
   - local
[0m19:32:55.980109 [debug] [MainThread]: Command `dbt compile` failed at 19:32:55.980109 after 0.05 seconds
[0m19:32:55.980109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E6A34580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D31FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D33850>]}
[0m19:32:55.980109 [debug] [MainThread]: Flushing usage events
[0m19:33:24.335806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671EBE6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE2AA0>]}


============================== 19:33:24.338805 | 0851af60-d510-4684-8b83-6e77f7a0d2fc ==============================
[0m19:33:24.338805 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:24.339806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:24.342806 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m19:33:24.343806 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m19:33:24.344807 [debug] [MainThread]: Command `dbt compile` failed at 19:33:24.343806 after 0.05 seconds
[0m19:33:24.344807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671EBE6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE14B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE3A90>]}
[0m19:33:24.344807 [debug] [MainThread]: Flushing usage events
[0m19:33:46.734469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EF8F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF2AA0>]}


============================== 19:33:46.737469 | a8ded509-a452-4dd5-b06a-e63918367e98 ==============================
[0m19:33:46.737469 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:46.737469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --target cloud', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:46.740473 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m19:33:46.741466 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m19:33:46.742465 [debug] [MainThread]: Command `dbt compile` failed at 19:33:46.742465 after 0.05 seconds
[0m19:33:46.742465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EF8F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF10C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF1210>]}
[0m19:33:46.743466 [debug] [MainThread]: Flushing usage events
[0m19:33:54.733908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA76A4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A2CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A2A40>]}


============================== 19:33:54.736876 | c4b667de-ee54-45eb-9855-23e249063928 ==============================
[0m19:33:54.736876 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:54.737878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --target local', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:54.844985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA3682E30>]}
[0m19:33:54.913076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9569B0>]}
[0m19:33:54.913076 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:33:54.922076 [debug] [MainThread]: checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd, vars: {}, profile: , target: local, version: 1.7.2
[0m19:33:54.962148 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:33:54.962148 [debug] [MainThread]: previous checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd, current checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9
[0m19:33:54.963148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:33:54.963148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAABDE6E0>]}
[0m19:33:55.726902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055BD0>]}
[0m19:33:55.733902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055CF0>]}
[0m19:33:55.735071 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:33:55.735071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055D20>]}
[0m19:33:55.737076 [info ] [MainThread]: 
[0m19:33:55.738080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:55.739077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:33:55.745571 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:33:55.746077 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:33:55.746077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:55.795653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:33:55.796652 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:33:55.796652 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:33:55.799652 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:33:55.800652 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:33:55.800652 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:33:55.804687 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:55.804687 [debug] [MainThread]: On master: BEGIN
[0m19:33:55.805701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:55.851684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:33:55.852686 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:55.852686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:33:55.855688 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:33:55.857690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055750>]}
[0m19:33:55.857690 [debug] [MainThread]: On master: ROLLBACK
[0m19:33:55.857690 [debug] [MainThread]: On master: Close
[0m19:33:55.858688 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:33:55.858688 [info ] [MainThread]: 
[0m19:33:55.861653 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:33:55.861653 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:33:55.861653 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:33:55.862651 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:33:55.863652 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:33:55.863652 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:33:55.864653 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:33:55.864653 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:33:55.864653 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:33:55.869653 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:33:55.870650 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:33:55.869653 => 19:33:55.870650
[0m19:33:55.871653 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:33:55.871653 => 19:33:55.871653
[0m19:33:55.872652 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:33:55.873651 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:33:55.865651 => 19:33:55.872652
[0m19:33:55.873651 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:33:55.873651 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:33:55.873651 => 19:33:55.873651
[0m19:33:55.874654 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:33:55.874654 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:33:55.874654 => 19:33:55.874654
[0m19:33:55.875654 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:33:55.875654 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:33:55.875654 => 19:33:55.875654
[0m19:33:55.876654 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:33:55.876654 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.877650 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:33:55.877650 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.878653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:33:55.878653 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.879689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:33:55.879689 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.880687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:33:55.880687 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.883692 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:33:55.884683 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.889692 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:33:55.894696 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:33:55.894696 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:33:55.881691 => 19:33:55.894696
[0m19:33:55.895689 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.895689 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:33:55.884683 => 19:33:55.895689
[0m19:33:55.895689 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:33:55.890683 => 19:33:55.895689
[0m19:33:55.896655 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:33:55.896655 => 19:33:55.896655
[0m19:33:55.896655 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.897651 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.897651 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.898654 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:33:55.897651 => 19:33:55.897651
[0m19:33:55.898654 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:33:55.898654 => 19:33:55.898654
[0m19:33:55.898654 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.899650 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.900653 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.900653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:33:55.901650 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.901650 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:33:55.901650 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.902654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:33:55.902654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:33:55.907650 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:33:55.907650 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.908651 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:33:55.910682 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:33:55.911683 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:33:55.903651 => 19:33:55.911683
[0m19:33:55.913681 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:33:55.913681 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.914686 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:33:55.908651 => 19:33:55.914686
[0m19:33:55.914686 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:33:55.914686 => 19:33:55.914686
[0m19:33:55.915689 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:33:55.911683 => 19:33:55.914686
[0m19:33:55.915689 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.916687 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.916687 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:33:55.916687 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:33:55.916687 => 19:33:55.916687
[0m19:33:55.917687 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.917687 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:33:55.917687 => 19:33:55.917687
[0m19:33:55.918687 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.918687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:33:55.919691 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:33:55.919691 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.920686 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.920686 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:33:55.921689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:33:55.923688 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:33:55.924684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:33:55.924684 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.925691 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:33:55.925691 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:33:55.921689 => 19:33:55.925691
[0m19:33:55.927651 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:33:55.929654 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:33:55.930652 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.930652 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:33:55.930652 => 19:33:55.930652
[0m19:33:55.931917 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:33:55.928651 => 19:33:55.931917
[0m19:33:55.931917 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:33:55.925691 => 19:33:55.931917
[0m19:33:55.932923 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.932923 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:33:55.932923 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.933924 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.933924 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:33:55.933924 => 19:33:55.933924
[0m19:33:55.934921 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:33:55.933924 => 19:33:55.933924
[0m19:33:55.934921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:33:55.935922 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:33:55.935922 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.936924 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.936924 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.936924 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.939922 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:33:55.940925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:33:55.940925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:33:55.941921 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.941921 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:33:55.937927 => 19:33:55.941921
[0m19:33:55.941921 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.945923 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:33:55.945923 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.948923 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:33:55.948923 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:33:55.948923 => 19:33:55.948923
[0m19:33:55.949955 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:33:55.942923 => 19:33:55.949955
[0m19:33:55.950953 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.950953 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:33:55.946922 => 19:33:55.950953
[0m19:33:55.950953 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.951955 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.951955 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.951955 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:33:55.951955 => 19:33:55.951955
[0m19:33:55.952953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:33:55.952953 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:33:55.952953 => 19:33:55.952953
[0m19:33:55.953969 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.953969 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.954960 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.954960 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m19:33:55.957963 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:33:55.957963 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.957963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:33:55.958962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:33:55.959968 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:33:55.954960 => 19:33:55.958962
[0m19:33:55.959968 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m19:33:55.959968 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.959968 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.961955 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:33:55.964961 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:33:55.964961 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:33:55.964961 => 19:33:55.964961
[0m19:33:55.965955 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.966953 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 19:33:55.960955 => 19:33:55.965955
[0m19:33:55.966953 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:33:55.962954 => 19:33:55.966953
[0m19:33:55.966953 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.967956 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m19:33:55.967956 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.968961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:33:55.968961 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 19:33:55.968961 => 19:33:55.968961
[0m19:33:55.968961 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:33:55.968961 => 19:33:55.968961
[0m19:33:55.969923 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.969923 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m19:33:55.970924 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.973924 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:33:55.973924 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:33:55.970924 => 19:33:55.973924
[0m19:33:55.975236 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.975236 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:33:55.975236 => 19:33:55.975236
[0m19:33:55.976241 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.976241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:55.976241 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:33:55.979466 [debug] [MainThread]: Command end result
[0m19:33:55.986465 [debug] [MainThread]: Command `dbt compile` succeeded at 19:33:55.986465 after 1.29 seconds
[0m19:33:55.986465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA76A4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB1D2C20>]}
[0m19:33:55.987465 [debug] [MainThread]: Flushing usage events
[0m19:34:22.813439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7B764400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA62CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA62A40>]}


============================== 19:34:22.816441 | 4fb59d18-24c3-4d3a-b832-9a4a3c2f0961 ==============================
[0m19:34:22.816441 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:34:22.816441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m19:34:22.936574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B77712E00>]}
[0m19:34:22.993575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA1B220>]}
[0m19:34:22.994574 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:34:23.001659 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:34:23.041680 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:34:23.042687 [debug] [MainThread]: previous checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, current checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd
[0m19:34:23.042687 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:34:23.043730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7ECA26E0>]}
[0m19:34:23.815203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111BD0>]}
[0m19:34:23.822203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111CF0>]}
[0m19:34:23.823203 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:34:23.823203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111D20>]}
[0m19:34:23.825203 [info ] [MainThread]: 
[0m19:34:23.825203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:23.827203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:34:23.833203 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:23.833203 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:34:23.834203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:23.884671 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:34:23.884671 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:23.885672 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:34:23.887670 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:34:23.888670 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:34:23.889670 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:34:23.893671 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:23.893671 [debug] [MainThread]: On master: BEGIN
[0m19:34:23.893671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:23.940782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:23.941782 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:23.941782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:23.944782 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:34:23.945781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F1118A0>]}
[0m19:34:23.946782 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:23.946782 [debug] [MainThread]: On master: Close
[0m19:34:23.947783 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:34:23.947783 [info ] [MainThread]: 
[0m19:34:23.950784 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:34:23.950784 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:34:23.950784 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:34:23.951782 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:34:23.951782 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:34:23.952782 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:34:23.952782 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:34:23.953782 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:34:23.953782 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:34:23.958781 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:34:23.959782 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:34:23.958781 => 19:34:23.959782
[0m19:34:23.960782 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:34:23.959782 => 19:34:23.960782
[0m19:34:23.961782 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:34:23.961782 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:34:23.953782 => 19:34:23.961782
[0m19:34:23.962783 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:34:23.962783 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:34:23.962783 => 19:34:23.962783
[0m19:34:23.963782 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:34:23.963782 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:34:23.963782 => 19:34:23.963782
[0m19:34:23.964782 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:34:23.964782 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:34:23.964782 => 19:34:23.964782
[0m19:34:23.965782 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:34:23.965782 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.966782 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:34:23.966782 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.967782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:34:23.967782 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.968782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:34:23.968782 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.969782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:34:23.969782 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.971897 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:23.971897 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.975888 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:23.975888 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:23.975888 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:34:23.969782 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:34:23.971897 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.975888 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.975888 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.975888 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.975888 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.988379 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:23.988379 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.989383 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:23.990026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:34:23.990026 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:34:23.990026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:34:23.990026 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:23.990026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:34:23.990026 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:23.990026 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:23.990026 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:34:23.990026 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:24.001669 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:34:24.002674 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:24.002674 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:24.002674 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:24.002674 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:24.002674 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.002674 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.002674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:34:24.002674 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:34:24.002674 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.002674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:34:24.002674 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.002674 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:24.002674 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:34:24.017130 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:24.019087 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:34:24.019087 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:34:24.002674 => 19:34:24.019087
[0m19:34:24.020132 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:34:24.002674 => 19:34:24.020132
[0m19:34:24.020132 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.021130 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:34:24.017130 => 19:34:24.020132
[0m19:34:24.021130 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.021130 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:34:24.021130 => 19:34:24.021130
[0m19:34:24.021130 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:34:24.022132 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:34:24.022132 => 19:34:24.022132
[0m19:34:24.023130 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.023130 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:34:24.023130 => 19:34:24.023130
[0m19:34:24.024129 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.024129 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.025129 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:34:24.025129 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.026131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:34:24.026131 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.027130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:34:24.027130 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.027130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:34:24.028135 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.031131 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:24.031131 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.035129 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:24.037131 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:24.038137 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:34:24.028135 => 19:34:24.038137
[0m19:34:24.039125 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:34:24.031131 => 19:34:24.038137
[0m19:34:24.039125 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.039125 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.039125 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:34:24.035129 => 19:34:24.039125
[0m19:34:24.040132 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:34:24.040132 => 19:34:24.040132
[0m19:34:24.040132 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:34:24.040132 => 19:34:24.040132
[0m19:34:24.041134 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.041134 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.042139 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.042139 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:34:24.042139 => 19:34:24.042139
[0m19:34:24.043134 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.043134 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:34:24.044134 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.044134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:34:24.045131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:34:24.045131 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.045131 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.046132 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:34:24.046132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:34:24.049084 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:24.051085 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:34:24.051085 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.052085 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:34:24.047135 => 19:34:24.052085
[0m19:34:24.055084 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:24.055084 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:34:24.049084 => 19:34:24.055084
[0m19:34:24.056085 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.056085 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:34:24.057085 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:34:24.052085 => 19:34:24.056085
[0m19:34:24.057085 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:34:24.057085 => 19:34:24.057085
[0m19:34:24.057085 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:34:24.057085 => 19:34:24.057085
[0m19:34:24.058084 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.058084 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.059084 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:34:24.059084 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:34:24.059084 => 19:34:24.059084
[0m19:34:24.060084 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.061084 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.061084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:34:24.062084 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.064084 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:24.065085 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:34:24.062084 => 19:34:24.065085
[0m19:34:24.065085 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.066084 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:34:24.066084 => 19:34:24.066084
[0m19:34:24.066084 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.067084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:34:24.070084 [debug] [MainThread]: Command end result
[0m19:34:24.077084 [debug] [MainThread]: Command `dbt compile` succeeded at 19:34:24.077084 after 1.30 seconds
[0m19:34:24.077084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7B764400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F292C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7ECCA3E0>]}
[0m19:34:24.078084 [debug] [MainThread]: Flushing usage events
[0m19:34:52.021295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E74B27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E77E1AD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E77E1AAD0>]}


============================== 19:34:52.023297 | f6b0ecec-530a-435b-b77b-6176b3f1fbd2 ==============================
[0m19:34:52.023297 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:34:52.024296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:34:52.144089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E70AA2E00>]}
[0m19:34:52.199095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7805AD10>]}
[0m19:34:52.199095 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:34:52.199095 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:34:52.285803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:52.286803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:52.290803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E782ABE20>]}
[0m19:34:52.298805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E781A6F20>]}
[0m19:34:52.298805 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:34:52.299804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E781A6F50>]}
[0m19:34:52.300804 [info ] [MainThread]: 
[0m19:34:52.301808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:52.302808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:34:52.309805 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:52.309805 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:34:52.309805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:52.362365 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.363365 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:52.363365 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:34:52.366365 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:34:52.367366 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:34:52.367366 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:34:52.371365 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.371365 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.372365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:52.419754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.419754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:52.420754 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E78088FD0>]}
[0m19:34:52.420754 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:52.420754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.420754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.420754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.420754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: On master: Close
[0m19:34:52.420754 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:34:52.420754 [info ] [MainThread]: 
[0m19:34:52.420754 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.420754 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.420754 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.420754 [info ] [Thread-1 (]: 1 of 13 START test not_null_contacts_joined_with_transactions_id ............... [RUN]
[0m19:34:52.420754 [info ] [Thread-2 (]: 2 of 13 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m19:34:52.420754 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311'
[0m19:34:52.420754 [info ] [Thread-3 (]: 3 of 13 START test not_null_stg_web__transactions_id ........................... [RUN]
[0m19:34:52.434543 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m19:34:52.434543 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.435645 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m19:34:52.435645 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.445833 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.445833 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.445833 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.445833 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.445833 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:34:52.435645 => 19:34:52.445833
[0m19:34:52.445833 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.445833 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:34:52.445833 => 19:34:52.445833
[0m19:34:52.445833 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:34:52.445833 => 19:34:52.445833
[0m19:34:52.463477 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.464475 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.464475 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.466470 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.467471 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.468478 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.468478 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m19:34:52.468478 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.469471 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.469471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:34:52.469471 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m19:34:52.470473 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m19:34:52.470473 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:34:52.471473 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:34:52.519439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.519439 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.519439 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.521439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.523440 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:34:52.445833 => 19:34:52.522439
[0m19:34:52.523440 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m19:34:52.523440 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m19:34:52.524439 [info ] [Thread-1 (]: 1 of 13 PASS not_null_contacts_joined_with_transactions_id ..................... [[32mPASS[0m in 0.10s]
[0m19:34:52.525439 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.525439 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.526440 [info ] [Thread-1 (]: 4 of 13 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m19:34:52.527439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:34:52.527439 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.533442 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.534442 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:34:52.527439 => 19:34:52.533442
[0m19:34:52.534442 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.536441 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.537440 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.537440 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m19:34:52.537440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.550439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.550439 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.551439 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m19:34:52.552439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.553439 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:34:52.464475 => 19:34:52.553439
[0m19:34:52.554441 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m19:34:52.554441 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m19:34:52.555476 [info ] [Thread-2 (]: 2 of 13 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.12s]
[0m19:34:52.556458 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.556458 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.557442 [info ] [Thread-2 (]: 5 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m19:34:52.557442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:34:52.558439 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.565440 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.566441 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:34:52.558439 => 19:34:52.566441
[0m19:34:52.566441 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.568625 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.569623 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.569623 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m19:34:52.570625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.581623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.581623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.581623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.583623 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.584623 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:34:52.466470 => 19:34:52.584623
[0m19:34:52.584623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m19:34:52.585623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m19:34:52.585623 [info ] [Thread-3 (]: 3 of 13 PASS not_null_stg_web__transactions_id ................................. [[32mPASS[0m in 0.15s]
[0m19:34:52.586632 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.586632 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.587623 [info ] [Thread-3 (]: 6 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m19:34:52.588623 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:34:52.588623 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.592624 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.593623 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:34:52.588623 => 19:34:52.593623
[0m19:34:52.593623 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.595623 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.596623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.596623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m19:34:52.596623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.614623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.614623 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.615623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:34:52.616623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.617624 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:34:52.534442 => 19:34:52.617624
[0m19:34:52.618623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m19:34:52.618623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m19:34:52.619623 [info ] [Thread-1 (]: 4 of 13 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.09s]
[0m19:34:52.620644 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.620644 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.621625 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m19:34:52.621625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:34:52.622623 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.625623 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.626623 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:34:52.622623 => 19:34:52.626623
[0m19:34:52.626623 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.628625 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.628625 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.629627 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m19:34:52.629627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.646624 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.646624 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.647623 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m19:34:52.648623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.650622 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:34:52.567617 => 19:34:52.649624
[0m19:34:52.650622 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m19:34:52.650622 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m19:34:52.651625 [info ] [Thread-2 (]: 5 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.09s]
[0m19:34:52.652622 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.652622 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.653625 [info ] [Thread-2 (]: 8 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m19:34:52.653625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:34:52.654623 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.658623 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.659623 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:34:52.654623 => 19:34:52.659623
[0m19:34:52.660625 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.662624 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.662624 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.663624 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m19:34:52.663624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.679623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.679623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.680623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.681627 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.683623 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:34:52.593623 => 19:34:52.682623
[0m19:34:52.683623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m19:34:52.684623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m19:34:52.684623 [info ] [Thread-3 (]: 6 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.10s]
[0m19:34:52.685623 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.686625 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.686625 [info ] [Thread-3 (]: 9 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m19:34:52.687762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:34:52.687762 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.687762 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:34:52.687762 => 19:34:52.687762
[0m19:34:52.687762 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.687762 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m19:34:52.687762 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.712880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.713875 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.713875 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.714878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.716879 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:34:52.626623 => 19:34:52.715881
[0m19:34:52.716879 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m19:34:52.716879 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m19:34:52.717880 [info ] [Thread-1 (]: 7 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.10s]
[0m19:34:52.718879 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.718879 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.719880 [info ] [Thread-1 (]: 10 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m19:34:52.719880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:34:52.720875 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.724893 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.725883 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:34:52.720875 => 19:34:52.725883
[0m19:34:52.725883 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.727846 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.728846 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.728846 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m19:34:52.728846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.744842 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.745842 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.745842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.747842 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.748842 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:34:52.660625 => 19:34:52.748842
[0m19:34:52.748842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m19:34:52.749842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m19:34:52.749842 [warn ] [Thread-2 (]: 8 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m19:34:52.750842 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.750842 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.751843 [info ] [Thread-2 (]: 11 of 13 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m19:34:52.752843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:34:52.752843 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.755842 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.756842 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:34:52.752843 => 19:34:52.756842
[0m19:34:52.756842 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.758843 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.759844 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.759844 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m19:34:52.759844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.775842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.776842 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.776842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.778847 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.779844 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:34:52.687762 => 19:34:52.779844
[0m19:34:52.780842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m19:34:52.780842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m19:34:52.781842 [info ] [Thread-3 (]: 9 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m19:34:52.782853 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.782853 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.783845 [info ] [Thread-3 (]: 12 of 13 START test unique_stg_web__transactions_id ............................ [RUN]
[0m19:34:52.783845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:34:52.784851 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.787842 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.788842 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:34:52.784851 => 19:34:52.787842
[0m19:34:52.788842 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.790844 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.790844 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.791845 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m19:34:52.791845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.809843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.810886 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.810886 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.812877 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.813874 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:34:52.725883 => 19:34:52.813874
[0m19:34:52.813874 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m19:34:52.814883 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m19:34:52.815879 [warn ] [Thread-1 (]: 10 of 13 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m19:34:52.816877 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.816877 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.817881 [info ] [Thread-1 (]: 13 of 13 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m19:34:52.818880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:34:52.818880 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.822845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.823845 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:34:52.818880 => 19:34:52.822845
[0m19:34:52.823845 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.825849 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.825849 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.826845 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m19:34:52.826845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.841845 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.841845 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.842844 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.843842 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.845843 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:34:52.757843 => 19:34:52.844842
[0m19:34:52.845843 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m19:34:52.845843 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m19:34:52.846843 [info ] [Thread-2 (]: 11 of 13 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m19:34:52.847842 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.873776 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.873776 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.873776 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.873776 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:34:52.788842 => 19:34:52.873776
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m19:34:52.873776 [info ] [Thread-3 (]: 12 of 13 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m19:34:52.873776 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.899637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.899637 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m19:34:52.899637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.899637 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:34:52.823845 => 19:34:52.899637
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m19:34:52.911858 [info ] [Thread-1 (]: 13 of 13 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.08s]
[0m19:34:52.911858 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.913869 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.913869 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.913869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:52.962392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.962392 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.962392 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.962392 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.962392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:34:52.962392 [debug] [MainThread]: On master: Close
[0m19:34:52.965166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:52.965166 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:34:52.965166 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m19:34:52.966018 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m19:34:52.966018 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m19:34:52.966563 [debug] [MainThread]: Command end result
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m19:34:52.966563 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m19:34:52.978528 [info ] [MainThread]: 
[0m19:34:52.978528 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m19:34:52.979601 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m19:34:52.979601 [info ] [MainThread]: 
[0m19:34:52.979601 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m19:34:52.980589 [info ] [MainThread]: 
[0m19:34:52.980589 [info ] [MainThread]: Done. PASS=11 WARN=2 ERROR=0 SKIP=0 TOTAL=13
[0m19:34:52.981581 [debug] [MainThread]: Command `dbt test` succeeded at 19:34:52.981581 after 1.00 seconds
[0m19:34:52.982570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E74B27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7805AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E783C7310>]}
[0m19:34:52.982570 [debug] [MainThread]: Flushing usage events
[0m19:35:04.040148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028195F97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928AC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928A9B0>]}


============================== 19:35:04.043355 | 3366dc73-96db-4dc2-b762-48c922ce461b ==============================
[0m19:35:04.043355 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:35:04.043355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:04.043355 [info ] [MainThread]: dbt version: 1.7.2
[0m19:35:04.043355 [info ] [MainThread]: python version: 3.10.11
[0m19:35:04.043355 [info ] [MainThread]: python path: C:\Users\Samuel\Desktop\customer360\integration_tests\venv\Scripts\python.exe
[0m19:35:04.043355 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m19:35:04.099858 [info ] [MainThread]: Using profiles dir at C:\Users\Samuel\Desktop\customer360\integration_tests
[0m19:35:04.100915 [info ] [MainThread]: Using profiles.yml file at C:\Users\Samuel\Desktop\customer360\integration_tests\profiles.yml
[0m19:35:04.101900 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Samuel\Desktop\customer360\integration_tests\dbt_project.yml
[0m19:35:04.102896 [info ] [MainThread]: adapter type: postgres
[0m19:35:04.102896 [info ] [MainThread]: adapter version: 1.7.2
[0m19:35:04.153143 [info ] [MainThread]: Configuration:
[0m19:35:04.154679 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:35:04.154679 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:35:04.154679 [info ] [MainThread]: Required dependencies:
[0m19:35:04.154679 [debug] [MainThread]: Executing "git --help"
[0m19:35:04.206583 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:35:04.207630 [debug] [MainThread]: STDERR: "b''"
[0m19:35:04.208175 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:35:04.208175 [info ] [MainThread]: Connection:
[0m19:35:04.208175 [info ] [MainThread]:   host: localhost
[0m19:35:04.208175 [info ] [MainThread]:   port: 5432
[0m19:35:04.208175 [info ] [MainThread]:   user: dbt
[0m19:35:04.208175 [info ] [MainThread]:   database: dbt
[0m19:35:04.208175 [info ] [MainThread]:   schema: public
[0m19:35:04.208175 [info ] [MainThread]:   connect_timeout: 10
[0m19:35:04.208175 [info ] [MainThread]:   role: None
[0m19:35:04.208175 [info ] [MainThread]:   search_path: None
[0m19:35:04.208175 [info ] [MainThread]:   keepalives_idle: 0
[0m19:35:04.208175 [info ] [MainThread]:   sslmode: None
[0m19:35:04.208175 [info ] [MainThread]:   sslcert: None
[0m19:35:04.208175 [info ] [MainThread]:   sslkey: None
[0m19:35:04.208175 [info ] [MainThread]:   sslrootcert: None
[0m19:35:04.208175 [info ] [MainThread]:   application_name: dbt
[0m19:35:04.208175 [info ] [MainThread]:   retries: 1
[0m19:35:04.208175 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:35:04.208175 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:35:04.208175 [debug] [MainThread]: Using postgres connection "debug"
[0m19:35:04.208175 [debug] [MainThread]: On debug: select 1 as id
[0m19:35:04.208175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:04.265512 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:35:04.266548 [debug] [MainThread]: On debug: Close
[0m19:35:04.266548 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:35:04.267512 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:35:04.268551 [debug] [MainThread]: Command `dbt debug` succeeded at 19:35:04.268551 after 0.27 seconds
[0m19:35:04.268551 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:35:04.269512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028195F97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928A920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028199288BB0>]}
[0m19:35:04.269512 [debug] [MainThread]: Flushing usage events
[0m19:35:20.006042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A71487220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74782D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74782AD0>]}


============================== 19:35:20.009038 | e792a71b-0059-4af7-b4cf-8460096df2d1 ==============================
[0m19:35:20.009038 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:35:20.009038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:20.130150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6D512E00>]}
[0m19:35:20.184642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A749C2D10>]}
[0m19:35:20.184642 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:35:20.184642 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:35:20.272486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:20.272486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:20.276484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74C0FE20>]}
[0m19:35:20.284448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74B1AEF0>]}
[0m19:35:20.284448 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:35:20.285448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74B1AF50>]}
[0m19:35:20.286448 [info ] [MainThread]: 
[0m19:35:20.287448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:20.288448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:35:20.295448 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:35:20.295448 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:35:20.295448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:20.344978 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.345980 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:35:20.345980 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:35:20.348981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:35:20.349980 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:35:20.349980 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:35:20.354010 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.354010 [debug] [MainThread]: On master: BEGIN
[0m19:35:20.355011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:20.514760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.515760 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.515760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:20.518760 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:35:20.519760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74BBB9D0>]}
[0m19:35:20.520760 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:20.520760 [debug] [MainThread]: On master: Close
[0m19:35:20.521760 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:35:20.521760 [info ] [MainThread]: 
[0m19:35:20.524760 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:35:20.524760 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:35:20.524760 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:35:20.525760 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:35:20.526760 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:35:20.526760 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:35:20.526760 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:35:20.527760 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:35:20.527760 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:35:20.532760 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:35:20.534760 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:35:20.532760 => 19:35:20.534760
[0m19:35:20.535760 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:35:20.534760 => 19:35:20.535760
[0m19:35:20.535760 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:35:20.536760 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:35:20.536760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:35:20.527760 => 19:35:20.536760
[0m19:35:20.536760 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:35:20.536760 => 19:35:20.536760
[0m19:35:20.537761 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:35:20.537761 => 19:35:20.537761
[0m19:35:20.537761 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:35:20.538760 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:35:20.539760 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:35:20.539760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:35:20.539760 => 19:35:20.539760
[0m19:35:20.539760 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.540760 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.540760 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:35:20.541760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:35:20.542760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:35:20.542760 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.542760 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.543760 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.543760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:35:20.553759 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:35:20.559760 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:35:20.560760 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.561760 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:35:20.544760 => 19:35:20.560760
[0m19:35:20.563760 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:35:20.564760 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:35:20.553759 => 19:35:20.563760
[0m19:35:20.564760 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.564760 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.565760 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:35:20.561760 => 19:35:20.565760
[0m19:35:20.565760 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:35:20.565760 => 19:35:20.565760
[0m19:35:20.566760 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:35:20.565760 => 19:35:20.565760
[0m19:35:20.566760 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.567760 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.567760 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.568760 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:35:20.568760 => 19:35:20.568760
[0m19:35:20.568760 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.569760 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.569760 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.570760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:35:20.570760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:35:20.571760 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:35:20.571760 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.571760 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.572760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:35:20.576760 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:35:20.579760 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:35:20.579760 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:35:20.583759 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:35:20.583759 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:35:20.572760 => 19:35:20.583759
[0m19:35:20.583759 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:35:20.577759 => 19:35:20.583759
[0m19:35:20.584760 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.584760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:35:20.580760 => 19:35:20.584760
[0m19:35:20.584760 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.585760 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:35:20.585760 => 19:35:20.585760
[0m19:35:20.585760 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:35:20.586760 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:35:20.585760 => 19:35:20.585760
[0m19:35:20.586760 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.587760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:35:20.586760 => 19:35:20.586760
[0m19:35:20.587760 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.588760 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.588760 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:35:20.589760 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.589760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:35:20.590760 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:35:20.590760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:35:20.590760 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.591760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:35:20.591760 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.594759 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:35:20.594759 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:35:20.597759 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:35:20.599760 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:35:20.600760 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:35:20.591760 => 19:35:20.600760
[0m19:35:20.600760 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.601760 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:35:20.595760 => 19:35:20.601760
[0m19:35:20.601760 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:35:20.601760 => 19:35:20.601760
[0m19:35:20.601760 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:35:20.597759 => 19:35:20.601760
[0m19:35:20.602760 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.602760 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.603760 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:35:20.603760 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:35:20.603760 => 19:35:20.603760
[0m19:35:20.604760 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.604760 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:35:20.604760 => 19:35:20.604760
[0m19:35:20.605760 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.605760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:35:20.606760 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:35:20.606760 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.606760 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.607760 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.607760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:35:20.611343 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:35:20.611856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:35:20.611856 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.612369 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.613372 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:35:20.608760 => 19:35:20.612369
[0m19:35:20.617372 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:35:20.620372 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:35:20.620372 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.621372 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:35:20.621372 => 19:35:20.621372
[0m19:35:20.622372 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:35:20.613372 => 19:35:20.621372
[0m19:35:20.622372 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.622372 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:35:20.618372 => 19:35:20.622372
[0m19:35:20.623372 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.623372 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.624372 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.624372 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:35:20.624372 => 19:35:20.624372
[0m19:35:20.624372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:35:20.625372 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:35:20.625372 => 19:35:20.625372
[0m19:35:20.625372 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.626372 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.626372 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.627373 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:35:20.630372 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:35:20.630372 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.631372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:35:20.631372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:35:20.632372 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:35:20.627373 => 19:35:20.632372
[0m19:35:20.632372 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:35:20.632372 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.633372 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.635372 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:35:20.638372 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:35:20.638372 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:35:20.638372 => 19:35:20.638372
[0m19:35:20.639372 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.639372 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:35:20.633372 => 19:35:20.639372
[0m19:35:20.640372 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:35:20.635372 => 19:35:20.640372
[0m19:35:20.640372 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.640372 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:35:20.641372 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.641372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:35:20.642372 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:35:20.642372 => 19:35:20.642372
[0m19:35:20.642372 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:35:20.642372 => 19:35:20.642372
[0m19:35:20.642372 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.643372 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:35:20.644372 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.647372 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:35:20.647372 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:35:20.644372 => 19:35:20.647372
[0m19:35:20.648372 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.648372 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:35:20.648372 => 19:35:20.648372
[0m19:35:20.649372 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.650372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:20.650372 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:35:20.650372 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:35:20.651372 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:35:20.651372 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:35:20.653373 [debug] [MainThread]: Command end result
[0m19:35:20.655520 [debug] [MainThread]: Command `dbt compile` succeeded at 19:35:20.655520 after 0.69 seconds
[0m19:35:20.655520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A71487220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A749C2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7488C2E0>]}
[0m19:35:20.655520 [debug] [MainThread]: Flushing usage events
[0m19:36:31.445938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128F307220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292602D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292602AD0>]}


============================== 19:36:31.448950 | 1ff94688-6afa-47b5-a3b7-0492d27436bc ==============================
[0m19:36:31.448950 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:36:31.449950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:36:31.573323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128B2F2E00>]}
[0m19:36:31.631925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292842D10>]}
[0m19:36:31.632925 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:36:31.641936 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:36:31.720103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:31.720103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:31.724104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292A8FE20>]}
[0m19:36:31.731111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292996EF0>]}
[0m19:36:31.732112 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:36:31.732112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292996F80>]}
[0m19:36:31.734111 [info ] [MainThread]: 
[0m19:36:31.735112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:31.736111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:36:31.742466 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:36:31.743465 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:36:31.743465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:31.794093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:31.794093 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:36:31.794093 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:36:31.797099 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:36:31.798102 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:36:31.798102 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:36:31.802166 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:31.803166 [debug] [MainThread]: On master: BEGIN
[0m19:36:31.803166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:31.850215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:31.851215 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:31.851215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:31.854215 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:36:31.856215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292A3B9D0>]}
[0m19:36:31.856215 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:31.856215 [debug] [MainThread]: On master: Close
[0m19:36:31.857216 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:36:31.858185 [info ] [MainThread]: 
[0m19:36:31.860189 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:36:31.860189 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:36:31.860189 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:36:31.861188 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:36:31.862188 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:36:31.862188 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:36:31.862188 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:36:31.863188 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:36:31.863188 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:36:31.868196 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:36:31.870199 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:36:31.869199 => 19:36:31.870199
[0m19:36:31.871201 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:36:31.870199 => 19:36:31.871201
[0m19:36:31.872199 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:36:31.872199 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:36:31.864189 => 19:36:31.872199
[0m19:36:31.872199 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:36:31.873199 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:36:31.873199 => 19:36:31.873199
[0m19:36:31.873199 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:36:31.874199 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:36:31.873199 => 19:36:31.873199
[0m19:36:31.874199 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:36:31.875199 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:36:31.874199 => 19:36:31.874199
[0m19:36:31.875199 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:36:31.876199 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.876199 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:36:31.877198 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.877198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:36:31.878376 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.878376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:36:31.878376 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.879443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:36:31.879443 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.889387 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:36:31.889387 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.895389 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:36:31.898924 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:36:31.899924 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:36:31.880379 => 19:36:31.898924
[0m19:36:31.899924 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:36:31.889387 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.899924 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:36:31.896415 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.899924 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.899924 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.899924 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.899924 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.899924 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.899924 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.899924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:36:31.899924 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:36:31.899924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:36:31.907458 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.907965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:36:31.907965 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.913051 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:36:31.913051 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:36:31.916051 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:36:31.918057 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:36:31.919061 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:36:31.907965 => 19:36:31.919061
[0m19:36:31.919061 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:36:31.913051 => 19:36:31.919061
[0m19:36:31.920061 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.920061 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:36:31.916051 => 19:36:31.920061
[0m19:36:31.920061 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.921061 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:36:31.921061 => 19:36:31.921061
[0m19:36:31.921061 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:36:31.921061 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:36:31.921061 => 19:36:31.921061
[0m19:36:31.922060 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.922060 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:36:31.922060 => 19:36:31.922060
[0m19:36:31.923060 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.924061 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.924061 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:36:31.925060 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.925060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:36:31.926060 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:36:31.926060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:36:31.926060 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.927060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:36:31.927564 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.930069 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:36:31.930069 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:36:31.933069 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:36:31.935070 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:36:31.936069 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:36:31.928067 => 19:36:31.936069
[0m19:36:31.937070 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:36:31.931070 => 19:36:31.936069
[0m19:36:31.937070 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.937070 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.938082 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:36:31.933069 => 19:36:31.937070
[0m19:36:31.938082 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:36:31.938082 => 19:36:31.938082
[0m19:36:31.938082 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:36:31.938082 => 19:36:31.938082
[0m19:36:31.939086 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:36:31.939086 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.940086 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.940086 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:36:31.940086 => 19:36:31.940086
[0m19:36:31.941086 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.941086 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.942086 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:36:31.942086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:36:31.943086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:36:31.943086 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.944086 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.944086 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.945086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:36:31.947086 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:36:31.953123 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:36:31.953123 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.956124 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:36:31.956124 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:36:31.945086 => 19:36:31.956124
[0m19:36:31.957123 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:36:31.948120 => 19:36:31.957123
[0m19:36:31.957123 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.958143 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:36:31.954124 => 19:36:31.957123
[0m19:36:31.958143 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.958143 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:36:31.958143 => 19:36:31.958143
[0m19:36:31.959147 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.959147 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:36:31.959147 => 19:36:31.959147
[0m19:36:31.960147 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.960147 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:36:31.960147 => 19:36:31.960147
[0m19:36:31.961147 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.961147 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.962147 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.962147 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:36:31.963147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:36:31.963147 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.964148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:36:31.964148 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.964148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:36:31.965148 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:36:31.968342 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:36:31.968342 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.970891 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:36:31.973890 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:36:31.973890 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:36:31.965148 => 19:36:31.973890
[0m19:36:31.974891 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.974891 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:36:31.968342 => 19:36:31.974891
[0m19:36:31.974891 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:36:31.970891 => 19:36:31.974891
[0m19:36:31.975891 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:36:31.975891 => 19:36:31.975891
[0m19:36:31.975891 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:36:31.975891 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.977394 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.977902 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:36:31.977394 => 19:36:31.977394
[0m19:36:31.977902 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:36:31.977902 => 19:36:31.977902
[0m19:36:31.977902 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.978905 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:36:31.979905 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.979905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:36:31.980905 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.982904 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:36:31.983905 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:36:31.980905 => 19:36:31.983905
[0m19:36:31.983905 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.984905 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:36:31.984905 => 19:36:31.984905
[0m19:36:31.984905 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.985905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:31.985905 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:36:31.985905 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:36:31.987408 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:36:31.987408 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:36:31.988931 [debug] [MainThread]: Command end result
[0m19:36:31.995433 [debug] [MainThread]: Command `dbt compile` succeeded at 19:36:31.995433 after 0.59 seconds
[0m19:36:31.996436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128F307220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292842D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002129270C2E0>]}
[0m19:36:31.996436 [debug] [MainThread]: Flushing usage events
[0m20:22:23.486839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016336296AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339592DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339592B60>]}


============================== 20:22:23.489838 | 0d49f039-7e8f-407e-8dc6-a80bfe1c8fa5 ==============================
[0m20:22:23.489838 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:22:23.489838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --target cloud', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:22:23.492840 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m20:22:23.493839 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m20:22:23.494839 [debug] [MainThread]: Command `dbt build` failed at 20:22:23.494839 after 0.05 seconds
[0m20:22:23.494839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016336296AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339593CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339591120>]}
[0m20:22:23.494839 [debug] [MainThread]: Flushing usage events
[0m20:23:04.034935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B335090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E632DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E632B60>]}


============================== 20:23:04.037933 | 7062cdd7-6ae0-46df-ac10-032448626b6f ==============================
[0m20:23:04.037933 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:23:04.037933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -s stg_sf__contacts', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:04.158973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E37320AC0>]}
[0m20:23:04.216933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E5E8C10>]}
[0m20:23:04.216933 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:23:04.226195 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:23:04.265191 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:23:04.266190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E86C6D0>]}
[0m20:23:05.054474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2F130>]}
[0m20:23:05.062513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2E860>]}
[0m20:23:05.062513 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:23:05.063508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2F130>]}
[0m20:23:05.064508 [info ] [MainThread]: 
[0m20:23:05.065512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:23:05.066503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:23:05.072394 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:23:05.072394 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:23:05.073534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:05.127972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:23:05.128973 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:23:05.128973 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:23:05.130972 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:23:05.131975 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:23:05.132974 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:23:05.136972 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:05.136972 [debug] [MainThread]: On master: BEGIN
[0m20:23:05.137954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:05.298642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:23:05.299679 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:05.299679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:23:05.302682 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:23:05.303642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3ECA4A30>]}
[0m20:23:05.304643 [debug] [MainThread]: On master: ROLLBACK
[0m20:23:05.304643 [debug] [MainThread]: On master: Close
[0m20:23:05.305642 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:23:05.305642 [info ] [MainThread]: 
[0m20:23:05.308095 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m20:23:05.309096 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m20:23:05.309096 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m20:23:05.314096 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m20:23:05.315096 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 20:23:05.309096 => 20:23:05.315096
[0m20:23:05.315096 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m20:23:05.315096 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 20:23:05.315096 => 20:23:05.315096
[0m20:23:05.316096 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m20:23:05.317096 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.317096 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.317096 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.318095 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m20:23:05.319096 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m20:23:05.319096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m20:23:05.319096 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.320096 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.320096 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.326096 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:23:05.329095 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:23:05.333097 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:23:05.334095 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 20:23:05.320096 => 20:23:05.334095
[0m20:23:05.334095 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:23:05.326096 => 20:23:05.334095
[0m20:23:05.335095 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.335095 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 20:23:05.330094 => 20:23:05.335095
[0m20:23:05.335095 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.336096 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 20:23:05.336096 => 20:23:05.336096
[0m20:23:05.336096 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.337096 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:23:05.336096 => 20:23:05.336096
[0m20:23:05.337096 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.338096 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 20:23:05.337096 => 20:23:05.337096
[0m20:23:05.338096 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.339095 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.340095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:05.340095 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:23:05.340095 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m20:23:05.341095 [debug] [MainThread]: Connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b' was properly closed.
[0m20:23:05.341095 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m20:23:05.342096 [debug] [MainThread]: Command end result
[0m20:23:05.348095 [debug] [MainThread]: Excluded node 'not_null_stg_sf__contacts_new_id' from results
[0m20:23:05.349095 [debug] [MainThread]: Excluded node 'relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_' from results
[0m20:23:05.349095 [debug] [MainThread]: Excluded node 'unique_stg_sf__contacts_new_id' from results
[0m20:23:05.349095 [info ] [MainThread]: Compiled node 'stg_sf__contacts' is:
with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
[0m20:23:05.351095 [debug] [MainThread]: Command `dbt compile` succeeded at 20:23:05.351095 after 1.36 seconds
[0m20:23:05.352096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B335090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E5E8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2D030>]}
[0m20:23:05.352096 [debug] [MainThread]: Flushing usage events
[0m20:23:56.481936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D13C66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D16F62D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D16F62AD0>]}


============================== 20:23:56.484865 | 4b0a546c-e075-4d64-ae04-271692296666 ==============================
[0m20:23:56.484865 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:23:56.484865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -s stg_sf__web__transactions.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:23:56.604992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0FC32E30>]}
[0m20:23:56.660951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1719ED10>]}
[0m20:23:56.661951 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:23:56.670951 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:23:56.749248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:56.749248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:56.753248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D173F7E20>]}
[0m20:23:56.761248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172FAEC0>]}
[0m20:23:56.761248 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:23:56.762248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172FAC50>]}
[0m20:23:56.763248 [warn ] [MainThread]: The selection criterion 'stg_sf__web__transactions.sql' does not match any nodes
[0m20:23:56.763248 [info ] [MainThread]: 
[0m20:23:56.764248 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:56.764248 [debug] [MainThread]: Command end result
[0m20:23:56.769228 [debug] [MainThread]: Command `dbt compile` succeeded at 20:23:56.769228 after 0.33 seconds
[0m20:23:56.770227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D13C66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1706E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172F99F0>]}
[0m20:23:56.770227 [debug] [MainThread]: Flushing usage events
[0m20:24:14.572468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DE925630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1C22CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1C22A70>]}


============================== 20:24:14.575468 | 5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc ==============================
[0m20:24:14.575468 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:14.576470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s stg_web__transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:14.700468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DA990AC0>]}
[0m20:24:14.758469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1BD8AF0>]}
[0m20:24:14.759469 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:24:14.768361 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:24:14.845341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:14.845341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:14.849345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E20B3DC0>]}
[0m20:24:14.856301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FBADD0>]}
[0m20:24:14.857302 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:24:14.857302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FBAE60>]}
[0m20:24:14.858302 [info ] [MainThread]: 
[0m20:24:14.859301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:14.860302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:24:14.867300 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:24:14.867300 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:24:14.867300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:14.922158 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:24:14.923157 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:24:14.923157 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:24:14.925157 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:24:14.926157 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:24:14.927157 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:24:14.931157 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:14.931157 [debug] [MainThread]: On master: BEGIN
[0m20:24:14.931157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:14.978158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:24:14.978158 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:14.979157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:14.982157 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:24:14.983157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FB92A0>]}
[0m20:24:14.983157 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:14.984157 [debug] [MainThread]: On master: Close
[0m20:24:14.984157 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:24:14.985160 [info ] [MainThread]: 
[0m20:24:14.987158 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m20:24:14.988159 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m20:24:14.988159 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m20:24:14.994158 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m20:24:14.995158 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 20:24:14.988159 => 20:24:14.995158
[0m20:24:14.995158 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m20:24:14.996158 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 20:24:14.996158 => 20:24:14.996158
[0m20:24:14.996158 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m20:24:14.997157 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:14.998159 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:14.998159 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:14.999158 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m20:24:14.999158 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m20:24:15.000157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m20:24:15.000157 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.001158 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.001158 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.009157 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:24:15.014158 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:24:15.019159 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:24:15.020158 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 20:24:15.001158 => 20:24:15.019159
[0m20:24:15.020158 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.020158 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:24:15.009157 => 20:24:15.020158
[0m20:24:15.021158 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 20:24:15.014158 => 20:24:15.021158
[0m20:24:15.021158 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 20:24:15.021158 => 20:24:15.021158
[0m20:24:15.021158 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.022157 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.023157 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.023157 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:24:15.023157 => 20:24:15.023157
[0m20:24:15.023157 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 20:24:15.023157 => 20:24:15.023157
[0m20:24:15.024157 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.024157 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.025157 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.026158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m20:24:15.026158 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.030157 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:24:15.031158 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 20:24:15.027158 => 20:24:15.031158
[0m20:24:15.031158 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.032158 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 20:24:15.032158 => 20:24:15.032158
[0m20:24:15.033158 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.033158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m20:24:15.035157 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m20:24:15.035157 [debug] [MainThread]: Command end result
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'not_null_stg_web__transactions_id' from results
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_' from results
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'unique_stg_web__transactions_id' from results
[0m20:24:15.042157 [debug] [MainThread]: Excluded node 'value_above_zero_stg_web__transactions_amount' from results
[0m20:24:15.042157 [info ] [MainThread]: Compiled node 'stg_web__transactions' is:
with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
[0m20:24:15.043158 [debug] [MainThread]: Command `dbt compile` succeeded at 20:24:15.043158 after 0.51 seconds
[0m20:24:15.044160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DE925630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1BD8AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E2183DC0>]}
[0m20:24:15.044160 [debug] [MainThread]: Flushing usage events
[0m20:24:41.904072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3B297040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E592C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E592A10>]}


============================== 20:24:41.907079 | bcd99f08-2681-4de2-8818-d200b5aedde4 ==============================
[0m20:24:41.907079 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:41.907079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s stg_web__transactions --target cloud', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:41.910077 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m20:24:41.911075 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m20:24:41.912076 [debug] [MainThread]: Command `dbt compile` failed at 20:24:41.912076 after 0.05 seconds
[0m20:24:41.912076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3B297040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E593A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E5910F0>]}
[0m20:24:41.913077 [debug] [MainThread]: Flushing usage events
[0m20:40:30.590799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135F146AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362442DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362442B60>]}


============================== 20:40:30.593782 | 2c6080fe-0b10-4d84-a78b-2ae85c28f9e1 ==============================
[0m20:40:30.593782 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:40:30.594781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:30.716781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135B182E00>]}
[0m20:40:30.773779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213623F6CB0>]}
[0m20:40:30.773779 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:40:30.783018 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:40:30.820730 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:40:30.821729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213626892D0>]}
[0m20:40:31.597340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362835E40>]}
[0m20:40:31.604341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213629D7340>]}
[0m20:40:31.605341 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:40:31.607340 [info ] [MainThread]: 
[0m20:40:31.607340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:31.609339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:40:31.615340 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:40:31.616340 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:40:31.616340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:31.778868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:40:31.779868 [debug] [ThreadPool]: On list_dbt: Close
[0m20:40:31.781868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:40:31.785868 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:40:31.785868 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:40:31.785868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:31.841868 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.841868 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:40:31.842869 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:31.844908 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:40:31.845868 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:40:31.846867 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:40:31.850866 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.850866 [debug] [MainThread]: On master: BEGIN
[0m20:40:31.850866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:31.904867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.905867 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.905867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:31.908868 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:40:31.909868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362AB6800>]}
[0m20:40:31.910866 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:31.910866 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.910866 [debug] [MainThread]: On master: BEGIN
[0m20:40:31.911867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.911867 [debug] [MainThread]: On master: COMMIT
[0m20:40:31.912868 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.912868 [debug] [MainThread]: On master: COMMIT
[0m20:40:31.912868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:31.913868 [debug] [MainThread]: On master: Close
[0m20:40:31.913868 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:40:31.914867 [info ] [MainThread]: 
[0m20:40:31.916867 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m20:40:31.917867 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m20:40:31.917867 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.917867 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m20:40:31.918868 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m20:40:31.918868 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m20:40:31.919868 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m20:40:31.920868 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m20:40:31.920868 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m20:40:31.921868 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m20:40:31.921868 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m20:40:31.921868 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.922867 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 20:40:31.922867 => 20:40:31.922867
[0m20:40:31.922867 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 20:40:31.922867 => 20:40:31.922867
[0m20:40:31.928868 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.929868 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m20:40:31.929868 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m20:40:31.940868 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 20:40:31.922867 => 20:40:31.940868
[0m20:40:31.951866 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:31.951866 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.954868 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:31.954868 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m20:40:31.964866 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.964866 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m20:40:31.965868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:31.965868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:40:31.966868 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.966868 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m20:40:31.967868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:32.013866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.013866 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.014867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m20:40:32.019866 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m20:40:32.042867 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.042867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m20:40:32.043868 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m20:40:32.047866 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m20:40:32.056867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m20:40:32.057867 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.057867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.057867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m20:40:32.058867 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.058867 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m20:40:32.059868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.060868 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 20:40:31.929868 => 20:40:32.060868
[0m20:40:32.060868 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m20:40:32.061867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136299E3E0>]}
[0m20:40:32.062868 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m20:40:32.062868 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m20:40:32.063870 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.063870 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m20:40:32.064868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m20:40:32.064868 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m20:40:32.065868 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.099866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.119869 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.169867 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.170614 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:32.170614 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:40:32.171620 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 20:40:32.115868 => 20:40:32.171620
[0m20:40:32.171620 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m20:40:32.172619 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.174619 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.174619 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m20:40:32.175619 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m20:40:32.175619 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.176620 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m20:40:32.177620 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m20:40:32.177620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.178619 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.178619 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m20:40:32.180620 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.180620 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.181620 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 20:40:31.938866 => 20:40:32.180620
[0m20:40:32.182618 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 20:40:31.955868 => 20:40:32.182618
[0m20:40:32.182618 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m20:40:32.183618 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m20:40:32.183618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213627B2290>]}
[0m20:40:32.184620 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m20:40:32.184620 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m20:40:32.186092 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m20:40:32.186092 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m20:40:32.187096 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.187096 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:32.188096 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.188096 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m20:40:32.188096 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m20:40:32.189097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m20:40:32.190096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m20:40:32.190096 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.190096 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.194096 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.199095 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.199095 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 20:40:32.191097 => 20:40:32.199095
[0m20:40:32.200096 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 20:40:32.194096 => 20:40:32.200096
[0m20:40:32.200096 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.200096 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.202095 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.204096 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.205096 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.205096 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.205096 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m20:40:32.206096 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m20:40:32.206096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.206096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.256096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.257096 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.257096 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.258095 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.259095 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 20:40:32.201096 => 20:40:32.259095
[0m20:40:32.259095 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m20:40:32.260095 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m20:40:32.261097 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m20:40:32.261097 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.262096 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.262096 [info ] [Thread-2 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m20:40:32.263095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m20:40:32.263095 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.267099 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.268096 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 20:40:32.264095 => 20:40:32.268096
[0m20:40:32.268096 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.270096 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.271097 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.271600 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m20:40:32.271600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.286603 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.287603 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.287603 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.289607 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.290604 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 20:40:32.203095 => 20:40:32.289607
[0m20:40:32.290604 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m20:40:32.290604 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m20:40:32.291604 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m20:40:32.292603 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.320604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.320604 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.321603 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.322604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.323605 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 20:40:32.269096 => 20:40:32.323605
[0m20:40:32.323605 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m20:40:32.324603 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m20:40:32.325604 [info ] [Thread-2 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m20:40:32.325604 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.332605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.332605 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.333604 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.334604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.335605 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 20:40:32.172619 => 20:40:32.335605
[0m20:40:32.335605 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m20:40:32.336604 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m20:40:32.336604 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.27s]
[0m20:40:32.337605 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.337605 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m20:40:32.338604 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m20:40:32.339604 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_sf__contacts)
[0m20:40:32.339604 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m20:40:32.341603 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m20:40:32.342604 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 20:40:32.339604 => 20:40:32.342604
[0m20:40:32.342604 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m20:40:32.364603 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m20:40:32.364603 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.365604 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m20:40:32.365604 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.417487 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.418487 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.418487 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m20:40:32.426348 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:40:32.430351 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.431351 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m20:40:32.431351 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.433353 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.434353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m20:40:32.434353 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.439353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m20:40:32.439353 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.440353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m20:40:32.440825 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.444829 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m20:40:32.447829 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.448829 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m20:40:32.449831 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:32.450830 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 20:40:32.343604 => 20:40:32.450830
[0m20:40:32.451829 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m20:40:32.451829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362E77F10>]}
[0m20:40:32.452830 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m20:40:32.452830 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m20:40:32.453829 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.453829 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.454830 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m20:40:32.454830 [info ] [Thread-2 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m20:40:32.455830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m20:40:32.455830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m20:40:32.456830 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.456830 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.459831 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.462830 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.462830 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 20:40:32.459831 => 20:40:32.462830
[0m20:40:32.463830 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 20:40:32.456830 => 20:40:32.463830
[0m20:40:32.463830 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.464830 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.465830 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.467830 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.468831 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.468831 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.468831 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m20:40:32.469830 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m20:40:32.469830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.469830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.519337 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.520337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.520337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.521337 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.522338 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 20:40:32.464830 => 20:40:32.522338
[0m20:40:32.523337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m20:40:32.523337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m20:40:32.524337 [info ] [Thread-2 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.07s]
[0m20:40:32.525347 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.549337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.550337 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.550337 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m20:40:32.551337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.552338 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 20:40:32.466829 => 20:40:32.552338
[0m20:40:32.553336 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m20:40:32.553336 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m20:40:32.554337 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.10s]
[0m20:40:32.554337 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.555337 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m20:40:32.556338 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m20:40:32.557338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m20:40:32.557338 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m20:40:32.560336 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m20:40:32.560336 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 20:40:32.557338 => 20:40:32.560336
[0m20:40:32.561337 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m20:40:32.563336 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m20:40:32.564336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.564336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m20:40:32.565337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.613338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.614337 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.614337 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m20:40:32.622338 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m20:40:32.625336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.626336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m20:40:32.626336 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.628339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.629339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m20:40:32.629339 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.631339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m20:40:32.631339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.631339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m20:40:32.632338 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.634336 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m20:40:32.634336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.635336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m20:40:32.636338 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:32.638339 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 20:40:32.561337 => 20:40:32.637339
[0m20:40:32.638339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m20:40:32.639339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362E38280>]}
[0m20:40:32.639339 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m20:40:32.640337 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m20:40:32.640337 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.641337 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.641337 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.641337 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m20:40:32.642337 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m20:40:32.642337 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m20:40:32.643337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m20:40:32.643337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m20:40:32.644337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m20:40:32.644337 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.644337 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.645338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.648337 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.652339 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.654337 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.655336 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:40:32.649337 => 20:40:32.655336
[0m20:40:32.656337 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 20:40:32.652339 => 20:40:32.656337
[0m20:40:32.656337 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.656337 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 20:40:32.645338 => 20:40:32.656337
[0m20:40:32.657337 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.658337 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.659337 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.660338 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.663338 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.664339 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.665337 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.665337 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.665337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m20:40:32.666338 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m20:40:32.666338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m20:40:32.666338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.667337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.667337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.716339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.717337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.717337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:40:32.718337 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.720337 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:40:32.657337 => 20:40:32.719339
[0m20:40:32.720337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m20:40:32.720337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m20:40:32.721337 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.08s]
[0m20:40:32.722338 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.722338 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.723338 [info ] [Thread-2 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m20:40:32.723338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m20:40:32.724338 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.727337 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.727337 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 20:40:32.724338 => 20:40:32.727337
[0m20:40:32.728337 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.730337 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.730337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.731337 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m20:40:32.731337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.747338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.748338 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.748338 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.749338 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.751337 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 20:40:32.659337 => 20:40:32.750338
[0m20:40:32.751337 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m20:40:32.751337 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m20:40:32.752336 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m20:40:32.753336 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.777337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.778338 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.778338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.779338 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.780337 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 20:40:32.661337 => 20:40:32.780337
[0m20:40:32.781338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m20:40:32.781338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m20:40:32.782337 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.14s]
[0m20:40:32.783339 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.808338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.809338 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.810338 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m20:40:32.811338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.812338 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 20:40:32.728337 => 20:40:32.812338
[0m20:40:32.812338 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m20:40:32.813337 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m20:40:32.813337 [info ] [Thread-2 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m20:40:32.814337 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.815337 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m20:40:32.815337 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m20:40:32.816337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m20:40:32.816337 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m20:40:32.818336 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.819337 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 20:40:32.816337 => 20:40:32.819337
[0m20:40:32.819337 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m20:40:32.831336 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.832337 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.832337 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m20:40:32.832337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.887160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.888161 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.888161 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m20:40:32.890160 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:40:32.893160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.893160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m20:40:32.893160 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.895159 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m20:40:32.895159 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.895159 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m20:40:32.896160 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.898162 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m20:40:32.900160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.900160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m20:40:32.900160 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:40:32.901159 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 20:40:32.820337 => 20:40:32.901159
[0m20:40:32.902160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m20:40:32.902160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363EC9E70>]}
[0m20:40:32.903160 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m20:40:32.904167 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m20:40:32.904167 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.905161 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.905161 [info ] [Thread-2 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m20:40:32.905161 [info ] [Thread-1 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m20:40:32.906162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m20:40:32.907160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m20:40:32.907160 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.907160 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.911160 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.914162 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.915161 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 20:40:32.911160 => 20:40:32.915161
[0m20:40:32.916160 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 20:40:32.908160 => 20:40:32.915161
[0m20:40:32.916160 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.917160 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.918162 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.920161 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.921160 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.921160 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m20:40:32.921160 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.922162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.922162 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m20:40:32.923161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.969162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.970162 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.970162 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.972161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.973161 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 20:40:32.917160 => 20:40:32.973161
[0m20:40:32.973161 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m20:40:32.974162 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m20:40:32.974162 [warn ] [Thread-1 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.07s]
[0m20:40:32.975200 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:33.000161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.000161 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:33.001162 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:33.002161 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:33.003160 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 20:40:32.919161 => 20:40:33.003160
[0m20:40:33.004159 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m20:40:33.004159 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m20:40:33.005160 [info ] [Thread-2 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.10s]
[0m20:40:33.005160 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:33.006168 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m20:40:33.007185 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m20:40:33.007185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m20:40:33.008140 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m20:40:33.010169 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m20:40:33.011163 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 20:40:33.008140 => 20:40:33.011163
[0m20:40:33.011163 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m20:40:33.014160 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m20:40:33.015160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.015160 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m20:40:33.016161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:33.065080 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.066079 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.066079 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m20:40:33.073350 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m20:40:33.075349 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.076349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m20:40:33.076349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:33.078350 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.079349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m20:40:33.079349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:33.081351 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m20:40:33.082351 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.082351 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m20:40:33.083351 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.084349 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m20:40:33.085349 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.085349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m20:40:33.087350 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:33.088351 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 20:40:33.012162 => 20:40:33.088351
[0m20:40:33.089349 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m20:40:33.089349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363F4FF40>]}
[0m20:40:33.090350 [info ] [Thread-3 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m20:40:33.091351 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m20:40:33.092350 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.092350 [debug] [MainThread]: On master: BEGIN
[0m20:40:33.092350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:33.141350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.141350 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.142351 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.142351 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.143351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.143351 [debug] [MainThread]: On master: Close
[0m20:40:33.143351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m20:40:33.145350 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m20:40:33.145350 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m20:40:33.146350 [info ] [MainThread]: 
[0m20:40:33.146350 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m20:40:33.148349 [debug] [MainThread]: Command end result
[0m20:40:33.154350 [info ] [MainThread]: 
[0m20:40:33.155350 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m20:40:33.156350 [info ] [MainThread]: 
[0m20:40:33.156350 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m20:40:33.157351 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:40:33.157351 [info ] [MainThread]: 
[0m20:40:33.158350 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m20:40:33.158350 [info ] [MainThread]: 
[0m20:40:33.158350 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m20:40:33.159350 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m20:40:33.159350 [info ] [MainThread]: 
[0m20:40:33.160350 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m20:40:33.160350 [info ] [MainThread]: 
[0m20:40:33.161350 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m20:40:33.161350 [debug] [MainThread]: Command `dbt build` succeeded at 20:40:33.161350 after 2.61 seconds
[0m20:40:33.162350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135F146AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362834CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136254DF00>]}
[0m20:40:33.162350 [debug] [MainThread]: Flushing usage events
[0m21:06:29.130254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A154DC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1580C2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1580C2BC0>]}


============================== 21:06:29.133251 | 3bc62f33-16b1-4df6-bb89-3cc2d6f0301d ==============================
[0m21:06:29.133251 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:06:29.134252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:29.255250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A150DF2E00>]}
[0m21:06:29.312251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158309DE0>]}
[0m21:06:29.313251 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:06:29.323251 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:06:29.402249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:29.402249 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:06:29.493756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15868C0D0>]}
[0m21:06:29.500756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15844B1F0>]}
[0m21:06:29.501756 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:06:29.503756 [info ] [MainThread]: 
[0m21:06:29.504294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:29.505300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:06:29.512300 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:06:29.512300 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:06:29.513300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:29.563195 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:06:29.564195 [debug] [ThreadPool]: On list_dbt: Close
[0m21:06:29.566194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:06:29.570194 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:06:29.570194 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:06:29.570194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:29.616685 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.616685 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:06:29.617685 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:06:29.619684 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:06:29.620686 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:06:29.620686 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:06:29.624684 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.625684 [debug] [MainThread]: On master: BEGIN
[0m21:06:29.625684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:29.677210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.677210 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.678211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:06:29.681210 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:06:29.682212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1586CFB50>]}
[0m21:06:29.682212 [debug] [MainThread]: On master: ROLLBACK
[0m21:06:29.683212 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.683212 [debug] [MainThread]: On master: BEGIN
[0m21:06:29.684212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.684212 [debug] [MainThread]: On master: COMMIT
[0m21:06:29.684212 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.685211 [debug] [MainThread]: On master: COMMIT
[0m21:06:29.685211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.685211 [debug] [MainThread]: On master: Close
[0m21:06:29.686212 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:06:29.687211 [info ] [MainThread]: 
[0m21:06:29.689212 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m21:06:29.689212 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m21:06:29.690211 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.690211 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m21:06:29.691211 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m21:06:29.691211 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m21:06:29.692211 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m21:06:29.692211 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m21:06:29.693212 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m21:06:29.693212 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m21:06:29.694212 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m21:06:29.694212 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.695211 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 21:06:29.694212 => 21:06:29.694212
[0m21:06:29.695211 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 21:06:29.695211 => 21:06:29.695211
[0m21:06:29.707210 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.708212 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m21:06:29.708212 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m21:06:29.719212 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 21:06:29.695211 => 21:06:29.719212
[0m21:06:29.730211 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.730211 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.733212 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.733212 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m21:06:29.744210 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.744210 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m21:06:29.744210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:29.745212 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:06:29.745212 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.746211 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m21:06:29.746211 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:06:29.791033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.792035 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.792035 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m21:06:29.798033 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:06:29.820033 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.820033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m21:06:29.821033 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m21:06:29.825505 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m21:06:29.825505 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.834506 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:06:29.834506 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.835505 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.835505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m21:06:29.836506 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:06:29.838506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.838506 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 21:06:29.708212 => 21:06:29.838506
[0m21:06:29.839505 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m21:06:29.840506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1584FB820>]}
[0m21:06:29.840506 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m21:06:29.841506 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m21:06:29.841506 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.842506 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:06:29.842506 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m21:06:29.915505 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.941505 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.942505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m21:06:29.942505 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.942505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m21:06:29.943505 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.943505 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m21:06:29.948505 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.949505 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m21:06:29.950519 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 21:06:29.944505 => 21:06:29.949505
[0m21:06:29.950519 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m21:06:29.951506 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.953505 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.954505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:06:29.954505 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.955506 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.955506 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:06:29.956506 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m21:06:29.956506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:29.957506 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.957506 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:29.958505 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 21:06:29.718211 => 21:06:29.958505
[0m21:06:29.960505 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 21:06:29.734211 => 21:06:29.959505
[0m21:06:29.960505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m21:06:29.960505 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m21:06:29.961505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1587AF0D0>]}
[0m21:06:29.962506 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m21:06:29.962506 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m21:06:29.963506 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m21:06:29.963506 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m21:06:29.964507 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.964507 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.965506 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m21:06:29.965506 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.966505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m21:06:29.966505 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m21:06:29.967505 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.967505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m21:06:29.970505 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.971505 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.975505 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.975505 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 21:06:29.967505 => 21:06:29.975505
[0m21:06:29.976505 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.976505 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 21:06:29.971505 => 21:06:29.976505
[0m21:06:29.978505 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.978505 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.980506 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.980506 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.981506 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m21:06:29.981506 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.982506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:29.982506 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m21:06:29.983505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.004505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.005505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:30.005505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.006505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.007505 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 21:06:29.951506 => 21:06:30.007505
[0m21:06:30.008505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m21:06:30.008505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m21:06:30.009505 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m21:06:30.010506 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:30.010506 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.011506 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m21:06:30.012506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m21:06:30.012506 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.015505 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.016506 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 21:06:30.012506 => 21:06:30.016506
[0m21:06:30.016506 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.018505 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.018505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.019505 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m21:06:30.019505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.037817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.038817 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:30.038817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.039817 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.041817 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 21:06:29.976505 => 21:06:30.040817
[0m21:06:30.041817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m21:06:30.041817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m21:06:30.042817 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m21:06:30.043818 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:30.070817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.070817 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:30.071817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.072818 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.073817 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 21:06:29.978505 => 21:06:30.073817
[0m21:06:30.073817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m21:06:30.074817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m21:06:30.075842 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.11s]
[0m21:06:30.076819 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:30.076819 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m21:06:30.077819 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m21:06:30.078818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m21:06:30.078818 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m21:06:30.081817 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m21:06:30.082817 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 21:06:30.078818 => 21:06:30.081817
[0m21:06:30.082817 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m21:06:30.105817 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m21:06:30.106818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.106818 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.107818 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.107818 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m21:06:30.107818 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.108817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.109818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.110818 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 21:06:30.016506 => 21:06:30.110818
[0m21:06:30.110818 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m21:06:30.111819 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m21:06:30.112323 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m21:06:30.113328 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.269254 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.269759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.270301 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m21:06:30.277494 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:06:30.281495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.282495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m21:06:30.282495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.284495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.284495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m21:06:30.285495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.290495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:06:30.290495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.290495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:06:30.291495 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.295494 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m21:06:30.298493 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.299493 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m21:06:30.300494 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.301494 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 21:06:30.082817 => 21:06:30.301494
[0m21:06:30.302496 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m21:06:30.302496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1587D3D60>]}
[0m21:06:30.303497 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.22s]
[0m21:06:30.304494 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m21:06:30.304494 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.305494 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.305494 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m21:06:30.306494 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m21:06:30.306494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m21:06:30.307495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m21:06:30.307495 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.307495 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.310493 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.314493 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.315495 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 21:06:30.308495 => 21:06:30.315495
[0m21:06:30.315495 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 21:06:30.311495 => 21:06:30.315495
[0m21:06:30.316495 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.316495 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.318493 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.319495 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.320494 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.320494 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.321494 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m21:06:30.321494 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m21:06:30.321494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.322494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.371655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.372655 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.372655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m21:06:30.373655 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.374655 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 21:06:30.316495 => 21:06:30.374655
[0m21:06:30.375655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m21:06:30.375655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m21:06:30.376655 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m21:06:30.376655 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.402655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.402655 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.403656 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.404655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.405657 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 21:06:30.318493 => 21:06:30.405657
[0m21:06:30.405657 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m21:06:30.406657 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m21:06:30.407657 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m21:06:30.407657 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.408656 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m21:06:30.409656 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m21:06:30.409656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m21:06:30.410657 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m21:06:30.413655 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m21:06:30.414655 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 21:06:30.410657 => 21:06:30.414655
[0m21:06:30.414655 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m21:06:30.417657 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m21:06:30.418657 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.418657 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m21:06:30.418657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.469655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.470655 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.470655 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m21:06:30.478114 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m21:06:30.481113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.481113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m21:06:30.482114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.484113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.484113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m21:06:30.485114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.486114 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:06:30.486114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.487113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:06:30.487113 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.489114 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m21:06:30.490113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.490113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m21:06:30.492114 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.493114 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 21:06:30.414655 => 21:06:30.493114
[0m21:06:30.493114 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m21:06:30.494114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15882E860>]}
[0m21:06:30.494114 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m21:06:30.495114 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m21:06:30.496114 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.496114 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.496114 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.497115 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m21:06:30.497115 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m21:06:30.498114 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m21:06:30.498114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m21:06:30.499114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m21:06:30.499114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m21:06:30.500114 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.500114 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.500114 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.504115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.510113 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.513115 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.514114 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 21:06:30.501114 => 21:06:30.514114
[0m21:06:30.514114 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 21:06:30.505115 => 21:06:30.514114
[0m21:06:30.515114 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.516115 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 21:06:30.510113 => 21:06:30.515114
[0m21:06:30.516115 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.518114 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.518114 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.520115 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.522113 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.522113 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.523114 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m21:06:30.523114 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.523114 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.524115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.524115 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m21:06:30.524115 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m21:06:30.525114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.525114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.572114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.572114 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.573113 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.574113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.575113 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 21:06:30.516115 => 21:06:30.575113
[0m21:06:30.575113 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m21:06:30.576114 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m21:06:30.576114 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m21:06:30.577114 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.577114 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.578115 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m21:06:30.579114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m21:06:30.579114 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.583115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.584113 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 21:06:30.579114 => 21:06:30.584113
[0m21:06:30.584113 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.587115 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.587115 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.588114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m21:06:30.588114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.603115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.604115 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.604115 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.605114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.606113 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 21:06:30.520115 => 21:06:30.606113
[0m21:06:30.607114 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m21:06:30.607114 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m21:06:30.608115 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m21:06:30.609114 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.635131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.635131 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.636115 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:06:30.637115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.638115 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 21:06:30.519114 => 21:06:30.638115
[0m21:06:30.639116 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m21:06:30.639116 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m21:06:30.640115 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.14s]
[0m21:06:30.641114 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.674115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.674115 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.675114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m21:06:30.676114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.677114 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 21:06:30.585114 => 21:06:30.677114
[0m21:06:30.677114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m21:06:30.678114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m21:06:30.679115 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m21:06:30.679115 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.680115 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m21:06:30.680115 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m21:06:30.681114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m21:06:30.682114 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m21:06:30.684113 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.685113 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 21:06:30.682114 => 21:06:30.684113
[0m21:06:30.685113 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m21:06:30.696113 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.697113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.698114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m21:06:30.698114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.749114 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.750114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.750114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m21:06:30.752115 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:06:30.754113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.755113 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m21:06:30.755113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.757115 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:06:30.757115 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.757115 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:06:30.758114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.760113 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m21:06:30.762114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.762114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m21:06:30.763114 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:06:30.764114 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 21:06:30.685113 => 21:06:30.764114
[0m21:06:30.764114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m21:06:30.765114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158866E30>]}
[0m21:06:30.765114 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m21:06:30.766113 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m21:06:30.767114 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.767114 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.767114 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m21:06:30.768115 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m21:06:30.769115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m21:06:30.769115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m21:06:30.769115 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.770115 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.773115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.776113 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.776113 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 21:06:30.770115 => 21:06:30.776113
[0m21:06:30.777115 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.777115 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 21:06:30.773115 => 21:06:30.777115
[0m21:06:30.780114 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.780114 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.782114 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.782114 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.783115 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m21:06:30.783115 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.783115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.784114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m21:06:30.784114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.833113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.834113 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.834113 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.836114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.837115 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 21:06:30.778115 => 21:06:30.837115
[0m21:06:30.837115 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m21:06:30.838114 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m21:06:30.839114 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m21:06:30.839114 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.865113 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.865113 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.866114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.867114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.868114 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 21:06:30.781114 => 21:06:30.868114
[0m21:06:30.869114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m21:06:30.869114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m21:06:30.870115 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m21:06:30.871115 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.871115 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m21:06:30.872115 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m21:06:30.872115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m21:06:30.873114 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m21:06:30.875113 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:06:30.876115 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 21:06:30.873114 => 21:06:30.876115
[0m21:06:30.876115 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m21:06:30.879115 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m21:06:30.880115 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.880115 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m21:06:30.881114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.929115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.930116 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.930116 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    date_part('year', age(current_date, birth_date)) AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,
   	case when category = 'Beauty' then amount else 0 end as Beauty_amount,
   	case when category = 'Books' then amount else 0 end as Books_amount,
   	case when category = 'Clothing' then amount else 0 end as Clothing_amount,
   	case when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,
   	case when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,
   	case when category = 'Sports' then amount else 0 end as Sports_amount,
    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,
   	case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m21:06:30.937915 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:06:30.940122 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.941121 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m21:06:30.941121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.944121 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.944121 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m21:06:30.945122 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.946121 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m21:06:30.947121 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.947121 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m21:06:30.948032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.949125 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m21:06:30.950128 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.950128 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m21:06:30.952129 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.953130 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 21:06:30.877115 => 21:06:30.953130
[0m21:06:30.953130 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m21:06:30.954129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15894B9A0>]}
[0m21:06:30.954129 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m21:06:30.955129 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m21:06:30.956129 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:30.957129 [debug] [MainThread]: On master: BEGIN
[0m21:06:30.957129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:31.010519 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:31.011519 [debug] [MainThread]: On master: COMMIT
[0m21:06:31.011519 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:31.011519 [debug] [MainThread]: On master: COMMIT
[0m21:06:31.012520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:06:31.012520 [debug] [MainThread]: On master: Close
[0m21:06:31.013519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:31.013519 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m21:06:31.013519 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m21:06:31.015519 [info ] [MainThread]: 
[0m21:06:31.015519 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m21:06:31.017518 [debug] [MainThread]: Command end result
[0m21:06:31.024518 [info ] [MainThread]: 
[0m21:06:31.025519 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m21:06:31.025519 [info ] [MainThread]: 
[0m21:06:31.026519 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m21:06:31.026519 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:06:31.026519 [info ] [MainThread]: 
[0m21:06:31.027520 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m21:06:31.027520 [info ] [MainThread]: 
[0m21:06:31.028518 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m21:06:31.028518 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m21:06:31.028518 [info ] [MainThread]: 
[0m21:06:31.029519 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m21:06:31.030034 [info ] [MainThread]: 
[0m21:06:31.030034 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m21:06:31.031039 [debug] [MainThread]: Command `dbt build` succeeded at 21:06:31.031039 after 1.94 seconds
[0m21:06:31.032039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A154DC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158309DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158806C20>]}
[0m21:06:31.032039 [debug] [MainThread]: Flushing usage events
