[0m14:50:16.932375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAA10>]}


============================== 14:50:16.935375 | 16040dd4-dfa5-4647-80c6-cc380ce7ef52 ==============================
[0m14:50:16.935375 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:16.935375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:17.001884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16040dd4-dfa5-4647-80c6-cc380ce7ef52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4ED7E080>]}
[0m14:50:17.002884 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-xaitn6h6'
[0m14:50:17.004883 [info ] [MainThread]: Updating lock file in file path: C:\Users\Samuel\Desktop\customer360\integration_tests/package-lock.yml
[0m14:50:17.005883 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-fst6ucu3'
[0m14:50:17.006883 [info ] [MainThread]: Installing ../
[0m14:50:17.006883 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:50:17.007883 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:50:20.607498 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:50:20.609500 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:50:20.612003 [debug] [MainThread]: Command `dbt deps` failed at 14:50:20.612003 after 3.72 seconds
[0m14:50:20.612003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EE63C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EEB0460>]}
[0m14:50:20.613008 [debug] [MainThread]: Flushing usage events
[0m14:50:57.146162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836AA40>]}


============================== 14:50:57.148463 | 4c6152b5-76b0-4004-9902-1d15f3881478 ==============================
[0m14:50:57.148463 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:57.149467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:57.650768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACE0>]}
[0m14:50:57.709781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C83236A0>]}
[0m14:50:57.709781 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:50:57.719918 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:57.720917 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:57.721918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C84793F0>]}
[0m14:50:58.471639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8CD00A0>]}
[0m14:50:58.516341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.517343 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:50:58.517343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8C79450>]}
[0m14:50:58.518343 [info ] [MainThread]: 
[0m14:50:58.519341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:58.520343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:50:58.526337 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:50:58.527338 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:50:58.527338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.577381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:50:58.578343 [debug] [ThreadPool]: On list_dbt: Close
[0m14:50:58.580343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:50:58.584342 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.585343 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:50:58.585343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.632050 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.632050 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.633044 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:58.635042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:50:58.639047 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.640004 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.640004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:58.692968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.692968 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.692968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:58.696005 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.696005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C89A5120>]}
[0m14:50:58.697007 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:58.697007 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.697007 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.698052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.698052 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.699048 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.699048 [debug] [MainThread]: On master: Close
[0m14:50:58.700049 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:50:58.701011 [info ] [MainThread]: 
[0m14:50:58.703010 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:50:58.703010 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:50:58.704009 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:50:58.704009 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:50:58.705010 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:50:58.705010 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:50:58.706010 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:50:58.706010 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:50:58.706010 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:50:58.706010 => 14:50:58.706010
[0m14:50:58.707010 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:50:58.707010 => 14:50:58.707010
[0m14:50:58.707010 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:50:58.708009 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:50:58.729514 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.731514 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.731514 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:50:58.731514 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:50:58.732515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:58.732515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:58.779976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.779976 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.780976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */

    create table "dbt"."public"."contacts" ("id" text,"username" text,"name" text,"gender" text,"address" text,"mail" text,"birthdate" date,"_loaded_at_utc" timestamp)
  
[0m14:50:58.786975 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.808979 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.809978 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:50:58.810979 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:50:58.814486 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:50:58.814486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.815487 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.815487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */

    create table "dbt"."public"."transactions" ("contact_id" text,"id" text,"transaction_date" text,"amount" float8,"item_count" integer,"category" text,"_loaded_at_utc" timestamp)
  
[0m14:50:58.826488 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.826488 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.827487 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.903536 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.924202 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.925162 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:50:58.927161 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:50:58.927161 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:50:58.939580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.940581 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:50:58.708009 => 14:50:58.940581
[0m14:50:58.941583 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.941583 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:50:58.942544 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.943543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>]}
[0m14:50:58.943543 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.944543 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.24s]
[0m14:50:58.944543 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.945543 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:50:58.945543 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:50:58.716514 => 14:50:58.945543
[0m14:50:58.946542 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:50:58.947542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.947542 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:50:58.948542 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:50:58.949542 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.949542 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.949542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:58.999545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.999545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:59.000545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:59.001545 [debug] [MainThread]: On master: Close
[0m14:50:59.001545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:50:59.003545 [info ] [MainThread]: 
[0m14:50:59.003545 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:50:59.004545 [debug] [MainThread]: Command end result
[0m14:50:59.010545 [info ] [MainThread]: 
[0m14:50:59.011545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:59.011545 [info ] [MainThread]: 
[0m14:50:59.012545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:50:59.013048 [debug] [MainThread]: Command `dbt seed` succeeded at 14:50:59.013048 after 1.91 seconds
[0m14:50:59.013048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8A4C3D0>]}
[0m14:50:59.014051 [debug] [MainThread]: Flushing usage events
[0m14:51:24.176973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323A920>]}


============================== 14:51:24.179971 | 2fa63a5f-3852-4337-baad-b6d425277112 ==============================
[0m14:51:24.179971 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:24.179971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:24.246481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa63a5f-3852-4337-baad-b6d425277112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323ABF0>]}
[0m14:51:25.112111 [debug] [MainThread]: Command `dbt clean` succeeded at 14:51:25.112111 after 0.97 seconds
[0m14:51:25.113112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A32935E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A31ABBE0>]}
[0m14:51:25.113112 [debug] [MainThread]: Flushing usage events
[0m14:51:39.842730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2B60>]}


============================== 14:51:39.845780 | 543031ae-e66a-4e6e-b09b-952668fb6dc9 ==============================
[0m14:51:39.845780 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:39.846768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:39.965249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028018B52E00>]}
[0m14:51:40.021249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010BBB0>]}
[0m14:51:40.022249 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:51:40.023249 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:51:40.024249 [debug] [MainThread]: Command `dbt build` failed at 14:51:40.024249 after 0.23 seconds
[0m14:51:40.024249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028020109A20>]}
[0m14:51:40.024249 [debug] [MainThread]: Flushing usage events
[0m14:51:56.581142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CABC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CA950>]}


============================== 14:51:56.584142 | b2c1ab68-d4d0-4adb-8a84-847e14914495 ==============================
[0m14:51:56.584142 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:56.585143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:56.651146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c1ab68-d4d0-4adb-8a84-847e14914495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CAC20>]}
[0m14:51:56.653148 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-n8fu7w2e'
[0m14:51:56.654147 [info ] [MainThread]: Installing ../
[0m14:51:56.655654 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:51:56.655654 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:51:59.866336 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:51:59.868336 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:51:59.870337 [debug] [MainThread]: Command `dbt deps` failed at 14:51:59.870337 after 3.33 seconds
[0m14:51:59.870337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D857820>]}
[0m14:51:59.871335 [debug] [MainThread]: Flushing usage events
[0m14:52:15.039154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAA70>]}


============================== 14:52:15.043155 | e9d1782c-893b-4ddc-8c25-8b50a44d7c63 ==============================
[0m14:52:15.043155 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:15.043155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:52:15.164375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAD10>]}
[0m14:52:15.225976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>]}
[0m14:52:15.226977 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:15.236976 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:15.236976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:52:15.237976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988315E0E0>]}
[0m14:52:15.984447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988384C0D0>]}
[0m14:52:16.030900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BDC90>]}
[0m14:52:16.030900 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:16.031900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BD630>]}
[0m14:52:16.032900 [info ] [MainThread]: 
[0m14:52:16.033900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:16.034900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:16.040901 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:16.041901 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:16.041901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.111840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:16.112840 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:16.114840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:16.118840 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.118840 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:16.118840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.190391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.191391 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.191391 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:16.194391 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:16.194391 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:16.195391 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:16.199391 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.199391 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.199391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:16.300178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.300178 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.301170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:16.303178 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:16.304170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837C67D0>]}
[0m14:52:16.305174 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:16.305174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.306170 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.306170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.306170 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.307175 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.308175 [debug] [MainThread]: On master: Close
[0m14:52:16.308175 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:16.309176 [info ] [MainThread]: 
[0m14:52:16.311180 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:16.311180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:16.312171 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:16.312171 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:16.314140 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:16.314140 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:16.314140 => 14:52:16.314140
[0m14:52:16.315139 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:16.315139 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:16.315139 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:16.315139 => 14:52:16.315139
[0m14:52:16.326141 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:16.336140 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.338392 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:16.341396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.341396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:16.341396 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:16.342395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:16.396399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.397400 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.397400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:16.403403 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.425399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.426400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:16.427399 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:16.427399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.431399 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:16.431399 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.441399 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.442399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.443400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.444400 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:16.316139 => 14:52:16.444400
[0m14:52:16.444400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:16.445400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019883320820>]}
[0m14:52:16.445400 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.13s]
[0m14:52:16.446399 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:16.447399 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.547349 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.547349 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:16.549334 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:16.550332 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.552370 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.554342 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.554342 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:16.336140 => 14:52:16.554342
[0m14:52:16.555826 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:16.556329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988354D8D0>]}
[0m14:52:16.557371 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:52:16.557371 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:16.558337 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.559336 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.559336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:16.623125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.623125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.624125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.625126 [debug] [MainThread]: On master: Close
[0m14:52:16.625126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:16.625126 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:52:16.627125 [info ] [MainThread]: 
[0m14:52:16.627125 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m14:52:16.628128 [debug] [MainThread]: Command end result
[0m14:52:16.634124 [info ] [MainThread]: 
[0m14:52:16.635124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:16.635124 [info ] [MainThread]: 
[0m14:52:16.636124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:52:16.636124 [debug] [MainThread]: Command `dbt seed` succeeded at 14:52:16.636124 after 1.64 seconds
[0m14:52:16.637124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837FB5B0>]}
[0m14:52:16.637124 [debug] [MainThread]: Flushing usage events
[0m14:52:24.451658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62B90>]}


============================== 14:52:24.454627 | 5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f ==============================
[0m14:52:24.454627 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:24.455626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:52:24.576755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752B7E2E00>]}
[0m14:52:24.636591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532DA8880>]}
[0m14:52:24.637592 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:24.647731 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:24.731036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:24.732003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:24.736003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532FD80D0>]}
[0m14:52:24.743536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4B50>]}
[0m14:52:24.743536 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:24.745536 [info ] [MainThread]: 
[0m14:52:24.745536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:24.747536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:24.753536 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:24.754536 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:24.754536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.825083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:24.826083 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:24.828046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:24.832046 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.832046 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:24.832046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.982175 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:24.982175 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.982175 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:24.985175 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:24.989174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.990211 [debug] [MainThread]: On master: BEGIN
[0m14:52:24.990211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:25.058461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.059927 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.060938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:25.063937 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:25.064935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532F8F850>]}
[0m14:52:25.064935 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:25.064935 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.065935 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.065935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.065935 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.067181 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.068222 [debug] [MainThread]: On master: Close
[0m14:52:25.068222 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:25.069227 [info ] [MainThread]: 
[0m14:52:25.071692 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:25.072196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:25.072196 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.073201 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m14:52:25.073201 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m14:52:25.074203 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:25.074203 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m14:52:25.075202 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:25.075202 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:25.076201 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m14:52:25.076201 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:25.076201 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:25.076201 => 14:52:25.076201
[0m14:52:25.077201 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.077201 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:25.077201 => 14:52:25.077201
[0m14:52:25.078201 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:25.089245 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.090238 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:25.111234 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.112237 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:25.115201 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.115201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:25.115201 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:25.116388 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:25.116388 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 14:52:25.078201 => 14:52:25.116388
[0m14:52:25.117834 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.127885 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.128895 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.129880 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m14:52:25.129880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:25.169847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.171351 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.171351 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:25.177365 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.199355 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.199355 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:25.200355 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:25.204391 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:25.214356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.214356 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.215357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.215357 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.215357 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.216357 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:25.217362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.218358 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:25.090238 => 14:52:25.217362
[0m14:52:25.218358 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:25.219357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753307C130>]}
[0m14:52:25.219357 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m14:52:25.220358 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:25.220358 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.221356 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m14:52:25.222356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m14:52:25.222356 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.222356 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.255356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.321096 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.326092 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.326092 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.327096 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:25.327096 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m14:52:25.329062 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 14:52:25.317059 => 14:52:25.328094
[0m14:52:25.329062 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.331060 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.331060 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:25.331060 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:25.333598 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.333598 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.333598 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.334594 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m14:52:25.334594 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.334594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.336561 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.336561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.337558 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:25.102201 => 14:52:25.337558
[0m14:52:25.339561 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 14:52:25.117834 => 14:52:25.338561
[0m14:52:25.339561 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:25.339561 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m14:52:25.340559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753301FE50>]}
[0m14:52:25.340559 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m14:52:25.342039 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m14:52:25.342039 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m14:52:25.342900 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:25.342900 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.344238 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.344238 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.344238 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m14:52:25.345281 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m14:52:25.345281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m14:52:25.346281 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m14:52:25.346281 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.347282 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.350283 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.354281 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.355278 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 14:52:25.347282 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 14:52:25.350283 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.356245 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.358249 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.359249 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.360249 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.361355 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.361355 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m14:52:25.361355 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m14:52:25.362400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:25.362400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:25.386938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.386938 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.387938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.388938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.389938 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 14:52:25.329062 => 14:52:25.389938
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m14:52:25.391938 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m14:52:25.391938 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.392979 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.392979 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m14:52:25.393987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m14:52:25.393987 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.397973 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.398974 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 14:52:25.394973 => 14:52:25.398974
[0m14:52:25.399941 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.400940 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m14:52:25.403227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.419271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.420273 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.420273 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.421271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.422272 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 14:52:25.357250 => 14:52:25.422272
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m14:52:25.424270 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m14:52:25.425234 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.491827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.491827 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.491827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.493827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.494826 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 14:52:25.399941 => 14:52:25.494826
[0m14:52:25.494826 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m14:52:25.495827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m14:52:25.496826 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m14:52:25.496826 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.497825 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m14:52:25.497825 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m14:52:25.498828 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m14:52:25.549823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.550822 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.550822 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.551823 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.552823 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 14:52:25.358249 => 14:52:25.552823
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m14:52:25.554822 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.21s]
[0m14:52:25.554822 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.555823 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m14:52:25.556915 [info ] [Thread-1 (]: 9 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m14:52:25.556915 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m14:52:25.557893 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.557893 [info ] [Thread-3 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m14:52:25.558861 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.558861 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.558861 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.559865 [info ] [Thread-1 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m14:52:25.559865 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m14:52:25.560861 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.560861 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.561859 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m14:52:25.561859 [info ] [Thread-3 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m14:52:25.562863 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m14:52:25.563864 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.563864 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.563864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:25.622412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.623412 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.624412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.624412 [debug] [MainThread]: On master: Close
[0m14:52:25.625412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m14:52:25.626413 [info ] [MainThread]: 
[0m14:52:25.627412 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:52:25.628413 [debug] [MainThread]: Command end result
[0m14:52:25.634489 [info ] [MainThread]: 
[0m14:52:25.635489 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:25.635489 [info ] [MainThread]: 
[0m14:52:25.635489 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m14:52:25.636489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.636489 [info ] [MainThread]: 
[0m14:52:25.637488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m14:52:25.637488 [info ] [MainThread]: 
[0m14:52:25.637488 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m14:52:25.638488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.638488 [info ] [MainThread]: 
[0m14:52:25.638488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m14:52:25.639488 [info ] [MainThread]: 
[0m14:52:25.639488 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m14:52:25.640491 [debug] [MainThread]: Command `dbt build` failed at 14:52:25.640491 after 1.24 seconds
[0m14:52:25.640491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753302F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4370>]}
[0m14:52:25.641489 [debug] [MainThread]: Flushing usage events
[0m15:05:12.345559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2B90>]}


============================== 15:05:12.347051 | beb80a8b-4487-4867-a7e0-bf551d511955 ==============================
[0m15:05:12.347051 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:05:12.347051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:12.456333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F4EC2E00>]}
[0m15:05:12.519283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>]}
[0m15:05:12.519283 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:05:12.519283 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:12.608952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC6280D0>]}
[0m15:05:12.613571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC534B50>]}
[0m15:05:12.613571 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:05:12.613571 [info ] [MainThread]: 
[0m15:05:12.613571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:12.613571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:05:12.613571 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:05:12.613571 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:05:12.613571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:12.959520 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:12.959520 [debug] [ThreadPool]: On list_dbt: Close
[0m15:05:12.959520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:05:12.975142 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:12.975142 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:05:12.975142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:05:13.085332 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.085332 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.085332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:13.179562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:13.179562 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5DF850>]}
[0m15:05:13.179562 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.195192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: Close
[0m15:05:13.195192 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:05:13.195192 [info ] [MainThread]: 
[0m15:05:13.195192 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:05:13.195192 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:05:13.195192 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.195192 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:05:13.195192 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:05:13.195192 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m15:05:13.202565 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:05:13.203552 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:05:13.204358 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m15:05:13.204358 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:05:13.204945 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:05:13.205488 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.205488 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.205488 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.214468 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.214468 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:05:13.214468 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:05:13.229243 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 15:05:13.205488 => 15:05:13.229243
[0m15:05:13.229243 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.241002 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.241002 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.241002 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:05:13.241002 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:05:13.253563 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.253563 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:13.254609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:13.255344 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.255344 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m15:05:13.255344 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:13.304252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.304252 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.304252 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:05:13.307253 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.323367 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:05:13.323367 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.339033 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:05:13.339033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:05:13.214468 => 15:05:13.339033
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:05:13.339033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC7100D0>]}
[0m15:05:13.339033 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:05:13.339033 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:05:13.339033 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.354661 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.339033 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:05:13.389962 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.449962 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.450958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:05:13.450958 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.451975 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:05:13.451975 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.452924 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:05:13.452924 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:05:13.229243 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 15:05:13.241002 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:05:13.454923 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m15:05:13.454923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5348B0>]}
[0m15:05:13.470617 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m15:05:13.454923 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.25s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:05:13.470617 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.470617 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:05:13.470617 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:05:13.470617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:05:13.470617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:05:13.470617 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.470617 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.470617 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.486256 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:05:13.487873 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:05:13.487873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:13.487873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.514769 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.514769 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:05:13.454923 => 15:05:13.520290
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:05:13.521194 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m15:05:13.521194 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.521194 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:05:13.521194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:05:13.521194 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:05:13.521194 => 15:05:13.521194
[0m15:05:13.521194 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:05:13.533648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:05:13.486256 => 15:05:13.575078
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:05:13.575078 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.10s]
[0m15:05:13.587031 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.588038 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:05:13.588038 [info ] [Thread-3 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:05:13.589036 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.614868 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.614868 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.628065 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:05:13.521194 => 15:05:13.627025
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:05:13.628202 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.11s]
[0m15:05:13.628202 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:05:13.470617 => 15:05:13.654607
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:05:13.654607 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.18s]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [info ] [Thread-3 (]: 9 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [info ] [Thread-2 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [info ] [Thread-1 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:05:13.654607 [info ] [Thread-2 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:05:13.666999 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:05:13.668478 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.668478 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.668478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:13.738351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.738351 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.739349 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.740348 [debug] [MainThread]: On master: Close
[0m15:05:13.740348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:05:13.742352 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m15:05:13.742352 [info ] [MainThread]: 
[0m15:05:13.742352 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m15:05:13.744352 [debug] [MainThread]: Command end result
[0m15:05:13.748314 [info ] [MainThread]: 
[0m15:05:13.748314 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:13.750809 [info ] [MainThread]: 
[0m15:05:13.750809 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m15:05:13.751793 [debug] [MainThread]: Command `dbt build` failed at 15:05:13.751793 after 1.46 seconds
[0m15:05:13.751793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3ACFD0>]}
[0m15:05:13.751793 [debug] [MainThread]: Flushing usage events
[0m15:08:11.365873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302B30>]}


============================== 15:08:11.368871 | 54b902e5-2b69-44fd-b815-34c8b9264ae1 ==============================
[0m15:08:11.368871 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:08:11.368871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:11.485997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F8022E00>]}
[0m15:08:11.541504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF54A440>]}
[0m15:08:11.542504 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:08:11.551504 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:08:11.624371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:11.625625 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__sources.yml
[0m15:08:11.862219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB563E0>]}
[0m15:08:11.870261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB10B80>]}
[0m15:08:11.871251 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:08:11.872261 [info ] [MainThread]: 
[0m15:08:11.873252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:11.874254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:08:11.875470 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:08:11.875470 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:08:11.875470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:11.943675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:08:11.945677 [debug] [ThreadPool]: On list_dbt: Close
[0m15:08:11.946675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:08:11.950639 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:11.950639 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:08:11.951639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:12.015577 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.016613 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:12.016613 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:08:12.018615 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:08:12.019614 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:08:12.020617 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:08:12.023578 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.024577 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.024577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:12.103158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.103158 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.103158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:12.106157 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:12.107157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB11120>]}
[0m15:08:12.107157 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:12.108157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.108157 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.109157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.109157 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.109157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.110187 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.110187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.110187 [debug] [MainThread]: On master: Close
[0m15:08:12.111157 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:08:12.112176 [info ] [MainThread]: 
[0m15:08:12.113181 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:08:12.114180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:08:12.114180 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.115181 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:08:12.115181 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:08:12.116185 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:08:12.116185 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:08:12.117183 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:08:12.118181 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:08:12.118181 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:08:12.118181 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:08:12.119182 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.119182 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.119182 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.125180 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.125180 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:08:12.126213 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:08:12.136397 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:08:12.120181 => 15:08:12.136397
[0m15:08:12.147396 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.148397 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.151396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.151396 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:08:12.160478 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.161479 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:08:12.161479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.163472 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:08:12.163472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.201758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.239089 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.239089 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:08:12.240089 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:08:12.244089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:08:12.244089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.245089 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.254090 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.254090 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:08:12.255092 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.255092 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.257132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.257132 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:08:12.126213 => 15:08:12.257132
[0m15:08:12.258137 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:08:12.258137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFBF2110>]}
[0m15:08:12.259091 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:08:12.260128 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:08:12.260128 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.260128 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.261092 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:08:12.296092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.311601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:08:12.343602 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.357633 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.357633 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.358636 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:08:12.358636 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:08:12.363635 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.364642 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:08:12.358636 => 15:08:12.364642
[0m15:08:12.365640 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.366636 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.367635 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:08:12.367635 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.368962 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:08:12.368962 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:08:12.370451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.370451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.371457 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.371457 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.372834 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.372834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.373840 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:08:12.138396 => 15:08:12.373840
[0m15:08:12.374840 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:08:12.151396 => 15:08:12.374840
[0m15:08:12.375842 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:08:12.375842 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:08:12.376841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF6857E0>]}
[0m15:08:12.376841 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:08:12.377842 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m15:08:12.378348 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m15:08:12.379391 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:08:12.380356 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.380894 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.380894 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.381994 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:08:12.381994 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.383652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:08:12.386159 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.387159 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.390249 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.391626 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:08:12.383652 => 15:08:12.391626
[0m15:08:12.391626 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.391626 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:08:12.387159 => 15:08:12.391626
[0m15:08:12.395163 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.395163 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.396161 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.397701 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.397701 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:08:12.398709 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.398709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:12.398709 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:08:12.399706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.419738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.420743 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.420743 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.421709 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.422724 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:08:12.365640 => 15:08:12.422724
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:08:12.424730 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.11s]
[0m15:08:12.424730 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.425764 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.425764 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:08:12.426770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:08:12.426770 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:08:12.427765 => 15:08:12.428943
[0m15:08:12.428943 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:08:12.428943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:08:12.393120 => 15:08:12.450221
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:08:12.461687 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m15:08:12.462801 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.476617 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.476617 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.488278 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:08:12.396161 => 15:08:12.476617
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:08:12.489320 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.11s]
[0m15:08:12.490319 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.491430 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:08:12.491430 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:08:12.492474 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:08:12.524026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.525014 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.525014 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.526010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.528010 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:08:12.428943 => 15:08:12.527010
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:08:12.529010 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:08:12.530011 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.530011 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:08:12.531013 [info ] [Thread-3 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:08:12.532014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:08:12.532014 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:08:12.534012 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:08:12.535012 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:08:12.532014 => 15:08:12.535012
[0m15:08:12.535012 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:08:12.556015 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:08:12.557014 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.558015 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:08:12.558015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.619534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.620531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.620531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.638188 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.638188 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.679037 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:08:12.682035 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.682035 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:08:12.683038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:08:12.684073 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:08:12.536013 => 15:08:12.684073
[0m15:08:12.684073 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:08:12.685043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD08B50>]}
[0m15:08:12.685043 [info ] [Thread-3 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.15s]
[0m15:08:12.686098 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:08:12.687082 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.687082 [info ] [Thread-1 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.688255 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:08:12.688255 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:08:12.693015 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.693015 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.694409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:12.869924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: Close
[0m15:08:12.869924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'model.customer360.stg_web__transactions' was properly closed.
[0m15:08:12.869924 [info ] [MainThread]: 
[0m15:08:12.869924 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m15:08:12.869924 [debug] [MainThread]: Command end result
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.886575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.891511 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:08:12.891511 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:08:12.892581 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:08:12.893264 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=5 TOTAL=13
[0m15:08:12.895546 [debug] [MainThread]: Command `dbt build` failed at 15:08:12.894731 after 1.57 seconds
[0m15:08:12.895546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD23640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD22560>]}
[0m15:08:12.895546 [debug] [MainThread]: Flushing usage events
[0m15:10:41.613814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2B00>]}


============================== 15:10:41.615800 | 2d75deeb-6ca3-4d86-9c99-d4931798420a ==============================
[0m15:10:41.615800 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:41.616800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:41.734048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B2E00>]}
[0m15:10:41.789052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B0A90>]}
[0m15:10:41.790052 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:41.799052 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:41.872555 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading customer360: staging\salesforce\_sf__sources.yaml - Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |           - name: id
    13 |             tests:
    14 |               - unique
    15 |                   config:
    16 |                     severity: error
    17 |                     error_if: ">5"
    18 |                     wan_if: ">0"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 15, column 25
[0m15:10:41.875523 [debug] [MainThread]: Command `dbt build` failed at 15:10:41.875523 after 0.32 seconds
[0m15:10:41.875523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955900>]}
[0m15:10:41.876524 [debug] [MainThread]: Flushing usage events
[0m15:10:57.883356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702B30>]}


============================== 15:10:57.886396 | 46a2d78d-ca8a-4129-8441-48188a34100b ==============================
[0m15:10:57.886396 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:57.887396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:58.004875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A5382E00>]}
[0m15:10:58.061391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC94A440>]}
[0m15:10:58.062391 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:58.068548 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:58.144533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:58.145541 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\_sf__sources.yaml
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACF480D0>]}
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACA84A60>]}
[0m15:10:58.369115 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:10:58.369115 [info ] [MainThread]: 
[0m15:10:58.384902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:58.385935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:10:58.391939 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:10:58.392931 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:10:58.392931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.450320 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:10:58.451320 [debug] [ThreadPool]: On list_dbt: Close
[0m15:10:58.453320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:10:58.456895 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.456895 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:10:58.457893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.656881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.657881 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.657881 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:58.659881 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:10:58.660881 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:10:58.661881 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:10:58.664881 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.665881 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.665881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:58.731882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.731882 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.732882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:58.734880 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:58.735880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2E9E0>]}
[0m15:10:58.736880 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:58.736880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.736880 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.737880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.737880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.738880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.739883 [debug] [MainThread]: On master: Close
[0m15:10:58.739883 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:10:58.739883 [info ] [MainThread]: 
[0m15:10:58.742260 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:10:58.743254 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:10:58.743254 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.744253 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:10:58.744253 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:10:58.745252 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:10:58.744253 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:10:58.746251 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:10:58.746251 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:10:58.747251 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:10:58.747251 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:10:58.748251 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.748251 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.749252 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.749252 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:10:58.761762 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.761762 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:10:58.781761 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.783762 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:10:58.749252 => 15:10:58.783762
[0m15:10:58.783762 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:10:58.786761 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.786761 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.787761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:58.787761 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:10:58.797761 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.797761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:58.798762 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.798762 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:10:58.799763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:10:58.847071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.848165 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.848165 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:10:58.854104 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:58.876522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.876522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:10:58.877523 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:10:58.881523 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.890522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.892522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.892522 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:10:58.761762 => 15:10:58.892522
[0m15:10:58.893522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:10:58.893522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2EA10>]}
[0m15:10:58.894521 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:10:58.895522 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:10:58.895522 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.896521 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:10:58.896521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:10:58.897522 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.901523 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.902522 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:10:58.897522 => 15:10:58.902522
[0m15:10:58.902522 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.904523 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:10:58.905525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.912521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.912521 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.913521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:10:58.914521 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.915521 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:10:58.787761 => 15:10:58.915521
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:10:58.917521 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.17s]
[0m15:10:58.918523 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.918523 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.918523 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:10:58.919522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:10:58.919522 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.923521 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.923521 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:10:58.920522 => 15:10:58.923521
[0m15:10:58.924678 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.924678 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:10:58.924678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:10:58.902522 => 15:10:58.954393
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:10:58.954393 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.06s]
[0m15:10:58.961540 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.961540 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.962572 [info ] [Thread-1 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:10:58.963226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:10:58.963226 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:10:58.963226 => 15:10:58.963226
[0m15:10:58.963226 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:10:58.963226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.975923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.975923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.976885 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:10:58.981883 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:59.028189 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:59.118039 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.119039 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:59.119039 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.120040 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:10:59.120040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.122041 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.123041 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:10:58.963226 => 15:10:59.123041
[0m15:10:59.124041 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:10:59.124041 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:10:59.125040 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:10:59.125040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:10:59.126446 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.125040 [warn ] [Thread-1 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.16s]
[0m15:10:59.127453 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.127453 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:59.128451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.128451 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.129451 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:10:59.129451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:10:59.130490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.131485 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:10:58.924678 => 15:10:59.131485
[0m15:10:59.132491 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:10:58.781761 => 15:10:59.132491
[0m15:10:59.135487 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.135487 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:10:59.135487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:10:59.136486 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:10:59.132491 => 15:10:59.136486
[0m15:10:59.136486 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:10:59.137483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD1229E0>]}
[0m15:10:59.137483 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.138491 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.22s]
[0m15:10:59.138491 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.39s]
[0m15:10:59.140531 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.141533 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:59.141533 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:10:59.141533 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:10:59.142529 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.142529 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:10:59.143532 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:10:59.143532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:10:59.144533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.144533 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:10:59.146533 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:10:59.147531 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:10:59.145533 => 15:10:59.147531
[0m15:10:59.147531 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:10:59.168372 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:10:59.169372 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.170384 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:10:59.170384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:10:59.139533 => 15:10:59.189386
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:10:59.201625 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m15:10:59.201625 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.202662 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:10:59.203671 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:10:59.203671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now model.customer360.stg_web__transactions)
[0m15:10:59.204676 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:10:59.207632 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:10:59.207632 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:10:59.204676 => 15:10:59.207632
[0m15:10:59.208671 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:10:59.211664 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:10:59.212664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.233631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.234630 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.234630 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.241799 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:10:59.245799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.250799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.250799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.251799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.251799 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.256311 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:10:59.259310 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.259310 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:10:59.260310 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.261311 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:10:59.147531 => 15:10:59.261311
[0m15:10:59.261311 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:10:59.262310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACCDEC20>]}
[0m15:10:59.262310 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m15:10:59.263311 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:10:59.385228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.385228 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.386261 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.393264 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:10:59.395262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.396263 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:10:59.396263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.398259 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.402262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.403262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.403262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.404262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.405266 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:10:59.406260 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.406260 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:10:59.408263 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.409266 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:10:59.208671 => 15:10:59.409266
[0m15:10:59.409266 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:10:59.410261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC9021D0>]}
[0m15:10:59.410261 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.21s]
[0m15:10:59.411261 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:10:59.412232 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.413230 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:10:59.413230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:10:59.414229 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:10:59.416229 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.417229 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:10:59.414229 => 15:10:59.416229
[0m15:10:59.417229 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:10:59.430233 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:10:59.432232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.525334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.526334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.526334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:10:59.528334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:10:59.530333 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.530333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:10:59.531334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.532334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.532334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.533333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.533333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.535334 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:10:59.537335 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.538334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:10:59.538334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:10:59.539334 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:10:59.417229 => 15:10:59.539334
[0m15:10:59.540338 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:10:59.540338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD122230>]}
[0m15:10:59.541338 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:59.541338 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.542338 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.543338 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.543338 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:10:59.543338 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.545338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:10:59.548338 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.548338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.551338 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.552342 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:10:59.545338 => 15:10:59.552342
[0m15:10:59.552342 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.553340 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:10:59.549338 => 15:10:59.552342
[0m15:10:59.554850 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.555855 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.556855 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.557855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.557855 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.558855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:10:59.558855 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:10:59.559855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.559855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.609855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.609855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.610855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.611855 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.612855 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:10:59.553340 => 15:10:59.612855
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:10:59.614856 [error] [Thread-2 (]: 11 of 13 FAIL 1 not_null_contacts_joined_with_transactions_id .................. [[31mFAIL 1[0m in 0.07s]
[0m15:10:59.615857 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.646858 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.647861 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.647861 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.649859 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.650858 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:10:59.555855 => 15:10:59.650858
[0m15:10:59.650858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:10:59.651858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:10:59.651858 [error] [Thread-3 (]: 12 of 13 FAIL 9 unique_contacts_joined_with_transactions_id .................... [[31mFAIL 9[0m in 0.11s]
[0m15:10:59.652891 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.652891 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:10:59.654431 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:10:59.654431 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:10:59.655467 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.656483 [debug] [MainThread]: On master: BEGIN
[0m15:10:59.656483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:59.709166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: Close
[0m15:10:59.709166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:10:59.709166 [info ] [MainThread]: 
[0m15:10:59.721608 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m15:10:59.723654 [debug] [MainThread]: Command end result
[0m15:10:59.730656 [info ] [MainThread]: 
[0m15:10:59.731651 [info ] [MainThread]: [31mCompleted with 2 errors and 1 warning:[0m
[0m15:10:59.731651 [info ] [MainThread]: 
[0m15:10:59.732649 [error] [MainThread]: [31mFailure in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.732649 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:10:59.733653 [info ] [MainThread]: 
[0m15:10:59.733653 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:10:59.734653 [info ] [MainThread]: 
[0m15:10:59.734653 [error] [MainThread]: [31mFailure in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.735649 [error] [MainThread]:   Got 9 results, configured to fail if != 0
[0m15:10:59.735649 [info ] [MainThread]: 
[0m15:10:59.736655 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:10:59.736655 [info ] [MainThread]: 
[0m15:10:59.736655 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:10:59.737649 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:10:59.737649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:10:59.738649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]: Done. PASS=9 WARN=1 ERROR=2 SKIP=1 TOTAL=13
[0m15:10:59.740657 [debug] [MainThread]: Command `dbt build` failed at 15:10:59.739691 after 1.91 seconds
[0m15:10:59.740657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC902050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC901FC0>]}
[0m15:10:59.740657 [debug] [MainThread]: Flushing usage events
[0m15:14:58.020660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762B60>]}


============================== 15:14:58.023660 | bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d ==============================
[0m15:14:58.023660 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:14:58.024660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:14:58.142954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5402E00>]}
[0m15:14:58.194143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC9ABBB0>]}
[0m15:14:58.194143 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:14:58.194143 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m15:14:58.458762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCEB6920>]}
[0m15:14:58.459867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCAE4B20>]}
[0m15:14:58.459867 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:14:58.459867 [info ] [MainThread]: 
[0m15:14:58.459867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:58.459867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:14:58.476102 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:14:58.477133 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:14:58.477133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.556767 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:14:58.557766 [debug] [ThreadPool]: On list_dbt: Close
[0m15:14:58.558767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:14:58.562766 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.563767 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:14:58.563767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.636275 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.636275 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.636275 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:58.639275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:14:58.644278 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.644278 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.645276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:58.729756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.729756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.730758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:58.733756 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:14:58.734756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCB8F850>]}
[0m15:14:58.734756 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:58.735756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.735756 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.735756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.736756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.737756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.737756 [debug] [MainThread]: On master: Close
[0m15:14:58.738757 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:14:58.738757 [info ] [MainThread]: 
[0m15:14:58.740757 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:14:58.740757 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:14:58.741757 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.741757 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:14:58.742756 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:14:58.743757 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:14:58.742756 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:14:58.743757 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:14:58.744757 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:14:58.744757 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:14:58.745756 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:14:58.745756 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.745756 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.746757 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.746757 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:14:58.758756 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.758756 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:14:58.777758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.779761 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:14:58.746757 => 15:14:58.779761
[0m15:14:58.780760 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:14:58.783760 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.783760 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.784760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:58.784760 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:14:58.794262 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.795265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:14:58.796267 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.796267 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:14:58.796267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:58.857266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.858267 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.858267 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:14:58.864265 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.887269 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.887269 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.888268 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:14:58.888268 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.889268 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:14:58.889268 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:14:58.893268 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:14:58.901774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.901774 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.902774 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.928774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.976774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:14:58.998406 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:14:58.758756 => 15:14:58.998406
[0m15:14:58.998406 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:14:58.998406 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:14:58.998406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF17820>]}
[0m15:14:58.998406 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.26s]
[0m15:14:58.998406 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:14:58.998406 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:14:58.998406 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.014032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.014032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.016845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:14:58.784760 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:14:58.778757 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:14:59.017630 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:14:58.998406 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:14:59.017630 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:14:59.017630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF31930>]}
[0m15:14:59.017630 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:14:59.017630 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:14:59.017630 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:59.017630 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:14:59.017630 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.017630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:14:59.017630 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.017630 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:14:59.017630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.017630 [info ] [Thread-2 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:14:59.030174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:14:59.031180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:14:59.031539 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.031539 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.031539 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.043480 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.044916 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.044916 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.044916 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:14:59.017630 => 15:14:59.077266
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:14:59.083459 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m15:14:59.084464 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.084464 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.084464 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:14:59.085464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:14:59.085464 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.089464 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.089464 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:14:59.086463 => 15:14:59.089464
[0m15:14:59.090464 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.092464 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.092464 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.093464 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:14:59.093464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.111972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.111972 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.111972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.112972 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.114972 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:14:59.031539 => 15:14:59.113972
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:14:59.115972 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.10s]
[0m15:14:59.116973 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.143972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.143972 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.144972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.145972 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.146972 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:14:59.043480 => 15:14:59.146972
[0m15:14:59.146972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:14:59.147972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:14:59.148974 [warn ] [Thread-2 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.12s]
[0m15:14:59.148974 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.149973 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:14:59.149973 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:14:59.150973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:14:59.151973 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:14:59.153972 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:14:59.154972 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:14:59.151973 => 15:14:59.153972
[0m15:14:59.154972 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:14:59.175972 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:14:59.176972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.176972 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.177972 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.177972 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:14:59.178972 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.178972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.179975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.180978 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:14:59.090464 => 15:14:59.180978
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:14:59.182975 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:14:59.183976 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.183976 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:14:59.184976 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:14:59.184976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:14:59.185976 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:14:59.187975 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:14:59.188976 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:14:59.185976 => 15:14:59.188976
[0m15:14:59.188976 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:14:59.192975 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:14:59.192975 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.194478 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:14:59.194478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.228482 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.229482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.229482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.236482 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.240482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.241482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:14:59.241482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.244484 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.244484 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:14:59.245482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.250482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.250482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.251482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.251482 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.255481 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:14:59.258481 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.259482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:14:59.261483 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.262482 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:14:59.154972 => 15:14:59.261483
[0m15:14:59.262482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:14:59.263482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076320>]}
[0m15:14:59.263482 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m15:14:59.264483 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:14:59.266482 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.266482 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.267483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.274482 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:14:59.276481 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.276481 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:14:59.277481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.279483 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.279483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:14:59.280487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.281487 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.282486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.282486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.283486 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.285486 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:14:59.285486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.286486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:14:59.287487 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.288486 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:14:59.189976 => 15:14:59.288486
[0m15:14:59.289486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:14:59.289486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076A10>]}
[0m15:14:59.290486 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.10s]
[0m15:14:59.290486 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:14:59.291488 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.292487 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:14:59.292487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:14:59.293486 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:14:59.296558 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.296558 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:14:59.293486 => 15:14:59.296558
[0m15:14:59.297559 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:14:59.307676 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.307676 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.310179 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:14:59.310179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.410550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.411552 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.411552 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:14:59.413550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:14:59.415549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.416550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:14:59.417550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.418550 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.419550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.421550 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:14:59.423549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.423549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:14:59.424550 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:14:59.425549 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:14:59.297559 => 15:14:59.425549
[0m15:14:59.425549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:14:59.426550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD07AE90>]}
[0m15:14:59.426550 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:59.427550 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.428550 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.428550 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.429550 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:14:59.429550 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:14:59.430550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:14:59.431550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:14:59.431550 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.431550 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.435550 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.438550 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.439550 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:14:59.431550 => 15:14:59.438550
[0m15:14:59.439550 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:14:59.435550 => 15:14:59.439550
[0m15:14:59.439550 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.440550 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.441550 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.444550 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.444550 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.445550 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:14:59.445550 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.445550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.446551 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:14:59.446551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.504055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.504055 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.505055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.506055 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.507055 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:14:59.440550 => 15:14:59.507055
[0m15:14:59.507055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:14:59.508055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:14:59.509056 [warn ] [Thread-2 (]: 11 of 13 WARN 1 not_null_contacts_joined_with_transactions_id .................. [[33mWARN 1[0m in 0.08s]
[0m15:14:59.509056 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.542054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.543055 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.543055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.545055 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.546055 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:14:59.442550 => 15:14:59.546055
[0m15:14:59.546055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:14:59.547054 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:14:59.547054 [warn ] [Thread-3 (]: 12 of 13 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.12s]
[0m15:14:59.548055 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.549057 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:14:59.549057 [info ] [Thread-1 (]: 13 of 13 START sql table model public.customers ................................ [RUN]
[0m15:14:59.550055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:14:59.550055 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m15:14:59.599564 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:14:59.600565 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 15:14:59.551055 => 15:14:59.600565
[0m15:14:59.600565 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m15:14:59.603565 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m15:14:59.604565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.698081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.698081 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.699083 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:14:59.707080 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.709080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.709080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:14:59.710080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.711080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.712080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.712080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.713080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.715080 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:14:59.715080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.716080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:14:59.716080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.717080 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 15:14:59.601565 => 15:14:59.717080
[0m15:14:59.718080 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m15:14:59.718080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD156AD0>]}
[0m15:14:59.719080 [info ] [Thread-1 (]: 13 of 13 OK created sql table model public.customers ........................... [[32mSELECT 11[0m in 0.17s]
[0m15:14:59.720081 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:14:59.721081 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.721081 [debug] [MainThread]: On master: BEGIN
[0m15:14:59.721081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:59.787084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.787084 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.787084 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.788083 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.788083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.788083 [debug] [MainThread]: On master: Close
[0m15:14:59.789083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:14:59.791083 [info ] [MainThread]: 
[0m15:14:59.791083 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m15:14:59.793083 [debug] [MainThread]: Command end result
[0m15:14:59.798588 [info ] [MainThread]: 
[0m15:14:59.798588 [info ] [MainThread]: [33mCompleted with 3 warnings:[0m
[0m15:14:59.799589 [info ] [MainThread]: 
[0m15:14:59.799589 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:14:59.800589 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:14:59.800589 [info ] [MainThread]: 
[0m15:14:59.800589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:14:59.801589 [info ] [MainThread]: 
[0m15:14:59.801589 [warn ] [MainThread]: [33mWarning in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.801589 [warn ] [MainThread]: Got 1 result, configured to warn if >0
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.802589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.803590 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.803590 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:14:59.804590 [info ] [MainThread]: 
[0m15:14:59.804590 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:14:59.805590 [info ] [MainThread]: 
[0m15:14:59.805590 [info ] [MainThread]: Done. PASS=10 WARN=3 ERROR=0 SKIP=0 TOTAL=13
[0m15:14:59.806589 [debug] [MainThread]: Command `dbt build` succeeded at 15:14:59.806589 after 1.84 seconds
[0m15:14:59.807590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC8A3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD064610>]}
[0m15:14:59.807590 [debug] [MainThread]: Flushing usage events
[0m15:23:13.674580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82B30>]}


============================== 15:23:13.676967 | a202ad70-273e-41a2-8106-2ac270eb246f ==============================
[0m15:23:13.676967 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:23:13.677935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:13.785735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E33942E00>]}
[0m15:23:13.851843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>]}
[0m15:23:13.851843 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:23:13.860843 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\salesforce\_sf__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\web\_web__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\stg_sf__contacts.sql
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m15:23:14.121897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B339660>]}
[0m15:23:14.129402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2B1600>]}
[0m15:23:14.130728 [info ] [MainThread]: Found 2 seeds, 10 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:23:14.131734 [info ] [MainThread]: 
[0m15:23:14.132733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:14.133733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:23:14.139733 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:23:14.139733 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:23:14.140733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.193986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:23:14.194986 [debug] [ThreadPool]: On list_dbt: Close
[0m15:23:14.195987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:23:14.200067 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.200067 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:23:14.201055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.277752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.277752 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.278752 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:23:14.280751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:23:14.285750 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.285750 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.286753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:14.396798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.397798 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.397798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:14.401301 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:23:14.403304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F1C60>]}
[0m15:23:14.403304 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:14.403304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.404304 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.404304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.405304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.406304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.406304 [debug] [MainThread]: On master: Close
[0m15:23:14.407304 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:23:14.407304 [info ] [MainThread]: 
[0m15:23:14.409304 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:23:14.410304 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:23:14.410304 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.410304 [info ] [Thread-1 (]: 1 of 16 START seed file public.contacts ........................................ [RUN]
[0m15:23:14.411304 [info ] [Thread-2 (]: 2 of 16 START seed file public.transactions .................................... [RUN]
[0m15:23:14.412355 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:23:14.411304 [info ] [Thread-3 (]: 3 of 16 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:23:14.413435 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:23:14.413435 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:23:14.414473 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:23:14.414473 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:23:14.415441 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:23:14.414473 => 15:23:14.414473
[0m15:23:14.415441 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.415441 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:23:14.415441 => 15:23:14.415441
[0m15:23:14.416440 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:23:14.426438 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.427441 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:23:14.437474 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.437474 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:23:14.437474 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:23:14.416440 => 15:23:14.437474
[0m15:23:14.437474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:14.450125 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.450125 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.450125 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:23:14.462624 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.462624 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:23:14.463667 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.463667 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:23:14.464382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:14.512974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.512974 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.513976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:23:14.518973 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.540942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.541942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:23:14.542942 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:23:14.546941 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:23:14.555942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.555942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.556942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.556942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.557942 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.557942 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:23:14.558942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.559941 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:23:14.427441 => 15:23:14.559941
[0m15:23:14.559941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:23:14.560942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AE9E0>]}
[0m15:23:14.560942 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:23:14.561942 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:23:14.561942 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.562951 [info ] [Thread-1 (]: 4 of 16 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:23:14.562951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:23:14.563943 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.567942 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.568945 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.598947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.646459 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.646459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:23:14.661459 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:23:14.563943 => 15:23:14.661459
[0m15:23:14.664459 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.664459 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.665460 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:23:14.667460 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:23:14.669460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.669460 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:23:14.670462 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:23:14.672464 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.672464 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.673462 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.674460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.674460 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.675460 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:23:14.437474 => 15:23:14.675460
[0m15:23:14.676459 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:23:14.450125 => 15:23:14.676459
[0m15:23:14.677459 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:23:14.677459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:23:14.678461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F4310>]}
[0m15:23:14.678461 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:23:14.679460 [info ] [Thread-2 (]: 2 of 16 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:23:14.679460 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:23:14.679460 [info ] [Thread-3 (]: 3 of 16 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:23:14.680784 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.680784 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.681794 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.681794 [info ] [Thread-2 (]: 5 of 16 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:23:14.682792 [info ] [Thread-3 (]: 6 of 16 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.683793 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:23:14.686801 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.687800 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.691800 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.692800 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:23:14.683793 => 15:23:14.691800
[0m15:23:14.692800 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.694819 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.694819 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:23:14.687800 => 15:23:14.694819
[0m15:23:14.695980 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.696989 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.697987 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.697987 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:23:14.697987 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.698989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.698989 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:23:14.699987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.725532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.726530 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.726530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.727529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.728530 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:23:14.665460 => 15:23:14.728530
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:23:14.730530 [info ] [Thread-1 (]: 4 of 16 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m15:23:14.731530 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.731530 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.732532 [info ] [Thread-1 (]: 7 of 16 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:23:14.733534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:23:14.733534 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.736531 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.737532 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:23:14.733534 => 15:23:14.737532
[0m15:23:14.737532 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.739665 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:23:14.739665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:23:14.692800 => 15:23:14.744338
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:23:14.744338 [info ] [Thread-2 (]: 5 of 16 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.06s]
[0m15:23:14.744338 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.782655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.782655 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.783772 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.784422 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.784422 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:23:14.695980 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:23:14.784422 [warn ] [Thread-3 (]: 6 of 16 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m15:23:14.784422 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.784422 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [info ] [Thread-2 (]: 8 of 16 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:23:14.784422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:23:14.784422 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:23:14.784422 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:23:14.784422 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:23:14.816535 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:23:14.817535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.818535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.819537 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.819537 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.820535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.821535 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:23:14.737532 => 15:23:14.821535
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:23:14.823535 [info ] [Thread-1 (]: 7 of 16 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:23:14.824535 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.884536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.885536 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.885536 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:23:14.892543 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:23:14.897540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.897540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:23:14.898540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.900540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.900540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:23:14.901540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.906050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.907051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.911051 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:23:14.914050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.914050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:23:14.916133 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:14.916133 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:23:14.784422 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m15:23:14.916133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AF7F0>]}
[0m15:23:14.916133 [info ] [Thread-2 (]: 8 of 16 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.13s]
[0m15:23:14.916133 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:23:14.916133 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:23:14.916133 [info ] [Thread-3 (]: 9 of 16 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:23:14.916133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:23:14.916133 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:23:14.916133 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:23:14.916133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.986656 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.986656 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.987662 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:23:14.993661 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:23:14.996660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.996660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:23:14.997660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.999660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.038166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.038166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.039166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.040167 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.041166 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:23:15.042166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.042166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:23:15.044168 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.045168 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:23:14.916133 => 15:23:15.045168
[0m15:23:15.046295 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:23:15.046295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B451CF0>]}
[0m15:23:15.046295 [info ] [Thread-3 (]: 9 of 16 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 101[0m in 0.13s]
[0m15:23:15.046295 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:23:15.046295 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:23:15.046295 [info ] [Thread-1 (]: 11 of 16 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:23:15.046295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:23:15.046295 [info ] [Thread-3 (]: 12 of 16 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:23:15.046295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:23:15.046295 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:23:15.046295 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.046295 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.046295 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.063040 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:23:15.046295 => 15:23:15.062038
[0m15:23:15.063547 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:23:15.046295 => 15:23:15.063040
[0m15:23:15.063547 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.064470 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:23:15.046295 => 15:23:15.063547
[0m15:23:15.064470 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.066513 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.066513 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.068512 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.070509 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.070509 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.071508 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:23:15.071508 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.071508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.072509 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.073507 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:23:15.073507 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:23:15.073507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.074476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.122017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.122017 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.122017 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.123078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.124020 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:23:15.064470 => 15:23:15.124020
[0m15:23:15.125020 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:23:15.126018 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:23:15.126018 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m15:23:15.127025 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.151287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.152287 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.152287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:23:15.153287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.154288 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:23:15.067510 => 15:23:15.154288
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:23:15.156287 [info ] [Thread-1 (]: 11 of 16 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m15:23:15.157656 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.181701 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.182704 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.182704 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.183696 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.185700 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:23:15.068512 => 15:23:15.184701
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:23:15.186741 [info ] [Thread-3 (]: 12 of 16 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m15:23:15.187741 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.187741 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.188741 [info ] [Thread-2 (]: 13 of 16 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:23:15.189744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now model.customer360.contacts_joined_with_transactions)
[0m15:23:15.189744 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:23:15.191741 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.192743 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:23:15.189744 => 15:23:15.192743
[0m15:23:15.192743 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:23:15.204216 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:23:15.205216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.310792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:23:15.192743 => 15:23:15.312169
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:23:15.312169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B54FF10>]}
[0m15:23:15.312169 [info ] [Thread-2 (]: 13 of 16 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.12s]
[0m15:23:15.327795 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.327795 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [info ] [Thread-3 (]: 14 of 16 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:23:15.328875 [info ] [Thread-1 (]: 15 of 16 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:23:15.343885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.328875 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.343885 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:23:15.345088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.391471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.392470 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.392470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.394473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.395471 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:23:15.328875 => 15:23:15.395471
[0m15:23:15.395471 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:23:15.396470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:23:15.396470 [info ] [Thread-3 (]: 14 of 16 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:23:15.397490 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.427158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.436048 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.436800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.436800 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:23:15.328875 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:23:15.436800 [warn ] [Thread-1 (]: 15 of 16 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.11s]
[0m15:23:15.436800 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.436800 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:23:15.436800 [info ] [Thread-2 (]: 16 of 16 START sql table model public.customers ................................ [RUN]
[0m15:23:15.436800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:23:15.436800 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m15:23:15.436800 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:23:15.436800 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 15:23:15.436800 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m15:23:15.449651 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m15:23:15.451656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.511277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.512277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.512277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:23:15.533277 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:23:15.536277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.536277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:23:15.537277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.539277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.541277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.542278 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.544277 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:23:15.544277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.545277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:23:15.546279 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.547277 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 15:23:15.436800 => 15:23:15.547277
[0m15:23:15.547277 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m15:23:15.548278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B12E950>]}
[0m15:23:15.548278 [info ] [Thread-2 (]: 16 of 16 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.11s]
[0m15:23:15.549278 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:23:15.550277 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.550277 [debug] [MainThread]: On master: BEGIN
[0m15:23:15.551280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:15.610495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.611490 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.612490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.612490 [debug] [MainThread]: On master: Close
[0m15:23:15.613490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:23:15.614493 [info ] [MainThread]: 
[0m15:23:15.615490 [info ] [MainThread]: Finished running 2 seeds, 10 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m15:23:15.617490 [debug] [MainThread]: Command end result
[0m15:23:15.623491 [info ] [MainThread]: 
[0m15:23:15.624489 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:23:15.624489 [info ] [MainThread]: 
[0m15:23:15.625498 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:23:15.625498 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.626496 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.627491 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:23:15.627491 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:23:15.628491 [info ] [MainThread]: 
[0m15:23:15.628491 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:23:15.629495 [info ] [MainThread]: 
[0m15:23:15.629495 [info ] [MainThread]: Done. PASS=14 WARN=2 ERROR=0 SKIP=0 TOTAL=16
[0m15:23:15.630461 [debug] [MainThread]: Command `dbt build` succeeded at 15:23:15.630461 after 2.01 seconds
[0m15:23:15.630461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B275780>]}
[0m15:23:15.631458 [debug] [MainThread]: Flushing usage events
