[0m14:50:16.932375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EDCAA10>]}


============================== 14:50:16.935375 | 16040dd4-dfa5-4647-80c6-cc380ce7ef52 ==============================
[0m14:50:16.935375 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:16.935375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:17.001884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16040dd4-dfa5-4647-80c6-cc380ce7ef52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4ED7E080>]}
[0m14:50:17.002884 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-xaitn6h6'
[0m14:50:17.004883 [info ] [MainThread]: Updating lock file in file path: C:\Users\Samuel\Desktop\customer360\integration_tests/package-lock.yml
[0m14:50:17.005883 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-fst6ucu3'
[0m14:50:17.006883 [info ] [MainThread]: Installing ../
[0m14:50:17.006883 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:50:17.007883 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:50:20.607498 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:50:20.609500 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:50:20.612003 [debug] [MainThread]: Command `dbt deps` failed at 14:50:20.612003 after 3.72 seconds
[0m14:50:20.612003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BAD42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EE63C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4EEB0460>]}
[0m14:50:20.613008 [debug] [MainThread]: Flushing usage events
[0m14:50:57.146162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836AA40>]}


============================== 14:50:57.148463 | 4c6152b5-76b0-4004-9902-1d15f3881478 ==============================
[0m14:50:57.148463 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:57.149467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:57.650768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C836ACE0>]}
[0m14:50:57.709781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C83236A0>]}
[0m14:50:57.709781 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:50:57.719918 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:57.720917 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:57.721918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C84793F0>]}
[0m14:50:58.471639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8CD00A0>]}
[0m14:50:58.516341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.517343 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:50:58.517343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8C79450>]}
[0m14:50:58.518343 [info ] [MainThread]: 
[0m14:50:58.519341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:58.520343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:50:58.526337 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:50:58.527338 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:50:58.527338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.577381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:50:58.578343 [debug] [ThreadPool]: On list_dbt: Close
[0m14:50:58.580343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:50:58.584342 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.585343 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:50:58.585343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:58.632050 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.632050 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:50:58.633044 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:58.635042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:50:58.636042 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:50:58.639047 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.640004 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.640004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:58.692968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.692968 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.692968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:58.696005 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:50:58.696005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C89A5120>]}
[0m14:50:58.697007 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:58.697007 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.697007 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.698052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.698052 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.699048 [debug] [MainThread]: On master: COMMIT
[0m14:50:58.699048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.699048 [debug] [MainThread]: On master: Close
[0m14:50:58.700049 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:50:58.701011 [info ] [MainThread]: 
[0m14:50:58.703010 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:50:58.703010 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:50:58.704009 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:50:58.704009 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:50:58.705010 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:50:58.705010 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:50:58.706010 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:50:58.706010 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:50:58.706010 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:50:58.706010 => 14:50:58.706010
[0m14:50:58.707010 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:50:58.707010 => 14:50:58.707010
[0m14:50:58.707010 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:50:58.708009 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:50:58.729514 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.731514 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.731514 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:50:58.731514 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:50:58.732515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:58.732515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:58.779976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.779976 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.780976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */

    create table "dbt"."public"."contacts" ("id" text,"username" text,"name" text,"gender" text,"address" text,"mail" text,"birthdate" date,"_loaded_at_utc" timestamp)
  
[0m14:50:58.786975 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.808979 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.809978 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:50:58.810979 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:50:58.814486 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:50:58.814486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.815487 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.815487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */

    create table "dbt"."public"."transactions" ("contact_id" text,"id" text,"transaction_date" text,"amount" float8,"item_count" integer,"category" text,"_loaded_at_utc" timestamp)
  
[0m14:50:58.826488 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.826488 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:50:58.827487 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:50:58.903536 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:50:58.924202 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.925162 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:50:58.927161 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:50:58.927161 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:50:58.939580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.940581 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:50:58.708009 => 14:50:58.940581
[0m14:50:58.941583 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.941583 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:50:58.942544 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:50:58.943543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>]}
[0m14:50:58.943543 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:50:58.944543 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.24s]
[0m14:50:58.944543 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:50:58.945543 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:50:58.945543 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:50:58.716514 => 14:50:58.945543
[0m14:50:58.946542 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:50:58.947542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6152b5-76b0-4004-9902-1d15f3881478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8B38C10>]}
[0m14:50:58.947542 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:50:58.948542 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:50:58.949542 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:58.949542 [debug] [MainThread]: On master: BEGIN
[0m14:50:58.949542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:58.999545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:50:58.999545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:59.000545 [debug] [MainThread]: On master: COMMIT
[0m14:50:59.000545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:50:59.001545 [debug] [MainThread]: On master: Close
[0m14:50:59.001545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:50:59.002545 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:50:59.003545 [info ] [MainThread]: 
[0m14:50:59.003545 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:50:59.004545 [debug] [MainThread]: Command end result
[0m14:50:59.010545 [info ] [MainThread]: 
[0m14:50:59.011545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:59.011545 [info ] [MainThread]: 
[0m14:50:59.012545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:50:59.013048 [debug] [MainThread]: Command `dbt seed` succeeded at 14:50:59.013048 after 1.91 seconds
[0m14:50:59.013048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C5074400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C88141C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C8A4C3D0>]}
[0m14:50:59.014051 [debug] [MainThread]: Flushing usage events
[0m14:51:24.176973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323A920>]}


============================== 14:51:24.179971 | 2fa63a5f-3852-4337-baad-b6d425277112 ==============================
[0m14:51:24.179971 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:24.179971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:24.246481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa63a5f-3852-4337-baad-b6d425277112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A323ABF0>]}
[0m14:51:25.112111 [debug] [MainThread]: Command `dbt clean` succeeded at 14:51:25.112111 after 0.97 seconds
[0m14:51:25.113112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99FF44400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A32935E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A31ABBE0>]}
[0m14:51:25.113112 [debug] [MainThread]: Flushing usage events
[0m14:51:39.842730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801FEC2B60>]}


============================== 14:51:39.845780 | 543031ae-e66a-4e6e-b09b-952668fb6dc9 ==============================
[0m14:51:39.845780 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:39.846768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:39.965249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028018B52E00>]}
[0m14:51:40.021249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '543031ae-e66a-4e6e-b09b-952668fb6dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010BBB0>]}
[0m14:51:40.022249 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:51:40.023249 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:51:40.024249 [debug] [MainThread]: Command `dbt build` failed at 14:51:40.024249 after 0.23 seconds
[0m14:51:40.024249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801CBC6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802010A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028020109A20>]}
[0m14:51:40.024249 [debug] [MainThread]: Flushing usage events
[0m14:51:56.581142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CABC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CA950>]}


============================== 14:51:56.584142 | b2c1ab68-d4d0-4adb-8a84-847e14914495 ==============================
[0m14:51:56.584142 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:51:56.585143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:56.651146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c1ab68-d4d0-4adb-8a84-847e14914495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CAC20>]}
[0m14:51:56.653148 [debug] [MainThread]: Set downloads directory='C:\Users\Samuel\AppData\Local\Temp\dbt-downloads-n8fu7w2e'
[0m14:51:56.654147 [info ] [MainThread]: Installing ../
[0m14:51:56.655654 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:51:56.655654 [debug] [MainThread]: Symlinks are not available on this OS, copying dependency.
[0m14:51:59.866336 [error] [MainThread]: Encountered an error:
[('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]
[0m14:51:59.868336 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 67, in install
    system.make_symlink(src_path, dest_path)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\clients\system.py", line 158, in make_symlink
    os.symlink(source, link_path)
OSError: [WinError 1314] A required privilege is not held by the client: 'C:\\Users\\Samuel\\Desktop\\customer360' -> 'dbt_packages\\customer360'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 492, in deps
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\deps.py", line 252, in run
    package.install(self.project, renderer)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\deps\local.py", line 70, in install
    shutil.copytree(src_path, dest_path)
  File "C:\Python\lib\shutil.py", line 559, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
  File "C:\Python\lib\shutil.py", line 513, in _copytree
    raise Error(errors)
shutil.Error: [('C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', 'dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360\\integration_tests\\dbt_packages\\customer360', "[WinError 206] The filename or extension is too long: 'dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360\\\\integration_tests\\\\dbt_packages\\\\customer360'")]

[0m14:51:59.870337 [debug] [MainThread]: Command `dbt deps` failed at 14:51:59.870337 after 3.33 seconds
[0m14:51:59.870337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A4D4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D7CACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60D857820>]}
[0m14:51:59.871335 [debug] [MainThread]: Flushing usage events
[0m14:52:15.039154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAA70>]}


============================== 14:52:15.043155 | e9d1782c-893b-4ddc-8c25-8b50a44d7c63 ==============================
[0m14:52:15.043155 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:15.043155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:52:15.164375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EEAD10>]}
[0m14:52:15.225976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>]}
[0m14:52:15.226977 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:15.236976 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:15.236976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:52:15.237976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988315E0E0>]}
[0m14:52:15.984447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988384C0D0>]}
[0m14:52:16.030900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BDC90>]}
[0m14:52:16.030900 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:16.031900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198836BD630>]}
[0m14:52:16.032900 [info ] [MainThread]: 
[0m14:52:16.033900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:16.034900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:16.040901 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:16.041901 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:16.041901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.111840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:16.112840 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:16.114840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:16.118840 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.118840 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:16.118840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:16.190391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.191391 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:16.191391 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:16.194391 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:16.194391 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:16.195391 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:16.199391 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.199391 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.199391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:16.300178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.300178 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.301170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:16.303178 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:16.304170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837C67D0>]}
[0m14:52:16.305174 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:16.305174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.306170 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.306170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.306170 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.307175 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.307175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.308175 [debug] [MainThread]: On master: Close
[0m14:52:16.308175 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:16.309176 [info ] [MainThread]: 
[0m14:52:16.311180 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:16.311180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:16.312171 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:16.312171 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m14:52:16.313178 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:16.314140 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:16.314140 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:16.314140 => 14:52:16.314140
[0m14:52:16.315139 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:16.315139 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:16.315139 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:16.315139 => 14:52:16.315139
[0m14:52:16.326141 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:16.336140 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.338392 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:16.341396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.341396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:16.341396 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:16.342395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:16.396399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.397400 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.397400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:16.403403 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.425399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.426400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:16.427399 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:16.427399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.431399 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:16.431399 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.441399 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:16.441399 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:16.442399 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:16.443400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.444400 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:16.316139 => 14:52:16.444400
[0m14:52:16.444400 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:16.445400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019883320820>]}
[0m14:52:16.445400 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.13s]
[0m14:52:16.446399 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:16.447399 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:16.547349 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.547349 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:16.549334 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:16.550332 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.552370 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:16.552370 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:16.554342 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.554342 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:16.336140 => 14:52:16.554342
[0m14:52:16.555826 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:16.556329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d1782c-893b-4ddc-8c25-8b50a44d7c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988354D8D0>]}
[0m14:52:16.557371 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.24s]
[0m14:52:16.557371 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:16.558337 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.559336 [debug] [MainThread]: On master: BEGIN
[0m14:52:16.559336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:16.623125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:16.623125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:16.624125 [debug] [MainThread]: On master: COMMIT
[0m14:52:16.624125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:16.625126 [debug] [MainThread]: On master: Close
[0m14:52:16.625126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:16.625126 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m14:52:16.626125 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m14:52:16.627125 [info ] [MainThread]: 
[0m14:52:16.627125 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m14:52:16.628128 [debug] [MainThread]: Command end result
[0m14:52:16.634124 [info ] [MainThread]: 
[0m14:52:16.635124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:16.635124 [info ] [MainThread]: 
[0m14:52:16.636124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:52:16.636124 [debug] [MainThread]: Command `dbt seed` succeeded at 14:52:16.636124 after 1.64 seconds
[0m14:52:16.637124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FFA84580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019882EA1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198837FB5B0>]}
[0m14:52:16.637124 [debug] [MainThread]: Flushing usage events
[0m14:52:24.451658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532B62B90>]}


============================== 14:52:24.454627 | 5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f ==============================
[0m14:52:24.454627 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:52:24.455626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:52:24.576755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752B7E2E00>]}
[0m14:52:24.636591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532DA8880>]}
[0m14:52:24.637592 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:52:24.647731 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:52:24.731036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:24.732003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:24.736003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532FD80D0>]}
[0m14:52:24.743536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4B50>]}
[0m14:52:24.743536 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m14:52:24.745536 [info ] [MainThread]: 
[0m14:52:24.745536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:24.747536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:52:24.753536 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:52:24.754536 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:52:24.754536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.825083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:24.826083 [debug] [ThreadPool]: On list_dbt: Close
[0m14:52:24.828046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m14:52:24.832046 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.832046 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m14:52:24.832046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:24.982175 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:24.982175 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m14:52:24.982175 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:24.985175 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m14:52:24.986174 [debug] [ThreadPool]: On list_dbt_public: Close
[0m14:52:24.989174 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:24.990211 [debug] [MainThread]: On master: BEGIN
[0m14:52:24.990211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:25.058461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.059927 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.060938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:25.063937 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:52:25.064935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532F8F850>]}
[0m14:52:25.064935 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:25.064935 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.065935 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.065935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.065935 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.067181 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.067181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.068222 [debug] [MainThread]: On master: Close
[0m14:52:25.068222 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m14:52:25.069227 [info ] [MainThread]: 
[0m14:52:25.071692 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m14:52:25.072196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m14:52:25.072196 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.073201 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m14:52:25.073201 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m14:52:25.074203 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m14:52:25.074203 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m14:52:25.075202 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m14:52:25.075202 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m14:52:25.076201 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m14:52:25.076201 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m14:52:25.076201 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 14:52:25.076201 => 14:52:25.076201
[0m14:52:25.077201 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.077201 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 14:52:25.077201 => 14:52:25.077201
[0m14:52:25.078201 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m14:52:25.089245 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.090238 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m14:52:25.111234 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.112237 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m14:52:25.115201 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.115201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:25.115201 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m14:52:25.116388 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:52:25.116388 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 14:52:25.078201 => 14:52:25.116388
[0m14:52:25.117834 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.127885 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.128895 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.129880 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m14:52:25.129880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:25.169847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.171351 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.171351 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m14:52:25.177365 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.199355 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.199355 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m14:52:25.200355 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:52:25.204391 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m14:52:25.214356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.214356 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m14:52:25.215357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.215357 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m14:52:25.215357 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.216357 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m14:52:25.217362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.218358 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 14:52:25.090238 => 14:52:25.217362
[0m14:52:25.218358 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m14:52:25.219357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753307C130>]}
[0m14:52:25.219357 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m14:52:25.220358 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m14:52:25.220358 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.221356 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m14:52:25.222356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m14:52:25.222356 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:52:25.222356 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.255356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.321096 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.326092 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.326092 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m14:52:25.327096 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m14:52:25.327096 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m14:52:25.329062 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 14:52:25.317059 => 14:52:25.328094
[0m14:52:25.329062 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.331060 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.331060 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m14:52:25.331060 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m14:52:25.333598 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.333598 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.333598 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m14:52:25.334594 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m14:52:25.334594 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m14:52:25.334594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.336561 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.336561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.337558 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 14:52:25.102201 => 14:52:25.337558
[0m14:52:25.339561 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 14:52:25.117834 => 14:52:25.338561
[0m14:52:25.339561 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m14:52:25.339561 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m14:52:25.340559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f9ca7-a8d2-40d7-8a1b-42878ba2de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753301FE50>]}
[0m14:52:25.340559 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m14:52:25.342039 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m14:52:25.342039 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m14:52:25.342900 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m14:52:25.342900 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m14:52:25.344238 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.344238 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.344238 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m14:52:25.345281 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m14:52:25.345281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m14:52:25.346281 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m14:52:25.346281 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.347282 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.350283 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.354281 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.355278 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 14:52:25.347282 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 14:52:25.350283 => 14:52:25.355278
[0m14:52:25.356245 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.356245 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.358249 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.359249 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.360249 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.361355 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.361355 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m14:52:25.361355 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m14:52:25.362400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:25.362400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:25.386938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.386938 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m14:52:25.387938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.388938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.389938 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 14:52:25.329062 => 14:52:25.389938
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m14:52:25.390938 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m14:52:25.391938 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m14:52:25.391938 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m14:52:25.392979 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.392979 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m14:52:25.393987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m14:52:25.393987 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.397973 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.398974 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 14:52:25.394973 => 14:52:25.398974
[0m14:52:25.399941 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.400940 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.401939 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m14:52:25.403227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:25.419271 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.420273 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m14:52:25.420273 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m14:52:25.421271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.422272 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 14:52:25.357250 => 14:52:25.422272
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m14:52:25.423272 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m14:52:25.424270 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m14:52:25.425234 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m14:52:25.491827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.491827 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m14:52:25.491827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.493827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.494826 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 14:52:25.399941 => 14:52:25.494826
[0m14:52:25.494826 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m14:52:25.495827 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m14:52:25.496826 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m14:52:25.496826 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m14:52:25.497825 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m14:52:25.497825 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m14:52:25.498828 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m14:52:25.549823 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.550822 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m14:52:25.550822 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:25.551823 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:52:25.552823 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 14:52:25.358249 => 14:52:25.552823
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m14:52:25.553823 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m14:52:25.554822 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.21s]
[0m14:52:25.554822 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m14:52:25.555823 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m14:52:25.556915 [info ] [Thread-1 (]: 9 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m14:52:25.556915 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m14:52:25.557893 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.557893 [info ] [Thread-3 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m14:52:25.558861 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m14:52:25.558861 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.558861 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.559865 [info ] [Thread-1 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m14:52:25.559865 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m14:52:25.560861 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m14:52:25.560861 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m14:52:25.561859 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m14:52:25.561859 [info ] [Thread-3 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m14:52:25.562863 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m14:52:25.563864 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.563864 [debug] [MainThread]: On master: BEGIN
[0m14:52:25.563864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:25.622412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.623412 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:25.623412 [debug] [MainThread]: On master: COMMIT
[0m14:52:25.624412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:25.624412 [debug] [MainThread]: On master: Close
[0m14:52:25.625412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m14:52:25.625412 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m14:52:25.626413 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m14:52:25.626413 [info ] [MainThread]: 
[0m14:52:25.627412 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:52:25.628413 [debug] [MainThread]: Command end result
[0m14:52:25.634489 [info ] [MainThread]: 
[0m14:52:25.635489 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:52:25.635489 [info ] [MainThread]: 
[0m14:52:25.635489 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m14:52:25.636489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.636489 [info ] [MainThread]: 
[0m14:52:25.637488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m14:52:25.637488 [info ] [MainThread]: 
[0m14:52:25.637488 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m14:52:25.638488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:52:25.638488 [info ] [MainThread]: 
[0m14:52:25.638488 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m14:52:25.639488 [info ] [MainThread]: 
[0m14:52:25.639488 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m14:52:25.640491 [debug] [MainThread]: Command `dbt build` failed at 14:52:25.640491 after 1.24 seconds
[0m14:52:25.640491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752F867220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753302F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027532EE4370>]}
[0m14:52:25.641489 [debug] [MainThread]: Flushing usage events
[0m15:05:12.345559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC1B2B90>]}


============================== 15:05:12.347051 | beb80a8b-4487-4867-a7e0-bf551d511955 ==============================
[0m15:05:12.347051 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:05:12.347051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:12.456333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F4EC2E00>]}
[0m15:05:12.519283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>]}
[0m15:05:12.519283 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:05:12.519283 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:12.604954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:12.608952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC6280D0>]}
[0m15:05:12.613571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC534B50>]}
[0m15:05:12.613571 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:05:12.613571 [info ] [MainThread]: 
[0m15:05:12.613571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:12.613571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:05:12.613571 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:05:12.613571 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:05:12.613571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:12.959520 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:05:12.959520 [debug] [ThreadPool]: On list_dbt: Close
[0m15:05:12.959520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:05:12.975142 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:12.975142 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:05:12.975142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:05:13.069667 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:05:13.069667 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:05:13.085332 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.085332 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.085332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:13.179562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:13.179562 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:13.179562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5DF850>]}
[0m15:05:13.179562 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:13.179562 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.179562 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.195192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.195192 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.195192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.195192 [debug] [MainThread]: On master: Close
[0m15:05:13.195192 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:05:13.195192 [info ] [MainThread]: 
[0m15:05:13.195192 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:05:13.195192 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:05:13.195192 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.195192 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:05:13.195192 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:05:13.195192 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [RUN]
[0m15:05:13.202565 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:05:13.203552 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:05:13.204358 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247'
[0m15:05:13.204358 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:05:13.204945 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:05:13.205488 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.205488 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.205488 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:05:13.205488 => 15:05:13.205488
[0m15:05:13.214468 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.214468 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:05:13.214468 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:05:13.229243 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (compile): 15:05:13.205488 => 15:05:13.229243
[0m15:05:13.229243 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.241002 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.241002 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.241002 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:05:13.241002 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:05:13.253563 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.253563 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:13.254609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:13.255344 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.255344 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: BEGIN
[0m15:05:13.255344 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:13.304252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.304252 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.304252 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:05:13.307253 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.323367 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:05:13.323367 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:05:13.323367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:05:13.339033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:05:13.339033 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.339033 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:05:13.339033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.339033 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:05:13.214468 => 15:05:13.339033
[0m15:05:13.339033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:05:13.339033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC7100D0>]}
[0m15:05:13.339033 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:05:13.339033 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:05:13.339033 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.354661 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:05:13.339033 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:05:13.389962 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.449962 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.450958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:05:13.450958 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"
[0m15:05:13.451975 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:05:13.451975 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.452924 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors'
)



      
    ) dbt_internal_test
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:05:13.452924 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.454923 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.454923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:05:13.454923 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:05:13.454923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.454923 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.454923 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:05:13.229243 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247 (execute): 15:05:13.241002 => 15:05:13.454923
[0m15:05:13.454923 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:05:13.454923 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: ROLLBACK
[0m15:05:13.454923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beb80a8b-4487-4867-a7e0-bf551d511955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC5348B0>]}
[0m15:05:13.470617 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247: Close
[0m15:05:13.454923 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.25s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:05:13.470617 [error] [Thread-3 (]: 3 of 13 FAIL 1 source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors  [[31mFAIL 1[0m in 0.27s]
[0m15:05:13.470617 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247
[0m15:05:13.470617 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:05:13.470617 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:05:13.470617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:05:13.470617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors.23608d4247, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:05:13.470617 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.470617 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.470617 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.470617 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:05:13.470617 => 15:05:13.470617
[0m15:05:13.470617 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.470617 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.486256 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.487873 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.487873 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:05:13.487873 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:05:13.487873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:13.487873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.514769 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:05:13.514769 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.514769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:05:13.454923 => 15:05:13.520290
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:05:13.521194 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m15:05:13.521194 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:05:13.521194 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:05:13.521194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:05:13.521194 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:05:13.521194 => 15:05:13.521194
[0m15:05:13.521194 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.521194 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.521194 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:05:13.533648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.575078 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.575078 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:05:13.486256 => 15:05:13.575078
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:05:13.575078 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:05:13.575078 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.10s]
[0m15:05:13.587031 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:05:13.588038 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:05:13.588038 [info ] [Thread-3 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:05:13.589036 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.614868 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:05:13.614868 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:05:13.614868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.628065 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:05:13.521194 => 15:05:13.627025
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:05:13.628202 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:05:13.628202 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.11s]
[0m15:05:13.628202 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:05:13.654607 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:05:13.654607 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:05:13.470617 => 15:05:13.654607
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:05:13.654607 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:05:13.654607 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.18s]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [info ] [Thread-3 (]: 9 of 13 SKIP relation public.stg_web__transactions ............................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [info ] [Thread-2 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:05:13.654607 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:05:13.654607 [info ] [Thread-1 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:05:13.654607 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:05:13.654607 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:05:13.654607 [info ] [Thread-2 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:05:13.666999 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:05:13.668478 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.668478 [debug] [MainThread]: On master: BEGIN
[0m15:05:13.668478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:13.738351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:13.738351 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:13.739349 [debug] [MainThread]: On master: COMMIT
[0m15:05:13.739349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:13.740348 [debug] [MainThread]: On master: Close
[0m15:05:13.740348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:05:13.741344 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:05:13.742352 [debug] [MainThread]: Connection 'test.customer360.source_unique_salesforce_contacts_id.01cadaaf43' was properly closed.
[0m15:05:13.742352 [info ] [MainThread]: 
[0m15:05:13.742352 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m15:05:13.744352 [debug] [MainThread]: Command end result
[0m15:05:13.748314 [info ] [MainThread]: 
[0m15:05:13.748314 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:13.750809 [info ] [MainThread]: 
[0m15:05:13.750809 [error] [MainThread]: [31mFailure in test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors (models\staging\web\_web__sources.yml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\web\_web__sources.yml\source_accepted_values_web_tra_137951f36ffb2bd59ccf7733305e6fbd.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:05:13.751793 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:05:13.751793 [info ] [MainThread]: 
[0m15:05:13.751793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=6 TOTAL=13
[0m15:05:13.751793 [debug] [MainThread]: Command `dbt build` failed at 15:05:13.751793 after 1.46 seconds
[0m15:05:13.751793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291F8EB7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3F8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291FC3ACFD0>]}
[0m15:05:13.751793 [debug] [MainThread]: Flushing usage events
[0m15:08:11.365873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF302B30>]}


============================== 15:08:11.368871 | 54b902e5-2b69-44fd-b815-34c8b9264ae1 ==============================
[0m15:08:11.368871 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:08:11.368871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:11.485997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F8022E00>]}
[0m15:08:11.541504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF54A440>]}
[0m15:08:11.542504 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:08:11.551504 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:08:11.624371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:11.625625 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__sources.yml
[0m15:08:11.862219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB563E0>]}
[0m15:08:11.870261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB10B80>]}
[0m15:08:11.871251 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:08:11.872261 [info ] [MainThread]: 
[0m15:08:11.873252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:11.874254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:08:11.875470 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:08:11.875470 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:08:11.875470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:11.943675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:08:11.945677 [debug] [ThreadPool]: On list_dbt: Close
[0m15:08:11.946675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:08:11.950639 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:11.950639 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:08:11.951639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:12.015577 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.016613 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:08:12.016613 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:08:12.018615 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:08:12.019614 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:08:12.020617 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:08:12.023578 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.024577 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.024577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:12.103158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.103158 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.103158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:12.106157 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:12.107157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB11120>]}
[0m15:08:12.107157 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:12.108157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.108157 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.109157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.109157 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.109157 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.110187 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.110187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.110187 [debug] [MainThread]: On master: Close
[0m15:08:12.111157 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:08:12.112176 [info ] [MainThread]: 
[0m15:08:12.113181 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:08:12.114180 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:08:12.114180 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.115181 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:08:12.115181 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:08:12.116185 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:08:12.116185 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:08:12.117183 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:08:12.118181 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:08:12.118181 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:08:12.118181 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:08:12.119182 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.119182 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.119182 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:08:12.119182 => 15:08:12.119182
[0m15:08:12.125180 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.125180 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:08:12.126213 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:08:12.136397 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:08:12.120181 => 15:08:12.136397
[0m15:08:12.147396 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.148397 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.151396 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.151396 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:08:12.160478 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.161479 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:08:12.161479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:12.162478 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.163472 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:08:12.163472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.201758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:08:12.201758 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.239089 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.239089 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:08:12.240089 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:08:12.244089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:08:12.244089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.245089 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.254090 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.254090 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:08:12.255092 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:08:12.255092 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:08:12.257132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.257132 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:08:12.126213 => 15:08:12.257132
[0m15:08:12.258137 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:08:12.258137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFBF2110>]}
[0m15:08:12.259091 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m15:08:12.260128 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:08:12.260128 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.260128 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:08:12.261092 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:08:12.296092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.311601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:08:12.343602 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:08:12.357633 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.357633 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.358636 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:08:12.358636 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:08:12.363635 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.364642 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:08:12.358636 => 15:08:12.364642
[0m15:08:12.365640 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.366636 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.367635 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:08:12.367635 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.368962 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:08:12.368962 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:08:12.370451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.370451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.371457 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:08:12.371457 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:08:12.372834 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.372834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.373840 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:08:12.138396 => 15:08:12.373840
[0m15:08:12.374840 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:08:12.151396 => 15:08:12.374840
[0m15:08:12.375842 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:08:12.375842 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:08:12.376841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FF6857E0>]}
[0m15:08:12.376841 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:08:12.377842 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m15:08:12.378348 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m15:08:12.379391 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:08:12.380356 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:08:12.380894 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.380894 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.381994 [info ] [Thread-2 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:08:12.381994 [info ] [Thread-3 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:08:12.382782 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.383652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:08:12.386159 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.387159 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.390249 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.391626 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:08:12.383652 => 15:08:12.391626
[0m15:08:12.391626 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.391626 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:08:12.387159 => 15:08:12.391626
[0m15:08:12.395163 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.395163 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.396161 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.397701 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.397701 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:08:12.398709 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.398709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:12.398709 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:08:12.399706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.419738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.420743 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:08:12.420743 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.421709 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.422724 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:08:12.365640 => 15:08:12.422724
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:08:12.423731 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:08:12.424730 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.11s]
[0m15:08:12.424730 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:08:12.425764 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.425764 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:08:12.426770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:08:12.426770 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:08:12.427765 => 15:08:12.428943
[0m15:08:12.428943 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.428943 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.428943 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:08:12.428943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:08:12.450221 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.450221 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:08:12.393120 => 15:08:12.450221
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:08:12.450221 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:08:12.461687 [info ] [Thread-2 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m15:08:12.462801 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.476617 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:08:12.476617 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.476617 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.488278 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:08:12.396161 => 15:08:12.476617
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:08:12.488278 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:08:12.489320 [error] [Thread-3 (]: 6 of 13 FAIL 1 source_unique_salesforce_contacts_id ............................ [[31mFAIL 1[0m in 0.11s]
[0m15:08:12.490319 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:08:12.491430 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:08:12.491430 [info ] [Thread-2 (]: 8 of 13 SKIP relation public.stg_sf__contacts .................................. [[33mSKIP[0m]
[0m15:08:12.492474 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:08:12.524026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.525014 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:08:12.525014 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:08:12.526010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:08:12.528010 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:08:12.428943 => 15:08:12.527010
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:08:12.528010 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:08:12.529010 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:08:12.530011 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:08:12.530011 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:08:12.531013 [info ] [Thread-3 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:08:12.532014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:08:12.532014 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:08:12.534012 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:08:12.535012 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:08:12.532014 => 15:08:12.535012
[0m15:08:12.535012 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:08:12.556015 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:08:12.557014 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.558015 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:08:12.558015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:12.619534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.620531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.620531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:08:12.622531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:08:12.622531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.622531 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.638188 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:08:12.638188 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.679037 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:08:12.682035 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:08:12.682035 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:08:12.683038 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:08:12.684073 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:08:12.536013 => 15:08:12.684073
[0m15:08:12.684073 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:08:12.685043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b902e5-2b69-44fd-b815-34c8b9264ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD08B50>]}
[0m15:08:12.685043 [info ] [Thread-3 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.15s]
[0m15:08:12.686098 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:08:12.687082 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.687082 [info ] [Thread-1 (]: 10 of 13 SKIP relation public.contacts_joined_with_transactions ................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:08:12.688255 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [info ] [Thread-3 (]: 11 of 13 SKIP test not_null_contacts_joined_with_transactions_id ............... [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:08:12.688255 [info ] [Thread-2 (]: 12 of 13 SKIP test unique_contacts_joined_with_transactions_id ................. [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:08:12.688255 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:08:12.688255 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:08:12.688255 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:08:12.693015 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.693015 [debug] [MainThread]: On master: BEGIN
[0m15:08:12.694409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:12.869924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:12.869924 [debug] [MainThread]: On master: COMMIT
[0m15:08:12.869924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:12.869924 [debug] [MainThread]: On master: Close
[0m15:08:12.869924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_unique_web_transactions_id.ba28079761' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'test.customer360.source_not_null_web_transactions_id.88a47bf7e5' was properly closed.
[0m15:08:12.869924 [debug] [MainThread]: Connection 'model.customer360.stg_web__transactions' was properly closed.
[0m15:08:12.869924 [info ] [MainThread]: 
[0m15:08:12.869924 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m15:08:12.869924 [debug] [MainThread]: Command end result
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.886575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:12.886575 [info ] [MainThread]: 
[0m15:08:12.891511 [error] [MainThread]: [31mFailure in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:08:12.891511 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:08:12.892581 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:08:12.893264 [info ] [MainThread]: 
[0m15:08:12.893264 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=5 TOTAL=13
[0m15:08:12.895546 [debug] [MainThread]: Command `dbt build` failed at 15:08:12.894731 after 1.57 seconds
[0m15:08:12.895546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FC004580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD23640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFD22560>]}
[0m15:08:12.895546 [debug] [MainThread]: Flushing usage events
[0m15:10:41.613814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B5D2B00>]}


============================== 15:10:41.615800 | 2d75deeb-6ca3-4d86-9c99-d4931798420a ==============================
[0m15:10:41.615800 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:41.616800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:41.734048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B2E00>]}
[0m15:10:41.789052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d75deeb-6ca3-4d86-9c99-d4931798420a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3842B0A90>]}
[0m15:10:41.790052 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:41.799052 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:41.872555 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading customer360: staging\salesforce\_sf__sources.yaml - Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |           - name: id
    13 |             tests:
    14 |               - unique
    15 |                   config:
    16 |                     severity: error
    17 |                     error_if: ">5"
    18 |                     wan_if: ">0"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 15, column 25
[0m15:10:41.875523 [debug] [MainThread]: Command `dbt build` failed at 15:10:41.875523 after 0.32 seconds
[0m15:10:41.875523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3882D4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B955900>]}
[0m15:10:41.876524 [debug] [MainThread]: Flushing usage events
[0m15:10:57.883356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC702B30>]}


============================== 15:10:57.886396 | 46a2d78d-ca8a-4129-8441-48188a34100b ==============================
[0m15:10:57.886396 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:10:57.887396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:58.004875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A5382E00>]}
[0m15:10:58.061391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC94A440>]}
[0m15:10:58.062391 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:10:58.068548 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:10:58.144533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:58.145541 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\_sf__sources.yaml
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACF480D0>]}
[0m15:10:58.369115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACA84A60>]}
[0m15:10:58.369115 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:10:58.369115 [info ] [MainThread]: 
[0m15:10:58.384902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:58.385935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:10:58.391939 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:10:58.392931 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:10:58.392931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.450320 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:10:58.451320 [debug] [ThreadPool]: On list_dbt: Close
[0m15:10:58.453320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:10:58.456895 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.456895 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:10:58.457893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:58.656881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.657881 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:10:58.657881 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:58.659881 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m15:10:58.660881 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:10:58.661881 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:10:58.664881 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.665881 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.665881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:58.731882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.731882 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.732882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:58.734880 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:58.735880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2E9E0>]}
[0m15:10:58.736880 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:58.736880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.736880 [debug] [MainThread]: On master: BEGIN
[0m15:10:58.737880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.737880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:58.738880 [debug] [MainThread]: On master: COMMIT
[0m15:10:58.738880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.739883 [debug] [MainThread]: On master: Close
[0m15:10:58.739883 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:10:58.739883 [info ] [MainThread]: 
[0m15:10:58.742260 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:10:58.743254 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:10:58.743254 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.744253 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:10:58.744253 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:10:58.745252 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:10:58.744253 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:10:58.746251 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:10:58.746251 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:10:58.747251 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:10:58.747251 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:10:58.748251 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.748251 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.749252 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:10:58.748251 => 15:10:58.748251
[0m15:10:58.749252 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:10:58.761762 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.761762 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:10:58.781761 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.783762 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:10:58.749252 => 15:10:58.783762
[0m15:10:58.783762 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:10:58.786761 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.786761 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.787761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:58.787761 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:10:58.797761 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.797761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:58.798762 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.798762 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:10:58.799763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:10:58.847071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.848165 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.848165 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:10:58.854104 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:58.876522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.876522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:10:58.877523 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:10:58.881523 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.890522 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:10:58.890522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:10:58.892522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:58.892522 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:10:58.761762 => 15:10:58.892522
[0m15:10:58.893522 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:10:58.893522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACB2EA10>]}
[0m15:10:58.894521 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:10:58.895522 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:10:58.895522 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.896521 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:10:58.896521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:10:58.897522 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.901523 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.902522 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:10:58.897522 => 15:10:58.902522
[0m15:10:58.902522 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.904523 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.905525 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:10:58.905525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.912521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.912521 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:10:58.913521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:10:58.914521 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.915521 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:10:58.787761 => 15:10:58.915521
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:10:58.916521 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:10:58.917521 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.17s]
[0m15:10:58.918523 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:10:58.918523 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.918523 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:10:58.919522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:10:58.919522 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.923521 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.923521 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:10:58.920522 => 15:10:58.923521
[0m15:10:58.924678 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:58.924678 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:58.924678 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:10:58.924678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:10:58.954393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:58.954393 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:10:58.902522 => 15:10:58.954393
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:10:58.954393 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:10:58.954393 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.06s]
[0m15:10:58.961540 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:10:58.961540 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.962572 [info ] [Thread-1 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:10:58.963226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:10:58.963226 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:10:58.963226 => 15:10:58.963226
[0m15:10:58.963226 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:58.963226 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:58.963226 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:10:58.963226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:58.975923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:58.975923 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:58.976885 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:10:58.981883 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:10:59.028189 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.059806 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:10:59.118039 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.119039 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:10:59.119039 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.120040 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:10:59.120040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.122041 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.123041 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:10:58.963226 => 15:10:59.123041
[0m15:10:59.124041 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:10:59.124041 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:10:59.125040 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:10:59.125040 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:10:59.126446 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.125040 [warn ] [Thread-1 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.16s]
[0m15:10:59.127453 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:10:59.127453 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:10:59.128451 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:10:59.128451 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.129451 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:10:59.129451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:10:59.130490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.130490 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.131485 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:10:58.924678 => 15:10:59.131485
[0m15:10:59.132491 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:10:58.781761 => 15:10:59.132491
[0m15:10:59.135487 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.135487 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:10:59.135487 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:10:59.136486 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:10:59.132491 => 15:10:59.136486
[0m15:10:59.136486 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:10:59.137483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD1229E0>]}
[0m15:10:59.137483 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.138491 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.22s]
[0m15:10:59.138491 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.39s]
[0m15:10:59.140531 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.141533 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:10:59.141533 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:10:59.141533 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:10:59.142529 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.142529 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:10:59.143532 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:10:59.143532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:10:59.144533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.144533 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:10:59.146533 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:10:59.147531 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:10:59.145533 => 15:10:59.147531
[0m15:10:59.147531 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:10:59.168372 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:10:59.169372 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.170384 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:10:59.170384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.189386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.189386 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:10:59.139533 => 15:10:59.189386
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:10:59.189386 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:10:59.201625 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m15:10:59.201625 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:10:59.202662 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:10:59.203671 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:10:59.203671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now model.customer360.stg_web__transactions)
[0m15:10:59.204676 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:10:59.207632 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:10:59.207632 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:10:59.204676 => 15:10:59.207632
[0m15:10:59.208671 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:10:59.211664 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.212664 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:10:59.212664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.233631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.234630 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.234630 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.241799 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:10:59.245799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:10:59.246799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.250799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.250799 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.251799 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:10:59.251799 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.256311 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:10:59.259310 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:10:59.259310 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:10:59.260310 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.261311 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:10:59.147531 => 15:10:59.261311
[0m15:10:59.261311 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:10:59.262310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACCDEC20>]}
[0m15:10:59.262310 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m15:10:59.263311 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:10:59.385228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.385228 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.386261 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:10:59.393264 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:10:59.395262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.396263 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:10:59.396263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.398259 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:10:59.399262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.402262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.403262 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.403262 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:10:59.404262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.405266 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:10:59.406260 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:10:59.406260 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:10:59.408263 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:10:59.409266 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:10:59.208671 => 15:10:59.409266
[0m15:10:59.409266 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:10:59.410261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC9021D0>]}
[0m15:10:59.410261 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.21s]
[0m15:10:59.411261 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:10:59.412232 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.413230 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:10:59.413230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:10:59.414229 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:10:59.416229 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.417229 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:10:59.414229 => 15:10:59.416229
[0m15:10:59.417229 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:10:59.430233 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.431233 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:10:59.432232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:59.525334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.526334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.526334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:10:59.528334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:10:59.530333 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.530333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:10:59.531334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:59.532334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.532334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.533333 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:10:59.533333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.535334 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:10:59.537335 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:10:59.538334 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:10:59.538334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:10:59.539334 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:10:59.417229 => 15:10:59.539334
[0m15:10:59.540338 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:10:59.540338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a2d78d-ca8a-4129-8441-48188a34100b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AD122230>]}
[0m15:10:59.541338 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:59.541338 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:10:59.542338 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.543338 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.543338 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:10:59.543338 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:10:59.544338 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.545338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:10:59.548338 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.548338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.551338 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.552342 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:10:59.545338 => 15:10:59.552342
[0m15:10:59.552342 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.553340 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:10:59.549338 => 15:10:59.552342
[0m15:10:59.554850 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.555855 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.556855 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.557855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.557855 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.558855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:10:59.558855 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:10:59.559855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:59.559855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:59.609855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.609855 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:10:59.610855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:10:59.611855 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.612855 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:10:59.553340 => 15:10:59.612855
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:10:59.613855 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:10:59.614856 [error] [Thread-2 (]: 11 of 13 FAIL 1 not_null_contacts_joined_with_transactions_id .................. [[31mFAIL 1[0m in 0.07s]
[0m15:10:59.615857 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:10:59.646858 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.647861 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:10:59.647861 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:10:59.649859 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:10:59.650858 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:10:59.555855 => 15:10:59.650858
[0m15:10:59.650858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:10:59.651858 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:10:59.651858 [error] [Thread-3 (]: 12 of 13 FAIL 9 unique_contacts_joined_with_transactions_id .................... [[31mFAIL 9[0m in 0.11s]
[0m15:10:59.652891 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:10:59.652891 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:10:59.654431 [info ] [Thread-1 (]: 13 of 13 SKIP relation public.customers ........................................ [[33mSKIP[0m]
[0m15:10:59.654431 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:10:59.655467 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.656483 [debug] [MainThread]: On master: BEGIN
[0m15:10:59.656483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:59.709166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:59.709166 [debug] [MainThread]: On master: COMMIT
[0m15:10:59.709166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:59.709166 [debug] [MainThread]: On master: Close
[0m15:10:59.709166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:10:59.709166 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:10:59.709166 [info ] [MainThread]: 
[0m15:10:59.721608 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m15:10:59.723654 [debug] [MainThread]: Command end result
[0m15:10:59.730656 [info ] [MainThread]: 
[0m15:10:59.731651 [info ] [MainThread]: [31mCompleted with 2 errors and 1 warning:[0m
[0m15:10:59.731651 [info ] [MainThread]: 
[0m15:10:59.732649 [error] [MainThread]: [31mFailure in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.732649 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:10:59.733653 [info ] [MainThread]: 
[0m15:10:59.733653 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:10:59.734653 [info ] [MainThread]: 
[0m15:10:59.734653 [error] [MainThread]: [31mFailure in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:10:59.735649 [error] [MainThread]:   Got 9 results, configured to fail if != 0
[0m15:10:59.735649 [info ] [MainThread]: 
[0m15:10:59.736655 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:10:59.736655 [info ] [MainThread]: 
[0m15:10:59.736655 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:10:59.737649 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:10:59.737649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:10:59.738649 [info ] [MainThread]: 
[0m15:10:59.738649 [info ] [MainThread]: Done. PASS=9 WARN=1 ERROR=2 SKIP=1 TOTAL=13
[0m15:10:59.740657 [debug] [MainThread]: Command `dbt build` failed at 15:10:59.739691 after 1.91 seconds
[0m15:10:59.740657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9404580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC902050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC901FC0>]}
[0m15:10:59.740657 [debug] [MainThread]: Flushing usage events
[0m15:14:58.020660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC762B60>]}


============================== 15:14:58.023660 | bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d ==============================
[0m15:14:58.023660 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:14:58.024660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:14:58.142954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5402E00>]}
[0m15:14:58.194143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC9ABBB0>]}
[0m15:14:58.194143 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:14:58.194143 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:58.283749 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m15:14:58.458762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCEB6920>]}
[0m15:14:58.459867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCAE4B20>]}
[0m15:14:58.459867 [info ] [MainThread]: Found 2 seeds, 4 models, 7 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:14:58.459867 [info ] [MainThread]: 
[0m15:14:58.459867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:58.459867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:14:58.476102 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:14:58.477133 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:14:58.477133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.556767 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:14:58.557766 [debug] [ThreadPool]: On list_dbt: Close
[0m15:14:58.558767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:14:58.562766 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.563767 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:14:58.563767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:58.636275 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.636275 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:14:58.636275 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:58.639275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:14:58.640275 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:14:58.644278 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.644278 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.645276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:58.729756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.729756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.730758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:58.733756 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:14:58.734756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCB8F850>]}
[0m15:14:58.734756 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:58.735756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.735756 [debug] [MainThread]: On master: BEGIN
[0m15:14:58.735756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.736756 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:58.736756 [debug] [MainThread]: On master: COMMIT
[0m15:14:58.737756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.737756 [debug] [MainThread]: On master: Close
[0m15:14:58.738757 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:14:58.738757 [info ] [MainThread]: 
[0m15:14:58.740757 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:14:58.740757 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:14:58.741757 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.741757 [info ] [Thread-1 (]: 1 of 13 START seed file public.contacts ........................................ [RUN]
[0m15:14:58.742756 [info ] [Thread-2 (]: 2 of 13 START seed file public.transactions .................................... [RUN]
[0m15:14:58.743757 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:14:58.742756 [info ] [Thread-3 (]: 3 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:14:58.743757 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:14:58.744757 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:14:58.744757 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:14:58.745756 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:14:58.745756 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.745756 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.746757 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:14:58.745756 => 15:14:58.745756
[0m15:14:58.746757 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:14:58.758756 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.758756 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:14:58.777758 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.779761 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:14:58.746757 => 15:14:58.779761
[0m15:14:58.780760 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:14:58.783760 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.783760 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:58.784760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:58.784760 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:14:58.794262 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.795265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:14:58.796267 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.796267 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:14:58.796267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:58.857266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.858267 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.858267 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:14:58.864265 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.887269 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.887269 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.888268 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:14:58.888268 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.889268 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:14:58.889268 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:14:58.893268 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:14:58.901774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.901774 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:14:58.902774 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:14:58.928774 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:14:58.976774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:14:58.998406 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:14:58.758756 => 15:14:58.998406
[0m15:14:58.998406 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:14:58.998406 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:14:58.998406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF17820>]}
[0m15:14:58.998406 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:14:58.998406 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.26s]
[0m15:14:58.998406 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:14:58.998406 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:14:58.998406 [info ] [Thread-1 (]: 4 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:14:58.998406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:14:58.998406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:14:58.998406 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.014032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.014032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.016845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:14:58.784760 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:14:58.778757 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:14:59.017630 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:14:58.998406 => 15:14:59.017630
[0m15:14:59.017630 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:14:59.017630 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.017630 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:14:59.017630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBCF31930>]}
[0m15:14:59.017630 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [info ] [Thread-3 (]: 3 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:14:59.017630 [info ] [Thread-2 (]: 2 of 13 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:14:59.017630 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:14:59.017630 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.017630 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:14:59.017630 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.017630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:14:59.017630 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.017630 [info ] [Thread-3 (]: 5 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:14:59.017630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.017630 [info ] [Thread-2 (]: 6 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:14:59.030174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:14:59.031180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:14:59.031539 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.031539 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.031539 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.031539 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:14:59.031539 => 15:14:59.031539
[0m15:14:59.031539 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.043480 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.044916 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.044916 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.044916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.044916 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:14:59.044916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.077266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.077266 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:14:59.017630 => 15:14:59.077266
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:14:59.077266 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:14:59.083459 [info ] [Thread-1 (]: 4 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m15:14:59.084464 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:14:59.084464 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.084464 [info ] [Thread-1 (]: 7 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:14:59.085464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:14:59.085464 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.089464 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.089464 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:14:59.086463 => 15:14:59.089464
[0m15:14:59.090464 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.092464 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.092464 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.093464 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:14:59.093464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.111972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.111972 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:14:59.111972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.112972 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.114972 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:14:59.031539 => 15:14:59.113972
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:14:59.114972 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:14:59.115972 [info ] [Thread-3 (]: 5 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.10s]
[0m15:14:59.116973 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:14:59.143972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.143972 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:14:59.144972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.145972 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.146972 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:14:59.043480 => 15:14:59.146972
[0m15:14:59.146972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:14:59.147972 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:14:59.148974 [warn ] [Thread-2 (]: 6 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.12s]
[0m15:14:59.148974 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:14:59.149973 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:14:59.149973 [info ] [Thread-3 (]: 8 of 13 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:14:59.150973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:14:59.151973 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:14:59.153972 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:14:59.154972 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:14:59.151973 => 15:14:59.153972
[0m15:14:59.154972 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:14:59.175972 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:14:59.176972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.176972 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.177972 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:14:59.177972 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:14:59.178972 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.178972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.179975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.180978 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:14:59.090464 => 15:14:59.180978
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:14:59.181975 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:14:59.182975 [info ] [Thread-1 (]: 7 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m15:14:59.183976 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:14:59.183976 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:14:59.184976 [info ] [Thread-2 (]: 9 of 13 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:14:59.184976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:14:59.185976 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:14:59.187975 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:14:59.188976 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:14:59.185976 => 15:14:59.188976
[0m15:14:59.188976 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:14:59.192975 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:14:59.192975 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.194478 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:14:59.194478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.228482 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.229482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.229482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.236482 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.240482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.241482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:14:59.241482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.244484 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.244484 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:14:59.245482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.250482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.250482 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.251482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:14:59.251482 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.255481 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:14:59.258481 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:14:59.259482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:14:59.261483 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.262482 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:14:59.154972 => 15:14:59.261483
[0m15:14:59.262482 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:14:59.263482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076320>]}
[0m15:14:59.263482 [info ] [Thread-3 (]: 8 of 13 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m15:14:59.264483 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:14:59.266482 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.266482 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.267483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:14:59.274482 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.0 seconds
[0m15:14:59.276481 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.276481 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:14:59.277481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.279483 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.279483 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:14:59.280487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.281487 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.282486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.282486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:14:59.283486 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.285486 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:14:59.285486 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:14:59.286486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:14:59.287487 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.288486 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:14:59.189976 => 15:14:59.288486
[0m15:14:59.289486 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:14:59.289486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD076A10>]}
[0m15:14:59.290486 [info ] [Thread-2 (]: 9 of 13 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 102[0m in 0.10s]
[0m15:14:59.290486 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:14:59.291488 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.292487 [info ] [Thread-1 (]: 10 of 13 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:14:59.292487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.contacts_joined_with_transactions)
[0m15:14:59.293486 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:14:59.296558 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.296558 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:14:59.293486 => 15:14:59.296558
[0m15:14:59.297559 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:14:59.307676 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.307676 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.310179 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:14:59.310179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.410550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.411552 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.411552 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:14:59.413550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:14:59.415549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.416550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:14:59.417550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.418550 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.418550 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:14:59.419550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.421550 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:14:59.423549 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:14:59.423549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:14:59.424550 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:14:59.425549 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:14:59.297559 => 15:14:59.425549
[0m15:14:59.425549 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:14:59.426550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD07AE90>]}
[0m15:14:59.426550 [info ] [Thread-1 (]: 10 of 13 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:59.427550 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:14:59.428550 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.428550 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.429550 [info ] [Thread-2 (]: 11 of 13 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:14:59.429550 [info ] [Thread-3 (]: 12 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:14:59.430550 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:14:59.431550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:14:59.431550 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.431550 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.435550 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.438550 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.439550 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:14:59.431550 => 15:14:59.438550
[0m15:14:59.439550 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:14:59.435550 => 15:14:59.439550
[0m15:14:59.439550 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.440550 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.441550 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.444550 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.444550 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.445550 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:14:59.445550 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.445550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:59.446551 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:14:59.446551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:14:59.504055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.504055 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:14:59.505055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:14:59.506055 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.507055 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:14:59.440550 => 15:14:59.507055
[0m15:14:59.507055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:14:59.508055 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:14:59.509056 [warn ] [Thread-2 (]: 11 of 13 WARN 1 not_null_contacts_joined_with_transactions_id .................. [[33mWARN 1[0m in 0.08s]
[0m15:14:59.509056 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:14:59.542054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.543055 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:14:59.543055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:14:59.545055 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:59.546055 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:14:59.442550 => 15:14:59.546055
[0m15:14:59.546055 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:14:59.547054 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:14:59.547054 [warn ] [Thread-3 (]: 12 of 13 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.12s]
[0m15:14:59.548055 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:14:59.549057 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:14:59.549057 [info ] [Thread-1 (]: 13 of 13 START sql table model public.customers ................................ [RUN]
[0m15:14:59.550055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:14:59.550055 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m15:14:59.599564 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:14:59.600565 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 15:14:59.551055 => 15:14:59.600565
[0m15:14:59.600565 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m15:14:59.603565 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.604565 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m15:14:59.604565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.698081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.698081 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.699083 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:14:59.707080 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:59.709080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.709080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:14:59.710080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:59.711080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.712080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.712080 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:14:59.713080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.715080 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:14:59.715080 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:14:59.716080 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:14:59.716080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:59.717080 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 15:14:59.601565 => 15:14:59.717080
[0m15:14:59.718080 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m15:14:59.718080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe3bcaa-3e8c-4d3d-b0f2-128ea2271f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD156AD0>]}
[0m15:14:59.719080 [info ] [Thread-1 (]: 13 of 13 OK created sql table model public.customers ........................... [[32mSELECT 11[0m in 0.17s]
[0m15:14:59.720081 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:14:59.721081 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.721081 [debug] [MainThread]: On master: BEGIN
[0m15:14:59.721081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:59.787084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:59.787084 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.787084 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:59.788083 [debug] [MainThread]: On master: COMMIT
[0m15:14:59.788083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:59.788083 [debug] [MainThread]: On master: Close
[0m15:14:59.789083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:14:59.789083 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:14:59.790083 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:14:59.791083 [info ] [MainThread]: 
[0m15:14:59.791083 [info ] [MainThread]: Finished running 2 seeds, 7 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m15:14:59.793083 [debug] [MainThread]: Command end result
[0m15:14:59.798588 [info ] [MainThread]: 
[0m15:14:59.798588 [info ] [MainThread]: [33mCompleted with 3 warnings:[0m
[0m15:14:59.799589 [info ] [MainThread]: 
[0m15:14:59.799589 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:14:59.800589 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:14:59.800589 [info ] [MainThread]: 
[0m15:14:59.800589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:14:59.801589 [info ] [MainThread]: 
[0m15:14:59.801589 [warn ] [MainThread]: [33mWarning in test not_null_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.801589 [warn ] [MainThread]: Got 1 result, configured to warn if >0
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.802589 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\not_null_contacts_joined_with_transactions_id.sql
[0m15:14:59.802589 [info ] [MainThread]: 
[0m15:14:59.803590 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:14:59.803590 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:14:59.804590 [info ] [MainThread]: 
[0m15:14:59.804590 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:14:59.805590 [info ] [MainThread]: 
[0m15:14:59.805590 [info ] [MainThread]: Done. PASS=10 WARN=3 ERROR=0 SKIP=0 TOTAL=13
[0m15:14:59.806589 [debug] [MainThread]: Command `dbt build` succeeded at 15:14:59.806589 after 1.84 seconds
[0m15:14:59.807590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9466AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC8A3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBD064610>]}
[0m15:14:59.807590 [debug] [MainThread]: Flushing usage events
[0m15:23:13.674580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3AB82B30>]}


============================== 15:23:13.676967 | a202ad70-273e-41a2-8106-2ac270eb246f ==============================
[0m15:23:13.676967 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:23:13.677935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:13.785735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E33942E00>]}
[0m15:23:13.851843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>]}
[0m15:23:13.851843 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:23:13.860843 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:23:13.935879 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\salesforce\_sf__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: added file: customer360://models\staging\web\_web__stg.yaml
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\stg_sf__contacts.sql
[0m15:23:13.936882 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m15:23:14.121897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B339660>]}
[0m15:23:14.129402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2B1600>]}
[0m15:23:14.130728 [info ] [MainThread]: Found 2 seeds, 10 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:23:14.131734 [info ] [MainThread]: 
[0m15:23:14.132733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:14.133733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:23:14.139733 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:23:14.139733 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:23:14.140733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.193986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:23:14.194986 [debug] [ThreadPool]: On list_dbt: Close
[0m15:23:14.195987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:23:14.200067 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.200067 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:23:14.201055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:14.277752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.277752 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:23:14.278752 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:23:14.280751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:23:14.281751 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:23:14.285750 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.285750 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.286753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:14.396798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.397798 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.397798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:14.401301 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:23:14.403304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F1C60>]}
[0m15:23:14.403304 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:14.403304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.404304 [debug] [MainThread]: On master: BEGIN
[0m15:23:14.404304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.405304 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:14.405304 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.406304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.406304 [debug] [MainThread]: On master: Close
[0m15:23:14.407304 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:23:14.407304 [info ] [MainThread]: 
[0m15:23:14.409304 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:23:14.410304 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:23:14.410304 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.410304 [info ] [Thread-1 (]: 1 of 16 START seed file public.contacts ........................................ [RUN]
[0m15:23:14.411304 [info ] [Thread-2 (]: 2 of 16 START seed file public.transactions .................................... [RUN]
[0m15:23:14.412355 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:23:14.411304 [info ] [Thread-3 (]: 3 of 16 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:23:14.413435 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:23:14.413435 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:23:14.414473 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:23:14.414473 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:23:14.415441 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:23:14.414473 => 15:23:14.414473
[0m15:23:14.415441 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.415441 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:23:14.415441 => 15:23:14.415441
[0m15:23:14.416440 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:23:14.426438 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.427441 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:23:14.437474 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.437474 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:23:14.437474 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:23:14.416440 => 15:23:14.437474
[0m15:23:14.437474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:14.450125 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.450125 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.450125 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:23:14.462624 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.462624 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:23:14.463667 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.463667 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:23:14.464382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:14.512974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.512974 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.513976 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:23:14.518973 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.540942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.541942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:23:14.542942 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:23:14.546941 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:23:14.555942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.555942 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:23:14.556942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.556942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:23:14.557942 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.557942 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:23:14.558942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.559941 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:23:14.427441 => 15:23:14.559941
[0m15:23:14.559941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:23:14.560942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AE9E0>]}
[0m15:23:14.560942 [info ] [Thread-1 (]: 1 of 16 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:23:14.561942 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:23:14.561942 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.562951 [info ] [Thread-1 (]: 4 of 16 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:23:14.562951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:23:14.563943 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.567942 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.568945 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:23:14.598947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.646459 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:23:14.646459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:23:14.661459 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:23:14.563943 => 15:23:14.661459
[0m15:23:14.664459 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.664459 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.665460 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:23:14.667460 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.668460 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:23:14.669460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.669460 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:23:14.670462 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:23:14.672464 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.672464 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:23:14.673462 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:23:14.674460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.674460 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.675460 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:23:14.437474 => 15:23:14.675460
[0m15:23:14.676459 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:23:14.450125 => 15:23:14.676459
[0m15:23:14.677459 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:23:14.677459 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:23:14.678461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B2F4310>]}
[0m15:23:14.678461 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:23:14.679460 [info ] [Thread-2 (]: 2 of 16 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:23:14.679460 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:23:14.679460 [info ] [Thread-3 (]: 3 of 16 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:23:14.680784 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.680784 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:23:14.681794 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.681794 [info ] [Thread-2 (]: 5 of 16 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:23:14.682792 [info ] [Thread-3 (]: 6 of 16 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:23:14.682792 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.683793 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:23:14.686801 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.687800 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.691800 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.692800 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:23:14.683793 => 15:23:14.691800
[0m15:23:14.692800 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.694819 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.694819 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:23:14.687800 => 15:23:14.694819
[0m15:23:14.695980 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.696989 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.697987 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.697987 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:23:14.697987 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.698989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.698989 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:23:14.699987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.725532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.726530 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:23:14.726530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.727529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.728530 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:23:14.665460 => 15:23:14.728530
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:23:14.729530 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:23:14.730530 [info ] [Thread-1 (]: 4 of 16 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m15:23:14.731530 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:23:14.731530 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.732532 [info ] [Thread-1 (]: 7 of 16 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:23:14.733534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:23:14.733534 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.736531 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.737532 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:23:14.733534 => 15:23:14.737532
[0m15:23:14.737532 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.739665 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.739665 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:23:14.739665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:14.744338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.744338 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:23:14.692800 => 15:23:14.744338
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:23:14.744338 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:23:14.744338 [info ] [Thread-2 (]: 5 of 16 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.06s]
[0m15:23:14.744338 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:23:14.782655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.782655 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:23:14.783772 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.784422 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.784422 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:23:14.695980 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:23:14.784422 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:23:14.784422 [warn ] [Thread-3 (]: 6 of 16 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m15:23:14.784422 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:23:14.784422 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [info ] [Thread-2 (]: 8 of 16 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:23:14.784422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:23:14.784422 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:23:14.784422 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:23:14.784422 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:23:14.784422 => 15:23:14.784422
[0m15:23:14.784422 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:23:14.816535 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.817535 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:23:14.817535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:14.818535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.819537 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:23:14.819537 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:14.820535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:14.821535 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:23:14.737532 => 15:23:14.821535
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:23:14.822535 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:23:14.823535 [info ] [Thread-1 (]: 7 of 16 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:23:14.824535 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:23:14.884536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.885536 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.885536 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:23:14.892543 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:23:14.897540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.897540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:23:14.898540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.900540 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.900540 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:23:14.901540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.906050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.906050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:23:14.907051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:14.911051 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:23:14.914050 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:23:14.914050 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:23:14.916133 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:14.916133 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:23:14.784422 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m15:23:14.916133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B3AF7F0>]}
[0m15:23:14.916133 [info ] [Thread-2 (]: 8 of 16 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.13s]
[0m15:23:14.916133 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:23:14.916133 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:23:14.916133 [info ] [Thread-3 (]: 9 of 16 START sql table model public.stg_web__transactions ..................... [RUN]
[0m15:23:14.916133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_web__transactions)
[0m15:23:14.916133 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:23:14.916133 => 15:23:14.916133
[0m15:23:14.916133 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:23:14.916133 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.916133 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:23:14.916133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:14.986656 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:14.986656 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.987662 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:23:14.993661 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:23:14.996660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:14.996660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:23:14.997660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:14.999660 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:23:15.000660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.038166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.038166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.039166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:23:15.040167 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.041166 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:23:15.042166 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:23:15.042166 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:23:15.044168 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.045168 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:23:14.916133 => 15:23:15.045168
[0m15:23:15.046295 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:23:15.046295 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B451CF0>]}
[0m15:23:15.046295 [info ] [Thread-3 (]: 9 of 16 OK created sql table model public.stg_web__transactions ................ [[32mSELECT 101[0m in 0.13s]
[0m15:23:15.046295 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:23:15.046295 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:23:15.046295 [info ] [Thread-1 (]: 11 of 16 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:23:15.046295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:23:15.046295 [info ] [Thread-3 (]: 12 of 16 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:23:15.046295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:23:15.046295 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.046295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:23:15.046295 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.046295 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.046295 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.046295 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.046295 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.063040 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:23:15.046295 => 15:23:15.062038
[0m15:23:15.063547 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:23:15.046295 => 15:23:15.063040
[0m15:23:15.063547 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.064470 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:23:15.046295 => 15:23:15.063547
[0m15:23:15.064470 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.066513 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.066513 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.068512 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.070509 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.070509 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.071508 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:23:15.071508 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.071508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.072509 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.073507 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:23:15.073507 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:23:15.073507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.074476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.122017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.122017 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:23:15.122017 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.123078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.124020 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:23:15.064470 => 15:23:15.124020
[0m15:23:15.125020 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:23:15.126018 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:23:15.126018 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m15:23:15.127025 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:23:15.151287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.152287 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:23:15.152287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:23:15.153287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.154288 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:23:15.067510 => 15:23:15.154288
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:23:15.155287 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:23:15.156287 [info ] [Thread-1 (]: 11 of 16 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m15:23:15.157656 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:23:15.181701 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.182704 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:23:15.182704 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.183696 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.185700 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:23:15.068512 => 15:23:15.184701
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:23:15.185700 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:23:15.186741 [info ] [Thread-3 (]: 12 of 16 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m15:23:15.187741 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:23:15.187741 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.188741 [info ] [Thread-2 (]: 13 of 16 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:23:15.189744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now model.customer360.contacts_joined_with_transactions)
[0m15:23:15.189744 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:23:15.191741 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.192743 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:23:15.189744 => 15:23:15.192743
[0m15:23:15.192743 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:23:15.204216 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.205216 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:23:15.205216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.310792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:23:15.312169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:23:15.312169 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:23:15.312169 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:23:15.192743 => 15:23:15.312169
[0m15:23:15.312169 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:23:15.312169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B54FF10>]}
[0m15:23:15.312169 [info ] [Thread-2 (]: 13 of 16 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.12s]
[0m15:23:15.327795 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:23:15.327795 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [info ] [Thread-3 (]: 14 of 16 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:23:15.328875 [info ] [Thread-1 (]: 15 of 16 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:23:15.328875 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.328875 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:23:15.328875 => 15:23:15.328875
[0m15:23:15.328875 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.328875 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.328875 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.328875 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:23:15.343885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:15.328875 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.343885 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:23:15.345088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:15.391471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.392470 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:23:15.392470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:23:15.394473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.395471 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:23:15.328875 => 15:23:15.395471
[0m15:23:15.395471 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:23:15.396470 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:23:15.396470 [info ] [Thread-3 (]: 14 of 16 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:23:15.397490 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:23:15.427158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.436048 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:23:15.436800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:23:15.436800 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:23:15.328875 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:23:15.436800 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:23:15.436800 [warn ] [Thread-1 (]: 15 of 16 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.11s]
[0m15:23:15.436800 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:23:15.436800 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:23:15.436800 [info ] [Thread-2 (]: 16 of 16 START sql table model public.customers ................................ [RUN]
[0m15:23:15.436800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:23:15.436800 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m15:23:15.436800 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:23:15.436800 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 15:23:15.436800 => 15:23:15.436800
[0m15:23:15.436800 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m15:23:15.449651 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.450659 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m15:23:15.451656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.511277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.512277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.512277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:23:15.533277 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:23:15.536277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.536277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:23:15.537277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.539277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:23:15.539277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.541277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.541277 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:23:15.542278 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.544277 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:23:15.544277 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:23:15.545277 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:23:15.546279 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:23:15.547277 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 15:23:15.436800 => 15:23:15.547277
[0m15:23:15.547277 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m15:23:15.548278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202ad70-273e-41a2-8106-2ac270eb246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B12E950>]}
[0m15:23:15.548278 [info ] [Thread-2 (]: 16 of 16 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.11s]
[0m15:23:15.549278 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:23:15.550277 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.550277 [debug] [MainThread]: On master: BEGIN
[0m15:23:15.551280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:15.610495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.611490 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:15.611490 [debug] [MainThread]: On master: COMMIT
[0m15:23:15.612490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:15.612490 [debug] [MainThread]: On master: Close
[0m15:23:15.613490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:23:15.613490 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:23:15.614493 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:23:15.614493 [info ] [MainThread]: 
[0m15:23:15.615490 [info ] [MainThread]: Finished running 2 seeds, 10 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m15:23:15.617490 [debug] [MainThread]: Command end result
[0m15:23:15.623491 [info ] [MainThread]: 
[0m15:23:15.624489 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:23:15.624489 [info ] [MainThread]: 
[0m15:23:15.625498 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:23:15.625498 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.626496 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:23:15.626496 [info ] [MainThread]: 
[0m15:23:15.627491 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:23:15.627491 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:23:15.628491 [info ] [MainThread]: 
[0m15:23:15.628491 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:23:15.629495 [info ] [MainThread]: 
[0m15:23:15.629495 [info ] [MainThread]: Done. PASS=14 WARN=2 ERROR=0 SKIP=0 TOTAL=16
[0m15:23:15.630461 [debug] [MainThread]: Command `dbt build` succeeded at 15:23:15.630461 after 2.01 seconds
[0m15:23:15.630461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E37884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3ADCA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E3B275780>]}
[0m15:23:15.631458 [debug] [MainThread]: Flushing usage events
[0m15:30:34.852339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7FD784580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780C22DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780C22B30>]}


============================== 15:30:34.854339 | 0aa6c457-0e5b-4485-8581-d9a0c4ac6a10 ==============================
[0m15:30:34.854339 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:30:34.855339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:30:34.968993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F9832E00>]}
[0m15:30:35.034556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C780E6A440>]}
[0m15:30:35.035558 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:30:35.044557 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:30:35.123024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:35.123024 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\_sf__stg.yaml
[0m15:30:35.232672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78126C0D0>]}
[0m15:30:35.248298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7810616F0>]}
[0m15:30:35.248298 [info ] [MainThread]: Found 2 seeds, 12 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:30:35.248298 [info ] [MainThread]: 
[0m15:30:35.248298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:35.248298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:30:35.264826 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:30:35.264826 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:30:35.265994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:35.320245 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:30:35.321246 [debug] [ThreadPool]: On list_dbt: Close
[0m15:30:35.323245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:30:35.326244 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:30:35.327244 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:30:35.327244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:35.373870 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.373870 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:30:35.373870 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:30:35.376869 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:30:35.377871 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:30:35.377871 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:30:35.381869 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.382636 [debug] [MainThread]: On master: BEGIN
[0m15:30:35.382636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:35.428144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.428144 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.429144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:35.432144 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:30:35.433144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7812DD4E0>]}
[0m15:30:35.433144 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:35.434144 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.434144 [debug] [MainThread]: On master: BEGIN
[0m15:30:35.434144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.435145 [debug] [MainThread]: On master: COMMIT
[0m15:30:35.435145 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:35.435145 [debug] [MainThread]: On master: COMMIT
[0m15:30:35.436144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.436144 [debug] [MainThread]: On master: Close
[0m15:30:35.436144 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:30:35.437144 [info ] [MainThread]: 
[0m15:30:35.439144 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:30:35.440144 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:30:35.440144 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.440144 [info ] [Thread-1 (]: 1 of 18 START seed file public.contacts ........................................ [RUN]
[0m15:30:35.441144 [info ] [Thread-2 (]: 2 of 18 START seed file public.transactions .................................... [RUN]
[0m15:30:35.441144 [info ] [Thread-3 (]: 3 of 18 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:30:35.442144 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:30:35.443146 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:30:35.443146 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:30:35.444145 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:30:35.444145 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:30:35.444145 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.445144 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:30:35.445144 => 15:30:35.445144
[0m15:30:35.445144 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:30:35.445144 => 15:30:35.445144
[0m15:30:35.457144 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.458144 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:30:35.458144 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:30:35.469144 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:30:35.445144 => 15:30:35.468144
[0m15:30:35.480144 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.480144 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.483147 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.483147 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:30:35.493147 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.493147 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:30:35.494147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:35.494147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:35.495147 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.495147 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:30:35.496149 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:35.544745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.544745 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.545748 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:30:35.550745 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:30:35.573748 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.574746 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:30:35.574746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.575746 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.575746 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:30:35.575746 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:30:35.579745 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:30:35.588752 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:30:35.589751 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:30:35.589751 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:30:35.636999 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.668764 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:30:35.686852 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.686852 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:30:35.687811 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:30:35.687811 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:30:35.688811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.689967 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:30:35.458144 => 15:30:35.689967
[0m15:30:35.689967 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:30:35.689967 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:30:35.689967 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:30:35.689967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7813AFF70>]}
[0m15:30:35.689967 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:30:35.689967 [info ] [Thread-1 (]: 1 of 18 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.25s]
[0m15:30:35.689967 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:30:35.689967 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:30:35.689967 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:30:35.689967 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.697472 [info ] [Thread-1 (]: 4 of 18 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:30:35.697472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:30:35.697472 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.697472 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.697472 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.697472 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:30:35.469144 => 15:30:35.697472
[0m15:30:35.697472 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:30:35.484147 => 15:30:35.697472
[0m15:30:35.705477 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.706055 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:30:35.706055 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:30:35.707131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C781330EB0>]}
[0m15:30:35.707131 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:30:35.697472 => 15:30:35.707131
[0m15:30:35.707131 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:30:35.707131 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.707131 [info ] [Thread-2 (]: 2 of 18 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m15:30:35.707131 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.707131 [info ] [Thread-3 (]: 3 of 18 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m15:30:35.707131 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:30:35.707131 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:30:35.707131 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.707131 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.707131 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.707131 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:30:35.715245 [info ] [Thread-2 (]: 5 of 18 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:30:35.716252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:35.715245 [info ] [Thread-3 (]: 6 of 18 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:30:35.716588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:30:35.716588 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:30:35.716588 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.716588 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.716588 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.716588 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.716588 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:30:35.716588 => 15:30:35.716588
[0m15:30:35.716588 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:30:35.716588 => 15:30:35.716588
[0m15:30:35.716588 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.716588 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.730141 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.730141 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.730141 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.730141 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.730141 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:30:35.730141 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:30:35.730141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:35.730141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:35.785451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.786452 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:30:35.786452 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:30:35.787841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.788845 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:30:35.707131 => 15:30:35.788845
[0m15:30:35.788845 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:30:35.789844 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:30:35.790844 [info ] [Thread-1 (]: 4 of 18 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m15:30:35.791846 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:30:35.791846 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.792845 [info ] [Thread-1 (]: 7 of 18 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:30:35.792845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:30:35.793845 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.795845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.797348 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:30:35.793845 => 15:30:35.797348
[0m15:30:35.798352 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.799353 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.800352 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.800352 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:30:35.801353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:35.806352 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.806352 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:30:35.806352 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:35.807352 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.809353 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:30:35.716588 => 15:30:35.809353
[0m15:30:35.809353 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:30:35.810352 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:30:35.811353 [info ] [Thread-2 (]: 5 of 18 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.09s]
[0m15:30:35.811353 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:30:35.845352 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.845352 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:30:35.846352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:35.847353 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.848352 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:30:35.730141 => 15:30:35.848352
[0m15:30:35.849352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:30:35.849352 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:30:35.850352 [warn ] [Thread-3 (]: 6 of 18 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.13s]
[0m15:30:35.851352 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:30:35.851352 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m15:30:35.852353 [info ] [Thread-2 (]: 8 of 18 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:30:35.853353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:30:35.853353 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:30:35.855352 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:30:35.856352 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:30:35.853353 => 15:30:35.856352
[0m15:30:35.856352 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:30:35.878352 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:30:35.879353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.879353 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.880354 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:30:35.880354 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:30:35.881352 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:35.881352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:35.882352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:35.883357 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:30:35.798352 => 15:30:35.883357
[0m15:30:35.884355 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:30:35.884355 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:30:35.885355 [info ] [Thread-1 (]: 7 of 18 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:30:35.885355 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:30:35.938862 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:35.938862 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.939862 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:30:35.946863 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:30:35.951863 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.951863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:30:35.952864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:35.954862 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.954862 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:30:35.955862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:35.960863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:30:35.960863 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.960863 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:30:35.961862 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:35.965863 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:30:35.968927 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:30:35.968927 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:30:35.968927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:35.968927 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:30:35.857352 => 15:30:35.968927
[0m15:30:35.968927 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m15:30:35.968927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7814B8D90>]}
[0m15:30:35.968927 [info ] [Thread-2 (]: 8 of 18 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m15:30:35.968927 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:30:35.968927 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.968927 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.968927 [info ] [Thread-3 (]: 9 of 18 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m15:30:35.968927 [info ] [Thread-1 (]: 10 of 18 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m15:30:35.968927 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m15:30:35.968927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m15:30:35.968927 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.968927 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.968927 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.968927 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.985211 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 15:30:35.968927 => 15:30:35.985211
[0m15:30:35.986216 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:35.986216 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 15:30:35.968927 => 15:30:35.986216
[0m15:30:35.986216 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.986216 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:35.986216 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.986216 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:35.986216 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:35.986216 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m15:30:35.986216 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m15:30:35.986216 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:35.986216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.039784 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.039784 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:30:36.039784 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m15:30:36.040783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.042785 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 15:30:35.986216 => 15:30:36.041785
[0m15:30:36.042785 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m15:30:36.042785 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m15:30:36.043784 [info ] [Thread-3 (]: 9 of 18 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m15:30:36.044785 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:30:36.068989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.068989 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:30:36.068989 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.070989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.071988 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 15:30:35.986216 => 15:30:36.071988
[0m15:30:36.071988 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m15:30:36.071988 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m15:30:36.072988 [info ] [Thread-1 (]: 10 of 18 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m15:30:36.073989 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:30:36.074989 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m15:30:36.074989 [info ] [Thread-2 (]: 11 of 18 START sql table model public.stg_web__transactions .................... [RUN]
[0m15:30:36.075989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m15:30:36.075989 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:30:36.080987 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:30:36.080987 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:30:36.076989 => 15:30:36.080987
[0m15:30:36.081988 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m15:30:36.083991 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:30:36.084991 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.084991 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:30:36.085991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.131499 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.131499 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.132498 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:30:36.139380 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:30:36.142380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.142380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:30:36.143380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.145379 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.145379 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:30:36.145379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.147380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:30:36.147380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.147380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:30:36.148380 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.150379 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:30:36.151380 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:30:36.151380 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:30:36.152438 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:36.153443 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:30:36.081988 => 15:30:36.153443
[0m15:30:36.154444 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m15:30:36.154444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7814C6530>]}
[0m15:30:36.155444 [info ] [Thread-2 (]: 11 of 18 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m15:30:36.156445 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m15:30:36.156445 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.157444 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.157444 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.158444 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:30:36.158444 [info ] [Thread-3 (]: 13 of 18 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:30:36.158444 [info ] [Thread-2 (]: 14 of 18 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:30:36.159443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:30:36.159443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:30:36.160445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:30:36.160445 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.161443 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.161443 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.164444 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.169443 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.172445 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.173451 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:30:36.161443 => 15:30:36.173451
[0m15:30:36.173451 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.174444 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:30:36.164444 => 15:30:36.173451
[0m15:30:36.174444 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:30:36.169443 => 15:30:36.174444
[0m15:30:36.176443 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.176443 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.176443 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.178443 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.179443 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.180443 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.181443 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:30:36.181443 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.182444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.182444 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.182444 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:30:36.183448 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:30:36.183448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:36.184447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.229005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.229005 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:30:36.230005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:36.231005 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.232005 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:30:36.174444 => 15:30:36.231005
[0m15:30:36.232005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:30:36.232005 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:30:36.233005 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.07s]
[0m15:30:36.234006 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:30:36.259006 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.259006 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:30:36.259006 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:30:36.261007 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.262006 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:30:36.177444 => 15:30:36.262006
[0m15:30:36.262006 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:30:36.263005 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:30:36.264006 [info ] [Thread-3 (]: 13 of 18 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.10s]
[0m15:30:36.265007 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:30:36.288346 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.288346 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:30:36.289347 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.290347 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.291634 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:30:36.179443 => 15:30:36.291634
[0m15:30:36.291634 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:30:36.291634 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:30:36.291634 [info ] [Thread-2 (]: 14 of 18 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.13s]
[0m15:30:36.291634 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:30:36.291634 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:30:36.291634 [info ] [Thread-1 (]: 15 of 18 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:30:36.291634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now model.customer360.contacts_joined_with_transactions)
[0m15:30:36.291634 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:30:36.297638 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.297638 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:30:36.291634 => 15:30:36.297638
[0m15:30:36.297638 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:30:36.303309 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.303309 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.303309 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:30:36.303309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.359043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.359043 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.360043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:30:36.362045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:30:36.364043 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.364043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:30:36.365043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.366045 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:30:36.366045 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.367043 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:30:36.367666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.370050 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:30:36.372051 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:30:36.372051 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:30:36.373051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:30:36.374051 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:30:36.297638 => 15:30:36.374051
[0m15:30:36.374051 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:30:36.375051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C781527460>]}
[0m15:30:36.375051 [info ] [Thread-1 (]: 15 of 18 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m15:30:36.376051 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:30:36.377052 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.377052 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.377052 [info ] [Thread-2 (]: 16 of 18 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:30:36.378052 [info ] [Thread-3 (]: 17 of 18 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:30:36.378052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:30:36.379051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:30:36.379051 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.380051 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.383053 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.385056 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.386056 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:30:36.380051 => 15:30:36.386056
[0m15:30:36.387055 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:30:36.383053 => 15:30:36.386056
[0m15:30:36.387055 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.387055 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.389053 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.390055 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.391054 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.391054 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.392054 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:30:36.392054 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:30:36.392054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:36.393054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:36.438917 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.438917 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:30:36.439917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:30:36.440917 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.441917 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:30:36.387055 => 15:30:36.441917
[0m15:30:36.442917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:30:36.442917 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:30:36.443918 [info ] [Thread-2 (]: 16 of 18 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:30:36.444918 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:30:36.467917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.467917 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:30:36.468917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:30:36.469919 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:36.470919 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:30:36.389053 => 15:30:36.470919
[0m15:30:36.471917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:30:36.471917 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:30:36.472918 [warn ] [Thread-3 (]: 17 of 18 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.09s]
[0m15:30:36.472918 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:30:36.473919 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m15:30:36.473919 [info ] [Thread-1 (]: 18 of 18 START sql table model public.customers ................................ [RUN]
[0m15:30:36.474918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:30:36.475918 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m15:30:36.477918 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:30:36.478917 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 15:30:36.475918 => 15:30:36.478917
[0m15:30:36.478917 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m15:30:36.481917 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:30:36.482920 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.482920 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m15:30:36.482920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:36.530427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.530427 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.531428 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:30:36.538157 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:30:36.540160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.541160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:30:36.541160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.544160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.544160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:30:36.545160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:36.546163 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:30:36.547162 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.547162 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m15:30:36.548162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.549161 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:30:36.550160 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m15:30:36.550160 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:30:36.552162 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:36.552162 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 15:30:36.479918 => 15:30:36.552162
[0m15:30:36.553162 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m15:30:36.553162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa6c457-0e5b-4485-8581-d9a0c4ac6a10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7812B2A70>]}
[0m15:30:36.554161 [info ] [Thread-1 (]: 18 of 18 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m15:30:36.555161 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m15:30:36.556161 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:36.556161 [debug] [MainThread]: On master: BEGIN
[0m15:30:36.557162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:36.599037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:36.599037 [debug] [MainThread]: On master: COMMIT
[0m15:30:36.599037 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:36.599037 [debug] [MainThread]: On master: COMMIT
[0m15:30:36.599037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:30:36.599037 [debug] [MainThread]: On master: Close
[0m15:30:36.599037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:30:36.599037 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:30:36.599037 [info ] [MainThread]: 
[0m15:30:36.608688 [info ] [MainThread]: Finished running 2 seeds, 12 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m15:30:36.611000 [debug] [MainThread]: Command end result
[0m15:30:36.611000 [info ] [MainThread]: 
[0m15:30:36.611000 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:30:36.618309 [info ] [MainThread]: 
[0m15:30:36.618813 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:30:36.618813 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:30:36.618813 [info ] [MainThread]: 
[0m15:30:36.618813 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:30:36.618813 [info ] [MainThread]: 
[0m15:30:36.618813 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:30:36.618813 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:30:36.622043 [info ] [MainThread]: 
[0m15:30:36.622043 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:30:36.623049 [info ] [MainThread]: 
[0m15:30:36.623474 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=0 SKIP=0 TOTAL=18
[0m15:30:36.624008 [debug] [MainThread]: Command `dbt build` succeeded at 15:30:36.624008 after 1.81 seconds
[0m15:30:36.624008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7FD784580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78150C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7810574F0>]}
[0m15:30:36.624008 [debug] [MainThread]: Flushing usage events
[0m15:35:14.133851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D7E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AB90>]}


============================== 15:35:14.136851 | 02522713-1f07-4b31-a648-6a1f64acb74e ==============================
[0m15:35:14.136851 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:35:14.137850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:14.260872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB12AE30>]}
[0m15:35:14.318379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB37F850>]}
[0m15:35:14.319379 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:35:14.329584 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:35:14.409096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:14.410096 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__sources.yml
[0m15:35:14.669665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB980100>]}
[0m15:35:14.677637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4CAD70>]}
[0m15:35:14.677637 [info ] [MainThread]: Found 2 seeds, 12 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m15:35:14.678667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4CABC0>]}
[0m15:35:14.679666 [info ] [MainThread]: 
[0m15:35:14.680628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:14.681627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:35:14.687627 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:35:14.687627 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:35:14.687627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:14.740342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.740342 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:35:14.741387 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:35:14.743388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:35:14.744390 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:35:14.744390 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:35:14.748386 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:14.749348 [debug] [MainThread]: On master: BEGIN
[0m15:35:14.749348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:14.794540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.794540 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:14.795547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:14.798585 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:35:14.799585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02522713-1f07-4b31-a648-6a1f64acb74e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB4C9420>]}
[0m15:35:14.799585 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:14.799585 [debug] [MainThread]: On master: Close
[0m15:35:14.800587 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:35:14.801547 [info ] [MainThread]: 
[0m15:35:14.802568 [debug] [Thread-1 (]: Began running node source.customer360.web.transactions
[0m15:35:14.803573 [info ] [Thread-1 (]: 1 of 1 START freshness of web.transactions ..................................... [RUN]
[0m15:35:14.804573 [debug] [Thread-1 (]: Acquiring new postgres connection 'source.customer360.web.transactions'
[0m15:35:14.804573 [debug] [Thread-1 (]: Began compiling node source.customer360.web.transactions
[0m15:35:14.804573 [debug] [Thread-1 (]: Timing info for source.customer360.web.transactions (compile): 15:35:14.804573 => 15:35:14.804573
[0m15:35:14.805572 [debug] [Thread-1 (]: Began executing node source.customer360.web.transactions
[0m15:35:14.805572 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.806571 [debug] [Thread-1 (]: On source.customer360.web.transactions: BEGIN
[0m15:35:14.806571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:14.851574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:35:14.851574 [debug] [Thread-1 (]: On source.customer360.web.transactions: COMMIT
[0m15:35:14.852574 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.852574 [debug] [Thread-1 (]: On source.customer360.web.transactions: COMMIT
[0m15:35:14.853574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:35:14.858574 [debug] [Thread-1 (]: Using postgres connection "source.customer360.web.transactions"
[0m15:35:14.859574 [debug] [Thread-1 (]: On source.customer360.web.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "source.customer360.web.transactions"} */
select
      max(_loaded_at_utc) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."public"."transactions"
    
  
[0m15:35:14.860575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:35:14.861575 [debug] [Thread-1 (]: On source.customer360.web.transactions: Close
[0m15:35:14.861575 [debug] [Thread-1 (]: Timing info for source.customer360.web.transactions (execute): 15:35:14.805572 => 15:35:14.861575
[0m15:35:14.862575 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of web.transactions ............................... [[31mERROR STALE[0m in 0.06s]
[0m15:35:14.863574 [debug] [Thread-1 (]: Finished running node source.customer360.web.transactions
[0m15:35:14.863574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:14.863574 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:35:14.865078 [debug] [MainThread]: Connection 'source.customer360.web.transactions' was properly closed.
[0m15:35:14.870081 [info ] [MainThread]: 
[0m15:35:14.870081 [info ] [MainThread]: Done.
[0m15:35:14.872082 [debug] [MainThread]: Command `dbt source freshness` failed at 15:35:14.871082 after 0.78 seconds
[0m15:35:14.872082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D7E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB882EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB6506A0>]}
[0m15:35:14.872082 [debug] [MainThread]: Flushing usage events
[0m15:49:38.135680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A2767220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5A5EDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5A5EB30>]}


============================== 15:49:38.135680 | 6fa245b3-eca7-46bc-bd90-1319916dcad0 ==============================
[0m15:49:38.135680 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:49:38.135680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s stg_web__transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:38.254965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fa245b3-eca7-46bc-bd90-1319916dcad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49E6F0AC0>]}
[0m15:49:38.325835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fa245b3-eca7-46bc-bd90-1319916dcad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5CA2440>]}
[0m15:49:38.325835 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:49:38.338304 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:49:38.417073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:49:38.418074 [debug] [MainThread]: Partial parsing: added file: customer360://macros\value_above_zero.sql
[0m15:49:38.418074 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__stg.yaml
[0m15:49:38.590716 [error] [MainThread]: Encountered an error:
Compilation Error in test value_above_zero_stg_web__transactions_amount (models\staging\web\_web__stg.yaml)
  macro 'dbt_macro__test_value_above_zero' takes no keyword argument 'column_name'
[0m15:49:38.590716 [debug] [MainThread]: Command `dbt test` failed at 15:49:38.590716 after 0.50 seconds
[0m15:49:38.590716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A2767220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A606A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A607AFB0>]}
[0m15:49:38.590716 [debug] [MainThread]: Flushing usage events
[0m15:50:29.566413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A972B42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A5AEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A5AEB90>]}


============================== 15:50:29.568412 | a57a03aa-d284-4691-9eba-6c473c7483ae ==============================
[0m15:50:29.568412 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:50:29.569412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s stg_web__transactions', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:29.689920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A93290AC0>]}
[0m15:50:29.747090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9A7ED390>]}
[0m15:50:29.748090 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:50:29.757090 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:50:29.832013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:50:29.832013 [debug] [MainThread]: Partial parsing: added file: customer360://macros\value_above_zero.sql
[0m15:50:29.833014 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\_web__stg.yaml
[0m15:50:30.021388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AD600D0>]}
[0m15:50:30.029389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AC839D0>]}
[0m15:50:30.029389 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m15:50:30.030389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AAC7790>]}
[0m15:50:30.031388 [info ] [MainThread]: 
[0m15:50:30.032388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:30.033388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:50:30.039388 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:30.039388 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:50:30.040388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:30.086783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.087783 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:30.088783 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:30.090783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:50:30.091783 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:50:30.091783 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:50:30.095784 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.096784 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.096784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:30.141966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.141966 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.142967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:30.145965 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:30.146965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a57a03aa-d284-4691-9eba-6c473c7483ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9ACAA410>]}
[0m15:50:30.146965 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:30.147966 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.147966 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.147966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.148965 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.148965 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.148965 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.149966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:30.149966 [debug] [MainThread]: On master: Close
[0m15:50:30.150966 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:50:30.150966 [info ] [MainThread]: 
[0m15:50:30.153386 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.153386 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.154388 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.154388 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_web__transactions_id ............................ [RUN]
[0m15:50:30.155387 [info ] [Thread-2 (]: 2 of 4 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:50:30.155387 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_web__transactions_id .............................. [RUN]
[0m15:50:30.156387 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m15:50:30.156387 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m15:50:30.157387 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.unique_stg_web__transactions_id.5518387fef'
[0m15:50:30.157387 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.157387 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.158386 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.166388 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.170386 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.174386 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.175386 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:50:30.158386 => 15:50:30.175386
[0m15:50:30.175386 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:50:30.167388 => 15:50:30.175386
[0m15:50:30.176387 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:50:30.171386 => 15:50:30.176387
[0m15:50:30.176387 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.177386 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.177386 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.185400 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.187387 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.189386 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.189386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.190387 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:50:30.190387 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.190387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:30.191387 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.191387 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:50:30.192387 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:50:30.192387 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:30.192387 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:30.236909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.236909 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:30.237910 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:30.238910 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.239910 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:50:30.177386 => 15:50:30.239910
[0m15:50:30.240909 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:50:30.240909 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:50:30.241910 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m15:50:30.241910 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:30.242911 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.242911 [info ] [Thread-1 (]: 4 of 4 START test value_above_zero_stg_web__transactions_amount ................ [RUN]
[0m15:50:30.243911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m15:50:30.243911 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.245985 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 15:50:30.244910 => 15:50:30.245985
[0m15:50:30.245985 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.245985 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.245985 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m15:50:30.245985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:30.269975 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.270977 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:30.270977 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:50:30.272977 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.273978 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:50:30.186388 => 15:50:30.273978
[0m15:50:30.273978 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:50:30.274977 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:50:30.274977 [info ] [Thread-2 (]: 2 of 4 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.12s]
[0m15:50:30.275976 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:30.299838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.299838 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:30.300837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:30.301837 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.302837 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:50:30.187387 => 15:50:30.302837
[0m15:50:30.302837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:50:30.303837 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:50:30.304838 [info ] [Thread-3 (]: 3 of 4 PASS unique_stg_web__transactions_id .................................... [[32mPASS[0m in 0.15s]
[0m15:50:30.305002 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:30.450470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.451470 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:30.451470 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m15:50:30.452470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:30.453470 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 15:50:30.245985 => 15:50:30.453470
[0m15:50:30.454471 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m15:50:30.454471 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m15:50:30.455470 [info ] [Thread-1 (]: 4 of 4 PASS value_above_zero_stg_web__transactions_amount ...................... [[32mPASS[0m in 0.21s]
[0m15:50:30.456735 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:30.457791 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.457791 [debug] [MainThread]: On master: BEGIN
[0m15:50:30.457791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:30.504287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:30.504287 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.504287 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:30.504287 [debug] [MainThread]: On master: COMMIT
[0m15:50:30.504287 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:30.504287 [debug] [MainThread]: On master: Close
[0m15:50:30.504287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m15:50:30.504287 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m15:50:30.504287 [info ] [MainThread]: 
[0m15:50:30.504287 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:50:30.509977 [debug] [MainThread]: Command end result
[0m15:50:30.517023 [info ] [MainThread]: 
[0m15:50:30.518024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:30.518024 [info ] [MainThread]: 
[0m15:50:30.518024 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:50:30.519023 [debug] [MainThread]: Command `dbt test` succeeded at 15:50:30.519023 after 0.99 seconds
[0m15:50:30.520023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A972B42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AD01F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9AE3FCD0>]}
[0m15:50:30.520023 [debug] [MainThread]: Flushing usage events
[0m15:50:48.614704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0A9C5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DCC2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DCC2BC0>]}


============================== 15:50:48.617710 | 93af4816-6c4a-4c30-8470-2dabf12e99cc ==============================
[0m15:50:48.617710 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:50:48.618709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:50:48.739138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D069C2E00>]}
[0m15:50:48.797138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0DF09930>]}
[0m15:50:48.798136 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:50:48.807137 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:50:48.885079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:48.885079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:48.889079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E14CA00>]}
[0m15:50:48.897079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E05F400>]}
[0m15:50:48.897079 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m15:50:48.899079 [info ] [MainThread]: 
[0m15:50:48.900080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:48.901080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m15:50:48.907079 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m15:50:48.907079 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m15:50:48.908079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:48.956591 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:50:48.957591 [debug] [ThreadPool]: On list_dbt: Close
[0m15:50:48.959591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m15:50:48.962589 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:48.963590 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m15:50:48.963590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:49.009687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.009687 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m15:50:49.009687 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:49.012686 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:50:49.013688 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m15:50:49.013688 [debug] [ThreadPool]: On list_dbt_public: Close
[0m15:50:49.017688 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.017688 [debug] [MainThread]: On master: BEGIN
[0m15:50:49.018686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:49.063197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.064197 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.064197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:49.067196 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:49.068198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1A21D0>]}
[0m15:50:49.069198 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:49.069198 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.069198 [debug] [MainThread]: On master: BEGIN
[0m15:50:49.070197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.070197 [debug] [MainThread]: On master: COMMIT
[0m15:50:49.070197 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:49.071198 [debug] [MainThread]: On master: COMMIT
[0m15:50:49.071198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.072198 [debug] [MainThread]: On master: Close
[0m15:50:49.072198 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m15:50:49.073197 [info ] [MainThread]: 
[0m15:50:49.075196 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m15:50:49.075196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m15:50:49.076197 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.076197 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m15:50:49.077198 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m15:50:49.077198 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m15:50:49.078197 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m15:50:49.078197 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m15:50:49.079198 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m15:50:49.079198 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m15:50:49.080197 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m15:50:49.080197 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.080197 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 15:50:49.080197 => 15:50:49.080197
[0m15:50:49.081197 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 15:50:49.081197 => 15:50:49.081197
[0m15:50:49.093196 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.094197 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m15:50:49.094197 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m15:50:49.105196 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 15:50:49.081197 => 15:50:49.105196
[0m15:50:49.106196 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.116196 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.119197 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.129199 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.129199 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m15:50:49.130200 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m15:50:49.130200 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:49.131200 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:49.131200 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.132199 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m15:50:49.132199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:49.178024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.179024 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.179024 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m15:50:49.185023 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:50:49.208024 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.209045 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m15:50:49.210026 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m15:50:49.213024 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m15:50:49.214024 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.223024 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:50:49.223024 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.224029 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m15:50:49.224029 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m15:50:49.225030 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m15:50:49.226028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.227029 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 15:50:49.094197 => 15:50:49.227029
[0m15:50:49.228028 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m15:50:49.228028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E22BC10>]}
[0m15:50:49.231029 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m15:50:49.231029 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m15:50:49.260162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.329321 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.329321 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m15:50:49.330262 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m15:50:49.330262 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m15:50:49.331261 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.331671 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m15:50:49.332717 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m15:50:49.333718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m15:50:49.333718 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.333718 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m15:50:49.338676 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.338676 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m15:50:49.340180 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 15:50:49.333718 => 15:50:49.340180
[0m15:50:49.341181 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:50:49.341181 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.342181 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m15:50:49.343180 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.344179 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m15:50:49.344179 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.345180 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m15:50:49.345180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.345180 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.345180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.347181 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 15:50:49.119197 => 15:50:49.347181
[0m15:50:49.348180 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 15:50:49.104196 => 15:50:49.348180
[0m15:50:49.348180 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m15:50:49.348180 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m15:50:49.350179 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m15:50:49.350179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1E02B0>]}
[0m15:50:49.351181 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m15:50:49.352180 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m15:50:49.353180 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m15:50:49.353180 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m15:50:49.354180 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.355180 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.355180 [info ] [Thread-3 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m15:50:49.356180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m15:50:49.355180 [info ] [Thread-2 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m15:50:49.356180 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.357180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m15:50:49.360179 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.360179 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.365181 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.365181 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 15:50:49.357180 => 15:50:49.365181
[0m15:50:49.366180 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 15:50:49.361180 => 15:50:49.366180
[0m15:50:49.366180 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.367181 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.369181 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.371179 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.371179 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.372179 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m15:50:49.372179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.373180 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.373180 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m15:50:49.374179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.393180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.393180 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m15:50:49.394181 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m15:50:49.395180 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.396180 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 15:50:49.342181 => 15:50:49.396180
[0m15:50:49.396180 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m15:50:49.397179 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m15:50:49.398179 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.06s]
[0m15:50:49.398179 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m15:50:49.399180 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.399180 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m15:50:49.400179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m15:50:49.400179 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.403179 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.404180 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 15:50:49.400179 => 15:50:49.404180
[0m15:50:49.404180 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.406181 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.407179 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.407179 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m15:50:49.407179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.423179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.424183 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m15:50:49.424183 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:49.425182 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.426183 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 15:50:49.367181 => 15:50:49.426183
[0m15:50:49.427182 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m15:50:49.427182 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m15:50:49.428183 [info ] [Thread-3 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m15:50:49.429183 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m15:50:49.483072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.484072 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m15:50:49.484072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.485072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.486072 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 15:50:49.405180 => 15:50:49.486072
[0m15:50:49.487072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m15:50:49.487072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m15:50:49.488072 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m15:50:49.489072 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m15:50:49.556673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.556673 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m15:50:49.557675 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.558674 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.559673 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 15:50:49.369181 => 15:50:49.559673
[0m15:50:49.559673 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m15:50:49.560673 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m15:50:49.561673 [warn ] [Thread-2 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.20s]
[0m15:50:49.561673 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m15:50:49.562674 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m15:50:49.563674 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m15:50:49.563674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m15:50:49.564674 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m15:50:49.566673 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m15:50:49.567673 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 15:50:49.564674 => 15:50:49.566673
[0m15:50:49.567673 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m15:50:49.588673 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m15:50:49.589673 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.590674 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m15:50:49.590674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.636247 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.637248 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.637248 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m15:50:49.644754 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:50:49.647756 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.647756 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m15:50:49.647756 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.663669 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m15:50:49.666668 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m15:50:49.667668 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m15:50:49.669669 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:49.670668 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 15:50:49.567673 => 15:50:49.670668
[0m15:50:49.670668 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m15:50:49.671668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E368400>]}
[0m15:50:49.672670 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m15:50:49.672670 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m15:50:49.673669 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.673669 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.674670 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m15:50:49.674670 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m15:50:49.675669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m15:50:49.675669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m15:50:49.676669 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.676669 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.679668 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.682668 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.682668 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 15:50:49.676669 => 15:50:49.682668
[0m15:50:49.683669 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 15:50:49.679668 => 15:50:49.683669
[0m15:50:49.683669 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.683669 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.685670 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.687669 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.687669 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.688668 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.688668 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m15:50:49.689669 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m15:50:49.689669 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.689669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.741181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.742181 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m15:50:49.742181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m15:50:49.743183 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.744181 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 15:50:49.684669 => 15:50:49.744181
[0m15:50:49.745181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m15:50:49.745181 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m15:50:49.746181 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m15:50:49.747181 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m15:50:49.776689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.776689 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m15:50:49.777691 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:49.778689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:49.779689 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 15:50:49.685670 => 15:50:49.779689
[0m15:50:49.779689 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m15:50:49.780689 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m15:50:49.781690 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.11s]
[0m15:50:49.781690 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m15:50:49.782691 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m15:50:49.783690 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m15:50:49.783690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m15:50:49.784689 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m15:50:49.787689 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m15:50:49.788689 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 15:50:49.784689 => 15:50:49.787689
[0m15:50:49.788689 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m15:50:49.791690 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m15:50:49.791690 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.792690 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m15:50:49.792690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:49.945413 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:49.945413 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.946412 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m15:50:49.954412 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m15:50:49.955648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m15:50:49.955648 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:49.955648 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 15:50:49.788689 => 15:50:49.955648
[0m15:50:49.955648 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m15:50:49.955648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E05C880>]}
[0m15:50:49.955648 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.17s]
[0m15:50:49.955648 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m15:50:49.971273 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.971273 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.971273 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.971273 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m15:50:49.971273 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m15:50:49.971273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m15:50:49.971273 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m15:50:49.971273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m15:50:49.971273 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.971273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m15:50:49.971273 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.971273 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.971273 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.971273 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.986899 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.987687 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 15:50:49.971273 => 15:50:49.987687
[0m15:50:49.988693 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 15:50:49.971273 => 15:50:49.987687
[0m15:50:49.988832 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 15:50:49.971273 => 15:50:49.988832
[0m15:50:49.988832 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:49.988832 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:49.988832 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:49.988832 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.994505 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.994505 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.994505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:49.994505 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:49.994505 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:49.994505 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m15:50:49.994505 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m15:50:49.994505 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m15:50:49.994505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:49.994505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:49.994505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:50.046341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.047342 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m15:50:50.047342 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:50.048342 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.049341 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 15:50:49.988832 => 15:50:50.049341
[0m15:50:50.049341 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m15:50:50.050341 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m15:50:50.051341 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m15:50:50.052342 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m15:50:50.052342 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.053342 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m15:50:50.053342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m15:50:50.054342 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.057341 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.058341 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 15:50:50.054342 => 15:50:50.058341
[0m15:50:50.058341 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.060342 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.061498 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.061498 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m15:50:50.061498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:50.061498 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.061498 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m15:50:50.061498 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:50:50.077880 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.078980 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 15:50:49.988832 => 15:50:50.078980
[0m15:50:50.078980 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m15:50:50.078980 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m15:50:50.078980 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m15:50:50.078980 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m15:50:50.101616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.101616 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m15:50:50.101616 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:50.113574 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.114589 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 15:50:49.994505 => 15:50:50.114589
[0m15:50:50.115582 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m15:50:50.115582 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m15:50:50.116578 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.15s]
[0m15:50:50.117677 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m15:50:50.141377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.141377 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m15:50:50.141377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.141377 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 15:50:50.059341 => 15:50:50.141377
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m15:50:50.141377 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m15:50:50.141377 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m15:50:50.141377 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m15:50:50.141377 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m15:50:50.141377 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m15:50:50.154359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m15:50:50.154359 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m15:50:50.155122 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.155122 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 15:50:50.155122 => 15:50:50.155122
[0m15:50:50.155122 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m15:50:50.169944 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.170945 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.170945 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m15:50:50.171944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:50.218959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.219960 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.219960 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m15:50:50.222750 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:50.224759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.225759 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m15:50:50.225759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.226760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:50:50.227760 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.227760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m15:50:50.228759 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.230760 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m15:50:50.232759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m15:50:50.233759 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m15:50:50.233759 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:50.234760 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 15:50:50.155122 => 15:50:50.234760
[0m15:50:50.235760 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m15:50:50.236760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E3977F0>]}
[0m15:50:50.236760 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m15:50:50.237769 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m15:50:50.238816 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.238816 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.239820 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m15:50:50.240820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m15:50:50.239820 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m15:50:50.240820 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.241821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m15:50:50.244819 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.244819 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.247821 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.248821 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 15:50:50.241821 => 15:50:50.248821
[0m15:50:50.248821 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.249820 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 15:50:50.244819 => 15:50:50.249820
[0m15:50:50.250821 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.251821 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.253820 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.253820 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.254820 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m15:50:50.254820 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.254820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:50.255821 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m15:50:50.255821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:50.303196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.304197 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m15:50:50.304197 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m15:50:50.306197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.307198 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 15:50:50.249820 => 15:50:50.307198
[0m15:50:50.307198 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m15:50:50.308197 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m15:50:50.308197 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m15:50:50.309197 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m15:50:50.333198 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.334199 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m15:50:50.334199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:50.335199 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m15:50:50.337199 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 15:50:50.251821 => 15:50:50.337199
[0m15:50:50.337199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m15:50:50.337199 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m15:50:50.338702 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m15:50:50.338702 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m15:50:50.339708 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m15:50:50.340708 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m15:50:50.340708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m15:50:50.341707 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m15:50:50.344707 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m15:50:50.345707 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 15:50:50.341707 => 15:50:50.344707
[0m15:50:50.345707 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m15:50:50.348706 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m15:50:50.348706 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.349706 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m15:50:50.349706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:50.394067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.394067 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.394067 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m15:50:50.407944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:50.407944 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:50:50.407944 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.420312 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m15:50:50.420312 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.422317 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m15:50:50.423316 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m15:50:50.423316 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m15:50:50.424417 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:50.425422 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 15:50:50.345707 => 15:50:50.425422
[0m15:50:50.426422 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m15:50:50.426422 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93af4816-6c4a-4c30-8470-2dabf12e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E330E80>]}
[0m15:50:50.427423 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.09s]
[0m15:50:50.427423 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m15:50:50.429422 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:50.429422 [debug] [MainThread]: On master: BEGIN
[0m15:50:50.429422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:50.475928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:50.476928 [debug] [MainThread]: On master: COMMIT
[0m15:50:50.476928 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:50.477928 [debug] [MainThread]: On master: COMMIT
[0m15:50:50.477928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:50.477928 [debug] [MainThread]: On master: Close
[0m15:50:50.478930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:50.478930 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m15:50:50.479930 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m15:50:50.480930 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m15:50:50.480930 [info ] [MainThread]: 
[0m15:50:50.480930 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m15:50:50.482928 [debug] [MainThread]: Command end result
[0m15:50:50.489928 [info ] [MainThread]: 
[0m15:50:50.489928 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m15:50:50.490932 [info ] [MainThread]: 
[0m15:50:50.490932 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m15:50:50.491929 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:50:50.491929 [info ] [MainThread]: 
[0m15:50:50.492552 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m15:50:50.492552 [info ] [MainThread]: 
[0m15:50:50.493558 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m15:50:50.493558 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m15:50:50.493558 [info ] [MainThread]: 
[0m15:50:50.494557 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m15:50:50.494557 [info ] [MainThread]: 
[0m15:50:50.494557 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m15:50:50.495558 [debug] [MainThread]: Command `dbt build` succeeded at 15:50:50.495558 after 1.92 seconds
[0m15:50:50.496557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0A9C5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E333FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E1A21D0>]}
[0m15:50:50.496557 [debug] [MainThread]: Flushing usage events
[0m19:25:20.266485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E832F5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86582D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86582B00>]}


============================== 19:25:20.269497 | 177c24ff-7987-48b3-9f4a-4afc32bc9351 ==============================
[0m19:25:20.269497 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:25:20.270501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:20.390088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF202E00>]}
[0m19:25:20.452142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF200A90>]}
[0m19:25:20.453142 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:25:20.463227 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:25:20.547243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:20.548746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:20.551765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86A13EB0>]}
[0m19:25:20.559912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8691AC20>]}
[0m19:25:20.560914 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:25:20.560914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8691AF20>]}
[0m19:25:20.562914 [info ] [MainThread]: 
[0m19:25:20.562914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:20.564914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:25:20.570896 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:20.571901 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:25:20.571901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:20.624915 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:25:20.624915 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:20.624915 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:20.627914 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:25:20.628914 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:25:20.629417 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:25:20.633143 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:20.634143 [debug] [MainThread]: On master: BEGIN
[0m19:25:20.634143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:20.682822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:20.683608 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:20.683608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:20.683608 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:25:20.688613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177c24ff-7987-48b3-9f4a-4afc32bc9351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E869BBBE0>]}
[0m19:25:20.688613 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:20.689628 [debug] [MainThread]: On master: Close
[0m19:25:20.689628 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:25:20.690621 [info ] [MainThread]: 
[0m19:25:20.690621 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:25:20.690621 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:25:20.690621 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:25:20.690621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:25:20.690621 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:25:20.690621 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:25:20.690621 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:25:20.690621 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:25:20.690621 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:25:20.701834 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:25:20.702833 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:25:20.701834 => 19:25:20.702833
[0m19:25:20.703834 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:25:20.702833 => 19:25:20.703834
[0m19:25:20.704833 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:25:20.704833 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:25:20.705834 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:25:20.696928 => 19:25:20.704833
[0m19:25:20.705834 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:25:20.705834 => 19:25:20.705834
[0m19:25:20.705834 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:25:20.705834 => 19:25:20.705834
[0m19:25:20.706833 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:25:20.707834 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:25:20.707834 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:25:20.708833 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:25:20.707834 => 19:25:20.707834
[0m19:25:20.708833 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.708833 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.710165 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:25:20.710165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:25:20.711183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:25:20.711183 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.712182 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.712182 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.713182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:25:20.722211 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:25:20.728714 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:25:20.728714 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.732739 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:25:20.732739 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:25:20.713182 => 19:25:20.732739
[0m19:25:20.733739 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:25:20.722211 => 19:25:20.732739
[0m19:25:20.733739 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.733739 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:25:20.729719 => 19:25:20.733739
[0m19:25:20.734739 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.734739 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:25:20.734739 => 19:25:20.734739
[0m19:25:20.735740 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.735740 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:25:20.735740 => 19:25:20.735740
[0m19:25:20.736739 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:20.736739 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:25:20.736739 => 19:25:20.736739
[0m19:25:20.737741 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:20.737741 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.739243 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:20.739746 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.739746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:25:20.740745 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:25:20.741248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:25:20.741248 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.742252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:25:20.742252 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.747252 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:25:20.747252 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:25:20.749758 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:25:20.752821 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:25:20.753821 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:25:20.742252 => 19:25:20.753821
[0m19:25:20.753821 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:25:20.747252 => 19:25:20.753821
[0m19:25:20.754823 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.754823 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:25:20.750821 => 19:25:20.754823
[0m19:25:20.754823 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.755822 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:25:20.755822 => 19:25:20.755822
[0m19:25:20.755822 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:25:20.756821 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:25:20.755822 => 19:25:20.755822
[0m19:25:20.756821 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:20.757821 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:25:20.757821 => 19:25:20.757821
[0m19:25:20.757821 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:20.758820 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.759827 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:25:20.759827 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.759827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:25:20.760794 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:25:20.760794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:25:20.762076 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.762076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:25:20.762076 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.765077 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:25:20.765077 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:25:20.768584 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:25:20.771593 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:25:20.771593 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:25:20.763076 => 19:25:20.771593
[0m19:25:20.772593 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.772593 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:25:20.766580 => 19:25:20.772593
[0m19:25:20.772593 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:25:20.772593 => 19:25:20.772593
[0m19:25:20.773593 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:25:20.769087 => 19:25:20.773593
[0m19:25:20.773593 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.774594 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:20.774594 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:25:20.775593 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:25:20.774594 => 19:25:20.774594
[0m19:25:20.775593 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.776593 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:25:20.775593 => 19:25:20.775593
[0m19:25:20.776593 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:20.777593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:25:20.777593 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:25:20.778593 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.779096 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.779599 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.779599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:25:20.783137 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:25:20.783137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:25:20.784136 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.784136 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.789643 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:25:20.789643 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:25:20.779599 => 19:25:20.789643
[0m19:25:20.792699 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:25:20.792699 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.793700 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:25:20.784136 => 19:25:20.793700
[0m19:25:20.793700 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:25:20.793700 => 19:25:20.793700
[0m19:25:20.794701 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:25:20.789643 => 19:25:20.794701
[0m19:25:20.794701 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.795699 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:20.795699 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.796698 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:25:20.795699 => 19:25:20.795699
[0m19:25:20.796698 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.797698 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:25:20.796698 => 19:25:20.796698
[0m19:25:20.797698 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:20.798699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:25:20.799206 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:20.799708 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:25:20.799708 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.800677 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.800677 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:25:20.803732 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:25:20.804732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:25:20.804732 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:25:20.805732 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.805732 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:25:20.800677 => 19:25:20.805732
[0m19:25:20.808734 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:25:20.811745 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:25:20.811745 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.812745 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:25:20.805732 => 19:25:20.812745
[0m19:25:20.812745 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:25:20.812745 => 19:25:20.812745
[0m19:25:20.812745 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:25:20.809240 => 19:25:20.812745
[0m19:25:20.813746 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:25:20.813746 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:20.814745 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.814745 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:25:20.814745 => 19:25:20.814745
[0m19:25:20.815745 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.815745 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:25:20.815745 => 19:25:20.815745
[0m19:25:20.816744 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:25:20.816744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:25:20.817747 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:20.818745 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.821756 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:25:20.821756 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:25:20.819250 => 19:25:20.821756
[0m19:25:20.822755 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.822755 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:25:20.822755 => 19:25:20.822755
[0m19:25:20.823755 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:20.824755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:20.824755 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:25:20.824755 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:25:20.825755 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:25:20.825755 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:25:20.827756 [debug] [MainThread]: Command end result
[0m19:25:20.834766 [debug] [MainThread]: Command `dbt compile` succeeded at 19:25:20.834766 after 0.61 seconds
[0m19:25:20.834766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E832F5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFF200A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E86B2A9B0>]}
[0m19:25:20.835765 [debug] [MainThread]: Flushing usage events
[0m19:25:45.786036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024456607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459902D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459902AD0>]}


============================== 19:25:45.789541 | c229fbb9-cd2a-441f-81a4-5e479f52ce34 ==============================
[0m19:25:45.789541 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:25:45.789541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:25:45.911775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452662E00>]}
[0m19:25:45.969608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452660A90>]}
[0m19:25:45.970612 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:25:45.979623 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:25:46.060743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:46.060743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:46.060743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459D93F40>]}
[0m19:25:46.076270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459C9AF20>]}
[0m19:25:46.076270 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:25:46.077275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459C9B0D0>]}
[0m19:25:46.078781 [info ] [MainThread]: 
[0m19:25:46.079787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:46.080775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:25:46.087810 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:46.087810 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:25:46.087810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:46.142783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:25:46.142783 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:25:46.143776 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:46.145746 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:25:46.146773 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:25:46.147745 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:25:46.151542 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:46.151542 [debug] [MainThread]: On master: BEGIN
[0m19:25:46.151542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:46.200610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:46.201611 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:46.201611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:46.205611 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:25:46.206610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c229fbb9-cd2a-441f-81a4-5e479f52ce34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459D3BBB0>]}
[0m19:25:46.206610 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:46.207609 [debug] [MainThread]: On master: Close
[0m19:25:46.207609 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:25:46.209117 [info ] [MainThread]: 
[0m19:25:46.210741 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:25:46.211748 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:25:46.211748 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:25:46.211748 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:25:46.212748 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:25:46.213747 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:25:46.213747 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:25:46.213747 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:25:46.214747 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:25:46.219936 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:25:46.220584 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:25:46.219936 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:25:46.220584 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:25:46.220584 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:25:46.214747 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:25:46.220584 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:25:46.220584 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:25:46.220584 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:25:46.220584 => 19:25:46.220584
[0m19:25:46.220584 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.220584 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.228596 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:25:46.228596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:25:46.229645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:25:46.229645 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.230703 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.230703 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.230703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:25:46.241262 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:25:46.247631 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:25:46.248628 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.251158 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:25:46.252165 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:25:46.230703 => 19:25:46.252165
[0m19:25:46.252165 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:25:46.241262 => 19:25:46.252165
[0m19:25:46.253166 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.253166 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:25:46.249132 => 19:25:46.253166
[0m19:25:46.253166 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.254163 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:25:46.254163 => 19:25:46.254163
[0m19:25:46.254163 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.255162 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:25:46.254163 => 19:25:46.254163
[0m19:25:46.255162 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:25:46.256165 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:25:46.256165 => 19:25:46.256165
[0m19:25:46.256165 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:25:46.257164 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.257164 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:25:46.257164 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.258667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:25:46.258667 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:25:46.260088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:25:46.260088 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.261096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:25:46.261096 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.266094 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:25:46.266094 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:25:46.268599 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:25:46.272118 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:25:46.272118 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:25:46.261096 => 19:25:46.272118
[0m19:25:46.273118 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:25:46.266094 => 19:25:46.273118
[0m19:25:46.273118 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:25:46.269605 => 19:25:46.273118
[0m19:25:46.274119 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.274119 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.274119 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:25:46.275118 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.275118 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.276117 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:25:46.275118 => 19:25:46.275118
[0m19:25:46.276117 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:25:46.277117 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:25:46.277117 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:25:46.278623 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.278623 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.279629 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:25:46.280134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:25:46.280134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:25:46.281140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:25:46.281140 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.282140 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.282140 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:25:46.285140 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:25:46.287651 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:25:46.290661 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:25:46.290661 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:25:46.282140 => 19:25:46.290661
[0m19:25:46.291665 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.291665 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:25:46.285645 => 19:25:46.291665
[0m19:25:46.292671 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:25:46.287651 => 19:25:46.291665
[0m19:25:46.292671 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:25:46.292671 => 19:25:46.292671
[0m19:25:46.292671 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.293670 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:25:46.293670 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:25:46.294670 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:25:46.294670 => 19:25:46.294670
[0m19:25:46.294670 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:25:46.294670 => 19:25:46.294670
[0m19:25:46.295701 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.295701 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:25:46.296700 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:25:46.296700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:25:46.297707 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.297707 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.298706 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.299241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:25:46.299777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:25:46.302811 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:25:46.302811 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.302811 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.308810 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:25:46.309347 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:25:46.299777 => 19:25:46.309347
[0m19:25:46.311926 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:25:46.311926 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.312924 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:25:46.303812 => 19:25:46.311926
[0m19:25:46.312924 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:25:46.312924 => 19:25:46.312924
[0m19:25:46.313895 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:25:46.309347 => 19:25:46.312924
[0m19:25:46.313895 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.314895 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:25:46.314895 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.314895 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:25:46.314895 => 19:25:46.314895
[0m19:25:46.315894 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.315894 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:25:46.315894 => 19:25:46.315894
[0m19:25:46.316894 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:25:46.316894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:25:46.317894 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:25:46.317894 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:25:46.318894 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.319399 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.319904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:25:46.322909 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:25:46.322909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:25:46.323910 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:25:46.323910 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.324910 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:25:46.319904 => 19:25:46.323910
[0m19:25:46.326941 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:25:46.330015 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:25:46.330015 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.331062 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:25:46.324910 => 19:25:46.331062
[0m19:25:46.331062 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:25:46.331062 => 19:25:46.331062
[0m19:25:46.332049 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:25:46.326941 => 19:25:46.332049
[0m19:25:46.332049 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:25:46.333049 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:25:46.333049 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.334049 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:25:46.334049 => 19:25:46.334049
[0m19:25:46.334049 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.335050 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:25:46.334049 => 19:25:46.334049
[0m19:25:46.335050 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:25:46.336049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:25:46.337051 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:25:46.337051 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.340590 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:25:46.341126 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:25:46.338050 => 19:25:46.341126
[0m19:25:46.341126 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.341126 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:25:46.341126 => 19:25:46.341126
[0m19:25:46.342161 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:25:46.343162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:46.343162 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:25:46.343162 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:25:46.344162 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:25:46.344162 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:25:46.346167 [debug] [MainThread]: Command end result
[0m19:25:46.353279 [debug] [MainThread]: Command `dbt compile` succeeded at 19:25:46.352307 after 0.61 seconds
[0m19:25:46.353279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024456607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452660A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024459EA90C0>]}
[0m19:25:46.353279 [debug] [MainThread]: Flushing usage events
[0m19:26:09.159893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D019CA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CFA2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CFA2B00>]}


============================== 19:26:09.159893 | de58b3af-ba12-4cd9-be15-2060fc471555 ==============================
[0m19:26:09.159893 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:26:09.159893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m19:26:09.294542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D12E00>]}
[0m19:26:09.351574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D10A90>]}
[0m19:26:09.352570 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:26:09.362542 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:26:09.445579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:09.445579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:09.449578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D433EB0>]}
[0m19:26:09.457571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D33AF80>]}
[0m19:26:09.458573 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:26:09.458573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D33B0D0>]}
[0m19:26:09.460574 [info ] [MainThread]: 
[0m19:26:09.461573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:26:09.462602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:26:09.469543 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:26:09.469543 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:26:09.469543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:09.531010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:26:09.532009 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:26:09.532009 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:26:09.534011 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:26:09.535009 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:26:09.536011 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:26:09.540046 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:09.540046 [debug] [MainThread]: On master: BEGIN
[0m19:26:09.540046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:09.604480 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:26:09.605483 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:09.605483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:09.608447 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:26:09.610447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de58b3af-ba12-4cd9-be15-2060fc471555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D3DBBE0>]}
[0m19:26:09.610447 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:09.610447 [debug] [MainThread]: On master: Close
[0m19:26:09.611447 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:26:09.612448 [info ] [MainThread]: 
[0m19:26:09.614447 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:26:09.614447 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:26:09.615447 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:26:09.615447 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:26:09.616447 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:26:09.616447 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:26:09.617447 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:26:09.617447 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:26:09.618447 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:26:09.622448 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:26:09.624447 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:26:09.623447 => 19:26:09.624447
[0m19:26:09.625447 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:26:09.624447 => 19:26:09.625447
[0m19:26:09.625447 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:26:09.626447 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:26:09.626447 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:26:09.618447 => 19:26:09.626447
[0m19:26:09.627451 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:26:09.626447 => 19:26:09.626447
[0m19:26:09.627451 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:26:09.627451 => 19:26:09.627451
[0m19:26:09.627451 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:26:09.628446 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:26:09.629445 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:26:09.629445 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:26:09.629445 => 19:26:09.629445
[0m19:26:09.630445 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.630445 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.631445 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:26:09.631445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:26:09.632445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:26:09.632445 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.633448 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.633448 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.633448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:26:09.643483 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:26:09.649486 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:26:09.649486 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.650487 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:26:09.634447 => 19:26:09.650487
[0m19:26:09.653485 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:26:09.653485 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:26:09.643483 => 19:26:09.653485
[0m19:26:09.654483 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.654483 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.655481 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:26:09.650487 => 19:26:09.655481
[0m19:26:09.655481 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:26:09.655481 => 19:26:09.655481
[0m19:26:09.656481 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:26:09.655481 => 19:26:09.655481
[0m19:26:09.656481 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.657476 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:26:09.657476 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:26:09.658481 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:26:09.658481 => 19:26:09.658481
[0m19:26:09.658481 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.658481 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.659483 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:26:09.660477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:26:09.660477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:26:09.660477 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:26:09.661478 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.661478 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.662483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:26:09.666483 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:26:09.669483 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:26:09.669483 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:26:09.670483 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:26:09.662483 => 19:26:09.670483
[0m19:26:09.672446 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:26:09.673446 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:26:09.666483 => 19:26:09.673446
[0m19:26:09.673446 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.674447 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.674447 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:26:09.670483 => 19:26:09.674447
[0m19:26:09.674447 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:26:09.674447 => 19:26:09.674447
[0m19:26:09.675446 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:26:09.675446 => 19:26:09.675446
[0m19:26:09.675446 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:26:09.676446 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:26:09.677446 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:26:09.677446 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:26:09.677446 => 19:26:09.677446
[0m19:26:09.677446 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.678447 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.679446 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:26:09.679446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:26:09.680446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:26:09.680446 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:26:09.680446 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.681446 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.681446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:26:09.684446 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:26:09.687447 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:26:09.687447 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:26:09.688446 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:26:09.682446 => 19:26:09.687447
[0m19:26:09.690446 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:26:09.690446 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:26:09.684446 => 19:26:09.690446
[0m19:26:09.691446 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.691446 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.692446 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:26:09.692446 => 19:26:09.692446
[0m19:26:09.692446 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:26:09.688446 => 19:26:09.692446
[0m19:26:09.692446 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:26:09.692446 => 19:26:09.692446
[0m19:26:09.693469 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:26:09.693469 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:26:09.694472 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:26:09.694472 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.695457 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:26:09.695457 => 19:26:09.695457
[0m19:26:09.695457 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.696468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:26:09.696468 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:26:09.697467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:26:09.697467 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.698454 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.698454 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.701455 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:26:09.701455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:26:09.706449 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:26:09.707447 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.707447 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:26:09.698454 => 19:26:09.707447
[0m19:26:09.710592 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:26:09.710592 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:26:09.702463 => 19:26:09.710592
[0m19:26:09.711594 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.711594 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.711594 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:26:09.707447 => 19:26:09.711594
[0m19:26:09.712871 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:26:09.711594 => 19:26:09.711594
[0m19:26:09.712871 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:26:09.712871 => 19:26:09.712871
[0m19:26:09.712871 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.713879 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:26:09.714876 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:26:09.714876 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:26:09.714876 => 19:26:09.714876
[0m19:26:09.714876 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.715875 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:26:09.715875 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:26:09.716878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:26:09.716878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:26:09.716878 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.716878 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.716878 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:26:09.716878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:26:09.716878 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:26:09.716878 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:26:09.716878 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.716878 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:26:09.716878 => 19:26:09.716878
[0m19:26:09.725699 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:26:09.725699 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:26:09.716878 => 19:26:09.725699
[0m19:26:09.725699 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.725699 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:26:09.729621 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:26:09.716878 => 19:26:09.725699
[0m19:26:09.729621 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.729621 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.729621 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.729621 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:26:09.729621 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:26:09.729621 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:26:09.729621 => 19:26:09.729621
[0m19:26:09.732819 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:26:09.733167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:26:09.733167 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:26:09.733167 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:26:09.733167 => 19:26:09.733167
[0m19:26:09.733167 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:26:09.733167 => 19:26:09.733167
[0m19:26:09.733167 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:26:09.733167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:26:09.733167 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:26:09.742729 [debug] [MainThread]: Command end result
[0m19:26:09.748736 [debug] [MainThread]: Command `dbt compile` succeeded at 19:26:09.748736 after 0.62 seconds
[0m19:26:09.749738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D019CA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D015D10A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01D5484F0>]}
[0m19:26:09.749738 [debug] [MainThread]: Flushing usage events
[0m19:27:55.309772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385AEE7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E1E2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E1E2B90>]}


============================== 19:27:55.313754 | 3af57065-a8e8-4a16-8450-7cf07e8ff4e4 ==============================
[0m19:27:55.313754 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:27:55.313754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:55.438661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023856F42E00>]}
[0m19:27:55.496183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E428880>]}
[0m19:27:55.497183 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:27:55.506193 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:27:55.587800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:55.587800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:55.592303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E66C9D0>]}
[0m19:27:55.595580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E57F3D0>]}
[0m19:27:55.595580 [info ] [MainThread]: Found 2 seeds, 13 tests, 4 models, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:27:55.602084 [info ] [MainThread]: 
[0m19:27:55.603100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:55.603100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:27:55.610754 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:27:55.610754 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:27:55.612257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:55.663880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:27:55.664880 [debug] [ThreadPool]: On list_dbt: Close
[0m19:27:55.666881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:27:55.670880 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:27:55.670880 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:27:55.671880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:55.717763 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.718763 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:27:55.718763 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:27:55.720763 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:27:55.722772 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:27:55.722772 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:27:55.726305 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.727809 [debug] [MainThread]: On master: BEGIN
[0m19:27:55.727809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:55.777248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.777248 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.778248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:55.781248 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:27:55.782752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E6BE1A0>]}
[0m19:27:55.782752 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:55.782752 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.783690 [debug] [MainThread]: On master: BEGIN
[0m19:27:55.784194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.784194 [debug] [MainThread]: On master: COMMIT
[0m19:27:55.784194 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:55.785196 [debug] [MainThread]: On master: COMMIT
[0m19:27:55.785196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:55.785196 [debug] [MainThread]: On master: Close
[0m19:27:55.786197 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:27:55.786197 [info ] [MainThread]: 
[0m19:27:55.789196 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m19:27:55.789196 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m19:27:55.789196 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.790196 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m19:27:55.790196 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m19:27:55.791197 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m19:27:55.791197 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:27:55.792197 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:27:55.793204 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m19:27:55.793204 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m19:27:55.794207 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m19:27:55.794207 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.795207 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 19:27:55.794207 => 19:27:55.794207
[0m19:27:55.795207 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 19:27:55.795207 => 19:27:55.795207
[0m19:27:55.807755 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.807755 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m19:27:55.808756 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m19:27:55.817769 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:27:55.795207 => 19:27:55.817769
[0m19:27:55.830290 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:55.830290 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:55.832792 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:55.833722 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m19:27:55.842906 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.842906 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m19:27:55.842906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:55.842906 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:27:55.842906 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:55.842906 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m19:27:55.842906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:27:55.894739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.895743 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:55.895743 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m19:27:55.925241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:55.926241 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:55.926241 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m19:27:55.928747 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:27:55.939244 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:27:55.951977 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:56.017941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m19:27:56.017941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.046793 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:56.047794 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:27:56.047794 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m19:27:56.048794 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m19:27:56.048794 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m19:27:56.052802 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m19:27:56.053806 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m19:27:56.054805 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m19:27:56.062813 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m19:27:56.063773 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m19:27:56.064276 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m19:27:56.065279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m19:27:56.065279 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m19:27:56.065279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m19:27:56.066280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.067280 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 19:27:55.808756 => 19:27:56.067280
[0m19:27:56.067280 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.068279 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.068279 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m19:27:56.069279 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 19:27:55.817769 => 19:27:56.069279
[0m19:27:56.070279 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:27:55.834226 => 19:27:56.070279
[0m19:27:56.071279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E57CD30>]}
[0m19:27:56.071279 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m19:27:56.071279 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m19:27:56.072782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E6B34F0>]}
[0m19:27:56.072279 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.28s]
[0m19:27:56.073786 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m19:27:56.074786 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m19:27:56.073786 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m19:27:56.075786 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.075786 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m19:27:56.076785 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m19:27:56.076785 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m19:27:56.077785 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:27:56.077785 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.078786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:27:56.078786 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.078786 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m19:27:56.079785 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.079785 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m19:27:56.080787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:27:56.085865 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.086864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:27:56.086864 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.086864 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.090865 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.090865 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:27:56.080787 => 19:27:56.090865
[0m19:27:56.094873 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.095875 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.096873 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:27:56.087865 => 19:27:56.095875
[0m19:27:56.097873 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.098874 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:27:56.090865 => 19:27:56.098874
[0m19:27:56.098874 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.099873 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.099873 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.101874 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.104128 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.104128 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m19:27:56.105132 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.106132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.106132 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.106132 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m19:27:56.107131 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m19:27:56.107131 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.107131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.155696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.155696 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:27:56.156697 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.157696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.158696 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:27:56.096873 => 19:27:56.158696
[0m19:27:56.158696 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m19:27:56.159696 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m19:27:56.159696 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m19:27:56.160696 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:27:56.160696 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.162201 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m19:27:56.162201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:27:56.163205 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.166224 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.166224 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:27:56.163205 => 19:27:56.166224
[0m19:27:56.167224 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.169224 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.169224 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.169224 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m19:27:56.169224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.188044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.189044 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:27:56.189044 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.190044 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.192045 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:27:56.099873 => 19:27:56.191044
[0m19:27:56.192549 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m19:27:56.192549 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m19:27:56.193052 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m19:27:56.194568 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:27:56.222122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.223127 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:27:56.223127 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.224211 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.226211 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:27:56.101874 => 19:27:56.226211
[0m19:27:56.226211 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m19:27:56.226211 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m19:27:56.227714 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m19:27:56.228719 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:27:56.228719 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m19:27:56.229719 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m19:27:56.229719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m19:27:56.230717 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:27:56.233224 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:27:56.233728 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:27:56.230717 => 19:27:56.233728
[0m19:27:56.234295 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:27:56.256318 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m19:27:56.256318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.257317 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.257317 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:27:56.258317 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m19:27:56.258317 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.258317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.260318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.261319 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:27:56.167224 => 19:27:56.261319
[0m19:27:56.261319 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m19:27:56.262318 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m19:27:56.262821 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m19:27:56.263827 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:27:56.308400 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.308400 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.309400 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m19:27:56.345822 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:27:56.349822 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.350822 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m19:27:56.350822 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.352834 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.353837 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m19:27:56.353837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.358836 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m19:27:56.359836 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.359836 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m19:27:56.360838 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.364260 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m19:27:56.367263 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m19:27:56.368263 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m19:27:56.369265 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:56.371263 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:27:56.234295 => 19:27:56.370264
[0m19:27:56.371263 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m19:27:56.372263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E8962F0>]}
[0m19:27:56.372766 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m19:27:56.373771 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:27:56.373771 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.373771 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.374770 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m19:27:56.375770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:27:56.374770 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m19:27:56.375770 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.376770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:27:56.379770 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.379770 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.382784 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.383952 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:27:56.376770 => 19:27:56.383952
[0m19:27:56.383952 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.384956 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:27:56.380770 => 19:27:56.383952
[0m19:27:56.385956 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.385956 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.387955 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.388956 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.388956 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m19:27:56.388956 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.389956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.389956 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m19:27:56.390956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.438195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.438195 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:27:56.438195 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m19:27:56.438195 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.438195 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:27:56.384956 => 19:27:56.438195
[0m19:27:56.442200 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m19:27:56.442200 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m19:27:56.443225 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m19:27:56.444215 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:27:56.463110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.463110 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:27:56.463110 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.472116 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.473126 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:27:56.386956 => 19:27:56.473126
[0m19:27:56.474182 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m19:27:56.474182 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m19:27:56.475510 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m19:27:56.476527 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:27:56.476527 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m19:27:56.477527 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m19:27:56.477527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m19:27:56.478527 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:27:56.480526 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:27:56.482030 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:27:56.478527 => 19:27:56.482030
[0m19:27:56.482030 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m19:27:56.484539 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m19:27:56.485539 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.485539 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m19:27:56.486539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.534672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.534672 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.535674 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        
    to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'
 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m19:27:56.544775 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m19:27:56.548775 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.548775 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m19:27:56.548775 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.550775 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.550775 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m19:27:56.552278 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.553752 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m19:27:56.554255 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.554255 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m19:27:56.555259 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.556259 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m19:27:56.557258 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m19:27:56.557258 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m19:27:56.559259 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:56.560258 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:27:56.482030 => 19:27:56.560258
[0m19:27:56.560258 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m19:27:56.561258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E7A4F70>]}
[0m19:27:56.561258 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m19:27:56.562763 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m19:27:56.562763 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.563768 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.563768 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.563768 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m19:27:56.564768 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m19:27:56.565768 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m19:27:56.565768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:27:56.566768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:27:56.566768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:27:56.567767 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.567767 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.567767 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.569767 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.573803 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.573803 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.573803 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:27:56.568767 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:27:56.569767 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.573803 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:27:56.573803 => 19:27:56.573803
[0m19:27:56.573803 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.583079 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.583079 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.586109 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.587110 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.588109 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.588109 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m19:27:56.589109 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.589109 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.589109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.590109 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m19:27:56.590109 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m19:27:56.591109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.591109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.640555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.640555 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:27:56.640555 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.642058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.644095 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:27:56.573803 => 19:27:56.643061
[0m19:27:56.644626 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m19:27:56.644626 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m19:27:56.645630 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m19:27:56.646631 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:27:56.646631 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.647630 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m19:27:56.647630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:27:56.648630 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.652134 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.653138 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:27:56.648630 => 19:27:56.653138
[0m19:27:56.653642 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.654645 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.655646 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.655646 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m19:27:56.656646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.672755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.672755 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:27:56.675461 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:27:56.677465 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.678465 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:27:56.583079 => 19:27:56.678465
[0m19:27:56.678465 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m19:27:56.679465 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m19:27:56.679465 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m19:27:56.680466 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:27:56.704236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.704236 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.704236 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.704236 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:27:56.586109 => 19:27:56.704236
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m19:27:56.704236 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m19:27:56.704236 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m19:27:56.712243 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:27:56.737227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.737227 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:27:56.737227 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m19:27:56.737227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.737227 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:27:56.653642 => 19:27:56.737227
[0m19:27:56.737227 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m19:27:56.742090 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m19:27:56.743096 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m19:27:56.744123 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:27:56.744303 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:27:56.745307 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m19:27:56.745307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m19:27:56.746307 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:27:56.748306 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.749306 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:27:56.746307 => 19:27:56.749306
[0m19:27:56.749306 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:27:56.760812 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.760812 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.762315 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m19:27:56.762822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.810970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.812475 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.812475 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m19:27:56.814503 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:56.817506 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.817506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m19:27:56.817506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:56.819506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m19:27:56.819506 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.819506 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m19:27:56.820507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:56.823013 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m19:27:56.825083 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m19:27:56.825083 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m19:27:56.826083 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:56.827083 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:27:56.749306 => 19:27:56.827083
[0m19:27:56.827083 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m19:27:56.828083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E8B1EA0>]}
[0m19:27:56.828083 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m19:27:56.829141 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:27:56.830141 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.830141 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.830141 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m19:27:56.831141 [info ] [Thread-2 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m19:27:56.831141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:27:56.832140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:27:56.832859 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.832859 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.835334 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.838334 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.839336 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:27:56.832859 => 19:27:56.839336
[0m19:27:56.840335 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.841839 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.841839 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:27:56.836335 => 19:27:56.841839
[0m19:27:56.842842 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.842842 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.844861 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.844861 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m19:27:56.845862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:56.845862 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.845862 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m19:27:56.846861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:56.897265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.897265 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:27:56.898267 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m19:27:56.899266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.901265 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:27:56.840335 => 19:27:56.900266
[0m19:27:56.901265 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m19:27:56.902265 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m19:27:56.902769 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m19:27:56.903773 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:27:56.926909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.926909 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:27:56.927909 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:27:56.929417 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:56.930417 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:27:56.842842 => 19:27:56.930417
[0m19:27:56.930417 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m19:27:56.931919 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m19:27:56.932923 [warn ] [Thread-2 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m19:27:56.932923 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:27:56.933934 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:27:56.934946 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m19:27:56.934946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m19:27:56.935945 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:27:56.937946 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:27:56.938945 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:27:56.935945 => 19:27:56.938945
[0m19:27:56.938945 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:27:56.941946 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m19:27:56.943135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:56.944140 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m19:27:56.944140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:27:56.993842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:56.994844 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:56.994844 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    
    date_part('year', age(current_date, birth_date))
 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m19:27:57.003529 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m19:27:57.006597 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.006597 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m19:27:57.007597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:57.009598 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.009598 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m19:27:57.010597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:57.012100 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m19:27:57.012100 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.013103 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m19:27:57.013103 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.014605 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m19:27:57.015603 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m19:27:57.015603 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m19:27:57.017602 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:57.018602 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:27:56.939945 => 19:27:57.018602
[0m19:27:57.018602 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m19:27:57.019602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af57065-a8e8-4a16-8450-7cf07e8ff4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E84B8B0>]}
[0m19:27:57.020603 [info ] [Thread-3 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m19:27:57.020603 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:27:57.022106 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.022106 [debug] [MainThread]: On master: BEGIN
[0m19:27:57.023110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:57.072696 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.073200 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.073200 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.073200 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.074203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.074203 [debug] [MainThread]: On master: Close
[0m19:27:57.075202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:57.075202 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:27:57.076203 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:27:57.077203 [info ] [MainThread]: 
[0m19:27:57.077203 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m19:27:57.079203 [debug] [MainThread]: Command end result
[0m19:27:57.085285 [info ] [MainThread]: 
[0m19:27:57.086285 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m19:27:57.086285 [info ] [MainThread]: 
[0m19:27:57.087287 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m19:27:57.087287 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m19:27:57.088287 [info ] [MainThread]: 
[0m19:27:57.088287 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m19:27:57.089287 [info ] [MainThread]: 
[0m19:27:57.089287 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m19:27:57.090288 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m19:27:57.090288 [info ] [MainThread]: 
[0m19:27:57.090288 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m19:27:57.091287 [info ] [MainThread]: 
[0m19:27:57.091287 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m19:27:57.092790 [debug] [MainThread]: Command `dbt build` succeeded at 19:27:57.092790 after 1.82 seconds
[0m19:27:57.092790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385AEE7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E428880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385E94F4F0>]}
[0m19:27:57.092790 [debug] [MainThread]: Flushing usage events
[0m19:28:50.915873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A372F42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F2B30>]}


============================== 19:28:50.918878 | ea74ddd7-828a-4d16-b197-a1f6126272a0 ==============================
[0m19:28:50.918878 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:28:50.918878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --target cloud', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:50.920875 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'integration_tests' does not have a target named 'cloud'. The valid target names for this profile are:
   - local
[0m19:28:50.921874 [debug] [MainThread]: Command `dbt compile` failed at 19:28:50.921874 after 0.05 seconds
[0m19:28:50.922879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A372F42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F1FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A3A5F3910>]}
[0m19:28:50.922879 [debug] [MainThread]: Flushing usage events
[0m19:32:55.963510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E6A34580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D32CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D32A70>]}


============================== 19:32:55.979635 | 265761cd-f7e8-41f5-828a-3e2ccee509b9 ==============================
[0m19:32:55.979635 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:32:55.980109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile --target cloud', 'send_anonymous_usage_stats': 'True'}
[0m19:32:55.980109 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'integration_tests' does not have a target named 'cloud'. The valid target names for this profile are:
   - local
[0m19:32:55.980109 [debug] [MainThread]: Command `dbt compile` failed at 19:32:55.980109 after 0.05 seconds
[0m19:32:55.980109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E6A34580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D31FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E9D33850>]}
[0m19:32:55.980109 [debug] [MainThread]: Flushing usage events
[0m19:33:24.335806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671EBE6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE2AA0>]}


============================== 19:33:24.338805 | 0851af60-d510-4684-8b83-6e77f7a0d2fc ==============================
[0m19:33:24.338805 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:24.339806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:24.342806 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m19:33:24.343806 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m19:33:24.344807 [debug] [MainThread]: Command `dbt compile` failed at 19:33:24.343806 after 0.05 seconds
[0m19:33:24.344807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671EBE6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE14B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016721EE3A90>]}
[0m19:33:24.344807 [debug] [MainThread]: Flushing usage events
[0m19:33:46.734469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EF8F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF2AA0>]}


============================== 19:33:46.737469 | a8ded509-a452-4dd5-b06a-e63918367e98 ==============================
[0m19:33:46.737469 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:46.737469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --target cloud', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:46.740473 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m19:33:46.741466 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m19:33:46.742465 [debug] [MainThread]: Command `dbt compile` failed at 19:33:46.742465 after 0.05 seconds
[0m19:33:46.742465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EF8F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF10C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F2BF1210>]}
[0m19:33:46.743466 [debug] [MainThread]: Flushing usage events
[0m19:33:54.733908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA76A4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A2CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A2A40>]}


============================== 19:33:54.736876 | c4b667de-ee54-45eb-9855-23e249063928 ==============================
[0m19:33:54.736876 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:33:54.737878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --target local', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:54.844985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA3682E30>]}
[0m19:33:54.913076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9569B0>]}
[0m19:33:54.913076 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:33:54.922076 [debug] [MainThread]: checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd, vars: {}, profile: , target: local, version: 1.7.2
[0m19:33:54.962148 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:33:54.962148 [debug] [MainThread]: previous checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd, current checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9
[0m19:33:54.963148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:33:54.963148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAABDE6E0>]}
[0m19:33:55.726902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055BD0>]}
[0m19:33:55.733902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055CF0>]}
[0m19:33:55.735071 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:33:55.735071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055D20>]}
[0m19:33:55.737076 [info ] [MainThread]: 
[0m19:33:55.738080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:55.739077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:33:55.745571 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:33:55.746077 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:33:55.746077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:55.795653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:33:55.796652 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:33:55.796652 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:33:55.799652 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:33:55.800652 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:33:55.800652 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:33:55.804687 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:55.804687 [debug] [MainThread]: On master: BEGIN
[0m19:33:55.805701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:55.851684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:33:55.852686 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:55.852686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:33:55.855688 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:33:55.857690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b667de-ee54-45eb-9855-23e249063928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB055750>]}
[0m19:33:55.857690 [debug] [MainThread]: On master: ROLLBACK
[0m19:33:55.857690 [debug] [MainThread]: On master: Close
[0m19:33:55.858688 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:33:55.858688 [info ] [MainThread]: 
[0m19:33:55.861653 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:33:55.861653 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:33:55.861653 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:33:55.862651 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:33:55.863652 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:33:55.863652 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:33:55.864653 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:33:55.864653 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:33:55.864653 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:33:55.869653 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:33:55.870650 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:33:55.869653 => 19:33:55.870650
[0m19:33:55.871653 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:33:55.871653 => 19:33:55.871653
[0m19:33:55.872652 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:33:55.873651 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:33:55.865651 => 19:33:55.872652
[0m19:33:55.873651 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:33:55.873651 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:33:55.873651 => 19:33:55.873651
[0m19:33:55.874654 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:33:55.874654 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:33:55.874654 => 19:33:55.874654
[0m19:33:55.875654 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:33:55.875654 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:33:55.875654 => 19:33:55.875654
[0m19:33:55.876654 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:33:55.876654 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.877650 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:33:55.877650 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.878653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:33:55.878653 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.879689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:33:55.879689 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.880687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:33:55.880687 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.883692 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:33:55.884683 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.889692 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:33:55.894696 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:33:55.894696 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:33:55.881691 => 19:33:55.894696
[0m19:33:55.895689 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.895689 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:33:55.884683 => 19:33:55.895689
[0m19:33:55.895689 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:33:55.890683 => 19:33:55.895689
[0m19:33:55.896655 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:33:55.896655 => 19:33:55.896655
[0m19:33:55.896655 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.897651 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.897651 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:33:55.898654 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:33:55.897651 => 19:33:55.897651
[0m19:33:55.898654 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:33:55.898654 => 19:33:55.898654
[0m19:33:55.898654 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.899650 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:33:55.900653 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:33:55.900653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:33:55.901650 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.901650 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:33:55.901650 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.902654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:33:55.902654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:33:55.907650 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:33:55.907650 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.908651 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:33:55.910682 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:33:55.911683 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:33:55.903651 => 19:33:55.911683
[0m19:33:55.913681 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:33:55.913681 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.914686 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:33:55.908651 => 19:33:55.914686
[0m19:33:55.914686 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:33:55.914686 => 19:33:55.914686
[0m19:33:55.915689 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:33:55.911683 => 19:33:55.914686
[0m19:33:55.915689 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.916687 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:33:55.916687 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:33:55.916687 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:33:55.916687 => 19:33:55.916687
[0m19:33:55.917687 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.917687 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:33:55.917687 => 19:33:55.917687
[0m19:33:55.918687 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:33:55.918687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:33:55.919691 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:33:55.919691 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.920686 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.920686 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:33:55.921689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:33:55.923688 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:33:55.924684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:33:55.924684 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.925691 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:33:55.925691 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:33:55.921689 => 19:33:55.925691
[0m19:33:55.927651 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:33:55.929654 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:33:55.930652 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.930652 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:33:55.930652 => 19:33:55.930652
[0m19:33:55.931917 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:33:55.928651 => 19:33:55.931917
[0m19:33:55.931917 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:33:55.925691 => 19:33:55.931917
[0m19:33:55.932923 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:33:55.932923 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:33:55.932923 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.933924 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.933924 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:33:55.933924 => 19:33:55.933924
[0m19:33:55.934921 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:33:55.933924 => 19:33:55.933924
[0m19:33:55.934921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:33:55.935922 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:33:55.935922 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:33:55.936924 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.936924 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.936924 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.939922 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:33:55.940925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:33:55.940925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:33:55.941921 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.941921 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:33:55.937927 => 19:33:55.941921
[0m19:33:55.941921 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.945923 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:33:55.945923 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.948923 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:33:55.948923 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:33:55.948923 => 19:33:55.948923
[0m19:33:55.949955 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:33:55.942923 => 19:33:55.949955
[0m19:33:55.950953 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:33:55.950953 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:33:55.946922 => 19:33:55.950953
[0m19:33:55.950953 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.951955 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.951955 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.951955 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:33:55.951955 => 19:33:55.951955
[0m19:33:55.952953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:33:55.952953 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:33:55.952953 => 19:33:55.952953
[0m19:33:55.953969 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:33:55.953969 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.954960 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:33:55.954960 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m19:33:55.957963 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:33:55.957963 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.957963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:33:55.958962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:33:55.959968 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:33:55.954960 => 19:33:55.958962
[0m19:33:55.959968 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m19:33:55.959968 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.959968 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.961955 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:33:55.964961 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:33:55.964961 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:33:55.964961 => 19:33:55.964961
[0m19:33:55.965955 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:33:55.966953 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 19:33:55.960955 => 19:33:55.965955
[0m19:33:55.966953 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:33:55.962954 => 19:33:55.966953
[0m19:33:55.966953 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.967956 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m19:33:55.967956 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.968961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:33:55.968961 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 19:33:55.968961 => 19:33:55.968961
[0m19:33:55.968961 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:33:55.968961 => 19:33:55.968961
[0m19:33:55.969923 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.969923 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m19:33:55.970924 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:33:55.973924 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:33:55.973924 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:33:55.970924 => 19:33:55.973924
[0m19:33:55.975236 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.975236 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:33:55.975236 => 19:33:55.975236
[0m19:33:55.976241 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:33:55.976241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:55.976241 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:33:55.977458 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:33:55.979466 [debug] [MainThread]: Command end result
[0m19:33:55.986465 [debug] [MainThread]: Command `dbt compile` succeeded at 19:33:55.986465 after 1.29 seconds
[0m19:33:55.986465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEA76A4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAA9A3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEAB1D2C20>]}
[0m19:33:55.987465 [debug] [MainThread]: Flushing usage events
[0m19:34:22.813439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7B764400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA62CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA62A40>]}


============================== 19:34:22.816441 | 4fb59d18-24c3-4d3a-b832-9a4a3c2f0961 ==============================
[0m19:34:22.816441 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:34:22.816441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m19:34:22.936574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B77712E00>]}
[0m19:34:22.993575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA1B220>]}
[0m19:34:22.994574 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:34:23.001659 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:34:23.041680 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:34:23.042687 [debug] [MainThread]: previous checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, current checksum: 4ae834636847b48384725240c2f0432b158caad36df504a4954a10903b721edd
[0m19:34:23.042687 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:34:23.043730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7ECA26E0>]}
[0m19:34:23.815203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111BD0>]}
[0m19:34:23.822203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111CF0>]}
[0m19:34:23.823203 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:34:23.823203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F111D20>]}
[0m19:34:23.825203 [info ] [MainThread]: 
[0m19:34:23.825203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:23.827203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:34:23.833203 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:23.833203 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:34:23.834203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:23.884671 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:34:23.884671 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:23.885672 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:34:23.887670 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:34:23.888670 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:34:23.889670 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:34:23.893671 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:23.893671 [debug] [MainThread]: On master: BEGIN
[0m19:34:23.893671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:23.940782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:23.941782 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:23.941782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:23.944782 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:34:23.945781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb59d18-24c3-4d3a-b832-9a4a3c2f0961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F1118A0>]}
[0m19:34:23.946782 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:23.946782 [debug] [MainThread]: On master: Close
[0m19:34:23.947783 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:34:23.947783 [info ] [MainThread]: 
[0m19:34:23.950784 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:34:23.950784 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:34:23.950784 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:34:23.951782 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:34:23.951782 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:34:23.952782 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:34:23.952782 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:34:23.953782 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:34:23.953782 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:34:23.958781 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:34:23.959782 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:34:23.958781 => 19:34:23.959782
[0m19:34:23.960782 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:34:23.959782 => 19:34:23.960782
[0m19:34:23.961782 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:34:23.961782 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:34:23.953782 => 19:34:23.961782
[0m19:34:23.962783 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:34:23.962783 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:34:23.962783 => 19:34:23.962783
[0m19:34:23.963782 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:34:23.963782 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:34:23.963782 => 19:34:23.963782
[0m19:34:23.964782 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:34:23.964782 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:34:23.964782 => 19:34:23.964782
[0m19:34:23.965782 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:34:23.965782 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.966782 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:34:23.966782 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.967782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:34:23.967782 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.968782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:34:23.968782 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.969782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:34:23.969782 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.971897 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:23.971897 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.975888 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:23.975888 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:23.975888 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:34:23.969782 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:34:23.971897 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.975888 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.975888 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.975888 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:23.975888 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:34:23.975888 => 19:34:23.975888
[0m19:34:23.975888 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:23.988379 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:23.988379 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:23.989383 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:23.990026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:34:23.990026 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:34:23.990026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:34:23.990026 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:23.990026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:34:23.990026 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:23.990026 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:23.990026 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:34:23.990026 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:24.001669 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:34:24.002674 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:24.002674 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:34:23.990026 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:24.002674 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:24.002674 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:34:24.002674 => 19:34:24.002674
[0m19:34:24.002674 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:24.002674 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.002674 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.002674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:34:24.002674 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:34:24.002674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:34:24.002674 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.002674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:34:24.002674 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.002674 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:24.002674 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:34:24.017130 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:24.019087 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:34:24.019087 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:34:24.002674 => 19:34:24.019087
[0m19:34:24.020132 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:34:24.002674 => 19:34:24.020132
[0m19:34:24.020132 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.021130 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:34:24.017130 => 19:34:24.020132
[0m19:34:24.021130 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.021130 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:34:24.021130 => 19:34:24.021130
[0m19:34:24.021130 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:34:24.022132 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:34:24.022132 => 19:34:24.022132
[0m19:34:24.023130 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:24.023130 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:34:24.023130 => 19:34:24.023130
[0m19:34:24.024129 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:24.024129 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.025129 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:34:24.025129 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.026131 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:34:24.026131 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.027130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:34:24.027130 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.027130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:34:24.028135 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.031131 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:24.031131 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.035129 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:24.037131 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:24.038137 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:34:24.028135 => 19:34:24.038137
[0m19:34:24.039125 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:34:24.031131 => 19:34:24.038137
[0m19:34:24.039125 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.039125 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.039125 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:34:24.035129 => 19:34:24.039125
[0m19:34:24.040132 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:34:24.040132 => 19:34:24.040132
[0m19:34:24.040132 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:34:24.040132 => 19:34:24.040132
[0m19:34:24.041134 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.041134 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:24.042139 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:24.042139 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:34:24.042139 => 19:34:24.042139
[0m19:34:24.043134 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.043134 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:34:24.044134 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:24.044134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:34:24.045131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:34:24.045131 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.045131 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.046132 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:34:24.046132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:34:24.049084 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:24.051085 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:34:24.051085 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.052085 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:34:24.047135 => 19:34:24.052085
[0m19:34:24.055084 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:24.055084 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:34:24.049084 => 19:34:24.055084
[0m19:34:24.056085 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.056085 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:34:24.057085 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:34:24.052085 => 19:34:24.056085
[0m19:34:24.057085 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:34:24.057085 => 19:34:24.057085
[0m19:34:24.057085 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:34:24.057085 => 19:34:24.057085
[0m19:34:24.058084 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.058084 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:24.059084 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:34:24.059084 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:34:24.059084 => 19:34:24.059084
[0m19:34:24.060084 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.061084 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:24.061084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:34:24.062084 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.064084 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:24.065085 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:34:24.062084 => 19:34:24.065085
[0m19:34:24.065085 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.066084 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:34:24.066084 => 19:34:24.066084
[0m19:34:24.066084 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:24.067084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:34:24.068085 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:34:24.070084 [debug] [MainThread]: Command end result
[0m19:34:24.077084 [debug] [MainThread]: Command `dbt compile` succeeded at 19:34:24.077084 after 1.30 seconds
[0m19:34:24.077084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7B764400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F292C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7ECCA3E0>]}
[0m19:34:24.078084 [debug] [MainThread]: Flushing usage events
[0m19:34:52.021295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E74B27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E77E1AD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E77E1AAD0>]}


============================== 19:34:52.023297 | f6b0ecec-530a-435b-b77b-6176b3f1fbd2 ==============================
[0m19:34:52.023297 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:34:52.024296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:34:52.144089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E70AA2E00>]}
[0m19:34:52.199095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7805AD10>]}
[0m19:34:52.199095 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:34:52.199095 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:34:52.285803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:52.286803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:52.290803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E782ABE20>]}
[0m19:34:52.298805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E781A6F20>]}
[0m19:34:52.298805 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:34:52.299804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E781A6F50>]}
[0m19:34:52.300804 [info ] [MainThread]: 
[0m19:34:52.301808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:52.302808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:34:52.309805 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:52.309805 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:34:52.309805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:52.362365 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.363365 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:34:52.363365 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:34:52.366365 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:34:52.367366 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:34:52.367366 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:34:52.371365 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.371365 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.372365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:52.419754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.419754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:52.420754 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b0ecec-530a-435b-b77b-6176b3f1fbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E78088FD0>]}
[0m19:34:52.420754 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:52.420754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.420754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.420754 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.420754 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.420754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:34:52.420754 [debug] [MainThread]: On master: Close
[0m19:34:52.420754 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:34:52.420754 [info ] [MainThread]: 
[0m19:34:52.420754 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.420754 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.420754 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.420754 [info ] [Thread-1 (]: 1 of 13 START test not_null_contacts_joined_with_transactions_id ............... [RUN]
[0m19:34:52.420754 [info ] [Thread-2 (]: 2 of 13 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m19:34:52.420754 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311'
[0m19:34:52.420754 [info ] [Thread-3 (]: 3 of 13 START test not_null_stg_web__transactions_id ........................... [RUN]
[0m19:34:52.434543 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m19:34:52.434543 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.435645 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m19:34:52.435645 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.445833 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.445833 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.445833 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.445833 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.445833 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:34:52.435645 => 19:34:52.445833
[0m19:34:52.445833 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.445833 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:34:52.445833 => 19:34:52.445833
[0m19:34:52.445833 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:34:52.445833 => 19:34:52.445833
[0m19:34:52.463477 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.464475 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.464475 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.466470 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.467471 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.468478 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.468478 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m19:34:52.468478 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.469471 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.469471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:34:52.469471 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m19:34:52.470473 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m19:34:52.470473 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:34:52.471473 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:34:52.519439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.519439 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:34:52.519439 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.521439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.523440 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:34:52.445833 => 19:34:52.522439
[0m19:34:52.523440 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m19:34:52.523440 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m19:34:52.524439 [info ] [Thread-1 (]: 1 of 13 PASS not_null_contacts_joined_with_transactions_id ..................... [[32mPASS[0m in 0.10s]
[0m19:34:52.525439 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:34:52.525439 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.526440 [info ] [Thread-1 (]: 4 of 13 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m19:34:52.527439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:34:52.527439 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.533442 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.534442 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:34:52.527439 => 19:34:52.533442
[0m19:34:52.534442 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.536441 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.537440 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.537440 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m19:34:52.537440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.550439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.550439 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:34:52.551439 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m19:34:52.552439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.553439 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:34:52.464475 => 19:34:52.553439
[0m19:34:52.554441 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m19:34:52.554441 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m19:34:52.555476 [info ] [Thread-2 (]: 2 of 13 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.12s]
[0m19:34:52.556458 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:34:52.556458 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.557442 [info ] [Thread-2 (]: 5 of 13 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m19:34:52.557442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:34:52.558439 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.565440 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.566441 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:34:52.558439 => 19:34:52.566441
[0m19:34:52.566441 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.568625 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.569623 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.569623 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m19:34:52.570625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.581623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.581623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:34:52.581623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.583623 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.584623 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:34:52.466470 => 19:34:52.584623
[0m19:34:52.584623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m19:34:52.585623 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m19:34:52.585623 [info ] [Thread-3 (]: 3 of 13 PASS not_null_stg_web__transactions_id ................................. [[32mPASS[0m in 0.15s]
[0m19:34:52.586632 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:34:52.586632 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.587623 [info ] [Thread-3 (]: 6 of 13 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m19:34:52.588623 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:34:52.588623 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.592624 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.593623 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:34:52.588623 => 19:34:52.593623
[0m19:34:52.593623 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.595623 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.596623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.596623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m19:34:52.596623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.614623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.614623 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:34:52.615623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:34:52.616623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.617624 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:34:52.534442 => 19:34:52.617624
[0m19:34:52.618623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m19:34:52.618623 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m19:34:52.619623 [info ] [Thread-1 (]: 4 of 13 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.09s]
[0m19:34:52.620644 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:34:52.620644 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.621625 [info ] [Thread-1 (]: 7 of 13 START test source_not_null_web_transactions_id ......................... [RUN]
[0m19:34:52.621625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:34:52.622623 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.625623 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.626623 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:34:52.622623 => 19:34:52.626623
[0m19:34:52.626623 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.628625 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.628625 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.629627 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m19:34:52.629627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.646624 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.646624 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:34:52.647623 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m19:34:52.648623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.650622 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:34:52.567617 => 19:34:52.649624
[0m19:34:52.650622 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m19:34:52.650622 [debug] [Thread-2 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m19:34:52.651625 [info ] [Thread-2 (]: 5 of 13 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.09s]
[0m19:34:52.652622 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:34:52.652622 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.653625 [info ] [Thread-2 (]: 8 of 13 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m19:34:52.653625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:34:52.654623 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.658623 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.659623 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:34:52.654623 => 19:34:52.659623
[0m19:34:52.660625 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.662624 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.662624 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.663624 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m19:34:52.663624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.679623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.679623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:34:52.680623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.681627 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.683623 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:34:52.593623 => 19:34:52.682623
[0m19:34:52.683623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m19:34:52.684623 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m19:34:52.684623 [info ] [Thread-3 (]: 6 of 13 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.10s]
[0m19:34:52.685623 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:34:52.686625 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.686625 [info ] [Thread-3 (]: 9 of 13 START test source_unique_web_transactions_id ........................... [RUN]
[0m19:34:52.687762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:34:52.687762 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.687762 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:34:52.687762 => 19:34:52.687762
[0m19:34:52.687762 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.687762 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.687762 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m19:34:52.687762 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.712880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.713875 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:34:52.713875 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m19:34:52.714878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.716879 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:34:52.626623 => 19:34:52.715881
[0m19:34:52.716879 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m19:34:52.716879 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m19:34:52.717880 [info ] [Thread-1 (]: 7 of 13 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.10s]
[0m19:34:52.718879 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:34:52.718879 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.719880 [info ] [Thread-1 (]: 10 of 13 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m19:34:52.719880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:34:52.720875 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.724893 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.725883 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:34:52.720875 => 19:34:52.725883
[0m19:34:52.725883 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.727846 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.728846 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.728846 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m19:34:52.728846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.744842 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.745842 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:34:52.745842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.747842 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.748842 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:34:52.660625 => 19:34:52.748842
[0m19:34:52.748842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m19:34:52.749842 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m19:34:52.749842 [warn ] [Thread-2 (]: 8 of 13 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m19:34:52.750842 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:34:52.750842 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.751843 [info ] [Thread-2 (]: 11 of 13 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m19:34:52.752843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:34:52.752843 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.755842 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.756842 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:34:52.752843 => 19:34:52.756842
[0m19:34:52.756842 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.758843 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.759844 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.759844 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m19:34:52.759844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:34:52.775842 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.776842 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:34:52.776842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.778847 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.779844 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:34:52.687762 => 19:34:52.779844
[0m19:34:52.780842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m19:34:52.780842 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m19:34:52.781842 [info ] [Thread-3 (]: 9 of 13 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m19:34:52.782853 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:34:52.782853 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.783845 [info ] [Thread-3 (]: 12 of 13 START test unique_stg_web__transactions_id ............................ [RUN]
[0m19:34:52.783845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:34:52.784851 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.787842 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.788842 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:34:52.784851 => 19:34:52.787842
[0m19:34:52.788842 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.790844 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.790844 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.791845 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m19:34:52.791845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:34:52.809843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.810886 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:34:52.810886 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.812877 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.813874 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:34:52.725883 => 19:34:52.813874
[0m19:34:52.813874 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m19:34:52.814883 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m19:34:52.815879 [warn ] [Thread-1 (]: 10 of 13 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m19:34:52.816877 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:34:52.816877 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.817881 [info ] [Thread-1 (]: 13 of 13 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m19:34:52.818880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:34:52.818880 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.822845 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.823845 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:34:52.818880 => 19:34:52.822845
[0m19:34:52.823845 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.825849 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.825849 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.826845 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m19:34:52.826845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:52.841845 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.841845 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:34:52.842844 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.843842 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.845843 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:34:52.757843 => 19:34:52.844842
[0m19:34:52.845843 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m19:34:52.845843 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m19:34:52.846843 [info ] [Thread-2 (]: 11 of 13 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m19:34:52.847842 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:34:52.873776 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.873776 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:34:52.873776 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.873776 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:34:52.788842 => 19:34:52.873776
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m19:34:52.873776 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m19:34:52.873776 [info ] [Thread-3 (]: 12 of 13 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m19:34:52.873776 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:34:52.899637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.899637 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m19:34:52.899637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:34:52.899637 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:34:52.823845 => 19:34:52.899637
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m19:34:52.899637 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m19:34:52.911858 [info ] [Thread-1 (]: 13 of 13 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.08s]
[0m19:34:52.911858 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:34:52.913869 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.913869 [debug] [MainThread]: On master: BEGIN
[0m19:34:52.913869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:52.962392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:34:52.962392 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.962392 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:52.962392 [debug] [MainThread]: On master: COMMIT
[0m19:34:52.962392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:34:52.962392 [debug] [MainThread]: On master: Close
[0m19:34:52.965166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:52.965166 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:34:52.965166 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m19:34:52.966018 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m19:34:52.966018 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m19:34:52.966563 [debug] [MainThread]: Command end result
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m19:34:52.966563 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m19:34:52.966563 [info ] [MainThread]: 
[0m19:34:52.966563 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m19:34:52.978528 [info ] [MainThread]: 
[0m19:34:52.978528 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m19:34:52.979601 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m19:34:52.979601 [info ] [MainThread]: 
[0m19:34:52.979601 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m19:34:52.980589 [info ] [MainThread]: 
[0m19:34:52.980589 [info ] [MainThread]: Done. PASS=11 WARN=2 ERROR=0 SKIP=0 TOTAL=13
[0m19:34:52.981581 [debug] [MainThread]: Command `dbt test` succeeded at 19:34:52.981581 after 1.00 seconds
[0m19:34:52.982570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E74B27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7805AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E783C7310>]}
[0m19:34:52.982570 [debug] [MainThread]: Flushing usage events
[0m19:35:04.040148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028195F97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928AC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928A9B0>]}


============================== 19:35:04.043355 | 3366dc73-96db-4dc2-b762-48c922ce461b ==============================
[0m19:35:04.043355 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:35:04.043355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:04.043355 [info ] [MainThread]: dbt version: 1.7.2
[0m19:35:04.043355 [info ] [MainThread]: python version: 3.10.11
[0m19:35:04.043355 [info ] [MainThread]: python path: C:\Users\Samuel\Desktop\customer360\integration_tests\venv\Scripts\python.exe
[0m19:35:04.043355 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m19:35:04.099858 [info ] [MainThread]: Using profiles dir at C:\Users\Samuel\Desktop\customer360\integration_tests
[0m19:35:04.100915 [info ] [MainThread]: Using profiles.yml file at C:\Users\Samuel\Desktop\customer360\integration_tests\profiles.yml
[0m19:35:04.101900 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Samuel\Desktop\customer360\integration_tests\dbt_project.yml
[0m19:35:04.102896 [info ] [MainThread]: adapter type: postgres
[0m19:35:04.102896 [info ] [MainThread]: adapter version: 1.7.2
[0m19:35:04.153143 [info ] [MainThread]: Configuration:
[0m19:35:04.154679 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:35:04.154679 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:35:04.154679 [info ] [MainThread]: Required dependencies:
[0m19:35:04.154679 [debug] [MainThread]: Executing "git --help"
[0m19:35:04.206583 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:35:04.207630 [debug] [MainThread]: STDERR: "b''"
[0m19:35:04.208175 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:35:04.208175 [info ] [MainThread]: Connection:
[0m19:35:04.208175 [info ] [MainThread]:   host: localhost
[0m19:35:04.208175 [info ] [MainThread]:   port: 5432
[0m19:35:04.208175 [info ] [MainThread]:   user: dbt
[0m19:35:04.208175 [info ] [MainThread]:   database: dbt
[0m19:35:04.208175 [info ] [MainThread]:   schema: public
[0m19:35:04.208175 [info ] [MainThread]:   connect_timeout: 10
[0m19:35:04.208175 [info ] [MainThread]:   role: None
[0m19:35:04.208175 [info ] [MainThread]:   search_path: None
[0m19:35:04.208175 [info ] [MainThread]:   keepalives_idle: 0
[0m19:35:04.208175 [info ] [MainThread]:   sslmode: None
[0m19:35:04.208175 [info ] [MainThread]:   sslcert: None
[0m19:35:04.208175 [info ] [MainThread]:   sslkey: None
[0m19:35:04.208175 [info ] [MainThread]:   sslrootcert: None
[0m19:35:04.208175 [info ] [MainThread]:   application_name: dbt
[0m19:35:04.208175 [info ] [MainThread]:   retries: 1
[0m19:35:04.208175 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:35:04.208175 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:35:04.208175 [debug] [MainThread]: Using postgres connection "debug"
[0m19:35:04.208175 [debug] [MainThread]: On debug: select 1 as id
[0m19:35:04.208175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:04.265512 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:35:04.266548 [debug] [MainThread]: On debug: Close
[0m19:35:04.266548 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:35:04.267512 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:35:04.268551 [debug] [MainThread]: Command `dbt debug` succeeded at 19:35:04.268551 after 0.27 seconds
[0m19:35:04.268551 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:35:04.269512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028195F97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819928A920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028199288BB0>]}
[0m19:35:04.269512 [debug] [MainThread]: Flushing usage events
[0m19:35:20.006042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A71487220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74782D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74782AD0>]}


============================== 19:35:20.009038 | e792a71b-0059-4af7-b4cf-8460096df2d1 ==============================
[0m19:35:20.009038 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:35:20.009038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:20.130150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6D512E00>]}
[0m19:35:20.184642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A749C2D10>]}
[0m19:35:20.184642 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:35:20.184642 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:35:20.272486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:20.272486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:20.276484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74C0FE20>]}
[0m19:35:20.284448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74B1AEF0>]}
[0m19:35:20.284448 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:35:20.285448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74B1AF50>]}
[0m19:35:20.286448 [info ] [MainThread]: 
[0m19:35:20.287448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:20.288448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:35:20.295448 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:35:20.295448 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:35:20.295448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:20.344978 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.345980 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:35:20.345980 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:35:20.348981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:35:20.349980 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:35:20.349980 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:35:20.354010 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.354010 [debug] [MainThread]: On master: BEGIN
[0m19:35:20.355011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:20.514760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.515760 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.515760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:20.518760 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:35:20.519760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e792a71b-0059-4af7-b4cf-8460096df2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A74BBB9D0>]}
[0m19:35:20.520760 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:20.520760 [debug] [MainThread]: On master: Close
[0m19:35:20.521760 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:35:20.521760 [info ] [MainThread]: 
[0m19:35:20.524760 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:35:20.524760 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:35:20.524760 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:35:20.525760 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:35:20.526760 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:35:20.526760 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:35:20.526760 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:35:20.527760 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:35:20.527760 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:35:20.532760 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:35:20.534760 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:35:20.532760 => 19:35:20.534760
[0m19:35:20.535760 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:35:20.534760 => 19:35:20.535760
[0m19:35:20.535760 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:35:20.536760 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:35:20.536760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:35:20.527760 => 19:35:20.536760
[0m19:35:20.536760 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:35:20.536760 => 19:35:20.536760
[0m19:35:20.537761 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:35:20.537761 => 19:35:20.537761
[0m19:35:20.537761 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:35:20.538760 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:35:20.539760 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:35:20.539760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:35:20.539760 => 19:35:20.539760
[0m19:35:20.539760 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.540760 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.540760 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:35:20.541760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:35:20.542760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:35:20.542760 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.542760 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.543760 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.543760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:35:20.553759 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:35:20.559760 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:35:20.560760 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.561760 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:35:20.544760 => 19:35:20.560760
[0m19:35:20.563760 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:35:20.564760 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:35:20.553759 => 19:35:20.563760
[0m19:35:20.564760 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.564760 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.565760 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:35:20.561760 => 19:35:20.565760
[0m19:35:20.565760 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:35:20.565760 => 19:35:20.565760
[0m19:35:20.566760 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:35:20.565760 => 19:35:20.565760
[0m19:35:20.566760 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.567760 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:35:20.567760 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:35:20.568760 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:35:20.568760 => 19:35:20.568760
[0m19:35:20.568760 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.569760 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.569760 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:35:20.570760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:35:20.570760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:35:20.571760 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:35:20.571760 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.571760 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.572760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:35:20.576760 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:35:20.579760 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:35:20.579760 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:35:20.583759 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:35:20.583759 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:35:20.572760 => 19:35:20.583759
[0m19:35:20.583759 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:35:20.577759 => 19:35:20.583759
[0m19:35:20.584760 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.584760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:35:20.580760 => 19:35:20.584760
[0m19:35:20.584760 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.585760 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:35:20.585760 => 19:35:20.585760
[0m19:35:20.585760 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:35:20.586760 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:35:20.585760 => 19:35:20.585760
[0m19:35:20.586760 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:35:20.587760 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:35:20.586760 => 19:35:20.586760
[0m19:35:20.587760 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:35:20.588760 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.588760 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:35:20.589760 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.589760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:35:20.590760 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:35:20.590760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:35:20.590760 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.591760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:35:20.591760 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.594759 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:35:20.594759 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:35:20.597759 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:35:20.599760 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:35:20.600760 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:35:20.591760 => 19:35:20.600760
[0m19:35:20.600760 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.601760 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:35:20.595760 => 19:35:20.601760
[0m19:35:20.601760 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:35:20.601760 => 19:35:20.601760
[0m19:35:20.601760 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:35:20.597759 => 19:35:20.601760
[0m19:35:20.602760 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.602760 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:35:20.603760 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:35:20.603760 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:35:20.603760 => 19:35:20.603760
[0m19:35:20.604760 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.604760 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:35:20.604760 => 19:35:20.604760
[0m19:35:20.605760 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:35:20.605760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:35:20.606760 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:35:20.606760 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.606760 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.607760 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.607760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:35:20.611343 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:35:20.611856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:35:20.611856 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.612369 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.613372 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:35:20.608760 => 19:35:20.612369
[0m19:35:20.617372 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:35:20.620372 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:35:20.620372 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.621372 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:35:20.621372 => 19:35:20.621372
[0m19:35:20.622372 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:35:20.613372 => 19:35:20.621372
[0m19:35:20.622372 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:35:20.622372 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:35:20.618372 => 19:35:20.622372
[0m19:35:20.623372 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.623372 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.624372 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.624372 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:35:20.624372 => 19:35:20.624372
[0m19:35:20.624372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:35:20.625372 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:35:20.625372 => 19:35:20.625372
[0m19:35:20.625372 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:35:20.626372 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.626372 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:35:20.627373 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:35:20.630372 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:35:20.630372 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.631372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:35:20.631372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:35:20.632372 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:35:20.627373 => 19:35:20.632372
[0m19:35:20.632372 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:35:20.632372 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.633372 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.635372 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:35:20.638372 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:35:20.638372 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:35:20.638372 => 19:35:20.638372
[0m19:35:20.639372 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:35:20.639372 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:35:20.633372 => 19:35:20.639372
[0m19:35:20.640372 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:35:20.635372 => 19:35:20.640372
[0m19:35:20.640372 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.640372 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:35:20.641372 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.641372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:35:20.642372 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:35:20.642372 => 19:35:20.642372
[0m19:35:20.642372 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:35:20.642372 => 19:35:20.642372
[0m19:35:20.642372 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.643372 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:35:20.644372 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:35:20.647372 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:35:20.647372 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:35:20.644372 => 19:35:20.647372
[0m19:35:20.648372 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.648372 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:35:20.648372 => 19:35:20.648372
[0m19:35:20.649372 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:35:20.650372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:20.650372 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:35:20.650372 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:35:20.651372 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:35:20.651372 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:35:20.653373 [debug] [MainThread]: Command end result
[0m19:35:20.655520 [debug] [MainThread]: Command `dbt compile` succeeded at 19:35:20.655520 after 0.69 seconds
[0m19:35:20.655520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A71487220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A749C2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7488C2E0>]}
[0m19:35:20.655520 [debug] [MainThread]: Flushing usage events
[0m19:36:31.445938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128F307220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292602D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292602AD0>]}


============================== 19:36:31.448950 | 1ff94688-6afa-47b5-a3b7-0492d27436bc ==============================
[0m19:36:31.448950 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:36:31.449950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:36:31.573323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128B2F2E00>]}
[0m19:36:31.631925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292842D10>]}
[0m19:36:31.632925 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:36:31.641936 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:36:31.720103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:31.720103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:31.724104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292A8FE20>]}
[0m19:36:31.731111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292996EF0>]}
[0m19:36:31.732112 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m19:36:31.732112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292996F80>]}
[0m19:36:31.734111 [info ] [MainThread]: 
[0m19:36:31.735112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:31.736111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m19:36:31.742466 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:36:31.743465 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m19:36:31.743465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:31.794093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:31.794093 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m19:36:31.794093 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:36:31.797099 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:36:31.798102 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m19:36:31.798102 [debug] [ThreadPool]: On list_dbt_public: Close
[0m19:36:31.802166 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:31.803166 [debug] [MainThread]: On master: BEGIN
[0m19:36:31.803166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:31.850215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:31.851215 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:31.851215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:31.854215 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m19:36:31.856215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff94688-6afa-47b5-a3b7-0492d27436bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292A3B9D0>]}
[0m19:36:31.856215 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:31.856215 [debug] [MainThread]: On master: Close
[0m19:36:31.857216 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m19:36:31.858185 [info ] [MainThread]: 
[0m19:36:31.860189 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m19:36:31.860189 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m19:36:31.860189 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m19:36:31.861188 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m19:36:31.862188 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m19:36:31.862188 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m19:36:31.862188 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m19:36:31.863188 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m19:36:31.863188 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m19:36:31.868196 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m19:36:31.870199 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 19:36:31.869199 => 19:36:31.870199
[0m19:36:31.871201 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 19:36:31.870199 => 19:36:31.871201
[0m19:36:31.872199 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m19:36:31.872199 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 19:36:31.864189 => 19:36:31.872199
[0m19:36:31.872199 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m19:36:31.873199 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 19:36:31.873199 => 19:36:31.873199
[0m19:36:31.873199 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m19:36:31.874199 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 19:36:31.873199 => 19:36:31.873199
[0m19:36:31.874199 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m19:36:31.875199 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 19:36:31.874199 => 19:36:31.874199
[0m19:36:31.875199 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m19:36:31.876199 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.876199 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m19:36:31.877198 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.877198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m19:36:31.878376 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.878376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m19:36:31.878376 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.879443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m19:36:31.879443 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.889387 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m19:36:31.889387 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.895389 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m19:36:31.898924 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m19:36:31.899924 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 19:36:31.880379 => 19:36:31.898924
[0m19:36:31.899924 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 19:36:31.889387 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.899924 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 19:36:31.896415 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.899924 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.899924 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m19:36:31.899924 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 19:36:31.899924 => 19:36:31.899924
[0m19:36:31.899924 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m19:36:31.899924 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.899924 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m19:36:31.899924 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.899924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m19:36:31.899924 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m19:36:31.899924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m19:36:31.907458 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.907965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m19:36:31.907965 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.913051 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m19:36:31.913051 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m19:36:31.916051 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m19:36:31.918057 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m19:36:31.919061 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 19:36:31.907965 => 19:36:31.919061
[0m19:36:31.919061 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 19:36:31.913051 => 19:36:31.919061
[0m19:36:31.920061 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.920061 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 19:36:31.916051 => 19:36:31.920061
[0m19:36:31.920061 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.921061 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 19:36:31.921061 => 19:36:31.921061
[0m19:36:31.921061 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m19:36:31.921061 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 19:36:31.921061 => 19:36:31.921061
[0m19:36:31.922060 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m19:36:31.922060 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 19:36:31.922060 => 19:36:31.922060
[0m19:36:31.923060 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m19:36:31.924061 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.924061 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m19:36:31.925060 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.925060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m19:36:31.926060 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m19:36:31.926060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m19:36:31.926060 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.927060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.contacts_joined_with_transactions)
[0m19:36:31.927564 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.930069 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m19:36:31.930069 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m19:36:31.933069 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m19:36:31.935070 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m19:36:31.936069 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 19:36:31.928067 => 19:36:31.936069
[0m19:36:31.937070 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 19:36:31.931070 => 19:36:31.936069
[0m19:36:31.937070 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.937070 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.938082 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 19:36:31.933069 => 19:36:31.937070
[0m19:36:31.938082 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 19:36:31.938082 => 19:36:31.938082
[0m19:36:31.938082 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 19:36:31.938082 => 19:36:31.938082
[0m19:36:31.939086 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m19:36:31.939086 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m19:36:31.940086 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m19:36:31.940086 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 19:36:31.940086 => 19:36:31.940086
[0m19:36:31.941086 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.941086 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.942086 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m19:36:31.942086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m19:36:31.943086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m19:36:31.943086 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.944086 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.944086 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.945086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m19:36:31.947086 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m19:36:31.953123 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m19:36:31.953123 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.956124 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m19:36:31.956124 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 19:36:31.945086 => 19:36:31.956124
[0m19:36:31.957123 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 19:36:31.948120 => 19:36:31.957123
[0m19:36:31.957123 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.958143 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 19:36:31.954124 => 19:36:31.957123
[0m19:36:31.958143 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.958143 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 19:36:31.958143 => 19:36:31.958143
[0m19:36:31.959147 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.959147 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 19:36:31.959147 => 19:36:31.959147
[0m19:36:31.960147 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m19:36:31.960147 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 19:36:31.960147 => 19:36:31.960147
[0m19:36:31.961147 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m19:36:31.961147 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.962147 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m19:36:31.962147 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m19:36:31.963147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m19:36:31.963147 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.964148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m19:36:31.964148 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.964148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m19:36:31.965148 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m19:36:31.968342 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m19:36:31.968342 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.970891 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m19:36:31.973890 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m19:36:31.973890 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 19:36:31.965148 => 19:36:31.973890
[0m19:36:31.974891 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.974891 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 19:36:31.968342 => 19:36:31.974891
[0m19:36:31.974891 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 19:36:31.970891 => 19:36:31.974891
[0m19:36:31.975891 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 19:36:31.975891 => 19:36:31.975891
[0m19:36:31.975891 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m19:36:31.975891 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.977394 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m19:36:31.977902 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 19:36:31.977394 => 19:36:31.977394
[0m19:36:31.977902 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 19:36:31.977902 => 19:36:31.977902
[0m19:36:31.977902 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.978905 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m19:36:31.979905 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m19:36:31.979905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m19:36:31.980905 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.982904 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m19:36:31.983905 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 19:36:31.980905 => 19:36:31.983905
[0m19:36:31.983905 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.984905 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 19:36:31.984905 => 19:36:31.984905
[0m19:36:31.984905 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m19:36:31.985905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:31.985905 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m19:36:31.985905 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m19:36:31.987408 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m19:36:31.987408 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m19:36:31.988931 [debug] [MainThread]: Command end result
[0m19:36:31.995433 [debug] [MainThread]: Command `dbt compile` succeeded at 19:36:31.995433 after 0.59 seconds
[0m19:36:31.996436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128F307220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021292842D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002129270C2E0>]}
[0m19:36:31.996436 [debug] [MainThread]: Flushing usage events
[0m20:22:23.486839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016336296AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339592DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339592B60>]}


============================== 20:22:23.489838 | 0d49f039-7e8f-407e-8dc6-a80bfe1c8fa5 ==============================
[0m20:22:23.489838 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:22:23.489838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --target cloud', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:22:23.492840 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m20:22:23.493839 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m20:22:23.494839 [debug] [MainThread]: Command `dbt build` failed at 20:22:23.494839 after 0.05 seconds
[0m20:22:23.494839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016336296AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339593CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016339591120>]}
[0m20:22:23.494839 [debug] [MainThread]: Flushing usage events
[0m20:23:04.034935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B335090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E632DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E632B60>]}


============================== 20:23:04.037933 | 7062cdd7-6ae0-46df-ac10-032448626b6f ==============================
[0m20:23:04.037933 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:23:04.037933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -s stg_sf__contacts', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:04.158973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E37320AC0>]}
[0m20:23:04.216933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E5E8C10>]}
[0m20:23:04.216933 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:23:04.226195 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:23:04.265191 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:23:04.266190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E86C6D0>]}
[0m20:23:05.054474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2F130>]}
[0m20:23:05.062513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2E860>]}
[0m20:23:05.062513 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:23:05.063508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2F130>]}
[0m20:23:05.064508 [info ] [MainThread]: 
[0m20:23:05.065512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:23:05.066503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:23:05.072394 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:23:05.072394 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:23:05.073534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:05.127972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:23:05.128973 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:23:05.128973 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:23:05.130972 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:23:05.131975 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:23:05.132974 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:23:05.136972 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:05.136972 [debug] [MainThread]: On master: BEGIN
[0m20:23:05.137954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:05.298642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:23:05.299679 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:05.299679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:23:05.302682 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:23:05.303642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7062cdd7-6ae0-46df-ac10-032448626b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3ECA4A30>]}
[0m20:23:05.304643 [debug] [MainThread]: On master: ROLLBACK
[0m20:23:05.304643 [debug] [MainThread]: On master: Close
[0m20:23:05.305642 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:23:05.305642 [info ] [MainThread]: 
[0m20:23:05.308095 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m20:23:05.309096 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m20:23:05.309096 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m20:23:05.314096 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m20:23:05.315096 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 20:23:05.309096 => 20:23:05.315096
[0m20:23:05.315096 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m20:23:05.315096 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 20:23:05.315096 => 20:23:05.315096
[0m20:23:05.316096 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m20:23:05.317096 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.317096 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.317096 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.318095 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m20:23:05.319096 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m20:23:05.319096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m20:23:05.319096 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.320096 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.320096 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.326096 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:23:05.329095 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:23:05.333097 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:23:05.334095 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 20:23:05.320096 => 20:23:05.334095
[0m20:23:05.334095 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:23:05.326096 => 20:23:05.334095
[0m20:23:05.335095 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.335095 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 20:23:05.330094 => 20:23:05.335095
[0m20:23:05.335095 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.336096 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 20:23:05.336096 => 20:23:05.336096
[0m20:23:05.336096 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.337096 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:23:05.336096 => 20:23:05.336096
[0m20:23:05.337096 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:23:05.338096 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 20:23:05.337096 => 20:23:05.337096
[0m20:23:05.338096 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:23:05.339095 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:23:05.340095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:05.340095 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:23:05.340095 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m20:23:05.341095 [debug] [MainThread]: Connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b' was properly closed.
[0m20:23:05.341095 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m20:23:05.342096 [debug] [MainThread]: Command end result
[0m20:23:05.348095 [debug] [MainThread]: Excluded node 'not_null_stg_sf__contacts_new_id' from results
[0m20:23:05.349095 [debug] [MainThread]: Excluded node 'relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_' from results
[0m20:23:05.349095 [debug] [MainThread]: Excluded node 'unique_stg_sf__contacts_new_id' from results
[0m20:23:05.349095 [info ] [MainThread]: Compiled node 'stg_sf__contacts' is:
with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
[0m20:23:05.351095 [debug] [MainThread]: Command `dbt compile` succeeded at 20:23:05.351095 after 1.36 seconds
[0m20:23:05.352096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B335090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E5E8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EA2D030>]}
[0m20:23:05.352096 [debug] [MainThread]: Flushing usage events
[0m20:23:56.481936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D13C66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D16F62D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D16F62AD0>]}


============================== 20:23:56.484865 | 4b0a546c-e075-4d64-ae04-271692296666 ==============================
[0m20:23:56.484865 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:23:56.484865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -s stg_sf__web__transactions.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:23:56.604992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0FC32E30>]}
[0m20:23:56.660951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1719ED10>]}
[0m20:23:56.661951 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:23:56.670951 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:23:56.749248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:56.749248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:56.753248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D173F7E20>]}
[0m20:23:56.761248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172FAEC0>]}
[0m20:23:56.761248 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:23:56.762248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0a546c-e075-4d64-ae04-271692296666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172FAC50>]}
[0m20:23:56.763248 [warn ] [MainThread]: The selection criterion 'stg_sf__web__transactions.sql' does not match any nodes
[0m20:23:56.763248 [info ] [MainThread]: 
[0m20:23:56.764248 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:56.764248 [debug] [MainThread]: Command end result
[0m20:23:56.769228 [debug] [MainThread]: Command `dbt compile` succeeded at 20:23:56.769228 after 0.33 seconds
[0m20:23:56.770227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D13C66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1706E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D172F99F0>]}
[0m20:23:56.770227 [debug] [MainThread]: Flushing usage events
[0m20:24:14.572468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DE925630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1C22CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1C22A70>]}


============================== 20:24:14.575468 | 5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc ==============================
[0m20:24:14.575468 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:14.576470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s stg_web__transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:14.700468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DA990AC0>]}
[0m20:24:14.758469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1BD8AF0>]}
[0m20:24:14.759469 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:24:14.768361 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:24:14.845341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:14.845341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:14.849345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E20B3DC0>]}
[0m20:24:14.856301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FBADD0>]}
[0m20:24:14.857302 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:24:14.857302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FBAE60>]}
[0m20:24:14.858302 [info ] [MainThread]: 
[0m20:24:14.859301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:14.860302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:24:14.867300 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:24:14.867300 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:24:14.867300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:14.922158 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:24:14.923157 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:24:14.923157 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:24:14.925157 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:24:14.926157 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:24:14.927157 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:24:14.931157 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:14.931157 [debug] [MainThread]: On master: BEGIN
[0m20:24:14.931157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:14.978158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:24:14.978158 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:14.979157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:14.982157 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:24:14.983157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e45b0cf-3cba-468f-acdf-f1b5aa0a98fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1FB92A0>]}
[0m20:24:14.983157 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:14.984157 [debug] [MainThread]: On master: Close
[0m20:24:14.984157 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:24:14.985160 [info ] [MainThread]: 
[0m20:24:14.987158 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m20:24:14.988159 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m20:24:14.988159 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m20:24:14.994158 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m20:24:14.995158 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 20:24:14.988159 => 20:24:14.995158
[0m20:24:14.995158 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m20:24:14.996158 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 20:24:14.996158 => 20:24:14.996158
[0m20:24:14.996158 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m20:24:14.997157 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:14.998159 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:14.998159 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:14.999158 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m20:24:14.999158 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m20:24:15.000157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m20:24:15.000157 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.001158 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.001158 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.009157 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:24:15.014158 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:24:15.019159 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:24:15.020158 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 20:24:15.001158 => 20:24:15.019159
[0m20:24:15.020158 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.020158 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:24:15.009157 => 20:24:15.020158
[0m20:24:15.021158 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 20:24:15.014158 => 20:24:15.021158
[0m20:24:15.021158 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 20:24:15.021158 => 20:24:15.021158
[0m20:24:15.021158 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.022157 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.023157 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:24:15.023157 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:24:15.023157 => 20:24:15.023157
[0m20:24:15.023157 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 20:24:15.023157 => 20:24:15.023157
[0m20:24:15.024157 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.024157 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:24:15.025157 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:24:15.026158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m20:24:15.026158 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.030157 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:24:15.031158 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 20:24:15.027158 => 20:24:15.031158
[0m20:24:15.031158 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.032158 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 20:24:15.032158 => 20:24:15.032158
[0m20:24:15.033158 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:24:15.033158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m20:24:15.034158 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m20:24:15.035157 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m20:24:15.035157 [debug] [MainThread]: Command end result
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'not_null_stg_web__transactions_id' from results
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_' from results
[0m20:24:15.041157 [debug] [MainThread]: Excluded node 'unique_stg_web__transactions_id' from results
[0m20:24:15.042157 [debug] [MainThread]: Excluded node 'value_above_zero_stg_web__transactions_amount' from results
[0m20:24:15.042157 [info ] [MainThread]: Compiled node 'stg_web__transactions' is:
with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
[0m20:24:15.043158 [debug] [MainThread]: Command `dbt compile` succeeded at 20:24:15.043158 after 0.51 seconds
[0m20:24:15.044160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294DE925630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E1BD8AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294E2183DC0>]}
[0m20:24:15.044160 [debug] [MainThread]: Flushing usage events
[0m20:24:41.904072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3B297040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E592C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E592A10>]}


============================== 20:24:41.907079 | bcd99f08-2681-4de2-8818-d200b5aedde4 ==============================
[0m20:24:41.907079 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:24:41.907079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s stg_web__transactions --target cloud', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:41.910077 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.spark'
[0m20:24:41.911075 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "integration_tests", target "cloud" invalid: Runtime Error
    Could not find adapter type spark!
[0m20:24:41.912076 [debug] [MainThread]: Command `dbt compile` failed at 20:24:41.912076 after 0.05 seconds
[0m20:24:41.912076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3B297040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E593A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3E5910F0>]}
[0m20:24:41.913077 [debug] [MainThread]: Flushing usage events
[0m20:40:30.590799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135F146AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362442DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362442B60>]}


============================== 20:40:30.593782 | 2c6080fe-0b10-4d84-a78b-2ae85c28f9e1 ==============================
[0m20:40:30.593782 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:40:30.594781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:30.716781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135B182E00>]}
[0m20:40:30.773779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213623F6CB0>]}
[0m20:40:30.773779 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m20:40:30.783018 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m20:40:30.820730 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:40:30.821729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213626892D0>]}
[0m20:40:31.597340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362835E40>]}
[0m20:40:31.604341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213629D7340>]}
[0m20:40:31.605341 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m20:40:31.607340 [info ] [MainThread]: 
[0m20:40:31.607340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:31.609339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:40:31.615340 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:40:31.616340 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:40:31.616340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:31.778868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:40:31.779868 [debug] [ThreadPool]: On list_dbt: Close
[0m20:40:31.781868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m20:40:31.785868 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:40:31.785868 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:40:31.785868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:31.841868 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.841868 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:40:31.842869 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:31.844908 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:40:31.845868 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:40:31.846867 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:40:31.850866 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.850866 [debug] [MainThread]: On master: BEGIN
[0m20:40:31.850866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:31.904867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.905867 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.905867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:31.908868 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:40:31.909868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362AB6800>]}
[0m20:40:31.910866 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:31.910866 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.910866 [debug] [MainThread]: On master: BEGIN
[0m20:40:31.911867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.911867 [debug] [MainThread]: On master: COMMIT
[0m20:40:31.912868 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:31.912868 [debug] [MainThread]: On master: COMMIT
[0m20:40:31.912868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:31.913868 [debug] [MainThread]: On master: Close
[0m20:40:31.913868 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m20:40:31.914867 [info ] [MainThread]: 
[0m20:40:31.916867 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m20:40:31.917867 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m20:40:31.917867 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.917867 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m20:40:31.918868 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m20:40:31.918868 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m20:40:31.919868 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m20:40:31.920868 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m20:40:31.920868 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m20:40:31.921868 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m20:40:31.921868 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m20:40:31.921868 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.922867 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 20:40:31.922867 => 20:40:31.922867
[0m20:40:31.922867 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 20:40:31.922867 => 20:40:31.922867
[0m20:40:31.928868 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.929868 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m20:40:31.929868 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m20:40:31.940868 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 20:40:31.922867 => 20:40:31.940868
[0m20:40:31.951866 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:31.951866 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:31.954868 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:31.954868 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m20:40:31.964866 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.964866 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m20:40:31.965868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:40:31.965868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:40:31.966868 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:31.966868 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m20:40:31.967868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:32.013866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.013866 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.014867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m20:40:32.019866 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m20:40:32.042867 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.042867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m20:40:32.043868 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m20:40:32.047866 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m20:40:32.056867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m20:40:32.057867 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m20:40:32.057867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.057867 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m20:40:32.058867 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.058867 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m20:40:32.059868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.060868 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 20:40:31.929868 => 20:40:32.060868
[0m20:40:32.060868 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m20:40:32.061867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136299E3E0>]}
[0m20:40:32.062868 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m20:40:32.062868 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m20:40:32.063870 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.063870 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m20:40:32.064868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m20:40:32.064868 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m20:40:32.065868 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.099866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.119869 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.169867 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.170614 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m20:40:32.170614 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m20:40:32.171620 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 20:40:32.115868 => 20:40:32.171620
[0m20:40:32.171620 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m20:40:32.172619 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.174619 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.174619 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m20:40:32.175619 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m20:40:32.175619 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.176620 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m20:40:32.177620 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m20:40:32.177620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.178619 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m20:40:32.178619 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m20:40:32.180620 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.180620 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.181620 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 20:40:31.938866 => 20:40:32.180620
[0m20:40:32.182618 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 20:40:31.955868 => 20:40:32.182618
[0m20:40:32.182618 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m20:40:32.183618 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m20:40:32.183618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213627B2290>]}
[0m20:40:32.184620 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m20:40:32.184620 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m20:40:32.186092 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m20:40:32.186092 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.26s]
[0m20:40:32.187096 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.187096 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m20:40:32.188096 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.188096 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m20:40:32.188096 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m20:40:32.189097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m20:40:32.190096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m20:40:32.190096 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.190096 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.194096 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.199095 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.199095 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 20:40:32.191097 => 20:40:32.199095
[0m20:40:32.200096 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 20:40:32.194096 => 20:40:32.200096
[0m20:40:32.200096 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.200096 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.202095 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.204096 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.205096 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.205096 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.205096 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m20:40:32.206096 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m20:40:32.206096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.206096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.256096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.257096 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m20:40:32.257096 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.258095 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.259095 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 20:40:32.201096 => 20:40:32.259095
[0m20:40:32.259095 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m20:40:32.260095 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m20:40:32.261097 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m20:40:32.261097 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m20:40:32.262096 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.262096 [info ] [Thread-2 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m20:40:32.263095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m20:40:32.263095 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.267099 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.268096 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 20:40:32.264095 => 20:40:32.268096
[0m20:40:32.268096 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.270096 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.271097 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.271600 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m20:40:32.271600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.286603 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.287603 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m20:40:32.287603 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.289607 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.290604 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 20:40:32.203095 => 20:40:32.289607
[0m20:40:32.290604 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m20:40:32.290604 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m20:40:32.291604 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m20:40:32.292603 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m20:40:32.320604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.320604 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m20:40:32.321603 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.322604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.323605 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 20:40:32.269096 => 20:40:32.323605
[0m20:40:32.323605 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m20:40:32.324603 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m20:40:32.325604 [info ] [Thread-2 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m20:40:32.325604 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m20:40:32.332605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.332605 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m20:40:32.333604 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.334604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.335605 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 20:40:32.172619 => 20:40:32.335605
[0m20:40:32.335605 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m20:40:32.336604 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m20:40:32.336604 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.27s]
[0m20:40:32.337605 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m20:40:32.337605 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m20:40:32.338604 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m20:40:32.339604 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_sf__contacts)
[0m20:40:32.339604 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m20:40:32.341603 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m20:40:32.342604 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 20:40:32.339604 => 20:40:32.342604
[0m20:40:32.342604 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m20:40:32.364603 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m20:40:32.364603 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.365604 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m20:40:32.365604 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.417487 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.418487 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.418487 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m20:40:32.426348 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:40:32.430351 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.431351 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m20:40:32.431351 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.433353 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.434353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m20:40:32.434353 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.439353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m20:40:32.439353 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.440353 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m20:40:32.440825 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.444829 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m20:40:32.447829 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m20:40:32.448829 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m20:40:32.449831 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:32.450830 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 20:40:32.343604 => 20:40:32.450830
[0m20:40:32.451829 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m20:40:32.451829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362E77F10>]}
[0m20:40:32.452830 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m20:40:32.452830 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m20:40:32.453829 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.453829 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.454830 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m20:40:32.454830 [info ] [Thread-2 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m20:40:32.455830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m20:40:32.455830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m20:40:32.456830 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.456830 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.459831 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.462830 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.462830 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 20:40:32.459831 => 20:40:32.462830
[0m20:40:32.463830 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 20:40:32.456830 => 20:40:32.463830
[0m20:40:32.463830 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.464830 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.465830 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.467830 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.468831 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.468831 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.468831 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m20:40:32.469830 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m20:40:32.469830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.469830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.519337 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.520337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m20:40:32.520337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.521337 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.522338 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 20:40:32.464830 => 20:40:32.522338
[0m20:40:32.523337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m20:40:32.523337 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m20:40:32.524337 [info ] [Thread-2 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.07s]
[0m20:40:32.525347 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m20:40:32.549337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.550337 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m20:40:32.550337 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m20:40:32.551337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.552338 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 20:40:32.466829 => 20:40:32.552338
[0m20:40:32.553336 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m20:40:32.553336 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m20:40:32.554337 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.10s]
[0m20:40:32.554337 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m20:40:32.555337 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m20:40:32.556338 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m20:40:32.557338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m20:40:32.557338 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m20:40:32.560336 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m20:40:32.560336 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 20:40:32.557338 => 20:40:32.560336
[0m20:40:32.561337 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m20:40:32.563336 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m20:40:32.564336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.564336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m20:40:32.565337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.613338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.614337 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.614337 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m20:40:32.622338 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m20:40:32.625336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.626336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m20:40:32.626336 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.628339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.629339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m20:40:32.629339 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.631339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m20:40:32.631339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.631339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m20:40:32.632338 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.634336 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m20:40:32.634336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m20:40:32.635336 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m20:40:32.636338 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:32.638339 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 20:40:32.561337 => 20:40:32.637339
[0m20:40:32.638339 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m20:40:32.639339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362E38280>]}
[0m20:40:32.639339 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m20:40:32.640337 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m20:40:32.640337 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.641337 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.641337 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.641337 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m20:40:32.642337 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m20:40:32.642337 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m20:40:32.643337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m20:40:32.643337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m20:40:32.644337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m20:40:32.644337 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.644337 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.645338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.648337 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.652339 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.654337 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.655336 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 20:40:32.649337 => 20:40:32.655336
[0m20:40:32.656337 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 20:40:32.652339 => 20:40:32.656337
[0m20:40:32.656337 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.656337 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 20:40:32.645338 => 20:40:32.656337
[0m20:40:32.657337 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.658337 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.659337 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.660338 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.663338 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.664339 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.665337 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.665337 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.665337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m20:40:32.666338 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m20:40:32.666338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m20:40:32.666338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.667337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.667337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.716339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.717337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m20:40:32.717337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:40:32.718337 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.720337 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 20:40:32.657337 => 20:40:32.719339
[0m20:40:32.720337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m20:40:32.720337 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m20:40:32.721337 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.08s]
[0m20:40:32.722338 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m20:40:32.722338 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.723338 [info ] [Thread-2 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m20:40:32.723338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m20:40:32.724338 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.727337 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.727337 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 20:40:32.724338 => 20:40:32.727337
[0m20:40:32.728337 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.730337 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.730337 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.731337 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m20:40:32.731337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.747338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.748338 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m20:40:32.748338 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.749338 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.751337 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 20:40:32.659337 => 20:40:32.750338
[0m20:40:32.751337 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m20:40:32.751337 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m20:40:32.752336 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m20:40:32.753336 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m20:40:32.777337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.778338 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m20:40:32.778338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:32.779338 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.780337 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 20:40:32.661337 => 20:40:32.780337
[0m20:40:32.781338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m20:40:32.781338 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m20:40:32.782337 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.14s]
[0m20:40:32.783339 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m20:40:32.808338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.809338 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m20:40:32.810338 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m20:40:32.811338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.812338 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 20:40:32.728337 => 20:40:32.812338
[0m20:40:32.812338 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m20:40:32.813337 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m20:40:32.813337 [info ] [Thread-2 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m20:40:32.814337 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m20:40:32.815337 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m20:40:32.815337 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m20:40:32.816337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m20:40:32.816337 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m20:40:32.818336 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.819337 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 20:40:32.816337 => 20:40:32.819337
[0m20:40:32.819337 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m20:40:32.831336 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.832337 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.832337 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m20:40:32.832337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:32.887160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.888161 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.888161 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m20:40:32.890160 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:40:32.893160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.893160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m20:40:32.893160 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.895159 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m20:40:32.895159 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.895159 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m20:40:32.896160 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.898162 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m20:40:32.900160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m20:40:32.900160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m20:40:32.900160 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:40:32.901159 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 20:40:32.820337 => 20:40:32.901159
[0m20:40:32.902160 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m20:40:32.902160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363EC9E70>]}
[0m20:40:32.903160 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m20:40:32.904167 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m20:40:32.904167 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.905161 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.905161 [info ] [Thread-2 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m20:40:32.905161 [info ] [Thread-1 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m20:40:32.906162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m20:40:32.907160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m20:40:32.907160 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.907160 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.911160 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.914162 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.915161 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 20:40:32.911160 => 20:40:32.915161
[0m20:40:32.916160 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 20:40:32.908160 => 20:40:32.915161
[0m20:40:32.916160 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:32.917160 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:32.918162 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.920161 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.921160 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.921160 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m20:40:32.921160 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:32.922162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:32.922162 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m20:40:32.923161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:32.969162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.970162 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m20:40:32.970162 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:32.972161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:32.973161 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 20:40:32.917160 => 20:40:32.973161
[0m20:40:32.973161 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m20:40:32.974162 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m20:40:32.974162 [warn ] [Thread-1 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.07s]
[0m20:40:32.975200 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m20:40:33.000161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.000161 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m20:40:33.001162 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m20:40:33.002161 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m20:40:33.003160 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 20:40:32.919161 => 20:40:33.003160
[0m20:40:33.004159 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m20:40:33.004159 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m20:40:33.005160 [info ] [Thread-2 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.10s]
[0m20:40:33.005160 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m20:40:33.006168 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m20:40:33.007185 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m20:40:33.007185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m20:40:33.008140 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m20:40:33.010169 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m20:40:33.011163 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 20:40:33.008140 => 20:40:33.011163
[0m20:40:33.011163 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m20:40:33.014160 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m20:40:33.015160 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.015160 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m20:40:33.016161 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:33.065080 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.066079 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.066079 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    id,
    gender,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    sum(amount) as total_expense
FROM "dbt"."public"."contacts_joined_with_transactions"
GROUP BY
    1,2,3
  );
  
[0m20:40:33.073350 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m20:40:33.075349 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.076349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m20:40:33.076349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:33.078350 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.079349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m20:40:33.079349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:33.081351 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m20:40:33.082351 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.082351 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m20:40:33.083351 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.084349 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m20:40:33.085349 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m20:40:33.085349 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m20:40:33.087350 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:33.088351 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 20:40:33.012162 => 20:40:33.088351
[0m20:40:33.089349 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m20:40:33.089349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6080fe-0b10-4d84-a78b-2ae85c28f9e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021363F4FF40>]}
[0m20:40:33.090350 [info ] [Thread-3 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m20:40:33.091351 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m20:40:33.092350 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.092350 [debug] [MainThread]: On master: BEGIN
[0m20:40:33.092350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:33.141350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.141350 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.142351 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.142351 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.143351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.143351 [debug] [MainThread]: On master: Close
[0m20:40:33.143351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m20:40:33.144351 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m20:40:33.145350 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m20:40:33.145350 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m20:40:33.146350 [info ] [MainThread]: 
[0m20:40:33.146350 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m20:40:33.148349 [debug] [MainThread]: Command end result
[0m20:40:33.154350 [info ] [MainThread]: 
[0m20:40:33.155350 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m20:40:33.156350 [info ] [MainThread]: 
[0m20:40:33.156350 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m20:40:33.157351 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m20:40:33.157351 [info ] [MainThread]: 
[0m20:40:33.158350 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m20:40:33.158350 [info ] [MainThread]: 
[0m20:40:33.158350 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m20:40:33.159350 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m20:40:33.159350 [info ] [MainThread]: 
[0m20:40:33.160350 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m20:40:33.160350 [info ] [MainThread]: 
[0m20:40:33.161350 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m20:40:33.161350 [debug] [MainThread]: Command `dbt build` succeeded at 20:40:33.161350 after 2.61 seconds
[0m20:40:33.162350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002135F146AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021362834CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136254DF00>]}
[0m20:40:33.162350 [debug] [MainThread]: Flushing usage events
[0m21:06:29.130254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A154DC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1580C2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1580C2BC0>]}


============================== 21:06:29.133251 | 3bc62f33-16b1-4df6-bb89-3cc2d6f0301d ==============================
[0m21:06:29.133251 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:06:29.134252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:29.255250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A150DF2E00>]}
[0m21:06:29.312251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158309DE0>]}
[0m21:06:29.313251 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:06:29.323251 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:06:29.402249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:29.402249 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:06:29.493756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15868C0D0>]}
[0m21:06:29.500756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15844B1F0>]}
[0m21:06:29.501756 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:06:29.503756 [info ] [MainThread]: 
[0m21:06:29.504294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:29.505300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:06:29.512300 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:06:29.512300 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:06:29.513300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:29.563195 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:06:29.564195 [debug] [ThreadPool]: On list_dbt: Close
[0m21:06:29.566194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:06:29.570194 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:06:29.570194 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:06:29.570194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:29.616685 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.616685 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:06:29.617685 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:06:29.619684 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:06:29.620686 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:06:29.620686 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:06:29.624684 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.625684 [debug] [MainThread]: On master: BEGIN
[0m21:06:29.625684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:29.677210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.677210 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.678211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:06:29.681210 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:06:29.682212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1586CFB50>]}
[0m21:06:29.682212 [debug] [MainThread]: On master: ROLLBACK
[0m21:06:29.683212 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.683212 [debug] [MainThread]: On master: BEGIN
[0m21:06:29.684212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.684212 [debug] [MainThread]: On master: COMMIT
[0m21:06:29.684212 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:29.685211 [debug] [MainThread]: On master: COMMIT
[0m21:06:29.685211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.685211 [debug] [MainThread]: On master: Close
[0m21:06:29.686212 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:06:29.687211 [info ] [MainThread]: 
[0m21:06:29.689212 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m21:06:29.689212 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m21:06:29.690211 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.690211 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m21:06:29.691211 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m21:06:29.691211 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m21:06:29.692211 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m21:06:29.692211 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m21:06:29.693212 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m21:06:29.693212 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m21:06:29.694212 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m21:06:29.694212 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.695211 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 21:06:29.694212 => 21:06:29.694212
[0m21:06:29.695211 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 21:06:29.695211 => 21:06:29.695211
[0m21:06:29.707210 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.708212 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m21:06:29.708212 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m21:06:29.719212 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 21:06:29.695211 => 21:06:29.719212
[0m21:06:29.730211 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.730211 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.733212 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.733212 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m21:06:29.744210 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.744210 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m21:06:29.744210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:29.745212 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:06:29.745212 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.746211 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m21:06:29.746211 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:06:29.791033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.792035 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.792035 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m21:06:29.798033 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:06:29.820033 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.820033 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m21:06:29.821033 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m21:06:29.825505 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m21:06:29.825505 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.834506 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:06:29.834506 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.835505 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:06:29.835505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m21:06:29.836506 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:06:29.838506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.838506 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 21:06:29.708212 => 21:06:29.838506
[0m21:06:29.839505 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m21:06:29.840506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1584FB820>]}
[0m21:06:29.840506 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m21:06:29.841506 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m21:06:29.841506 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.842506 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:06:29.842506 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m21:06:29.915505 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:29.941505 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.942505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m21:06:29.942505 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:06:29.942505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m21:06:29.943505 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.943505 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m21:06:29.948505 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.949505 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m21:06:29.950519 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 21:06:29.944505 => 21:06:29.949505
[0m21:06:29.950519 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m21:06:29.951506 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:29.953505 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.954505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:06:29.954505 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:06:29.955506 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:29.955506 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:06:29.956506 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m21:06:29.956506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:29.957506 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:29.957506 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:29.958505 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 21:06:29.718211 => 21:06:29.958505
[0m21:06:29.960505 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 21:06:29.734211 => 21:06:29.959505
[0m21:06:29.960505 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m21:06:29.960505 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m21:06:29.961505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1587AF0D0>]}
[0m21:06:29.962506 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m21:06:29.962506 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m21:06:29.963506 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m21:06:29.963506 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m21:06:29.964507 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.964507 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:06:29.965506 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m21:06:29.965506 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.966505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m21:06:29.966505 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m21:06:29.967505 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.967505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m21:06:29.970505 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.971505 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.975505 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.975505 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 21:06:29.967505 => 21:06:29.975505
[0m21:06:29.976505 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:29.976505 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 21:06:29.971505 => 21:06:29.976505
[0m21:06:29.978505 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.978505 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:29.980506 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.980506 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:29.981506 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m21:06:29.981506 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:29.982506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:29.982506 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m21:06:29.983505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.004505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.005505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:06:30.005505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.006505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.007505 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 21:06:29.951506 => 21:06:30.007505
[0m21:06:30.008505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m21:06:30.008505 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m21:06:30.009505 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m21:06:30.010506 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:06:30.010506 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.011506 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m21:06:30.012506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m21:06:30.012506 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.015505 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.016506 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 21:06:30.012506 => 21:06:30.016506
[0m21:06:30.016506 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.018505 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.018505 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.019505 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m21:06:30.019505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.037817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.038817 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:06:30.038817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.039817 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.041817 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 21:06:29.976505 => 21:06:30.040817
[0m21:06:30.041817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m21:06:30.041817 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m21:06:30.042817 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m21:06:30.043818 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:06:30.070817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.070817 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:06:30.071817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.072818 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.073817 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 21:06:29.978505 => 21:06:30.073817
[0m21:06:30.073817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m21:06:30.074817 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m21:06:30.075842 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.11s]
[0m21:06:30.076819 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:06:30.076819 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m21:06:30.077819 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m21:06:30.078818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m21:06:30.078818 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m21:06:30.081817 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m21:06:30.082817 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 21:06:30.078818 => 21:06:30.081817
[0m21:06:30.082817 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m21:06:30.105817 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m21:06:30.106818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.106818 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.107818 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:06:30.107818 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m21:06:30.107818 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.108817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.109818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.110818 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 21:06:30.016506 => 21:06:30.110818
[0m21:06:30.110818 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m21:06:30.111819 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m21:06:30.112323 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m21:06:30.113328 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:06:30.269254 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.269759 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.270301 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m21:06:30.277494 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:06:30.281495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.282495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m21:06:30.282495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.284495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.284495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m21:06:30.285495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.290495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:06:30.290495 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.290495 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:06:30.291495 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.295494 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m21:06:30.298493 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:06:30.299493 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m21:06:30.300494 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.301494 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 21:06:30.082817 => 21:06:30.301494
[0m21:06:30.302496 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m21:06:30.302496 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1587D3D60>]}
[0m21:06:30.303497 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.22s]
[0m21:06:30.304494 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m21:06:30.304494 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.305494 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.305494 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m21:06:30.306494 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m21:06:30.306494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m21:06:30.307495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m21:06:30.307495 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.307495 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.310493 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.314493 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.315495 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 21:06:30.308495 => 21:06:30.315495
[0m21:06:30.315495 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 21:06:30.311495 => 21:06:30.315495
[0m21:06:30.316495 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.316495 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.318493 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.319495 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.320494 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.320494 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.321494 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m21:06:30.321494 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m21:06:30.321494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.322494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.371655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.372655 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:06:30.372655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m21:06:30.373655 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.374655 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 21:06:30.316495 => 21:06:30.374655
[0m21:06:30.375655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m21:06:30.375655 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m21:06:30.376655 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m21:06:30.376655 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:06:30.402655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.402655 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:06:30.403656 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.404655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.405657 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 21:06:30.318493 => 21:06:30.405657
[0m21:06:30.405657 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m21:06:30.406657 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m21:06:30.407657 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m21:06:30.407657 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:06:30.408656 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m21:06:30.409656 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m21:06:30.409656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m21:06:30.410657 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m21:06:30.413655 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m21:06:30.414655 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 21:06:30.410657 => 21:06:30.414655
[0m21:06:30.414655 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m21:06:30.417657 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m21:06:30.418657 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.418657 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m21:06:30.418657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.469655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.470655 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.470655 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m21:06:30.478114 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m21:06:30.481113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.481113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m21:06:30.482114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.484113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.484113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m21:06:30.485114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.486114 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:06:30.486114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.487113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:06:30.487113 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.489114 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m21:06:30.490113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:06:30.490113 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m21:06:30.492114 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.493114 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 21:06:30.414655 => 21:06:30.493114
[0m21:06:30.493114 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m21:06:30.494114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15882E860>]}
[0m21:06:30.494114 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m21:06:30.495114 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m21:06:30.496114 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.496114 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.496114 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.497115 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m21:06:30.497115 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m21:06:30.498114 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m21:06:30.498114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m21:06:30.499114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m21:06:30.499114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m21:06:30.500114 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.500114 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.500114 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.504115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.510113 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.513115 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.514114 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 21:06:30.501114 => 21:06:30.514114
[0m21:06:30.514114 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 21:06:30.505115 => 21:06:30.514114
[0m21:06:30.515114 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.516115 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 21:06:30.510113 => 21:06:30.515114
[0m21:06:30.516115 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.518114 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.518114 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.520115 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.522113 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.522113 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.523114 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m21:06:30.523114 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.523114 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.524115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.524115 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m21:06:30.524115 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m21:06:30.525114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.525114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.572114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.572114 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:06:30.573113 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.574113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.575113 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 21:06:30.516115 => 21:06:30.575113
[0m21:06:30.575113 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m21:06:30.576114 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m21:06:30.576114 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m21:06:30.577114 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:06:30.577114 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.578115 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m21:06:30.579114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m21:06:30.579114 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.583115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.584113 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 21:06:30.579114 => 21:06:30.584113
[0m21:06:30.584113 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.587115 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.587115 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.588114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m21:06:30.588114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.603115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.604115 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:06:30.604115 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.605114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.606113 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 21:06:30.520115 => 21:06:30.606113
[0m21:06:30.607114 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m21:06:30.607114 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m21:06:30.608115 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m21:06:30.609114 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:06:30.635131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.635131 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:06:30.636115 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:06:30.637115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.638115 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 21:06:30.519114 => 21:06:30.638115
[0m21:06:30.639116 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m21:06:30.639116 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m21:06:30.640115 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.14s]
[0m21:06:30.641114 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:06:30.674115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.674115 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:06:30.675114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m21:06:30.676114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.677114 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 21:06:30.585114 => 21:06:30.677114
[0m21:06:30.677114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m21:06:30.678114 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m21:06:30.679115 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m21:06:30.679115 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:06:30.680115 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m21:06:30.680115 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m21:06:30.681114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m21:06:30.682114 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m21:06:30.684113 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.685113 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 21:06:30.682114 => 21:06:30.684113
[0m21:06:30.685113 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m21:06:30.696113 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.697113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.698114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m21:06:30.698114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.749114 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.750114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.750114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m21:06:30.752115 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:06:30.754113 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.755113 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m21:06:30.755113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.757115 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:06:30.757115 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.757115 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:06:30.758114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.760113 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m21:06:30.762114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:06:30.762114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m21:06:30.763114 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:06:30.764114 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 21:06:30.685113 => 21:06:30.764114
[0m21:06:30.764114 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m21:06:30.765114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158866E30>]}
[0m21:06:30.765114 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m21:06:30.766113 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m21:06:30.767114 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.767114 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.767114 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m21:06:30.768115 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m21:06:30.769115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m21:06:30.769115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m21:06:30.769115 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.770115 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.773115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.776113 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.776113 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 21:06:30.770115 => 21:06:30.776113
[0m21:06:30.777115 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.777115 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 21:06:30.773115 => 21:06:30.777115
[0m21:06:30.780114 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.780114 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.782114 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.782114 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.783115 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m21:06:30.783115 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.783115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:30.784114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m21:06:30.784114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:06:30.833113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.834113 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:06:30.834113 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m21:06:30.836114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.837115 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 21:06:30.778115 => 21:06:30.837115
[0m21:06:30.837115 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m21:06:30.838114 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m21:06:30.839114 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m21:06:30.839114 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:06:30.865113 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.865113 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:06:30.866114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:06:30.867114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:06:30.868114 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 21:06:30.781114 => 21:06:30.868114
[0m21:06:30.869114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m21:06:30.869114 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m21:06:30.870115 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m21:06:30.871115 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:06:30.871115 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m21:06:30.872115 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m21:06:30.872115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m21:06:30.873114 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m21:06:30.875113 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:06:30.876115 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 21:06:30.873114 => 21:06:30.876115
[0m21:06:30.876115 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m21:06:30.879115 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m21:06:30.880115 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.880115 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m21:06:30.881114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:06:30.929115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:06:30.930116 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.930116 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    date_part('year', age(current_date, birth_date)) AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,
   	case when category = 'Beauty' then amount else 0 end as Beauty_amount,
   	case when category = 'Books' then amount else 0 end as Books_amount,
   	case when category = 'Clothing' then amount else 0 end as Clothing_amount,
   	case when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,
   	case when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,
   	case when category = 'Sports' then amount else 0 end as Sports_amount,
    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,
   	case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m21:06:30.937915 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:06:30.940122 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.941121 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m21:06:30.941121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.944121 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.944121 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m21:06:30.945122 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:06:30.946121 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m21:06:30.947121 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.947121 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m21:06:30.948032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:06:30.949125 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m21:06:30.950128 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:06:30.950128 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m21:06:30.952129 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:06:30.953130 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 21:06:30.877115 => 21:06:30.953130
[0m21:06:30.953130 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m21:06:30.954129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc62f33-16b1-4df6-bb89-3cc2d6f0301d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15894B9A0>]}
[0m21:06:30.954129 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m21:06:30.955129 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m21:06:30.956129 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:30.957129 [debug] [MainThread]: On master: BEGIN
[0m21:06:30.957129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:31.010519 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:06:31.011519 [debug] [MainThread]: On master: COMMIT
[0m21:06:31.011519 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:31.011519 [debug] [MainThread]: On master: COMMIT
[0m21:06:31.012520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:06:31.012520 [debug] [MainThread]: On master: Close
[0m21:06:31.013519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:31.013519 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m21:06:31.013519 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:06:31.014518 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m21:06:31.015519 [info ] [MainThread]: 
[0m21:06:31.015519 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m21:06:31.017518 [debug] [MainThread]: Command end result
[0m21:06:31.024518 [info ] [MainThread]: 
[0m21:06:31.025519 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m21:06:31.025519 [info ] [MainThread]: 
[0m21:06:31.026519 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m21:06:31.026519 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:06:31.026519 [info ] [MainThread]: 
[0m21:06:31.027520 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m21:06:31.027520 [info ] [MainThread]: 
[0m21:06:31.028518 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m21:06:31.028518 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m21:06:31.028518 [info ] [MainThread]: 
[0m21:06:31.029519 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m21:06:31.030034 [info ] [MainThread]: 
[0m21:06:31.030034 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m21:06:31.031039 [debug] [MainThread]: Command `dbt build` succeeded at 21:06:31.031039 after 1.94 seconds
[0m21:06:31.032039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A154DC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158309DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158806C20>]}
[0m21:06:31.032039 [debug] [MainThread]: Flushing usage events
[0m21:12:53.110305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4CA05090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FD02E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FD02BC0>]}


============================== 21:12:53.113304 | d1820b65-2026-41f5-895f-92ff33b9e659 ==============================
[0m21:12:53.113304 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:12:53.113304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:53.233304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C489A2E00>]}
[0m21:12:53.290443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FF49DE0>]}
[0m21:12:53.291443 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:12:53.300442 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:12:53.375446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:53.376447 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:12:53.467978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C502C80D0>]}
[0m21:12:53.475980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C5008B1F0>]}
[0m21:12:53.476980 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:12:53.477980 [info ] [MainThread]: 
[0m21:12:53.478978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:53.479979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:12:53.485979 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:12:53.486979 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:12:53.486979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:53.536151 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:12:53.537150 [debug] [ThreadPool]: On list_dbt: Close
[0m21:12:53.538150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:12:53.542149 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:12:53.542149 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:12:53.543149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:53.595528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.595528 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:12:53.595528 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:12:53.598528 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:12:53.599529 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:12:53.599529 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:12:53.603879 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:53.603879 [debug] [MainThread]: On master: BEGIN
[0m21:12:53.603879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:53.654877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.654877 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:53.655877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:53.658877 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:12:53.659877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C5030FB50>]}
[0m21:12:53.660877 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:53.660877 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:53.660877 [debug] [MainThread]: On master: BEGIN
[0m21:12:53.661878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.661878 [debug] [MainThread]: On master: COMMIT
[0m21:12:53.662878 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:53.662878 [debug] [MainThread]: On master: COMMIT
[0m21:12:53.662878 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:12:53.663879 [debug] [MainThread]: On master: Close
[0m21:12:53.663879 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:12:53.664879 [info ] [MainThread]: 
[0m21:12:53.666878 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m21:12:53.666878 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m21:12:53.667878 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:12:53.667878 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m21:12:53.668878 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m21:12:53.668878 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m21:12:53.669878 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m21:12:53.669878 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m21:12:53.670879 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m21:12:53.671879 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m21:12:53.671879 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m21:12:53.672878 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:12:53.672878 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 21:12:53.672878 => 21:12:53.672878
[0m21:12:53.672878 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 21:12:53.672878 => 21:12:53.672878
[0m21:12:53.685877 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:12:53.685877 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m21:12:53.686878 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m21:12:53.697879 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 21:12:53.673878 => 21:12:53.697879
[0m21:12:53.707878 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:12:53.708878 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:12:53.711880 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:12:53.711880 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m21:12:53.722000 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:12:53.722000 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m21:12:53.723002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:53.723991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:53.723991 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:12:53.724950 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m21:12:53.724950 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:12:53.769949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.770950 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:12:53.770950 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m21:12:53.776949 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:12:53.800950 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:12:53.801949 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m21:12:53.802950 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m21:12:53.805949 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m21:12:53.814949 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:12:53.815954 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:12:53.815954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.816950 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:12:53.816950 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:12:53.817950 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m21:12:53.817950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:12:53.818950 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 21:12:53.686878 => 21:12:53.818950
[0m21:12:53.819950 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m21:12:53.819950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FFA03D0>]}
[0m21:12:53.820950 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m21:12:53.821953 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m21:12:53.821953 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:12:53.822951 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m21:12:53.822951 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:12:53.823951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m21:12:53.858949 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.906949 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:12:53.922950 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:12:53.923950 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:12:53.928234 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:12:53.929311 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m21:12:53.929754 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m21:12:53.930226 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 21:12:53.924227 => 21:12:53.930226
[0m21:12:53.931232 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:12:53.933231 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:12:53.933231 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m21:12:53.934231 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m21:12:53.935231 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:12:53.936231 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:12:53.936231 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m21:12:53.937231 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:12:53.937231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:53.937231 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:12:53.939231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:12:53.939231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:53.940738 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 21:12:53.695878 => 21:12:53.940738
[0m21:12:53.941743 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m21:12:53.941743 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 21:12:53.711880 => 21:12:53.941743
[0m21:12:53.942743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C50088070>]}
[0m21:12:53.942743 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m21:12:53.943742 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m21:12:53.944743 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m21:12:53.945742 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m21:12:53.946743 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:12:53.945742 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m21:12:53.946743 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m21:12:53.947742 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:12:53.948744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m21:12:53.948744 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:12:53.948744 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:12:53.952743 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:12:53.949743 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m21:12:53.953743 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 21:12:53.949743 => 21:12:53.953743
[0m21:12:53.954743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m21:12:53.954743 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:12:53.955743 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:12:53.956744 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:12:53.961742 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:12:53.962743 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:12:53.962743 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m21:12:53.963743 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 21:12:53.957743 => 21:12:53.962743
[0m21:12:53.963743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:53.963743 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:12:53.965744 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:12:53.966743 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:12:53.966743 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m21:12:53.967743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:53.986742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:53.987743 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:12:53.987743 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m21:12:53.988743 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:53.989744 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 21:12:53.931232 => 21:12:53.989744
[0m21:12:53.989744 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m21:12:53.990744 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m21:12:53.991743 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m21:12:53.992742 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:12:53.992742 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:12:53.992742 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m21:12:53.993743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m21:12:53.993743 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:12:53.996741 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:12:53.997742 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 21:12:53.994743 => 21:12:53.997742
[0m21:12:53.998741 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:12:53.999743 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:12:54.000742 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:12:54.000742 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m21:12:54.001742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.020743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.020743 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:12:54.021742 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m21:12:54.022743 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.023742 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 21:12:53.955743 => 21:12:54.023742
[0m21:12:54.023742 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m21:12:54.024741 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m21:12:54.024741 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m21:12:54.025741 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:12:54.055744 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.056743 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:12:54.056743 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:12:54.057744 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.058743 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 21:12:53.964743 => 21:12:54.058743
[0m21:12:54.059743 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m21:12:54.059743 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m21:12:54.060743 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.11s]
[0m21:12:54.061744 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:12:54.061744 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m21:12:54.062743 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m21:12:54.062743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m21:12:54.063743 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m21:12:54.066743 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m21:12:54.067742 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 21:12:54.063743 => 21:12:54.066743
[0m21:12:54.067742 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m21:12:54.089743 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m21:12:54.090743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.090743 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.091742 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:12:54.091742 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m21:12:54.091742 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:12:54.092742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:54.093743 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.094743 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 21:12:53.998741 => 21:12:54.094743
[0m21:12:54.094743 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m21:12:54.095744 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m21:12:54.096742 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m21:12:54.097743 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:12:54.138742 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.139742 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.139742 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m21:12:54.146748 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:12:54.150751 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.151751 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m21:12:54.151751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:12:54.153751 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.154751 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m21:12:54.154751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:12:54.159751 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:12:54.159751 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.160751 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:12:54.161271 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:12:54.164757 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m21:12:54.167757 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:12:54.167757 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m21:12:54.169770 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:12:54.170775 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 21:12:54.067742 => 21:12:54.170775
[0m21:12:54.171776 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m21:12:54.171776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C50088A00>]}
[0m21:12:54.172775 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m21:12:54.172775 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m21:12:54.174082 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:12:54.174082 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:12:54.175087 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m21:12:54.175087 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m21:12:54.176087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m21:12:54.176087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m21:12:54.177087 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:12:54.177087 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:12:54.180088 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:12:54.183086 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:12:54.184086 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 21:12:54.177087 => 21:12:54.184086
[0m21:12:54.185086 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 21:12:54.180088 => 21:12:54.184086
[0m21:12:54.185086 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:12:54.185086 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:12:54.187086 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:12:54.188087 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:12:54.189086 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:12:54.189086 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:12:54.190088 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m21:12:54.190088 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m21:12:54.191087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:54.191087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.237087 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.238087 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:12:54.238087 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m21:12:54.239087 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.241086 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 21:12:54.186088 => 21:12:54.240086
[0m21:12:54.241086 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m21:12:54.242087 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m21:12:54.242087 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m21:12:54.243087 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:12:54.268086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.268086 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:12:54.269087 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:12:54.270087 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.271087 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 21:12:54.187086 => 21:12:54.271087
[0m21:12:54.272086 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m21:12:54.272086 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m21:12:54.273087 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m21:12:54.274086 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:12:54.274086 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m21:12:54.275087 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m21:12:54.275087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m21:12:54.276087 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m21:12:54.279085 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m21:12:54.280086 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 21:12:54.276087 => 21:12:54.279085
[0m21:12:54.280086 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m21:12:54.283087 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m21:12:54.284086 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.284086 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m21:12:54.284086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:54.331087 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.331087 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.331087 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m21:12:54.338102 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m21:12:54.341102 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.341102 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m21:12:54.342103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:12:54.344102 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.344102 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m21:12:54.345101 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:12:54.346103 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:12:54.346103 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.347102 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:12:54.347102 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:12:54.349103 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m21:12:54.350102 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:12:54.350102 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m21:12:54.352101 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:12:54.353103 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 21:12:54.280086 => 21:12:54.352101
[0m21:12:54.353103 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m21:12:54.353103 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C504982B0>]}
[0m21:12:54.354103 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m21:12:54.355102 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m21:12:54.355102 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:12:54.356101 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:12:54.356101 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:12:54.356101 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m21:12:54.357101 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m21:12:54.357101 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m21:12:54.358102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m21:12:54.358102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m21:12:54.359102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m21:12:54.359102 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:12:54.359102 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:12:54.360101 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:12:54.364100 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:12:54.369103 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:12:54.372103 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:12:54.373102 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 21:12:54.360101 => 21:12:54.372103
[0m21:12:54.373102 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:12:54.373102 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 21:12:54.364100 => 21:12:54.373102
[0m21:12:54.374102 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 21:12:54.369103 => 21:12:54.374102
[0m21:12:54.376102 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:12:54.376102 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:12:54.376102 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:12:54.378101 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:12:54.380102 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:12:54.380102 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:12:54.381101 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:12:54.381101 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m21:12:54.381101 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m21:12:54.382102 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:12:54.382102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.382102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:54.383102 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m21:12:54.383102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:54.437100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.437100 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:12:54.437100 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m21:12:54.438100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.439100 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 21:12:54.374102 => 21:12:54.439100
[0m21:12:54.440100 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m21:12:54.440100 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m21:12:54.441100 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m21:12:54.442101 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:12:54.442101 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:12:54.443102 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m21:12:54.443102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m21:12:54.444101 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:12:54.447102 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:12:54.448101 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 21:12:54.444101 => 21:12:54.448101
[0m21:12:54.448101 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:12:54.451101 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:12:54.451101 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:12:54.452101 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m21:12:54.452101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.474100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.474100 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:12:54.475101 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:12:54.476101 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.477102 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 21:12:54.377102 => 21:12:54.477102
[0m21:12:54.478102 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m21:12:54.478102 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m21:12:54.479102 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.12s]
[0m21:12:54.479102 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:12:54.508102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.508102 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:12:54.509102 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:12:54.510101 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.511102 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 21:12:54.378101 => 21:12:54.511102
[0m21:12:54.512102 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m21:12:54.512102 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m21:12:54.513102 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.15s]
[0m21:12:54.514102 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:12:54.538502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.539503 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:12:54.539503 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m21:12:54.540502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.542504 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 21:12:54.448101 => 21:12:54.541503
[0m21:12:54.542504 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m21:12:54.543503 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m21:12:54.543503 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m21:12:54.544503 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:12:54.545503 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m21:12:54.545503 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m21:12:54.546504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m21:12:54.546504 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m21:12:54.549503 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.550502 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 21:12:54.546504 => 21:12:54.549503
[0m21:12:54.550502 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m21:12:54.562504 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.563505 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.563505 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m21:12:54.564503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:54.731731 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.732733 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.732733 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m21:12:54.734691 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:12:54.737692 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.737692 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m21:12:54.738691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:12:54.739693 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:12:54.739693 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.739693 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:12:54.740692 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:12:54.742691 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m21:12:54.744690 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:12:54.745690 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m21:12:54.745690 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:12:54.746691 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 21:12:54.550502 => 21:12:54.746691
[0m21:12:54.746691 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m21:12:54.747691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C504A8EB0>]}
[0m21:12:54.748691 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.20s]
[0m21:12:54.748691 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m21:12:54.749691 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:12:54.749691 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:12:54.750692 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m21:12:54.750692 [info ] [Thread-2 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m21:12:54.751691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m21:12:54.751691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m21:12:54.752692 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:12:54.752692 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:12:54.755690 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:12:54.758692 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:12:54.759693 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 21:12:54.752692 => 21:12:54.758692
[0m21:12:54.759693 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 21:12:54.755690 => 21:12:54.759693
[0m21:12:54.759693 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:12:54.760691 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:12:54.762691 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:12:54.764692 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:12:54.765691 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:12:54.765691 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m21:12:54.765691 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:12:54.766691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:54.766691 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m21:12:54.766691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:12:54.815692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.815692 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:12:54.815692 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m21:12:54.817691 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.819691 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 21:12:54.760691 => 21:12:54.818692
[0m21:12:54.819691 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m21:12:54.820692 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m21:12:54.820692 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m21:12:54.822691 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:12:54.849691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.849691 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:12:54.850691 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:12:54.851690 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:12:54.852692 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 21:12:54.763690 => 21:12:54.852692
[0m21:12:54.853693 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m21:12:54.853693 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m21:12:54.854692 [warn ] [Thread-2 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m21:12:54.855693 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:12:54.856693 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m21:12:54.856693 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m21:12:54.857692 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m21:12:54.857692 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m21:12:54.860693 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:12:54.860693 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 21:12:54.858691 => 21:12:54.860693
[0m21:12:54.861692 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m21:12:54.863690 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m21:12:54.864690 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:12:54.864690 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m21:12:54.865690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:12:54.914690 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.914690 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:12:54.915690 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    age_in_years(birth_date) AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,
   	case when category = 'Beauty' then amount else 0 end as Beauty_amount,
   	case when category = 'Books' then amount else 0 end as Books_amount,
   	case when category = 'Clothing' then amount else 0 end as Clothing_amount,
   	case when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,
   	case when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,
   	case when category = 'Sports' then amount else 0 end as Sports_amount,
    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,
   	case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m21:12:54.916690 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function age_in_years(date) does not exist
LINE 18:     age_in_years(birth_date) AS age,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:12:54.916690 [debug] [Thread-3 (]: On model.customer360.customers: ROLLBACK
[0m21:12:54.917691 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 21:12:54.861692 => 21:12:54.917691
[0m21:12:54.917691 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m21:12:54.920691 [debug] [Thread-3 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  function age_in_years(date) does not exist
  LINE 18:     age_in_years(birth_date) AS age,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m21:12:54.920691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1820b65-2026-41f5-895f-92ff33b9e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C5058E620>]}
[0m21:12:54.921692 [error] [Thread-3 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.06s]
[0m21:12:54.922198 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m21:12:54.923209 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:54.923209 [debug] [MainThread]: On master: BEGIN
[0m21:12:54.924254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:54.972203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:12:54.972203 [debug] [MainThread]: On master: COMMIT
[0m21:12:54.972203 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:54.973204 [debug] [MainThread]: On master: COMMIT
[0m21:12:54.973204 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:12:54.974202 [debug] [MainThread]: On master: Close
[0m21:12:54.974202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:54.975203 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m21:12:54.975203 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:12:54.975203 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m21:12:54.976356 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m21:12:54.976356 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:12:54.976356 [info ] [MainThread]: 
[0m21:12:54.977359 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m21:12:54.979360 [debug] [MainThread]: Command end result
[0m21:12:54.985359 [info ] [MainThread]: 
[0m21:12:54.985359 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m21:12:54.986360 [info ] [MainThread]: 
[0m21:12:54.986360 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  function age_in_years(date) does not exist
  LINE 18:     age_in_years(birth_date) AS age,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m21:12:54.987359 [info ] [MainThread]: 
[0m21:12:54.987359 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m21:12:54.988359 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:12:54.988359 [info ] [MainThread]: 
[0m21:12:54.989360 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m21:12:54.989360 [info ] [MainThread]: 
[0m21:12:54.989360 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m21:12:54.990361 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m21:12:54.990361 [info ] [MainThread]: 
[0m21:12:54.990361 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m21:12:54.991361 [info ] [MainThread]: 
[0m21:12:54.991361 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m21:12:54.992360 [debug] [MainThread]: Command `dbt build` failed at 21:12:54.992360 after 1.92 seconds
[0m21:12:54.993359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4CA05090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4FF49DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C5033EE90>]}
[0m21:12:54.993359 [debug] [MainThread]: Flushing usage events
[0m21:14:24.782914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020095E47220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020099152E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020099152B90>]}


============================== 21:14:24.785916 | de22bb26-b9c6-4981-ac0f-eb5527cbdc7e ==============================
[0m21:14:24.785916 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:14:24.786914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:14:24.906913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020091DD2E00>]}
[0m21:14:24.964915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200993991E0>]}
[0m21:14:24.965915 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:14:24.975626 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:14:25.052626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:25.053626 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:14:25.146777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002009975C0D0>]}
[0m21:14:25.154745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200994DB1C0>]}
[0m21:14:25.155745 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:14:25.156787 [info ] [MainThread]: 
[0m21:14:25.157792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:25.159342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:14:25.166346 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:14:25.167347 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:14:25.167347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:25.218958 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:14:25.219958 [debug] [ThreadPool]: On list_dbt: Close
[0m21:14:25.220956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:14:25.224956 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:14:25.225956 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:14:25.225956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:25.270312 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.271312 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:14:25.271312 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:14:25.273312 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:14:25.274313 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:14:25.275312 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:14:25.279310 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:25.279310 [debug] [MainThread]: On master: BEGIN
[0m21:14:25.280310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:25.328312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.329311 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:25.329311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:25.332311 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:14:25.333310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002009971A380>]}
[0m21:14:25.334310 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:25.334310 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:25.334310 [debug] [MainThread]: On master: BEGIN
[0m21:14:25.335310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.335310 [debug] [MainThread]: On master: COMMIT
[0m21:14:25.336310 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:25.336310 [debug] [MainThread]: On master: COMMIT
[0m21:14:25.336310 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:25.336310 [debug] [MainThread]: On master: Close
[0m21:14:25.337310 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:14:25.338311 [info ] [MainThread]: 
[0m21:14:25.340311 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m21:14:25.340311 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m21:14:25.340311 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:14:25.341311 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m21:14:25.341311 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m21:14:25.342311 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m21:14:25.342311 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m21:14:25.343311 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m21:14:25.343311 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m21:14:25.344312 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m21:14:25.344312 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m21:14:25.344312 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 21:14:25.344312 => 21:14:25.344312
[0m21:14:25.345312 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:14:25.345312 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 21:14:25.345312 => 21:14:25.345312
[0m21:14:25.345312 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m21:14:25.357310 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:14:25.358310 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m21:14:25.378310 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:14:25.379310 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 21:14:25.346311 => 21:14:25.379310
[0m21:14:25.380311 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m21:14:25.383310 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:14:25.383310 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:14:25.383310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:14:25.384311 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m21:14:25.393310 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:14:25.394310 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:14:25.395312 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:14:25.395312 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m21:14:25.396312 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:14:25.439310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.439310 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:14:25.440310 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m21:14:25.446310 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:14:25.468310 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:14:25.468310 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m21:14:25.469310 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m21:14:25.473311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m21:14:25.482310 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:14:25.482310 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.483310 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:14:25.483310 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:14:25.483310 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:14:25.484311 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m21:14:25.485310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:25.487311 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 21:14:25.358310 => 21:14:25.486311
[0m21:14:25.487311 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m21:14:25.488311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002009934F2B0>]}
[0m21:14:25.488311 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m21:14:25.489311 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m21:14:25.489311 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:14:25.490313 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:14:25.490313 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m21:14:25.529311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.575310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m21:14:25.590311 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:14:25.590311 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:14:25.590311 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:14:25.591311 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m21:14:25.591311 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m21:14:25.596310 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:14:25.597311 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 21:14:25.592312 => 21:14:25.597311
[0m21:14:25.598312 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:14:25.599312 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:14:25.600313 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m21:14:25.600313 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m21:14:25.601311 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:14:25.601311 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m21:14:25.601311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:25.603312 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:14:25.603312 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:14:25.603312 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:14:25.605312 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.605312 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:25.607310 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 21:14:25.384311 => 21:14:25.606311
[0m21:14:25.607310 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 21:14:25.369311 => 21:14:25.607310
[0m21:14:25.608312 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m21:14:25.608312 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m21:14:25.609312 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m21:14:25.609312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020099290760>]}
[0m21:14:25.610311 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m21:14:25.611312 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:14:25.610311 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m21:14:25.611312 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:14:25.612311 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m21:14:25.612311 [info ] [Thread-3 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m21:14:25.613311 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:14:25.613311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m21:14:25.614311 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:14:25.614311 [info ] [Thread-2 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m21:14:25.617310 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:14:25.618312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m21:14:25.618312 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:14:25.623313 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:14:25.623313 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 21:14:25.614311 => 21:14:25.623313
[0m21:14:25.624312 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:14:25.624312 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 21:14:25.618312 => 21:14:25.624312
[0m21:14:25.626311 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:14:25.626311 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:14:25.628311 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:14:25.629311 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:14:25.629311 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m21:14:25.630311 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:14:25.630311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:25.630311 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m21:14:25.631311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:25.649312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.650313 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:14:25.650313 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m21:14:25.651310 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.653312 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 21:14:25.598312 => 21:14:25.652312
[0m21:14:25.653312 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m21:14:25.654311 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m21:14:25.654311 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m21:14:25.655313 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:14:25.656311 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:14:25.656311 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m21:14:25.657312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m21:14:25.657312 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:14:25.660310 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:14:25.661311 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 21:14:25.657312 => 21:14:25.661311
[0m21:14:25.661311 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:14:25.663311 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:14:25.663311 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:14:25.664311 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m21:14:25.664311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:25.681311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.681311 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:14:25.682312 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m21:14:25.683311 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.684313 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 21:14:25.624312 => 21:14:25.684313
[0m21:14:25.684313 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m21:14:25.685312 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m21:14:25.685312 [info ] [Thread-3 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m21:14:25.686311 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:14:25.711224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.712224 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:14:25.712224 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:25.713223 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.714225 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 21:14:25.627311 => 21:14:25.714225
[0m21:14:25.715226 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m21:14:25.715226 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m21:14:25.716226 [warn ] [Thread-2 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m21:14:25.717225 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:14:25.717225 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m21:14:25.718225 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m21:14:25.718225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m21:14:25.719224 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m21:14:25.722223 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m21:14:25.723224 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 21:14:25.719224 => 21:14:25.723224
[0m21:14:25.723224 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m21:14:25.744224 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m21:14:25.745228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.746225 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:14:25.746225 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:25.746225 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.747226 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m21:14:25.747226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:25.748225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.749226 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 21:14:25.661311 => 21:14:25.749226
[0m21:14:25.749226 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m21:14:25.750225 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m21:14:25.750225 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m21:14:25.751225 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:14:25.794225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.795225 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.795225 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m21:14:25.802421 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:14:25.807422 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.807422 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m21:14:25.808422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:25.810422 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.810422 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m21:14:25.811422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:25.815422 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:14:25.816422 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.816422 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:14:25.817454 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:25.821458 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m21:14:25.824458 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:14:25.824458 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m21:14:25.825967 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:14:25.826972 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 21:14:25.723224 => 21:14:25.826972
[0m21:14:25.827972 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m21:14:25.827972 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200998BBF40>]}
[0m21:14:25.828971 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m21:14:25.828971 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m21:14:25.830000 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:14:25.830000 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:14:25.831004 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m21:14:25.831004 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m21:14:25.832004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m21:14:25.832004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m21:14:25.833005 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:14:25.833005 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:14:25.836003 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:14:25.839005 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:14:25.840004 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 21:14:25.833005 => 21:14:25.840004
[0m21:14:25.840004 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 21:14:25.836003 => 21:14:25.840004
[0m21:14:25.840004 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:14:25.841004 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:14:25.843004 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:14:25.844005 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:14:25.845005 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:14:25.845005 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:14:25.846005 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m21:14:25.846005 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m21:14:25.846005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:25.847004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:25.893004 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.893004 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:14:25.894004 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m21:14:25.895004 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.896004 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 21:14:25.841004 => 21:14:25.896004
[0m21:14:25.896004 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m21:14:25.897003 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m21:14:25.897003 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.06s]
[0m21:14:25.898004 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:14:25.924964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.924964 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:14:25.925971 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:25.927009 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:25.928013 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 21:14:25.843004 => 21:14:25.928013
[0m21:14:25.928013 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m21:14:25.929010 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m21:14:25.929010 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m21:14:25.930008 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:14:25.930969 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m21:14:25.930969 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m21:14:25.931970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m21:14:25.931970 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m21:14:25.935968 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m21:14:25.935968 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 21:14:25.931970 => 21:14:25.935968
[0m21:14:25.936968 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m21:14:25.939968 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m21:14:25.939968 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:25.939968 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m21:14:25.940968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:25.988968 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:25.988968 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:25.989969 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m21:14:25.996836 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m21:14:25.999845 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:25.999845 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m21:14:26.000846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:26.002845 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:26.002845 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m21:14:26.003843 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:26.004845 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:14:26.005845 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:26.005845 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:14:26.006639 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:26.008643 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m21:14:26.009643 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:14:26.009643 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m21:14:26.010644 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:14:26.011645 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 21:14:25.936968 => 21:14:26.011645
[0m21:14:26.012643 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m21:14:26.012643 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020099928130>]}
[0m21:14:26.013644 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m21:14:26.013644 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m21:14:26.014855 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:14:26.014855 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:14:26.015859 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:14:26.015859 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m21:14:26.016859 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m21:14:26.016859 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m21:14:26.016859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m21:14:26.017860 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m21:14:26.017860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m21:14:26.018860 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:14:26.018860 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:14:26.019860 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:14:26.022860 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:14:26.027859 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:14:26.030860 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:14:26.031859 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 21:14:26.019860 => 21:14:26.030860
[0m21:14:26.031859 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 21:14:26.022860 => 21:14:26.031859
[0m21:14:26.031859 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:14:26.032858 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 21:14:26.027859 => 21:14:26.031859
[0m21:14:26.032858 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:14:26.034860 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:14:26.034860 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:14:26.035860 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:14:26.037859 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:14:26.038859 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:14:26.038859 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:14:26.039859 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m21:14:26.039859 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:14:26.039859 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m21:14:26.040860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:26.040860 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m21:14:26.041859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:26.041859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:26.088859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.089860 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:14:26.089860 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m21:14:26.090859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.091860 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 21:14:26.032858 => 21:14:26.091860
[0m21:14:26.092859 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m21:14:26.092859 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m21:14:26.093860 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m21:14:26.094859 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:14:26.094859 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:14:26.095860 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m21:14:26.095860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m21:14:26.096859 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:14:26.100859 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:14:26.101859 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 21:14:26.096859 => 21:14:26.100859
[0m21:14:26.101859 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:14:26.103860 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:14:26.103860 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:14:26.104860 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m21:14:26.104860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:26.120859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.120859 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:14:26.121859 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:14:26.122861 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.123861 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 21:14:26.034860 => 21:14:26.123861
[0m21:14:26.123861 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m21:14:26.124861 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m21:14:26.125859 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m21:14:26.125859 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:14:26.151844 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.152829 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:14:26.152829 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:26.153711 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.154700 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 21:14:26.036860 => 21:14:26.154700
[0m21:14:26.155706 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m21:14:26.155706 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m21:14:26.156704 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m21:14:26.157703 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:14:26.188007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.189002 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:14:26.189002 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m21:14:26.190004 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.191006 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 21:14:26.101859 => 21:14:26.191006
[0m21:14:26.192008 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m21:14:26.192008 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m21:14:26.192989 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m21:14:26.194023 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:14:26.194943 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m21:14:26.194943 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m21:14:26.195944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m21:14:26.195944 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m21:14:26.197945 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.198945 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 21:14:26.195944 => 21:14:26.198945
[0m21:14:26.198945 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m21:14:26.210953 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.211952 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.211952 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m21:14:26.212944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:26.262399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.262399 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.263399 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m21:14:26.265399 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:26.267399 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.267399 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m21:14:26.268399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:26.269399 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:14:26.270398 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.270398 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:14:26.271399 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:26.272399 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m21:14:26.275428 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:14:26.275428 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m21:14:26.276399 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:26.277399 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 21:14:26.199945 => 21:14:26.277399
[0m21:14:26.277399 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m21:14:26.278398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002009991CD00>]}
[0m21:14:26.278398 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m21:14:26.279399 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m21:14:26.280399 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:14:26.280399 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:14:26.280399 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m21:14:26.281398 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m21:14:26.281398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m21:14:26.282398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m21:14:26.282398 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:14:26.283399 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:14:26.286399 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:14:26.289399 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:14:26.290398 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 21:14:26.283399 => 21:14:26.289399
[0m21:14:26.290398 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:14:26.290398 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 21:14:26.286399 => 21:14:26.290398
[0m21:14:26.293399 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:14:26.293399 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:14:26.295399 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:14:26.295399 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:14:26.296399 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m21:14:26.296399 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:14:26.297399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:26.297399 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m21:14:26.297399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:26.353422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.353422 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:14:26.354422 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m21:14:26.355421 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.356420 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 21:14:26.291401 => 21:14:26.356420
[0m21:14:26.357421 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m21:14:26.357421 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m21:14:26.358420 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.08s]
[0m21:14:26.359400 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:14:26.382399 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.382399 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:14:26.383399 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:26.384399 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:26.385399 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 21:14:26.294399 => 21:14:26.385399
[0m21:14:26.386399 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m21:14:26.386399 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m21:14:26.387399 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.11s]
[0m21:14:26.388399 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:14:26.388399 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m21:14:26.389399 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m21:14:26.389399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m21:14:26.390399 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m21:14:26.392398 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:14:26.393398 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 21:14:26.390399 => 21:14:26.393398
[0m21:14:26.393398 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m21:14:26.396398 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m21:14:26.397399 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:14:26.397399 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m21:14:26.397399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:26.550580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.550580 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m21:14:26.551582 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, ))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,
   	case when category = 'Beauty' then amount else 0 end as Beauty_amount,
   	case when category = 'Books' then amount else 0 end as Books_amount,
   	case when category = 'Clothing' then amount else 0 end as Clothing_amount,
   	case when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,
   	case when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,
   	case when category = 'Sports' then amount else 0 end as Sports_amount,
    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,
   	case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m21:14:26.551582 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 22:         date_part('year', age(current_date, ))
                                                     ^

[0m21:14:26.552582 [debug] [Thread-2 (]: On model.customer360.customers: ROLLBACK
[0m21:14:26.552582 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 21:14:26.393398 => 21:14:26.552582
[0m21:14:26.553581 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m21:14:26.555581 [debug] [Thread-2 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near ")"
  LINE 22:         date_part('year', age(current_date, ))
                                                       ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m21:14:26.555581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22bb26-b9c6-4981-ac0f-eb5527cbdc7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200998BCD30>]}
[0m21:14:26.556582 [error] [Thread-2 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.17s]
[0m21:14:26.557582 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m21:14:26.558582 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:26.558582 [debug] [MainThread]: On master: BEGIN
[0m21:14:26.558582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:26.604731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:26.605731 [debug] [MainThread]: On master: COMMIT
[0m21:14:26.605731 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:26.605731 [debug] [MainThread]: On master: COMMIT
[0m21:14:26.606731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:26.606731 [debug] [MainThread]: On master: Close
[0m21:14:26.607731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:26.607731 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m21:14:26.607731 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:14:26.608731 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m21:14:26.608731 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:14:26.608731 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m21:14:26.608731 [info ] [MainThread]: 
[0m21:14:26.609732 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m21:14:26.611730 [debug] [MainThread]: Command end result
[0m21:14:26.618732 [info ] [MainThread]: 
[0m21:14:26.618732 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m21:14:26.619731 [info ] [MainThread]: 
[0m21:14:26.619731 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near ")"
  LINE 22:         date_part('year', age(current_date, ))
                                                       ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m21:14:26.620731 [info ] [MainThread]: 
[0m21:14:26.620731 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m21:14:26.620731 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:14:26.621732 [info ] [MainThread]: 
[0m21:14:26.621732 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m21:14:26.622731 [info ] [MainThread]: 
[0m21:14:26.622731 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m21:14:26.622731 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m21:14:26.623731 [info ] [MainThread]: 
[0m21:14:26.623731 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m21:14:26.624731 [info ] [MainThread]: 
[0m21:14:26.624731 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m21:14:26.625732 [debug] [MainThread]: Command `dbt build` failed at 21:14:26.625732 after 1.88 seconds
[0m21:14:26.626732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020095E47220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200993F1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200994D97B0>]}
[0m21:14:26.626732 [debug] [MainThread]: Flushing usage events
[0m21:20:49.349986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C67A4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9AA2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9AA2B30>]}


============================== 21:20:49.352986 | e2484cb1-dc0c-4fed-84f8-13b5aa9d0525 ==============================
[0m21:20:49.352986 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:20:49.352986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:20:49.472985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C27F2E00>]}
[0m21:20:49.529986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9CEA440>]}
[0m21:20:49.530986 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:20:49.540545 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:20:49.619494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:20:49.619494 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:20:49.716542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA0980D0>]}
[0m21:20:49.724542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9E2B0D0>]}
[0m21:20:49.724542 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:20:49.726542 [info ] [MainThread]: 
[0m21:20:49.727543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:49.728541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:20:49.735542 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:20:49.735542 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:20:49.735542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:49.787991 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:20:49.789990 [debug] [ThreadPool]: On list_dbt: Close
[0m21:20:49.790991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:20:49.794991 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:20:49.795991 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:20:49.795991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:49.848990 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:20:49.849990 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:20:49.849990 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:20:49.851990 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:20:49.852990 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:20:49.853992 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:20:49.857990 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:49.858990 [debug] [MainThread]: On master: BEGIN
[0m21:20:49.858990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:49.908355 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:49.909356 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:49.909356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:49.912356 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:20:49.913356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA0604F0>]}
[0m21:20:49.914356 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:49.914356 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:49.914356 [debug] [MainThread]: On master: BEGIN
[0m21:20:49.915357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:49.915357 [debug] [MainThread]: On master: COMMIT
[0m21:20:49.915357 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:49.916356 [debug] [MainThread]: On master: COMMIT
[0m21:20:49.916356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:49.916356 [debug] [MainThread]: On master: Close
[0m21:20:49.917356 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:20:49.918356 [info ] [MainThread]: 
[0m21:20:49.920356 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m21:20:49.920356 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m21:20:49.920356 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:20:49.921356 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m21:20:49.921356 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m21:20:49.922355 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m21:20:49.922355 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m21:20:49.923355 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m21:20:49.923355 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m21:20:49.924357 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m21:20:49.924357 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m21:20:49.925356 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:20:49.925356 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 21:20:49.925356 => 21:20:49.925356
[0m21:20:49.925356 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 21:20:49.925356 => 21:20:49.925356
[0m21:20:49.938356 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:20:49.939356 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m21:20:49.939356 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m21:20:49.949356 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 21:20:49.926355 => 21:20:49.949356
[0m21:20:49.962355 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:20:49.964357 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:20:49.965356 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:20:49.965356 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m21:20:49.966355 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m21:20:49.975355 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:20:49.976356 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:20:49.976356 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:49.977358 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:20:49.977358 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m21:20:49.978357 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:20:50.061357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.061357 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:20:50.062356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m21:20:50.068355 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:20:50.090355 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:20:50.091355 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m21:20:50.092356 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m21:20:50.096354 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m21:20:50.106356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:20:50.106356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.106356 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m21:20:50.107356 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m21:20:50.107356 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m21:20:50.108356 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m21:20:50.109357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.109357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:50.111355 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 21:20:49.966355 => 21:20:50.111355
[0m21:20:50.112356 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 21:20:49.940357 => 21:20:50.112356
[0m21:20:50.112356 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m21:20:50.113368 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m21:20:50.113368 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m21:20:50.114365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA11C760>]}
[0m21:20:50.114365 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.19s]
[0m21:20:50.116356 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m21:20:50.115357 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.19s]
[0m21:20:50.116356 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:20:50.117356 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m21:20:50.117356 [info ] [Thread-3 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m21:20:50.118356 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:20:50.118356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m21:20:50.119356 [info ] [Thread-1 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m21:20:50.119356 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:20:50.120356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m21:20:50.125357 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:20:50.125357 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:20:50.129355 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:20:50.129355 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 21:20:50.120356 => 21:20:50.129355
[0m21:20:50.130354 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:20:50.130354 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 21:20:50.126356 => 21:20:50.130354
[0m21:20:50.132355 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:20:50.132355 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:20:50.134355 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:20:50.134355 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.134355 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:20:50.135356 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:20:50.135356 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:20:50.136357 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m21:20:50.136357 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m21:20:50.136357 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m21:20:50.137414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:50.137414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:50.143811 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m21:20:50.214810 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.242810 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:20:50.242810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.242810 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m21:20:50.243811 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m21:20:50.243811 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m21:20:50.244811 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m21:20:50.244811 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m21:20:50.245811 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.246811 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m21:20:50.247812 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 21:20:50.130354 => 21:20:50.247812
[0m21:20:50.247812 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m21:20:50.248812 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m21:20:50.249811 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:20:50.250810 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m21:20:50.250810 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m21:20:50.251812 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m21:20:50.251812 [info ] [Thread-3 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.13s]
[0m21:20:50.252824 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m21:20:50.252824 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:20:50.252824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.253811 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:50.254811 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 21:20:50.132355 => 21:20:50.254811
[0m21:20:50.253811 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m21:20:50.255811 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 21:20:49.949356 => 21:20:50.255811
[0m21:20:50.255811 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m21:20:50.256811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m21:20:50.256811 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m21:20:50.257811 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:20:50.257811 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m21:20:50.258815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA0607F0>]}
[0m21:20:50.262810 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:20:50.263810 [info ] [Thread-1 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.14s]
[0m21:20:50.264811 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.33s]
[0m21:20:50.265812 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m21:20:50.265812 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 21:20:50.258815 => 21:20:50.265812
[0m21:20:50.265812 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m21:20:50.266811 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:20:50.266811 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:20:50.267811 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m21:20:50.269810 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:20:50.269810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m21:20:50.270811 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:20:50.270811 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:20:50.273811 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:20:50.273811 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m21:20:50.274811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:50.274811 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 21:20:50.270811 => 21:20:50.274811
[0m21:20:50.275811 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:20:50.276812 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:20:50.277812 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:20:50.277812 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m21:20:50.278812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:50.331438 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.332447 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m21:20:50.332447 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:20:50.333448 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.335444 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 21:20:50.267811 => 21:20:50.334441
[0m21:20:50.335444 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m21:20:50.335444 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m21:20:50.336447 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.08s]
[0m21:20:50.337365 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m21:20:50.338361 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m21:20:50.338361 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m21:20:50.339367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now model.customer360.stg_sf__contacts)
[0m21:20:50.339367 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m21:20:50.342362 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m21:20:50.343307 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 21:20:50.340358 => 21:20:50.343307
[0m21:20:50.343307 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m21:20:50.364309 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m21:20:50.365310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.365310 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m21:20:50.366310 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.366310 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:20:50.367309 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m21:20:50.367309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:20:50.368309 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.369309 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 21:20:50.275811 => 21:20:50.369309
[0m21:20:50.369309 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m21:20:50.370309 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m21:20:50.370309 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m21:20:50.371289 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m21:20:50.414308 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.415309 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.415309 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m21:20:50.421737 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m21:20:50.425742 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.426741 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m21:20:50.426741 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:50.428743 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.429742 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m21:20:50.429742 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:50.434742 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:20:50.434742 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.435742 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m21:20:50.436291 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:50.439747 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m21:20:50.442747 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m21:20:50.442747 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m21:20:50.445748 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:20:50.446748 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 21:20:50.343307 => 21:20:50.446748
[0m21:20:50.446748 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m21:20:50.447748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA058A00>]}
[0m21:20:50.447748 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m21:20:50.447748 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m21:20:50.449204 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:20:50.449204 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:20:50.450209 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m21:20:50.450209 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m21:20:50.451208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m21:20:50.451208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m21:20:50.452208 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:20:50.452208 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:20:50.455209 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:20:50.458209 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:20:50.459208 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 21:20:50.452208 => 21:20:50.459208
[0m21:20:50.459208 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 21:20:50.455209 => 21:20:50.459208
[0m21:20:50.460208 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:20:50.460208 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:20:50.461208 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:20:50.463209 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:20:50.464208 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:20:50.464208 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m21:20:50.464208 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:20:50.465208 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:50.465208 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m21:20:50.466211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:50.511485 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.512485 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m21:20:50.512485 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m21:20:50.513485 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.514486 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 21:20:50.460208 => 21:20:50.514486
[0m21:20:50.515484 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m21:20:50.515484 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m21:20:50.516485 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m21:20:50.517484 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m21:20:50.656887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.656887 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m21:20:50.657888 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:20:50.658888 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.659889 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 21:20:50.462207 => 21:20:50.659889
[0m21:20:50.659889 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m21:20:50.660887 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m21:20:50.661893 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.21s]
[0m21:20:50.661893 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m21:20:50.662888 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m21:20:50.662888 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m21:20:50.663889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m21:20:50.663889 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m21:20:50.667889 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m21:20:50.667889 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 21:20:50.664888 => 21:20:50.667889
[0m21:20:50.668888 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m21:20:50.671889 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m21:20:50.671889 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.672888 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m21:20:50.672888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:20:50.720887 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.721888 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.721888 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m21:20:50.729889 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m21:20:50.731887 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.732886 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m21:20:50.732886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:50.734889 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.735888 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m21:20:50.735888 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:50.737889 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:20:50.737889 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.738895 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m21:20:50.738895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:50.741886 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m21:20:50.741886 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m21:20:50.742887 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m21:20:50.743887 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:20:50.744889 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 21:20:50.668888 => 21:20:50.744889
[0m21:20:50.745887 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m21:20:50.745887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA2ABE50>]}
[0m21:20:50.746888 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m21:20:50.747888 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m21:20:50.747888 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:20:50.748891 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:20:50.748891 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m21:20:50.748891 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:20:50.749888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m21:20:50.749888 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m21:20:50.750887 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m21:20:50.750887 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:20:50.751888 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m21:20:50.751888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m21:20:50.754888 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:20:50.755887 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:20:50.755887 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:20:50.760887 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:20:50.763890 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:20:50.764888 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 21:20:50.751888 => 21:20:50.763890
[0m21:20:50.764888 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:20:50.765888 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 21:20:50.755887 => 21:20:50.765888
[0m21:20:50.765888 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 21:20:50.761888 => 21:20:50.765888
[0m21:20:50.767889 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:20:50.767889 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:20:50.768887 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:20:50.769888 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:20:50.770889 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:20:50.771888 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:20:50.772887 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m21:20:50.772887 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:20:50.773888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:50.773888 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:20:50.773888 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m21:20:50.774888 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m21:20:50.774888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:50.774888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:20:50.826097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.827098 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m21:20:50.827098 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m21:20:50.828099 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.829099 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 21:20:50.765888 => 21:20:50.829099
[0m21:20:50.829099 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m21:20:50.830097 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m21:20:50.831099 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m21:20:50.831099 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m21:20:50.832099 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:20:50.832099 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m21:20:50.833098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m21:20:50.833098 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:20:50.838099 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:20:50.839098 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 21:20:50.834098 => 21:20:50.839098
[0m21:20:50.839098 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:20:50.841098 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:20:50.841098 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:20:50.842097 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m21:20:50.842097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:50.862099 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.863098 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m21:20:50.863098 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m21:20:50.864099 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.865098 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 21:20:50.768887 => 21:20:50.865098
[0m21:20:50.866098 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m21:20:50.866098 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m21:20:50.867098 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.12s]
[0m21:20:50.868098 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m21:20:50.893100 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.893100 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m21:20:50.894098 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:20:50.895097 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.896099 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 21:20:50.770889 => 21:20:50.896099
[0m21:20:50.897099 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m21:20:50.897099 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m21:20:50.898100 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.15s]
[0m21:20:50.899099 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m21:20:50.927098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:50.927098 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m21:20:50.928099 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m21:20:50.929099 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:50.930099 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 21:20:50.839098 => 21:20:50.930099
[0m21:20:50.930099 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m21:20:50.931097 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m21:20:50.931097 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m21:20:50.932097 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m21:20:50.933098 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m21:20:50.933098 [info ] [Thread-3 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m21:20:50.934098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m21:20:50.934098 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m21:20:50.937097 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m21:20:50.937097 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 21:20:50.935098 => 21:20:50.937097
[0m21:20:50.938098 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m21:20:50.950100 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m21:20:50.950100 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:20:50.951099 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m21:20:50.951099 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:51.003099 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:51.004098 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:20:51.004098 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m21:20:51.006098 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:20:51.008100 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:20:51.009100 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m21:20:51.009100 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:51.010098 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:20:51.011099 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:20:51.011099 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m21:20:51.012100 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:51.014097 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m21:20:51.016097 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m21:20:51.016097 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m21:20:51.017099 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:20:51.018099 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 21:20:50.938098 => 21:20:51.018099
[0m21:20:51.018099 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m21:20:51.019098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA22E230>]}
[0m21:20:51.020098 [info ] [Thread-3 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m21:20:51.020098 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m21:20:51.021098 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:20:51.021098 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:20:51.022098 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m21:20:51.022098 [info ] [Thread-2 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m21:20:51.023098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m21:20:51.023098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m21:20:51.024099 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:20:51.024099 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:20:51.027097 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:20:51.031233 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:20:51.032186 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 21:20:51.024099 => 21:20:51.031233
[0m21:20:51.032186 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:20:51.034230 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:20:51.034230 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 21:20:51.027097 => 21:20:51.034230
[0m21:20:51.034230 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:20:51.035228 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:20:51.036231 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:20:51.037232 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m21:20:51.037232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:51.038228 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:20:51.038228 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m21:20:51.039239 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:20:51.087184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:51.088184 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m21:20:51.088184 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m21:20:51.090185 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:51.091184 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 21:20:51.032186 => 21:20:51.091184
[0m21:20:51.091184 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m21:20:51.092185 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m21:20:51.093185 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m21:20:51.093185 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m21:20:51.118764 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:51.119764 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m21:20:51.119764 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:20:51.121764 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:51.122764 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 21:20:51.035228 => 21:20:51.122764
[0m21:20:51.123764 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m21:20:51.123764 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m21:20:51.124765 [warn ] [Thread-2 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m21:20:51.125768 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m21:20:51.125768 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m21:20:51.126765 [info ] [Thread-3 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m21:20:51.127765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m21:20:51.127765 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m21:20:51.130764 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:20:51.130764 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 21:20:51.127765 => 21:20:51.130764
[0m21:20:51.131764 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m21:20:51.133764 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m21:20:51.134764 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.134764 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m21:20:51.135764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:51.185764 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:51.185764 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.186764 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,
   	case when category = 'Beauty' then amount else 0 end as Beauty_amount,
   	case when category = 'Books' then amount else 0 end as Books_amount,
   	case when category = 'Clothing' then amount else 0 end as Clothing_amount,
   	case when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,
   	case when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,
   	case when category = 'Sports' then amount else 0 end as Sports_amount,
    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,
   	case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m21:20:51.194135 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:20:51.197135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.197135 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m21:20:51.198135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:51.200135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.200135 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m21:20:51.201136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:51.202135 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m21:20:51.202135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.203135 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m21:20:51.203135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:51.205135 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m21:20:51.206135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m21:20:51.206135 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m21:20:51.207135 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:20:51.208135 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 21:20:51.131764 => 21:20:51.208135
[0m21:20:51.209137 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m21:20:51.209137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2484cb1-dc0c-4fed-84f8-13b5aa9d0525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CA36AAA0>]}
[0m21:20:51.210136 [info ] [Thread-3 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m21:20:51.210136 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m21:20:51.212537 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:51.212537 [debug] [MainThread]: On master: BEGIN
[0m21:20:51.212537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:51.258538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:51.259537 [debug] [MainThread]: On master: COMMIT
[0m21:20:51.259537 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:51.260538 [debug] [MainThread]: On master: COMMIT
[0m21:20:51.260538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:51.260538 [debug] [MainThread]: On master: Close
[0m21:20:51.261537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:51.261537 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m21:20:51.262536 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:20:51.262536 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m21:20:51.262536 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m21:20:51.263538 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:20:51.263538 [info ] [MainThread]: 
[0m21:20:51.264537 [info ] [MainThread]: Finished running 13 tests, 2 seeds, 3 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m21:20:51.266537 [debug] [MainThread]: Command end result
[0m21:20:51.273536 [info ] [MainThread]: 
[0m21:20:51.273536 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m21:20:51.274538 [info ] [MainThread]: 
[0m21:20:51.274538 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m21:20:51.275537 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m21:20:51.275537 [info ] [MainThread]: 
[0m21:20:51.276537 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m21:20:51.276537 [info ] [MainThread]: 
[0m21:20:51.276537 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m21:20:51.277537 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m21:20:51.277537 [info ] [MainThread]: 
[0m21:20:51.278536 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m21:20:51.278536 [info ] [MainThread]: 
[0m21:20:51.278536 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m21:20:51.279537 [debug] [MainThread]: Command `dbt build` succeeded at 21:20:51.279537 after 1.97 seconds
[0m21:20:51.280536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C67A4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9CEA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C9E29930>]}
[0m21:20:51.280536 [debug] [MainThread]: Flushing usage events
[0m21:54:39.077114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BDF797220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2A92D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2A92B00>]}


============================== 21:54:39.080121 | bdac3c22-ae74-450f-8b9c-07228390f8a2 ==============================
[0m21:54:39.080121 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:54:39.081114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:39.206975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BDB802E30>]}
[0m21:54:39.266612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2A493F0>]}
[0m21:54:39.267616 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:54:39.276634 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:54:39.358067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:39.358067 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:54:39.451103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE308C0D0>]}
[0m21:54:39.459330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2E2AE60>]}
[0m21:54:39.459330 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:54:39.460330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2E2AEF0>]}
[0m21:54:39.461329 [info ] [MainThread]: 
[0m21:54:39.462330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:39.463329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:54:39.469900 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:54:39.470900 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:54:39.470900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:39.520425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:54:39.520425 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:54:39.521424 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:54:39.523958 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:54:39.524997 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:54:39.524997 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:54:39.528579 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:39.529583 [debug] [MainThread]: On master: BEGIN
[0m21:54:39.529583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:39.575925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:39.576925 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:39.576925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:39.579925 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:54:39.580926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdac3c22-ae74-450f-8b9c-07228390f8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2E292D0>]}
[0m21:54:39.581924 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:39.581924 [debug] [MainThread]: On master: Close
[0m21:54:39.582926 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:54:39.582926 [info ] [MainThread]: 
[0m21:54:39.585494 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:54:39.586500 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:54:39.586500 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:54:39.593003 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:54:39.593003 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:54:39.586500 => 21:54:39.593003
[0m21:54:39.594009 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:54:39.594513 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:54:39.594009 => 21:54:39.594009
[0m21:54:39.595018 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:54:39.595018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:39.596023 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:54:39.596023 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:54:39.597022 [debug] [MainThread]: Command end result
[0m21:54:39.603022 [info ] [MainThread]: Compiled node 'customers' is:


with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,

   
    

    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount

    
    ,
    

    

    case when category = 'Beauty' then amount else 0 end as Beauty_amount

    
    ,
    

    

    case when category = 'Books' then amount else 0 end as Books_amount

    
    ,
    

    

    case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount

    
    ,
    

    

    case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount

    
    ,
    

    

    case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount

    
    ,
    

    

    case when category = 'Kitchen' then amount else 0 end as Kitchen_amount

    

    

FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:54:39.606130 [debug] [MainThread]: Command `dbt compile` succeeded at 21:54:39.606130 after 0.57 seconds
[0m21:54:39.607133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BDF797220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2F83190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BE2F07430>]}
[0m21:54:39.607133 [debug] [MainThread]: Flushing usage events
[0m21:56:05.835163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B3027220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B6322D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B6322B00>]}


============================== 21:56:05.837166 | a675132e-aebf-4f4f-b8c4-7c0b780c3472 ==============================
[0m21:56:05.837166 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:56:05.838166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -s customers', 'send_anonymous_usage_stats': 'True'}
[0m21:56:05.959514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF092E30>]}
[0m21:56:06.014539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B62D93F0>]}
[0m21:56:06.015539 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:56:06.024539 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:56:06.100932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:06.100932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:06.104932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B67B3E50>]}
[0m21:56:06.111933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B66BAE60>]}
[0m21:56:06.112932 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:56:06.112932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B66BAF20>]}
[0m21:56:06.113932 [info ] [MainThread]: 
[0m21:56:06.114912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:06.115932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:56:06.122932 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:56:06.122932 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:56:06.122932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:06.172049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:56:06.172049 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:56:06.172049 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:06.175048 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:56:06.176048 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:56:06.176048 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:56:06.180049 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.180049 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.181051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:06.232672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:56:06.232672 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.233672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:06.236669 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:56:06.237672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a675132e-aebf-4f4f-b8c4-7c0b780c3472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B66B92D0>]}
[0m21:56:06.237672 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:06.238671 [debug] [MainThread]: On master: Close
[0m21:56:06.238671 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:56:06.239672 [info ] [MainThread]: 
[0m21:56:06.241670 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:56:06.242670 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:56:06.242670 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:56:06.249672 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:56:06.249672 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:56:06.243670 => 21:56:06.249672
[0m21:56:06.250672 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:56:06.250672 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:56:06.250672 => 21:56:06.250672
[0m21:56:06.251672 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:56:06.252673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:06.252673 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:56:06.252673 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:56:06.253673 [debug] [MainThread]: Command end result
[0m21:56:06.258672 [info ] [MainThread]: Compiled node 'customers' is:


with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,

   
    

    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount

    
    ,
    

    

    case when category = 'Beauty' then amount else 0 end as Beauty_amount

    
    ,
    

    

    case when category = 'Books' then amount else 0 end as Books_amount

    
    ,
    

    

    case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount

    
    ,
    

    

    case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount

    
    ,
    

    

    case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount

    
    ,
    

    

    case when category = 'Kitchen' then amount else 0 end as Kitchen_amount

    

    

FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:56:06.262179 [debug] [MainThread]: Command `dbt compile` succeeded at 21:56:06.262179 after 0.47 seconds
[0m21:56:06.262179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B3027220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B62D93F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B66B9C00>]}
[0m21:56:06.262179 [debug] [MainThread]: Flushing usage events
[0m21:56:35.473029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E23607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26902D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26902B00>]}


============================== 21:56:35.476029 | 8abb8d00-afe3-46cd-9b01-c314842e3419 ==============================
[0m21:56:35.476029 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:56:35.477029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -s customers', 'send_anonymous_usage_stats': 'True'}
[0m21:56:35.601751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1F5A2E30>]}
[0m21:56:35.662510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E268B93F0>]}
[0m21:56:35.663510 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:56:35.672524 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:56:35.754506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:35.755506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:35.758506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26D93E50>]}
[0m21:56:35.767036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26C9AE60>]}
[0m21:56:35.768035 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:56:35.768035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26C9AF80>]}
[0m21:56:35.769037 [info ] [MainThread]: 
[0m21:56:35.770541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:35.771044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:56:35.778048 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:56:35.778048 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:56:35.778048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:35.828037 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:56:35.829037 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:56:35.829037 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:35.831084 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:56:35.832088 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:56:35.833089 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:56:35.837088 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:35.837088 [debug] [MainThread]: On master: BEGIN
[0m21:56:35.837088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:35.886452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:56:35.886452 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:35.887459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:35.890001 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:56:35.891006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8abb8d00-afe3-46cd-9b01-c314842e3419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26C992D0>]}
[0m21:56:35.892149 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:35.892149 [debug] [MainThread]: On master: Close
[0m21:56:35.893148 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:56:35.893148 [info ] [MainThread]: 
[0m21:56:35.896291 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:56:35.896291 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:56:35.897294 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:56:35.902829 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:56:35.903833 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:56:35.897294 => 21:56:35.903833
[0m21:56:35.904832 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:56:35.904832 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:56:35.904832 => 21:56:35.904832
[0m21:56:35.905833 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:56:35.905833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:35.906833 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:56:35.906833 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:56:35.907833 [debug] [MainThread]: Command end result
[0m21:56:35.913868 [info ] [MainThread]: Compiled node 'customers' is:


with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,

   
    

    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount

    
    ,
    

    

    case when category = 'Beauty' then amount else 0 end as Beauty_amount

    
    ,
    

    

    case when category = 'Books' then amount else 0 end as Books_amount

    
    ,
    

    

    case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount

    
    ,
    

    

    case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount

    
    ,
    

    

    case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount

    
    ,
    

    

    case when category = 'Kitchen' then amount else 0 end as Kitchen_amount

    

    

FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:56:35.916867 [debug] [MainThread]: Command `dbt compile` succeeded at 21:56:35.916867 after 0.48 seconds
[0m21:56:35.917868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E23607220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E268B93F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E26C99C00>]}
[0m21:56:35.917868 [debug] [MainThread]: Flushing usage events
[0m21:57:28.387983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B75174580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78472D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78472AA0>]}


============================== 21:57:28.390982 | bb96aecf-93b6-480c-a285-9f9154f501f4 ==============================
[0m21:57:28.390982 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:57:28.390982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -s customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:57:28.516741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B711C2E30>]}
[0m21:57:28.576887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78471DB0>]}
[0m21:57:28.577889 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:57:28.587422 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:57:28.668775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:28.669777 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:57:28.765095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78A6C0D0>]}
[0m21:57:28.774265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B7880AE00>]}
[0m21:57:28.774768 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:57:28.775271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B7880AEC0>]}
[0m21:57:28.775271 [info ] [MainThread]: 
[0m21:57:28.776274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:28.777274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:57:28.785283 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:57:28.785283 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:57:28.786288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:28.837052 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:57:28.837052 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:57:28.838052 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:57:28.840052 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:57:28.841054 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:57:28.841054 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:57:28.846046 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:28.846346 [debug] [MainThread]: On master: BEGIN
[0m21:57:28.846346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:28.896428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:57:28.896944 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:28.896944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:28.900948 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:57:28.901949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb96aecf-93b6-480c-a285-9f9154f501f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78809270>]}
[0m21:57:28.901949 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:28.902949 [debug] [MainThread]: On master: Close
[0m21:57:28.902949 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:57:28.902949 [info ] [MainThread]: 
[0m21:57:28.905459 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:57:28.906739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:57:28.906739 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:57:28.912740 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:57:28.914244 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:57:28.907740 => 21:57:28.914244
[0m21:57:28.914244 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:57:28.915251 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:57:28.915251 => 21:57:28.915251
[0m21:57:28.915251 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:57:28.916275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:28.916275 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:57:28.917282 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:57:28.917282 [debug] [MainThread]: Command end result
[0m21:57:28.923282 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount,case when category = 'Beauty' then amount else 0 end as Beauty_amount,case when category = 'Books' then amount else 0 end as Books_amount,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount,case when category = 'Kitchen' then amount else 0 end as Kitchen_amountFROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:57:28.926378 [debug] [MainThread]: Command `dbt compile` succeeded at 21:57:28.926378 after 0.58 seconds
[0m21:57:28.926378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B75174580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78961ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B78848040>]}
[0m21:57:28.927377 [debug] [MainThread]: Flushing usage events
[0m21:58:25.407191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200474F5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004A7F2CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004A7F2A40>]}


============================== 21:58:25.410192 | 660479af-c490-45fc-8da1-1edee51e8871 ==============================
[0m21:58:25.410192 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:58:25.410192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -s customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:25.532206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020043562E30>]}
[0m21:58:25.590258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004A7A83D0>]}
[0m21:58:25.591259 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:58:25.601258 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:58:25.677768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:25.677768 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:58:25.771276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004ADEC0D0>]}
[0m21:58:25.778276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004AB8EE00>]}
[0m21:58:25.779276 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:58:25.779497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004AB8EDA0>]}
[0m21:58:25.780542 [info ] [MainThread]: 
[0m21:58:25.781503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:25.782193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:58:25.788198 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:58:25.789198 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:58:25.789198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:25.943072 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:58:25.944071 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:58:25.944071 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:58:25.946072 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:58:25.947034 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:58:25.948034 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:58:25.952033 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.953032 [debug] [MainThread]: On master: BEGIN
[0m21:58:25.953032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:26.004568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:58:26.005567 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:26.005567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:26.008570 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:58:26.009571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660479af-c490-45fc-8da1-1edee51e8871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004AB8D270>]}
[0m21:58:26.010572 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:26.010572 [debug] [MainThread]: On master: Close
[0m21:58:26.011571 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:58:26.012572 [info ] [MainThread]: 
[0m21:58:26.014570 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:58:26.014570 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:58:26.015572 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:58:26.021570 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:58:26.021570 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:58:26.015572 => 21:58:26.021570
[0m21:58:26.021570 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:58:26.022822 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:58:26.022822 => 21:58:26.022822
[0m21:58:26.022822 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:58:26.024204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:26.025208 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:58:26.025208 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:58:26.025208 [debug] [MainThread]: Command end result
[0m21:58:26.031209 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount,case when category = 'Beauty' then amount else 0 end as Beauty_amount,case when category = 'Books' then amount else 0 end as Books_amount,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount,case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:58:26.033207 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:26.033207 after 0.67 seconds
[0m21:58:26.034207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200474F5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004ACE1E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004AA99840>]}
[0m21:58:26.034207 [debug] [MainThread]: Flushing usage events
[0m21:58:51.745316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC4105630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7402CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7402A40>]}


============================== 21:58:51.748315 | 3c2695bb-ba4b-477a-b955-2f7b6c1c89be ==============================
[0m21:58:51.748315 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:58:51.748315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile -s customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:51.872330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC00B2E30>]}
[0m21:58:51.934331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC73B83D0>]}
[0m21:58:51.935331 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:58:51.945332 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:58:52.024442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:52.024442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:52.028442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7893D90>]}
[0m21:58:52.036443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7796E00>]}
[0m21:58:52.036443 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:58:52.037443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7796DA0>]}
[0m21:58:52.038447 [info ] [MainThread]: 
[0m21:58:52.038447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:52.040446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:58:52.046447 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:58:52.047692 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:58:52.047692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:52.095568 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:58:52.096568 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:58:52.096568 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:58:52.098568 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:58:52.100570 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:58:52.100570 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:58:52.104568 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:52.104568 [debug] [MainThread]: On master: BEGIN
[0m21:58:52.105567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:52.152259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:58:52.153221 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:52.153726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:52.155775 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:58:52.157775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c2695bb-ba4b-477a-b955-2f7b6c1c89be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7795270>]}
[0m21:58:52.157775 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:52.157775 [debug] [MainThread]: On master: Close
[0m21:58:52.158730 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:58:52.159730 [info ] [MainThread]: 
[0m21:58:52.161729 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:58:52.161729 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:58:52.162729 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:58:52.168729 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:58:52.169729 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:58:52.162729 => 21:58:52.168729
[0m21:58:52.169729 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:58:52.169729 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:58:52.169729 => 21:58:52.169729
[0m21:58:52.170729 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:58:52.171729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:52.171729 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:58:52.171729 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:58:52.172729 [debug] [MainThread]: Command end result
[0m21:58:52.177729 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount,case when category = 'Beauty' then amount else 0 end as Beauty_amount,case when category = 'Books' then amount else 0 end as Books_amount,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount,case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:58:52.180729 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:52.179730 after 0.47 seconds
[0m21:58:52.180729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC4105630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC73B83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC7796F20>]}
[0m21:58:52.180729 [debug] [MainThread]: Flushing usage events
[0m21:59:43.600137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE31977220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE34C72D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE34C72B00>]}


============================== 21:59:43.603141 | 14d15b7d-6d76-443f-95b0-cf433b544881 ==============================
[0m21:59:43.603141 [info ] [MainThread]: Running with dbt=1.7.2
[0m21:59:43.603141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:43.723485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE2D902E30>]}
[0m21:59:43.779485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE34C293F0>]}
[0m21:59:43.780485 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m21:59:43.789485 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m21:59:43.866998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:59:43.866998 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m21:59:43.959935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE352680D0>]}
[0m21:59:43.966797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3500AE60>]}
[0m21:59:43.967799 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m21:59:43.968806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3500AF20>]}
[0m21:59:43.969777 [info ] [MainThread]: 
[0m21:59:43.969777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:43.971777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m21:59:43.977797 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:59:43.977797 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m21:59:43.977797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:44.028894 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:59:44.029893 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m21:59:44.029893 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:59:44.031893 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:59:44.032895 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m21:59:44.033894 [debug] [ThreadPool]: On list_dbt_public: Close
[0m21:59:44.037894 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:44.037894 [debug] [MainThread]: On master: BEGIN
[0m21:59:44.038893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:44.084535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:59:44.085573 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:44.085573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:59:44.088534 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:59:44.089535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d15b7d-6d76-443f-95b0-cf433b544881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE350092D0>]}
[0m21:59:44.090533 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:44.090533 [debug] [MainThread]: On master: Close
[0m21:59:44.091534 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m21:59:44.091534 [info ] [MainThread]: 
[0m21:59:44.093895 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m21:59:44.094902 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m21:59:44.094902 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m21:59:44.100899 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m21:59:44.100899 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 21:59:44.094902 => 21:59:44.100899
[0m21:59:44.101902 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m21:59:44.101902 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 21:59:44.101902 => 21:59:44.101902
[0m21:59:44.102902 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m21:59:44.103902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:44.103902 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m21:59:44.103902 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m21:59:44.104902 [debug] [MainThread]: Command end result
[0m21:59:44.109903 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount
    ,case when category = 'Beauty' then amount else 0 end as Beauty_amount
    ,case when category = 'Books' then amount else 0 end as Books_amount
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount
    ,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount
    ,case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps_and_Games_amount) Apps_and_Games_amount,
   	sum(Beauty_amount) Beauty_amount,
   	sum(Books_amount) Books_amount,
   	sum(Clothing_amount) Clothing_amount,
   	sum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,
   	sum(Movies_and_TV_amount) Movies_and_TV_amount,
    sum(Sports_amount) Sports_amount,
    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,
   	sum(Kitchen_amount) Kitchen_amount
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m21:59:44.111902 [debug] [MainThread]: Command `dbt compile` succeeded at 21:59:44.111902 after 0.55 seconds
[0m21:59:44.112902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE31977220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE35163280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE350E7430>]}
[0m21:59:44.112902 [debug] [MainThread]: Flushing usage events
[0m22:03:01.033538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35E7A5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361AA2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361AA2B30>]}


============================== 22:03:01.035537 | 1034dce9-a041-4adc-8cf2-4ccd95f797e3 ==============================
[0m22:03:01.035537 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:03:01.036537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -s customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:03:01.157086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35A832E30>]}
[0m22:03:01.214285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361CDA440>]}
[0m22:03:01.215287 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:03:01.224240 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:03:01.304875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:01.304875 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:03:01.396390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36209C0D0>]}
[0m22:03:01.403428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361E3AEF0>]}
[0m22:03:01.404389 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:03:01.404389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361E3AE90>]}
[0m22:03:01.405390 [info ] [MainThread]: 
[0m22:03:01.406390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:03:01.407390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:03:01.413389 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:03:01.414389 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:03:01.414389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:01.465344 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:03:01.465344 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:03:01.465344 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:03:01.468342 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:03:01.469344 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:03:01.469344 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:03:01.473343 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:01.474344 [debug] [MainThread]: On master: BEGIN
[0m22:03:01.474344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:01.519852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:03:01.519852 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:01.520851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:03:01.523849 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:03:01.524850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1034dce9-a041-4adc-8cf2-4ccd95f797e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361E39360>]}
[0m22:03:01.524850 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:01.525851 [debug] [MainThread]: On master: Close
[0m22:03:01.526851 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:03:01.526851 [info ] [MainThread]: 
[0m22:03:01.528851 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:03:01.529851 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m22:03:01.529851 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:03:01.535850 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:03:01.536851 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:03:01.529851 => 22:03:01.536851
[0m22:03:01.536851 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:03:01.536851 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:03:01.536851 => 22:03:01.536851
[0m22:03:01.537851 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:03:01.538851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:01.538851 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:03:01.539851 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:03:01.539851 [debug] [MainThread]: Command end result
[0m22:03:01.545851 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount
    ,case when category = 'Beauty' then amount else 0 end as Beauty_amount
    ,case when category = 'Books' then amount else 0 end as Books_amount
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount
    ,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount
    ,case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m22:03:01.547851 [debug] [MainThread]: Command `dbt compile` succeeded at 22:03:01.547851 after 0.55 seconds
[0m22:03:01.547851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35E7A5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361F17460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3620C5F60>]}
[0m22:03:01.548850 [debug] [MainThread]: Flushing usage events
[0m22:04:05.359027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442A3B5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D6B2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D6B2BC0>]}


============================== 22:04:05.362028 | 676224fe-7e90-427d-a89a-1320773c6d9d ==============================
[0m22:04:05.362028 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:04:05.362028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:05.484535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024426362E00>]}
[0m22:04:05.541090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D8F9DE0>]}
[0m22:04:05.542090 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:04:05.551274 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:04:05.629740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:05.629740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:05.633740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DB3FF10>]}
[0m22:04:05.641741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DA3B1F0>]}
[0m22:04:05.641741 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:04:05.643741 [info ] [MainThread]: 
[0m22:04:05.644741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:05.645741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:04:05.651740 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:04:05.652740 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:04:05.652740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:05.702273 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:04:05.703273 [debug] [ThreadPool]: On list_dbt: Close
[0m22:04:05.704273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:04:05.708273 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:04:05.709272 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:04:05.709272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:05.755590 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:04:05.755590 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:04:05.756591 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:04:05.758589 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:04:05.759592 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:04:05.759592 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:04:05.763589 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:05.764590 [debug] [MainThread]: On master: BEGIN
[0m22:04:05.764590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:05.814109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:04:05.815112 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:05.815112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:05.818113 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:04:05.820112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DB8E1D0>]}
[0m22:04:05.820112 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:05.820112 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:05.821112 [debug] [MainThread]: On master: BEGIN
[0m22:04:05.821112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:04:05.821112 [debug] [MainThread]: On master: COMMIT
[0m22:04:05.822112 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:05.822112 [debug] [MainThread]: On master: COMMIT
[0m22:04:05.822112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:04:05.823112 [debug] [MainThread]: On master: Close
[0m22:04:05.823112 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:04:05.824113 [info ] [MainThread]: 
[0m22:04:05.826113 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:04:05.826113 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:04:05.827113 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:04:05.827113 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:04:05.827113 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:04:05.828113 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:04:05.829113 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:04:05.829113 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:04:05.830113 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:04:05.830113 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:04:05.830113 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:04:05.831112 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:04:05.831112 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:04:05.831112 => 22:04:05.831112
[0m22:04:05.831112 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:04:05.831112 => 22:04:05.831112
[0m22:04:05.844112 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:04:05.844112 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:04:05.845112 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:04:05.854113 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:04:05.832113 => 22:04:05.854113
[0m22:04:05.866112 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:04:05.867114 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:04:05.870112 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:04:05.870112 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:04:05.880114 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:04:05.880114 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:04:05.880114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:04:05.881113 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:05.882114 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:04:05.882114 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:04:05.883113 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:04:05.940621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:05.941621 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:04:05.941621 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:04:05.970623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:05.972621 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:04:05.972621 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:04:05.973623 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:04:05.995984 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:04:05.995984 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:04:05.996984 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:04:06.000986 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:04:06.000986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.001987 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:04:06.009988 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:04:06.010988 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:04:06.010988 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:04:06.011987 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:04:06.025140 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:04:06.044144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:06.075144 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:04:05.845112 => 22:04:06.075144
[0m22:04:06.090144 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:04:06.106146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DC47A00>]}
[0m22:04:06.121694 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:04:06.121694 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.28s]
[0m22:04:06.122695 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:04:06.123354 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:04:06.124360 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:04:06.124360 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:04:06.125360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:04:06.125360 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:04:06.125360 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:04:06.126360 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:04:06.131360 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:04:06.132359 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:04:06.133359 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:04:06.126360 => 22:04:06.132359
[0m22:04:06.133359 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:04:06.133359 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:04:06.134361 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:04:06.135360 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:04:06.136360 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:04:06.136360 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:04:06.137360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:06.137360 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:06.138360 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.139359 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:04:05.854113 => 22:04:06.139359
[0m22:04:06.141359 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:04:05.870112 => 22:04:06.141359
[0m22:04:06.141359 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:04:06.142359 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:04:06.143360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DBCC130>]}
[0m22:04:06.143360 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:04:06.143360 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.31s]
[0m22:04:06.145359 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:04:06.144359 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.32s]
[0m22:04:06.145359 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:04:06.146360 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:04:06.147359 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:04:06.146360 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:04:06.147359 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:04:06.148359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:04:06.149360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:04:06.149360 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:04:06.149360 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:04:06.152358 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:04:06.157358 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:04:06.158360 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:04:06.150360 => 22:04:06.157358
[0m22:04:06.158360 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:04:06.153359 => 22:04:06.158360
[0m22:04:06.158360 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:04:06.159360 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:04:06.161361 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:04:06.163360 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:04:06.164359 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:04:06.164359 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:04:06.165359 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:04:06.165359 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:04:06.165359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:06.166360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:06.214364 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.214364 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:04:06.215472 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:04:06.216472 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.217472 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:04:06.159360 => 22:04:06.217472
[0m22:04:06.217472 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:04:06.218471 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:04:06.218471 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m22:04:06.219473 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:04:06.219473 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:04:06.220685 [info ] [Thread-2 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:04:06.221689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:04:06.221689 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:04:06.224688 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:04:06.225689 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:04:06.221689 => 22:04:06.225689
[0m22:04:06.225689 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:04:06.227689 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:04:06.228688 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:04:06.228688 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:04:06.228688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:06.274689 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.275689 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:04:06.275689 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:04:06.277689 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.278690 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:04:06.225689 => 22:04:06.278690
[0m22:04:06.278690 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:04:06.279689 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:04:06.279689 [info ] [Thread-2 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.06s]
[0m22:04:06.280690 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:04:06.289689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.289689 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:04:06.289689 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:04:06.290689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.292690 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:04:06.134361 => 22:04:06.291688
[0m22:04:06.292690 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:04:06.293689 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:04:06.293689 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m22:04:06.294689 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:04:06.351900 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.351900 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:04:06.352900 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:04:06.353900 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.354900 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:04:06.161361 => 22:04:06.354900
[0m22:04:06.354900 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:04:06.355900 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:04:06.355900 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.21s]
[0m22:04:06.356900 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:04:06.356900 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m22:04:06.357900 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:04:06.358900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now model.customer360.stg_sf__contacts)
[0m22:04:06.358900 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:04:06.360900 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:04:06.361900 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:04:06.358900 => 22:04:06.361900
[0m22:04:06.361900 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:04:06.382900 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:04:06.383900 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.383900 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:04:06.384900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:06.431836 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.432836 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.432836 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:04:06.439837 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:04:06.444840 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.444840 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:04:06.444840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:06.446841 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.447840 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:04:06.447840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:06.452840 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:04:06.453840 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.453840 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:04:06.454846 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:06.458849 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:04:06.460849 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:04:06.461850 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:04:06.463850 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:04:06.464851 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:04:06.361900 => 22:04:06.464851
[0m22:04:06.464851 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m22:04:06.465850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DD55C60>]}
[0m22:04:06.466850 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m22:04:06.466850 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:04:06.467852 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:04:06.468850 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:04:06.468850 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:04:06.469850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:04:06.468850 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:04:06.469850 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:04:06.470850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:04:06.473849 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:04:06.473849 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:04:06.476849 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:04:06.476849 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:04:06.470850 => 22:04:06.476849
[0m22:04:06.476849 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:04:06.478850 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:04:06.478850 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:04:06.473849 => 22:04:06.478850
[0m22:04:06.479850 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:04:06.479850 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:04:06.481850 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:04:06.482851 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:04:06.482851 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:04:06.482851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:06.483853 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:04:06.483853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:06.534827 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.535827 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:04:06.535827 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:04:06.536827 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.537826 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:04:06.477850 => 22:04:06.537826
[0m22:04:06.538828 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:04:06.538828 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:04:06.539827 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m22:04:06.540825 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:04:06.566587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.566587 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:04:06.567636 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:04:06.568631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.569633 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:04:06.479850 => 22:04:06.569633
[0m22:04:06.569633 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:04:06.570594 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:04:06.571593 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m22:04:06.571593 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:04:06.572896 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m22:04:06.572896 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:04:06.573901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:04:06.574901 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:04:06.577899 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:04:06.578899 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:04:06.574901 => 22:04:06.577899
[0m22:04:06.578899 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m22:04:06.581899 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:04:06.582900 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.582900 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:04:06.583899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:06.630243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.630243 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.631243 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:04:06.659243 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:04:06.661244 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.662243 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:04:06.662243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:06.664243 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.665243 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:04:06.665243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:06.667243 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:04:06.667243 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.667243 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:04:06.668243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:06.670245 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:04:06.670245 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:04:06.671244 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:04:06.672244 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:04:06.673244 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:04:06.578899 => 22:04:06.673244
[0m22:04:06.674245 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m22:04:06.674245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DCC2380>]}
[0m22:04:06.675244 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.10s]
[0m22:04:06.675244 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m22:04:06.676524 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:04:06.676524 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:04:06.677528 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:04:06.677528 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:04:06.677528 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:04:06.678527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:04:06.678527 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:04:06.679527 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:04:06.679527 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:04:06.680527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:04:06.680527 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:04:06.684529 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:04:06.684529 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:04:06.690526 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:04:06.693528 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:04:06.694527 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:04:06.681527 => 22:04:06.693528
[0m22:04:06.694527 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:04:06.696527 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:04:06.696527 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:04:06.690526 => 22:04:06.696527
[0m22:04:06.697527 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:04:06.685528 => 22:04:06.697527
[0m22:04:06.697527 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:04:06.698527 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:04:06.698527 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:04:06.700530 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:04:06.701530 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:04:06.702531 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:04:06.703531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:06.703531 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:04:06.704532 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:04:06.704532 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:04:06.704532 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:04:06.705531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:06.705531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:06.753115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.753115 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:04:06.753115 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:04:06.754114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.756115 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:04:06.694527 => 22:04:06.755117
[0m22:04:06.756115 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:04:06.756115 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:04:06.757115 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:04:06.758115 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:04:06.759115 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:04:06.759115 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:04:06.760115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:04:06.760115 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:04:06.764115 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:04:06.765114 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:04:06.760115 => 22:04:06.764115
[0m22:04:06.765114 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:04:06.767163 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:04:06.767163 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:04:06.768165 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:04:06.768165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:06.782164 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.782164 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:04:06.783162 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:04:06.784161 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.785163 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:04:06.698527 => 22:04:06.785163
[0m22:04:06.786163 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:04:06.786163 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:04:06.787163 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m22:04:06.788163 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:04:06.814292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.815289 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:04:06.815289 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:04:06.816797 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.817797 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:04:06.701530 => 22:04:06.817797
[0m22:04:06.817797 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:04:06.818797 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:04:06.819797 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.14s]
[0m22:04:06.819797 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:04:06.971849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:06.972850 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:04:06.972850 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:04:06.973849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:06.975851 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:04:06.765114 => 22:04:06.974850
[0m22:04:06.975851 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:04:06.975851 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:04:06.976850 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.22s]
[0m22:04:06.977849 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:04:06.978849 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:04:06.978849 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:04:06.979849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m22:04:06.979849 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:04:06.982848 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:04:06.983860 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:04:06.980850 => 22:04:06.982848
[0m22:04:06.983860 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:04:06.994849 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:04:06.995849 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:04:06.996849 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:04:06.996849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:07.047100 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:07.047100 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:04:07.048102 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m22:04:07.050100 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:04:07.052100 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:04:07.052100 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:04:07.053423 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:07.054429 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:04:07.054429 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:04:07.055428 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:04:07.055428 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:07.058427 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:04:07.060427 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:04:07.061428 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:04:07.061428 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:04:07.062428 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:04:06.983860 => 22:04:07.062428
[0m22:04:07.063428 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:04:07.063428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DD89E70>]}
[0m22:04:07.064427 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m22:04:07.065428 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:04:07.065428 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:04:07.066427 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:04:07.066427 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:04:07.066427 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:04:07.067428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:04:07.067428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:04:07.068427 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:04:07.068427 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:04:07.071428 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:04:07.074427 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:04:07.075427 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:04:07.068427 => 22:04:07.075427
[0m22:04:07.075427 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:04:07.072428 => 22:04:07.075427
[0m22:04:07.076428 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:04:07.076428 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:04:07.078428 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:04:07.080428 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:04:07.080428 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:04:07.081427 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:04:07.081427 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:04:07.081427 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:04:07.082428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:04:07.082428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:07.142936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:07.142936 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:04:07.143936 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:04:07.144938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:07.145938 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:04:07.076428 => 22:04:07.145938
[0m22:04:07.146936 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:04:07.146936 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:04:07.147938 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.08s]
[0m22:04:07.147938 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:04:07.177936 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:07.178936 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:04:07.178936 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:04:07.180936 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:04:07.181936 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:04:07.078428 => 22:04:07.180936
[0m22:04:07.181936 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:04:07.182936 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:04:07.182936 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.12s]
[0m22:04:07.183936 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:04:07.184939 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:04:07.184939 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:04:07.185938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:04:07.185938 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:04:07.190936 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:04:07.191936 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:04:07.186938 => 22:04:07.190936
[0m22:04:07.191936 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:04:07.194936 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:04:07.194936 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:04:07.195936 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:04:07.195936 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:04:07.242814 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:04:07.243815 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:04:07.243815 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as Apps & Games_amount
    ,case when category = 'Beauty' then amount else 0 end as Beauty_amount
    ,case when category = 'Books' then amount else 0 end as Books_amount
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as Clothing, Shoes & Accessories_amount
    ,case when category = 'Movies & TV' then amount else 0 end as Movies & TV_amount
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as Sports, Fitness & Outdoors_amount
    ,case when category = 'Kitchen' then amount else 0 end as Kitchen_amount
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:04:07.244814 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "&"
LINE 27: ...y = 'Apps & Games' then amount else 0 end as Apps & Games_am...
                                                              ^

[0m22:04:07.244814 [debug] [Thread-2 (]: On model.customer360.customers: ROLLBACK
[0m22:04:07.245816 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:04:07.191936 => 22:04:07.244814
[0m22:04:07.245816 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:04:07.247964 [debug] [Thread-2 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "&"
  LINE 27: ...y = 'Apps & Games' then amount else 0 end as Apps & Games_am...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:04:07.247964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676224fe-7e90-427d-a89a-1320773c6d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DD7D5D0>]}
[0m22:04:07.248967 [error] [Thread-2 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.06s]
[0m22:04:07.248967 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:04:07.250968 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:07.250968 [debug] [MainThread]: On master: BEGIN
[0m22:04:07.250968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:07.296967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:04:07.296967 [debug] [MainThread]: On master: COMMIT
[0m22:04:07.297969 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:07.297969 [debug] [MainThread]: On master: COMMIT
[0m22:04:07.297969 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:04:07.298967 [debug] [MainThread]: On master: Close
[0m22:04:07.298967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:07.299967 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:04:07.299967 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:04:07.299967 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:04:07.301043 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:04:07.301043 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:04:07.301043 [info ] [MainThread]: 
[0m22:04:07.302047 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m22:04:07.304046 [debug] [MainThread]: Command end result
[0m22:04:07.312047 [info ] [MainThread]: 
[0m22:04:07.312047 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m22:04:07.313047 [info ] [MainThread]: 
[0m22:04:07.313047 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "&"
  LINE 27: ...y = 'Apps & Games' then amount else 0 end as Apps & Games_am...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:04:07.314047 [info ] [MainThread]: 
[0m22:04:07.314047 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:04:07.314047 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:04:07.314047 [info ] [MainThread]: 
[0m22:04:07.315550 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:04:07.315550 [info ] [MainThread]: 
[0m22:04:07.315550 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:04:07.316555 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:04:07.316555 [info ] [MainThread]: 
[0m22:04:07.316555 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:04:07.317555 [info ] [MainThread]: 
[0m22:04:07.317555 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m22:04:07.318554 [debug] [MainThread]: Command `dbt build` failed at 22:04:07.318554 after 2.00 seconds
[0m22:04:07.319555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442A3B5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DE18040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442DE1AE00>]}
[0m22:04:07.319555 [debug] [MainThread]: Flushing usage events
[0m22:06:10.415728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580497220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583822D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583822B00>]}


============================== 22:06:10.417728 | d8c7a1b3-6564-4a4c-a24b-6b5003114603 ==============================
[0m22:06:10.417728 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:06:10.418728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -s customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.538661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FC422E30>]}
[0m22:06:10.595850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5837D93F0>]}
[0m22:06:10.595850 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:06:10.604806 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:06:10.679314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:10.680315 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:06:10.772448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583E2C0D0>]}
[0m22:06:10.780409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583BCAE60>]}
[0m22:06:10.781409 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:06:10.781409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583BCAF20>]}
[0m22:06:10.782409 [info ] [MainThread]: 
[0m22:06:10.783408 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:10.784409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:06:10.790407 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:06:10.790407 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:06:10.791408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:10.841246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:06:10.841246 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:06:10.842248 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:06:10.844246 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:06:10.845246 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:06:10.845246 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:06:10.850246 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:10.850246 [debug] [MainThread]: On master: BEGIN
[0m22:06:10.850246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:10.897197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:06:10.898236 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:10.898236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:06:10.901195 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:06:10.902197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c7a1b3-6564-4a4c-a24b-6b5003114603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583BC92D0>]}
[0m22:06:10.903197 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:10.903197 [debug] [MainThread]: On master: Close
[0m22:06:10.904197 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:06:10.904197 [info ] [MainThread]: 
[0m22:06:10.906197 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:06:10.907197 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m22:06:10.907197 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:06:10.913195 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:06:10.914196 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:06:10.907197 => 22:06:10.914196
[0m22:06:10.914196 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:06:10.915196 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:06:10.914196 => 22:06:10.914196
[0m22:06:10.915196 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:06:10.916195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:10.916195 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:06:10.917197 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:06:10.917197 [debug] [MainThread]: Command end result
[0m22:06:10.923197 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as `Apps & Games_amount`
    ,case when category = 'Beauty' then amount else 0 end as `Beauty_amount`
    ,case when category = 'Books' then amount else 0 end as `Books_amount`
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as `Clothing, Shoes & Accessories_amount`
    ,case when category = 'Movies & TV' then amount else 0 end as `Movies & TV_amount`
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as `Sports, Fitness & Outdoors_amount`
    ,case when category = 'Kitchen' then amount else 0 end as `Kitchen_amount`
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m22:06:10.925197 [debug] [MainThread]: Command `dbt compile` succeeded at 22:06:10.925197 after 0.55 seconds
[0m22:06:10.926197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D580497220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583D230D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D583CA7430>]}
[0m22:06:10.926197 [debug] [MainThread]: Flushing usage events
[0m22:06:38.814662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2A7E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DAE2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DAE2BC0>]}


============================== 22:06:38.817662 | 81b815e9-711d-4174-8d37-20ecf4dad3d6 ==============================
[0m22:06:38.817662 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:06:38.818165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:38.936695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D26812E00>]}
[0m22:06:38.995996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DD29DE0>]}
[0m22:06:38.996994 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:06:39.006004 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:06:39.082466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:39.082466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:39.086466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DF6BF10>]}
[0m22:06:39.095467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DE6B1F0>]}
[0m22:06:39.095467 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:06:39.097467 [info ] [MainThread]: 
[0m22:06:39.097467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:39.098467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:06:39.105507 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:06:39.105507 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:06:39.106515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.158863 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:06:39.159863 [debug] [ThreadPool]: On list_dbt: Close
[0m22:06:39.160863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:06:39.165298 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:06:39.165298 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:06:39.166298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.214222 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.214222 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:06:39.215223 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:06:39.216263 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:06:39.217816 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:06:39.218822 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:06:39.222822 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:39.222822 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.222822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.271822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.271822 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:39.271822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:06:39.274821 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:06:39.276821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DFBA1D0>]}
[0m22:06:39.276821 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:39.276821 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:39.277821 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.277821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.278821 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.278821 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:39.278821 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.278821 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:06:39.279821 [debug] [MainThread]: On master: Close
[0m22:06:39.279821 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:06:39.280821 [info ] [MainThread]: 
[0m22:06:39.282821 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:06:39.282821 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:06:39.283822 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:06:39.283822 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:06:39.283822 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:06:39.284821 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:06:39.284821 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:06:39.285821 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:06:39.286821 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:06:39.286821 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:06:39.286821 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:06:39.287821 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:06:39.287821 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:06:39.287821 => 22:06:39.287821
[0m22:06:39.287821 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:06:39.287821 => 22:06:39.287821
[0m22:06:39.299820 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:06:39.299820 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:06:39.300821 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:06:39.309825 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:06:39.288822 => 22:06:39.309825
[0m22:06:39.322328 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:06:39.322328 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:06:39.326330 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:06:39.326330 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:06:39.335330 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:06:39.336331 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:06:39.336331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:39.337331 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:06:39.338330 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:06:39.338330 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:06:39.338330 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:39.385330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.386329 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:06:39.386329 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:06:39.415332 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:06:39.437887 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:06:39.438882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.438882 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:06:39.439840 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:06:39.439840 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:06:39.440840 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:06:39.444839 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:06:39.453838 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:06:39.453838 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:06:39.453838 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:06:39.457194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.457194 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:06:39.457194 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:06:39.471930 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:06:39.481926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:06:39.543538 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:06:39.300821 => 22:06:39.543538
[0m22:06:39.571499 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:06:39.572343 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:06:39.572343 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:06:39.573349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DFDD420>]}
[0m22:06:39.575396 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:06:39.574349 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.29s]
[0m22:06:39.576348 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:06:39.576348 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:06:39.577348 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:06:39.579387 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:06:39.577348 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:06:39.579387 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:06:39.580348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:06:39.580348 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:06:39.580348 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:06:39.585347 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:06:39.585347 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:06:39.585347 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.586348 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:06:39.309825 => 22:06:39.586348
[0m22:06:39.588348 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:06:39.326330 => 22:06:39.587347
[0m22:06:39.588348 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:06:39.581349 => 22:06:39.588348
[0m22:06:39.588348 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:06:39.589347 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:06:39.589347 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:06:39.590348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2DFDDE10>]}
[0m22:06:39.590348 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:06:39.592348 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:06:39.592348 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.30s]
[0m22:06:39.593349 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.31s]
[0m22:06:39.594348 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:06:39.594348 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:06:39.595350 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:06:39.595350 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:06:39.595350 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:06:39.596348 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:06:39.597348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.596348 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:06:39.597348 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:06:39.598348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:06:39.599348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:06:39.599348 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:06:39.599348 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:06:39.603354 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:06:39.608355 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:06:39.609355 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:06:39.600349 => 22:06:39.609355
[0m22:06:39.609355 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:06:39.603354 => 22:06:39.609355
[0m22:06:39.609355 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:06:39.610355 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:06:39.612355 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:06:39.614353 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:06:39.614353 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:06:39.615354 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:06:39.615354 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:06:39.615354 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:06:39.616355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:39.616355 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:39.644862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.644862 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:06:39.645862 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:06:39.646861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.647861 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:06:39.590348 => 22:06:39.647861
[0m22:06:39.647861 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:06:39.648862 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:06:39.648862 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m22:06:39.649862 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:06:39.649862 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:06:39.650863 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:06:39.650863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:06:39.651862 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:06:39.654862 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:06:39.655862 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:06:39.651862 => 22:06:39.654862
[0m22:06:39.655862 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:06:39.657863 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:06:39.657863 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:06:39.658863 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:06:39.658863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.678861 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.679863 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:06:39.679863 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:06:39.680864 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.681863 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:06:39.610355 => 22:06:39.681863
[0m22:06:39.681863 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:06:39.682862 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:06:39.683863 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m22:06:39.683863 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:06:39.710865 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.710865 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:06:39.711866 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:39.712866 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.713867 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:06:39.612355 => 22:06:39.713867
[0m22:06:39.713867 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:06:39.714866 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:06:39.715866 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.12s]
[0m22:06:39.715866 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:06:39.716867 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m22:06:39.716867 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:06:39.717867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m22:06:39.718989 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:06:39.720988 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:06:39.721988 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:06:39.718989 => 22:06:39.720988
[0m22:06:39.721988 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:06:39.743987 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:06:39.743987 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.744987 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:06:39.744987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:39.746988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.746988 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:06:39.747989 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:39.748990 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.749990 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:06:39.655862 => 22:06:39.749990
[0m22:06:39.750989 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:06:39.750989 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:06:39.751989 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m22:06:39.751989 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:06:39.790989 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.791988 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.791988 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:06:39.828004 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:06:39.836008 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.836008 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:06:39.836999 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:06:39.840002 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.840002 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:06:39.841001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:06:39.846001 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:06:39.847000 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.847000 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:06:39.847961 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:06:39.850964 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:06:39.853964 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:06:39.854964 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:06:39.855966 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:06:39.856966 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:06:39.721988 => 22:06:39.856966
[0m22:06:39.857965 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m22:06:39.858972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E14AB90>]}
[0m22:06:39.858972 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m22:06:39.859965 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:06:39.860966 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:06:39.860966 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:06:39.861967 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:06:39.862966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:06:39.861967 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:06:39.862966 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:06:39.863966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:06:39.866964 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:06:39.866964 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:06:39.869966 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:06:39.869966 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:06:39.863966 => 22:06:39.869966
[0m22:06:39.870965 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:06:39.866964 => 22:06:39.870965
[0m22:06:39.870965 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:06:39.870965 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:06:39.872966 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:06:39.874965 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:06:39.874965 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:06:39.875966 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:06:39.875966 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:06:39.876965 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:06:39.876965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:39.876965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.924543 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.924543 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:06:39.925543 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:06:39.926544 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.927544 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:06:39.871965 => 22:06:39.927544
[0m22:06:39.927544 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:06:39.928542 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:06:39.929543 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m22:06:39.929543 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:06:39.953544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:39.953544 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:06:39.954545 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:39.955543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:39.956545 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:06:39.872966 => 22:06:39.956545
[0m22:06:39.956545 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:06:39.957543 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:06:39.957543 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m22:06:39.958543 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:06:39.959544 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m22:06:39.959544 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:06:39.960543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:06:39.960543 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:06:39.963542 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:06:39.964543 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:06:39.960543 => 22:06:39.964543
[0m22:06:39.964543 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m22:06:39.967543 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:06:39.968543 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:39.968543 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:06:39.969543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:40.019049 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.020054 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:40.020054 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:06:40.052572 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:06:40.058566 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:40.058566 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:06:40.059566 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:06:40.061565 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:40.061565 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:06:40.062566 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:06:40.063566 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:06:40.063566 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:40.064565 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:06:40.064565 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:06:40.066565 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:06:40.066565 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:06:40.067565 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:06:40.068529 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:06:40.069569 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:06:39.965544 => 22:06:40.069569
[0m22:06:40.070573 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m22:06:40.070573 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E0F0E80>]}
[0m22:06:40.071573 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.11s]
[0m22:06:40.071573 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m22:06:40.072573 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:06:40.072573 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:06:40.073573 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:06:40.073573 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:06:40.073573 [info ] [Thread-3 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:06:40.074574 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:06:40.074574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:06:40.075574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:06:40.075574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:06:40.076574 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:06:40.076574 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:06:40.077574 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:06:40.080574 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:06:40.085574 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:06:40.088572 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:06:40.089573 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:06:40.077574 => 22:06:40.088572
[0m22:06:40.089573 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:06:40.086575 => 22:06:40.089573
[0m22:06:40.089573 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:06:40.080574 => 22:06:40.089573
[0m22:06:40.090573 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:06:40.090573 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:06:40.090573 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:06:40.092573 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:06:40.094574 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:06:40.096573 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:06:40.097575 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:06:40.097575 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:06:40.098574 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:06:40.098574 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:06:40.098574 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:06:40.099573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:40.099573 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:06:40.099573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:40.100573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:40.147082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.148082 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:06:40.148082 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:06:40.149083 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.150083 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:06:40.091573 => 22:06:40.150083
[0m22:06:40.151096 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:06:40.151096 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:06:40.152082 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:06:40.153082 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:06:40.153082 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:06:40.153082 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:06:40.154081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:06:40.154081 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:06:40.158081 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:06:40.159083 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:06:40.155081 => 22:06:40.159083
[0m22:06:40.159083 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:06:40.161082 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:06:40.162081 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:06:40.162081 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:06:40.162081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:40.182082 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.183083 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:06:40.183083 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:40.185083 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.186082 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:06:40.092573 => 22:06:40.186082
[0m22:06:40.186082 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:06:40.187098 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:06:40.187098 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.11s]
[0m22:06:40.188084 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:06:40.216087 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.216087 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:06:40.217086 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:06:40.217086 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.219595 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:06:40.095574 => 22:06:40.218590
[0m22:06:40.219595 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:06:40.220594 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:06:40.220594 [info ] [Thread-3 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.15s]
[0m22:06:40.221595 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:06:40.246678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.246678 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:06:40.247679 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:06:40.248678 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.249679 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:06:40.160082 => 22:06:40.249679
[0m22:06:40.249679 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:06:40.250680 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:06:40.251679 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m22:06:40.251679 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:06:40.252678 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:06:40.253679 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:06:40.253679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m22:06:40.254678 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:06:40.256677 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.257677 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:06:40.254678 => 22:06:40.256677
[0m22:06:40.257677 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:06:40.268678 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.269677 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.270678 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:06:40.270678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:40.327188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.327188 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.328187 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m22:06:40.330188 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:06:40.332186 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.332186 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:06:40.333186 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:06:40.334186 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:06:40.335186 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.335186 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:06:40.335186 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:06:40.338186 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:06:40.340186 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:06:40.340186 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:06:40.341186 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:06:40.342187 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:06:40.257677 => 22:06:40.342187
[0m22:06:40.342187 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:06:40.343187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E1B1AB0>]}
[0m22:06:40.343187 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m22:06:40.344187 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:06:40.345188 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:06:40.345188 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:06:40.346187 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:06:40.347187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:06:40.347187 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:06:40.348187 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:06:40.348187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:06:40.352187 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:06:40.352187 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:06:40.355188 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:06:40.355188 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:06:40.348187 => 22:06:40.355188
[0m22:06:40.356187 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:06:40.356187 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:06:40.352187 => 22:06:40.356187
[0m22:06:40.358186 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:06:40.358186 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:06:40.360187 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:06:40.360187 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:06:40.360187 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:06:40.361187 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:06:40.361187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:40.361187 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:06:40.362187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:40.408190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.409190 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:06:40.409190 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:06:40.410191 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.411191 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:06:40.356187 => 22:06:40.411191
[0m22:06:40.412191 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:06:40.412191 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:06:40.413190 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m22:06:40.414191 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:06:40.439697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.440696 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:06:40.440696 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:40.442698 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:06:40.443698 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:06:40.358186 => 22:06:40.443698
[0m22:06:40.443698 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:06:40.444697 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:06:40.445698 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m22:06:40.446698 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:06:40.447697 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:06:40.447697 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:06:40.448696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:06:40.448696 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:06:40.453696 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:06:40.453696 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:06:40.449696 => 22:06:40.453696
[0m22:06:40.454696 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:06:40.456696 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:06:40.458697 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:06:40.458697 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:06:40.458697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:40.506700 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.506700 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:06:40.507699 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as `Apps & Games_amount`
    ,case when category = 'Beauty' then amount else 0 end as `Beauty_amount`
    ,case when category = 'Books' then amount else 0 end as `Books_amount`
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as `Clothing, Shoes & Accessories_amount`
    ,case when category = 'Movies & TV' then amount else 0 end as `Movies & TV_amount`
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as `Sports, Fitness & Outdoors_amount`
    ,case when category = 'Kitchen' then amount else 0 end as `Kitchen_amount`
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:06:40.507699 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "`"
LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                              ^

[0m22:06:40.508699 [debug] [Thread-2 (]: On model.customer360.customers: ROLLBACK
[0m22:06:40.508699 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:06:40.454696 => 22:06:40.508699
[0m22:06:40.508699 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:06:40.511700 [debug] [Thread-2 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "`"
  LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:06:40.511700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b815e9-711d-4174-8d37-20ecf4dad3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E1951E0>]}
[0m22:06:40.512700 [error] [Thread-2 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.06s]
[0m22:06:40.512700 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:06:40.514700 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:40.514700 [debug] [MainThread]: On master: BEGIN
[0m22:06:40.514700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:40.570206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:06:40.570206 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.571207 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:40.571207 [debug] [MainThread]: On master: COMMIT
[0m22:06:40.571207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:06:40.572207 [debug] [MainThread]: On master: Close
[0m22:06:40.572207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:40.573206 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:06:40.573206 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:06:40.573206 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:06:40.573206 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:06:40.574207 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:06:40.574207 [info ] [MainThread]: 
[0m22:06:40.575206 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m22:06:40.576206 [debug] [MainThread]: Command end result
[0m22:06:40.584206 [info ] [MainThread]: 
[0m22:06:40.584206 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m22:06:40.585207 [info ] [MainThread]: 
[0m22:06:40.585207 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "`"
  LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:06:40.586206 [info ] [MainThread]: 
[0m22:06:40.586206 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:06:40.586206 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:06:40.587206 [info ] [MainThread]: 
[0m22:06:40.587206 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:06:40.588206 [info ] [MainThread]: 
[0m22:06:40.588206 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:06:40.588206 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:06:40.589206 [info ] [MainThread]: 
[0m22:06:40.589206 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:06:40.590206 [info ] [MainThread]: 
[0m22:06:40.590206 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m22:06:40.591206 [debug] [MainThread]: Command `dbt build` failed at 22:06:40.591206 after 1.81 seconds
[0m22:06:40.591206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2A7E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E23CD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2E23E080>]}
[0m22:06:40.592206 [debug] [MainThread]: Flushing usage events
[0m22:08:33.324279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A60CDC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6100D2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6100D2BC0>]}


============================== 22:08:33.327279 | ef74ce74-fa67-483d-81cb-69812b118b54 ==============================
[0m22:08:33.327279 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:08:33.328280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:08:33.448788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A608DC2E00>]}
[0m22:08:33.505295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A610319DE0>]}
[0m22:08:33.506295 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:08:33.515295 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:08:33.592806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:33.592806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:33.596806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61055FF10>]}
[0m22:08:33.603806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61045B1F0>]}
[0m22:08:33.604806 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:08:33.605807 [info ] [MainThread]: 
[0m22:08:33.606808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:33.607807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:08:33.614805 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:08:33.614805 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:08:33.614805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:33.669330 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:08:33.670330 [debug] [ThreadPool]: On list_dbt: Close
[0m22:08:33.671502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:08:33.675503 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:08:33.675503 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:08:33.676503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:33.721488 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:08:33.721488 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:08:33.722523 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:08:33.724484 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:08:33.725485 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:08:33.725485 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:08:33.729482 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.730482 [debug] [MainThread]: On master: BEGIN
[0m22:08:33.730482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:33.776990 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:08:33.776990 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.777992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:08:33.780990 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:08:33.781992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6105AE1D0>]}
[0m22:08:33.781992 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:33.782992 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.782992 [debug] [MainThread]: On master: BEGIN
[0m22:08:33.783992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:08:33.783992 [debug] [MainThread]: On master: COMMIT
[0m22:08:33.783992 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.783992 [debug] [MainThread]: On master: COMMIT
[0m22:08:33.784990 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:08:33.784990 [debug] [MainThread]: On master: Close
[0m22:08:33.785991 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:08:33.785991 [info ] [MainThread]: 
[0m22:08:33.788991 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:08:33.788991 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:08:33.788991 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:08:33.789991 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:08:33.789991 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:08:33.790991 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:08:33.790991 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:08:33.791992 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:08:33.792991 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:08:33.792991 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:08:33.793991 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:08:33.793991 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:08:33.793991 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:08:33.793991 => 22:08:33.793991
[0m22:08:33.794992 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:08:33.794992 => 22:08:33.794992
[0m22:08:33.806992 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:08:33.806992 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:08:33.807991 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:08:33.817991 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:08:33.794992 => 22:08:33.817991
[0m22:08:33.828990 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:08:33.829990 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:08:33.831991 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:08:33.832992 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:08:33.842992 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:08:33.842992 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:08:33.842992 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:33.843992 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:08:33.843992 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:08:33.844991 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:08:33.844991 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:08:33.901497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:33.902497 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:08:33.902497 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:08:33.930536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:33.931498 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:08:33.931498 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:08:33.935498 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:08:33.950916 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:08:33.957918 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:08:33.998424 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.028424 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:08:34.052465 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:08:34.053425 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:08:34.053425 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:08:34.054425 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:08:34.054817 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:08:34.058866 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:08:34.058866 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:08:34.059822 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:08:34.068821 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:08:34.068821 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:08:34.070325 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:08:34.070325 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:08:34.071329 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:08:34.071329 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:08:34.072329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:08:34.073331 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:08:33.807991 => 22:08:34.072329
[0m22:08:34.073331 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:08:34.073331 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.073331 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:08:34.074331 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:08:33.816992 => 22:08:34.074331
[0m22:08:34.075330 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:08:33.832992 => 22:08:34.075330
[0m22:08:34.076331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A610458BB0>]}
[0m22:08:34.076331 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:08:34.077330 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:08:34.077330 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.29s]
[0m22:08:34.078700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A610640040>]}
[0m22:08:34.079705 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:08:34.079705 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:08:34.080705 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:08:34.080705 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.29s]
[0m22:08:34.081705 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.29s]
[0m22:08:34.082705 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:08:34.081705 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:08:34.082705 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:08:34.083705 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:08:34.083705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:08:34.084705 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:08:34.084705 [info ] [Thread-3 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:08:34.084705 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:08:34.085705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:08:34.085705 [info ] [Thread-2 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:08:34.091706 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:08:34.091706 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:08:34.092706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:08:34.094704 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:08:34.095704 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:08:34.095704 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:08:34.086706 => 22:08:34.095704
[0m22:08:34.100704 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:08:34.100704 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:08:34.092706 => 22:08:34.100704
[0m22:08:34.101706 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:08:34.101706 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:08:34.102705 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:08:34.096705 => 22:08:34.101706
[0m22:08:34.103706 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:08:34.105704 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:08:34.105704 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:08:34.106705 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:08:34.108704 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:08:34.108704 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:08:34.108704 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:08:34.109704 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:08:34.109704 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:08:34.110705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.110705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:34.110705 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:08:34.111705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:34.156761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.156761 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:08:34.156761 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:08:34.157761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.159761 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:08:34.102705 => 22:08:34.158762
[0m22:08:34.159761 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:08:34.159761 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:08:34.160760 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m22:08:34.161761 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:08:34.161761 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:08:34.162761 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:08:34.162761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:08:34.163760 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:08:34.166761 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:08:34.166761 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:08:34.163760 => 22:08:34.166761
[0m22:08:34.167762 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:08:34.168761 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:08:34.170265 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:08:34.170265 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:08:34.171270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.187269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.187269 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:08:34.187269 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:08:34.188269 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.190269 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:08:34.103706 => 22:08:34.189270
[0m22:08:34.190269 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:08:34.191269 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:08:34.191269 [info ] [Thread-3 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m22:08:34.192269 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:08:34.217269 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.218269 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:08:34.218269 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:08:34.219270 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.221270 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:08:34.106705 => 22:08:34.220272
[0m22:08:34.221270 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:08:34.221270 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:08:34.222269 [warn ] [Thread-2 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.13s]
[0m22:08:34.223269 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:08:34.224269 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m22:08:34.224269 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:08:34.225268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m22:08:34.225268 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:08:34.227268 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:08:34.228269 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:08:34.225268 => 22:08:34.228269
[0m22:08:34.228269 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:08:34.250666 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:08:34.250666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.251667 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:08:34.251667 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.251667 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:08:34.252667 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:08:34.252667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:34.253667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.254668 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:08:34.167762 => 22:08:34.254668
[0m22:08:34.254668 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:08:34.255671 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:08:34.255671 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m22:08:34.256671 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:08:34.299176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.299176 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.300176 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:08:34.331067 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:08:34.337074 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.337074 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:08:34.338074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:08:34.340074 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.340074 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:08:34.341073 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:08:34.346072 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:08:34.346072 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.347071 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:08:34.347071 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:08:34.351072 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:08:34.354072 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:08:34.354072 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:08:34.356075 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:08:34.357076 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:08:34.229269 => 22:08:34.357076
[0m22:08:34.357076 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m22:08:34.358074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61072C760>]}
[0m22:08:34.359075 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.13s]
[0m22:08:34.359075 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:08:34.360075 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:08:34.360075 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:08:34.361076 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:08:34.361076 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:08:34.362076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:08:34.362076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:08:34.363077 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:08:34.363077 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:08:34.366074 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:08:34.368077 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:08:34.369077 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:08:34.363077 => 22:08:34.369077
[0m22:08:34.369077 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:08:34.371109 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:08:34.371109 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:08:34.366074 => 22:08:34.371109
[0m22:08:34.372110 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:08:34.372110 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:08:34.373110 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:08:34.374110 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:08:34.374110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:34.375111 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:08:34.376110 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:08:34.376110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.421497 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.421497 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:08:34.422498 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:08:34.423498 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.424499 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:08:34.370075 => 22:08:34.424499
[0m22:08:34.424499 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:08:34.425499 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:08:34.425499 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.06s]
[0m22:08:34.426498 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:08:34.451547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.452548 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:08:34.452548 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:08:34.454548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.455552 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:08:34.372110 => 22:08:34.455552
[0m22:08:34.455552 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:08:34.456552 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:08:34.456552 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m22:08:34.457552 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:08:34.457552 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m22:08:34.458553 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:08:34.459554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:08:34.459554 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:08:34.462551 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:08:34.463551 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:08:34.459554 => 22:08:34.463551
[0m22:08:34.463551 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m22:08:34.466551 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:08:34.467551 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.467551 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:08:34.467551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:34.515171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.515171 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.516171 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:08:34.548771 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:08:34.554760 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.554760 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:08:34.555935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:08:34.557935 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.557935 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:08:34.558937 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:08:34.559931 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:08:34.559931 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.560938 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:08:34.560938 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:08:34.562845 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:08:34.563929 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:08:34.563929 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:08:34.565810 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:08:34.566797 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:08:34.464551 => 22:08:34.566797
[0m22:08:34.566797 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m22:08:34.567798 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6106CD7E0>]}
[0m22:08:34.567798 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.11s]
[0m22:08:34.568799 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m22:08:34.568799 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:08:34.570312 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:08:34.570312 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:08:34.570312 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:08:34.571317 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:08:34.571317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:08:34.571317 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:08:34.572340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:08:34.572340 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:08:34.573339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:08:34.573339 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:08:34.576337 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:08:34.577338 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:08:34.582339 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:08:34.584338 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:08:34.585337 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:08:34.574338 => 22:08:34.585337
[0m22:08:34.586337 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:08:34.577338 => 22:08:34.585337
[0m22:08:34.586337 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:08:34.586337 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:08:34.582339 => 22:08:34.586337
[0m22:08:34.587338 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:08:34.588339 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:08:34.588339 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:08:34.591337 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:08:34.593339 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:08:34.593339 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:08:34.594342 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:08:34.594342 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:08:34.595338 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:08:34.595338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.595338 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:08:34.595338 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:08:34.596338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:34.596338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:34.645317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.646317 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:08:34.646317 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:08:34.647317 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.648317 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:08:34.587338 => 22:08:34.648317
[0m22:08:34.648317 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:08:34.649317 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:08:34.650320 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:08:34.650320 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:08:34.651318 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:08:34.651318 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:08:34.652319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:08:34.652319 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:08:34.656322 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:08:34.656322 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:08:34.652319 => 22:08:34.656322
[0m22:08:34.657322 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:08:34.659323 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:08:34.659323 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:08:34.660322 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:08:34.660322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.678931 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.679931 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:08:34.679931 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:08:34.680930 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.682931 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:08:34.589337 => 22:08:34.681930
[0m22:08:34.682931 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:08:34.682931 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:08:34.683930 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m22:08:34.684935 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:08:34.711894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.711894 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:08:34.712893 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:08:34.713894 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.714893 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:08:34.591337 => 22:08:34.714893
[0m22:08:34.715893 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:08:34.715893 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:08:34.716893 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m22:08:34.717918 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:08:34.742914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.742914 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:08:34.743915 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:08:34.744914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.745915 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:08:34.657322 => 22:08:34.745915
[0m22:08:34.745915 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:08:34.746915 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:08:34.746915 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m22:08:34.747914 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:08:34.748914 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:08:34.748914 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:08:34.749915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m22:08:34.749915 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:08:34.752894 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.753922 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:08:34.750914 => 22:08:34.752894
[0m22:08:34.753922 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:08:34.765951 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.765951 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.766951 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:08:34.766951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:34.814484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.814484 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.815483 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m22:08:34.816484 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:08:34.819483 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.819483 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:08:34.820483 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:08:34.821484 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:08:34.821484 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.822484 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:08:34.822484 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:08:34.825482 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:08:34.827482 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:08:34.827482 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:08:34.828483 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:08:34.829483 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:08:34.753922 => 22:08:34.828483
[0m22:08:34.829483 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:08:34.830463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6107A69B0>]}
[0m22:08:34.830463 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m22:08:34.831466 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:08:34.832463 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:08:34.832463 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:08:34.832463 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:08:34.833464 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:08:34.833464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:08:34.834492 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:08:34.834492 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:08:34.835484 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:08:34.838484 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:08:34.840462 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:08:34.841482 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:08:34.835484 => 22:08:34.841482
[0m22:08:34.842462 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:08:34.842462 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:08:34.838484 => 22:08:34.842462
[0m22:08:34.843483 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:08:34.844484 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:08:34.845483 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:08:34.846483 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:08:34.846483 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:08:34.847484 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:08:34.847484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:34.847484 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:08:34.848484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:34.893989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:34.894989 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:08:34.894989 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:08:34.896992 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:34.897992 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:08:34.842462 => 22:08:34.897992
[0m22:08:34.897992 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:08:34.898992 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:08:34.898992 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m22:08:34.899997 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:08:35.040030 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:35.041030 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:08:35.041030 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:08:35.043029 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:08:35.044031 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:08:34.844484 => 22:08:35.044031
[0m22:08:35.044031 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:08:35.044031 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:08:35.045030 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.21s]
[0m22:08:35.046030 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:08:35.047030 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:08:35.047030 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:08:35.048030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:08:35.048030 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:08:35.052029 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:08:35.053028 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:08:35.048030 => 22:08:35.053028
[0m22:08:35.054030 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:08:35.056034 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:08:35.057034 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:08:35.057034 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:08:35.058034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:35.104538 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:08:35.104538 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:08:35.105539 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as `Apps & Games_amount`
    ,case when category = 'Beauty' then amount else 0 end as `Beauty_amount`
    ,case when category = 'Books' then amount else 0 end as `Books_amount`
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as `Clothing, Shoes & Accessories_amount`
    ,case when category = 'Movies & TV' then amount else 0 end as `Movies & TV_amount`
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as `Sports, Fitness & Outdoors_amount`
    ,case when category = 'Kitchen' then amount else 0 end as `Kitchen_amount`
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:08:35.105539 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "`"
LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                              ^

[0m22:08:35.106539 [debug] [Thread-2 (]: On model.customer360.customers: ROLLBACK
[0m22:08:35.106539 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:08:35.054030 => 22:08:35.106539
[0m22:08:35.107540 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:08:35.109540 [debug] [Thread-2 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "`"
  LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:08:35.109540 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef74ce74-fa67-483d-81cb-69812b118b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6107842E0>]}
[0m22:08:35.110540 [error] [Thread-2 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.06s]
[0m22:08:35.111539 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:08:35.112540 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:35.112540 [debug] [MainThread]: On master: BEGIN
[0m22:08:35.112540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:35.158543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:08:35.158543 [debug] [MainThread]: On master: COMMIT
[0m22:08:35.159542 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:35.159542 [debug] [MainThread]: On master: COMMIT
[0m22:08:35.159542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:08:35.160542 [debug] [MainThread]: On master: Close
[0m22:08:35.160542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:35.161542 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:08:35.161542 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:08:35.161542 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:08:35.162543 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:08:35.162543 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:08:35.162543 [info ] [MainThread]: 
[0m22:08:35.163543 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m22:08:35.165543 [debug] [MainThread]: Command end result
[0m22:08:35.173052 [info ] [MainThread]: 
[0m22:08:35.173052 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m22:08:35.174050 [info ] [MainThread]: 
[0m22:08:35.174050 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  syntax error at or near "`"
  LINE 27: ...tegory = 'Apps & Games' then amount else 0 end as `Apps & Ga...
                                                                ^
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:08:35.175173 [info ] [MainThread]: 
[0m22:08:35.175173 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:08:35.175173 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:08:35.176176 [info ] [MainThread]: 
[0m22:08:35.176176 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:08:35.177177 [info ] [MainThread]: 
[0m22:08:35.177177 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:08:35.178177 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:08:35.178177 [info ] [MainThread]: 
[0m22:08:35.179178 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:08:35.179178 [info ] [MainThread]: 
[0m22:08:35.180177 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m22:08:35.181177 [debug] [MainThread]: Command `dbt build` failed at 22:08:35.181177 after 1.89 seconds
[0m22:08:35.181177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A60CDC5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6107A69B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61082EBF0>]}
[0m22:08:35.181177 [debug] [MainThread]: Flushing usage events
[0m22:08:45.700011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB67A07220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6AD02D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6AD02B00>]}


============================== 22:08:45.703034 | 0fd1e0ed-2189-49dc-b8bc-0126881a544b ==============================
[0m22:08:45.703034 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:08:45.704035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:45.823608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB63A02E30>]}
[0m22:08:45.879590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6ACB93F0>]}
[0m22:08:45.880590 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:08:45.889160 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:08:45.965841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:45.966841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:45.970840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6B193E50>]}
[0m22:08:45.978874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6B09EE60>]}
[0m22:08:45.978874 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:08:45.979873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6B09EEF0>]}
[0m22:08:45.980873 [info ] [MainThread]: 
[0m22:08:45.980873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:45.981873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:08:45.988874 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:08:45.989419 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:08:45.989419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:46.041614 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:08:46.041614 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:08:46.041614 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:08:46.043629 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:08:46.044630 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:08:46.045629 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:08:46.049629 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:46.049629 [debug] [MainThread]: On master: BEGIN
[0m22:08:46.049629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:46.095233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:08:46.095233 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:46.096232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:08:46.099233 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:08:46.100233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fd1e0ed-2189-49dc-b8bc-0126881a544b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6B09D2D0>]}
[0m22:08:46.100233 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:46.101232 [debug] [MainThread]: On master: Close
[0m22:08:46.101232 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:08:46.102232 [info ] [MainThread]: 
[0m22:08:46.104237 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:08:46.105234 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m22:08:46.105234 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:08:46.112215 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:08:46.112215 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:08:46.105234 => 22:08:46.112215
[0m22:08:46.113215 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:08:46.113215 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:08:46.113215 => 22:08:46.113215
[0m22:08:46.114233 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:08:46.115233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:46.115233 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:08:46.115233 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:08:46.116232 [debug] [MainThread]: Command end result
[0m22:08:46.122239 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as `Apps & Games_amount`
    ,case when category = 'Beauty' then amount else 0 end as `Beauty_amount`
    ,case when category = 'Books' then amount else 0 end as `Books_amount`
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as `Clothing, Shoes & Accessories_amount`
    ,case when category = 'Movies & TV' then amount else 0 end as `Movies & TV_amount`
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as `Sports, Fitness & Outdoors_amount`
    ,case when category = 'Kitchen' then amount else 0 end as `Kitchen_amount`
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m22:08:46.124210 [debug] [MainThread]: Command `dbt compile` succeeded at 22:08:46.124210 after 0.46 seconds
[0m22:08:46.124210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB67A07220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6ACB93F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB6B09DC00>]}
[0m22:08:46.125210 [debug] [MainThread]: Flushing usage events
[0m22:10:43.897467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F3155090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6452DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6452B30>]}


============================== 22:10:43.900465 | cf832beb-7389-413d-b557-4e921eae071b ==============================
[0m22:10:43.900465 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:10:43.901467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -s customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:44.021589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EF102E30>]}
[0m22:10:44.079179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F668A440>]}
[0m22:10:44.080179 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:10:44.089180 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:10:44.165686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:44.166687 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:10:44.259195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6A4C0D0>]}
[0m22:10:44.266210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F67E6EF0>]}
[0m22:10:44.267215 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:10:44.267215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F67E6E90>]}
[0m22:10:44.268215 [info ] [MainThread]: 
[0m22:10:44.269214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:44.270214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:10:44.276214 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:10:44.276214 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:10:44.277214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:44.328451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:44.328451 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:10:44.329451 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:10:44.330450 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:10:44.331981 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:10:44.333020 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:10:44.337019 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:44.337019 [debug] [MainThread]: On master: BEGIN
[0m22:10:44.337019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:44.384156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:44.384156 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:44.385155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:44.388154 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:10:44.389156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf832beb-7389-413d-b557-4e921eae071b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F67E5360>]}
[0m22:10:44.389156 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:44.390156 [debug] [MainThread]: On master: Close
[0m22:10:44.390156 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:10:44.391156 [info ] [MainThread]: 
[0m22:10:44.393155 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:10:44.394155 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m22:10:44.394155 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:10:44.400154 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:10:44.401154 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:10:44.394155 => 22:10:44.401154
[0m22:10:44.401154 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:10:44.402154 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:10:44.401154 => 22:10:44.401154
[0m22:10:44.402154 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:10:44.403644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:44.403644 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:10:44.403644 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:10:44.404689 [debug] [MainThread]: Command end result
[0m22:10:44.409694 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end --as `Apps & Games_amount`
    ,case when category = 'Beauty' then amount else 0 end --as `Beauty_amount`
    ,case when category = 'Books' then amount else 0 end --as `Books_amount`
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end --as `Clothing, Shoes & Accessories_amount`
    ,case when category = 'Movies & TV' then amount else 0 end --as `Movies & TV_amount`
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end --as `Sports, Fitness & Outdoors_amount`
    ,case when category = 'Kitchen' then amount else 0 end --as `Kitchen_amount`
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum(Apps & Games_amount)
    ,sum(Beauty_amount)
    ,sum(Books_amount)
    ,sum(Clothing, Shoes & Accessories_amount)
    ,sum(Movies & TV_amount)
    ,sum(Sports, Fitness & Outdoors_amount)
    ,sum(Kitchen_amount)
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m22:10:44.412694 [debug] [MainThread]: Command `dbt compile` succeeded at 22:10:44.411691 after 0.55 seconds
[0m22:10:44.412694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F3155090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F68C7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6A7DF60>]}
[0m22:10:44.412694 [debug] [MainThread]: Flushing usage events
[0m22:10:52.308890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F4245090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7542DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7542B30>]}


============================== 22:10:52.311889 | 4ebef769-d82c-4f7a-b63e-d7d8ebf844d7 ==============================
[0m22:10:52.311889 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:10:52.312890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -s customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:52.431408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F0222E30>]}
[0m22:10:52.488919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7782440>]}
[0m22:10:52.489919 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:10:52.499918 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:10:52.577351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:52.578354 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:10:52.668980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7B3C0D0>]}
[0m22:10:52.676982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F78DAEF0>]}
[0m22:10:52.676982 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:10:52.677981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F78DAE90>]}
[0m22:10:52.678983 [info ] [MainThread]: 
[0m22:10:52.678983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:52.679981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:10:52.685981 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:10:52.686981 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:10:52.686981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:52.735148 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:52.736147 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:10:52.736147 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:10:52.738148 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:10:52.739653 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:10:52.739653 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:10:52.743656 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:52.744656 [debug] [MainThread]: On master: BEGIN
[0m22:10:52.744656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:52.789658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:52.790658 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:52.790658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:52.793656 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:10:52.795659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebef769-d82c-4f7a-b63e-d7d8ebf844d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F78D9360>]}
[0m22:10:52.795659 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:52.795659 [debug] [MainThread]: On master: Close
[0m22:10:52.796658 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:10:52.797658 [info ] [MainThread]: 
[0m22:10:52.798658 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:10:52.799826 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.customers'
[0m22:10:52.799826 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:10:52.805831 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:10:52.806832 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:10:52.800832 => 22:10:52.806832
[0m22:10:52.807831 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:10:52.807831 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:10:52.807831 => 22:10:52.807831
[0m22:10:52.808830 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:10:52.808830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:52.809832 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:10:52.809832 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:10:52.809832 [debug] [MainThread]: Command end result
[0m22:10:52.815832 [info ] [MainThread]: Compiled node 'customers' is:
with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount")
    ,sum("Beauty_amount")
    ,sum("Books_amount")
    ,sum("Clothing, Shoes & Accessories_amount")
    ,sum("Movies & TV_amount")
    ,sum("Sports, Fitness & Outdoors_amount")
    ,sum("Kitchen_amount")
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
[0m22:10:52.818831 [debug] [MainThread]: Command `dbt compile` succeeded at 22:10:52.818831 after 0.55 seconds
[0m22:10:52.818831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F4245090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F79B7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217F7B65F60>]}
[0m22:10:52.819830 [debug] [MainThread]: Flushing usage events
[0m22:11:07.692843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964A244580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D542DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D542B30>]}


============================== 22:11:07.695843 | a4bcbdcf-8983-4acb-92ee-2ae3335f5c84 ==============================
[0m22:11:07.695843 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:11:07.696854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m22:11:07.816405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029646292E00>]}
[0m22:11:07.872961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D78A440>]}
[0m22:11:07.872961 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:11:07.881956 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:11:07.955853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:11:07.955853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:11:07.959853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D9CBE80>]}
[0m22:11:07.967889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D8CB0A0>]}
[0m22:11:07.968889 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:11:07.969930 [info ] [MainThread]: 
[0m22:11:07.970888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:07.971890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:11:07.977930 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:11:07.978931 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:11:07.978931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:08.028497 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:11:08.030496 [debug] [ThreadPool]: On list_dbt: Close
[0m22:11:08.031497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:11:08.036496 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:11:08.036496 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:11:08.036496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:08.081416 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.081416 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:11:08.082416 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:11:08.084416 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:11:08.085418 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:11:08.085418 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:11:08.090416 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:08.090416 [debug] [MainThread]: On master: BEGIN
[0m22:11:08.090416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:08.135584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.136584 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:08.136584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:11:08.139584 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:11:08.140585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DA1A140>]}
[0m22:11:08.141583 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:08.141583 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:08.141583 [debug] [MainThread]: On master: BEGIN
[0m22:11:08.142583 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.142583 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.142583 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:08.143584 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.143584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:11:08.143584 [debug] [MainThread]: On master: Close
[0m22:11:08.144583 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:11:08.144583 [info ] [MainThread]: 
[0m22:11:08.146584 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:11:08.147589 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:11:08.147589 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:11:08.147589 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:11:08.148588 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:11:08.148588 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:11:08.149588 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:11:08.149588 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:11:08.150589 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:11:08.150589 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:11:08.151588 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:11:08.151588 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:11:08.151588 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:11:08.151588 => 22:11:08.151588
[0m22:11:08.152589 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:11:08.152589 => 22:11:08.152589
[0m22:11:08.164136 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:11:08.165098 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:11:08.165098 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:11:08.175096 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:11:08.152589 => 22:11:08.175096
[0m22:11:08.186097 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:11:08.188097 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:11:08.190098 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:11:08.190098 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:11:08.200096 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:11:08.200096 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:11:08.201096 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:08.201096 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:08.202097 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:11:08.203097 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:11:08.203097 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:08.246530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.247533 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:11:08.247533 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:11:08.275578 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.276534 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:11:08.276534 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:11:08.279580 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:11:08.289531 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:11:08.303531 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:11:08.353534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.398038 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:11:08.398590 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:11:08.398590 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:11:08.398590 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:11:08.399597 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:11:08.400596 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:11:08.404597 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:11:08.404597 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:11:08.405596 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:11:08.414637 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:11:08.414637 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:11:08.414637 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:11:08.416597 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:11:08.416597 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:11:08.416597 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:11:08.417596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:08.417596 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:11:08.165098 => 22:11:08.417596
[0m22:11:08.418597 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:08.418597 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.418597 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:11:08.419596 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:11:08.174096 => 22:11:08.419596
[0m22:11:08.420596 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:11:08.190098 => 22:11:08.420596
[0m22:11:08.421595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964D8CAFB0>]}
[0m22:11:08.421595 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:11:08.422596 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:11:08.423667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DA5FDC0>]}
[0m22:11:08.422596 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.27s]
[0m22:11:08.423667 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:11:08.424675 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.27s]
[0m22:11:08.424675 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:11:08.426675 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:11:08.425674 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m22:11:08.426675 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:11:08.427674 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:11:08.427674 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:11:08.427674 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:11:08.428674 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:11:08.428674 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:11:08.429674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:11:08.429674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:11:08.430674 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:11:08.430674 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:11:08.430674 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:11:08.436918 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:11:08.437919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:11:08.440916 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:11:08.440916 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:11:08.441917 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:11:08.431674 => 22:11:08.441917
[0m22:11:08.445916 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:11:08.445916 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:11:08.437919 => 22:11:08.445916
[0m22:11:08.446916 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:11:08.446916 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:11:08.447920 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:11:08.441917 => 22:11:08.446916
[0m22:11:08.448922 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:11:08.451058 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:11:08.452055 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:11:08.452558 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:11:08.454563 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:11:08.454563 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:11:08.455562 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:11:08.455562 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:11:08.455562 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:11:08.456563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.456563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:08.456563 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:11:08.457563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:08.504300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.504300 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:11:08.505300 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:11:08.506300 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.507300 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:11:08.447920 => 22:11:08.507300
[0m22:11:08.507300 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:11:08.508300 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:11:08.508300 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m22:11:08.509300 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:11:08.510301 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:11:08.510301 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:11:08.511300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:11:08.511300 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:11:08.514302 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:11:08.515301 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:11:08.511300 => 22:11:08.515301
[0m22:11:08.515301 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:11:08.517301 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:11:08.518430 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:11:08.518430 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:11:08.518430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.567947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.571946 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:11:08.571946 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:08.572946 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.573947 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:11:08.452558 => 22:11:08.573947
[0m22:11:08.574946 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:11:08.574946 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:11:08.575945 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m22:11:08.576946 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:11:08.576946 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m22:11:08.577946 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:11:08.577946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_sf__contacts)
[0m22:11:08.578947 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:11:08.580947 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:11:08.581947 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:11:08.578947 => 22:11:08.581947
[0m22:11:08.581947 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:11:08.603992 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:11:08.604946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.604946 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.604946 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:11:08.605946 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:11:08.605946 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:08.605946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:08.607947 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.608947 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:11:08.516301 => 22:11:08.608947
[0m22:11:08.608947 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:11:08.609946 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:11:08.609946 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m22:11:08.610947 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:11:08.648317 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.648317 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:11:08.648317 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:11:08.649317 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.651317 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:11:08.449920 => 22:11:08.650318
[0m22:11:08.651317 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:11:08.652318 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:11:08.653317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.652318 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.22s]
[0m22:11:08.653317 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.654317 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:11:08.654317 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:11:08.688839 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:11:08.693839 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.694839 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:11:08.694839 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:11:08.696838 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.697838 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:11:08.697838 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:11:08.702838 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:11:08.703839 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.703839 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:11:08.704839 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:08.708838 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:11:08.711838 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:11:08.711838 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:11:08.713839 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:11:08.714839 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:11:08.581947 => 22:11:08.714839
[0m22:11:08.715839 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m22:11:08.715839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DBF20E0>]}
[0m22:11:08.716840 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m22:11:08.716840 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:11:08.717840 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:11:08.717840 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:11:08.718840 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:11:08.718840 [info ] [Thread-2 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:11:08.719840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:11:08.719840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:11:08.720839 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:11:08.720839 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:11:08.723838 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:11:08.725838 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:11:08.726839 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:11:08.720839 => 22:11:08.726839
[0m22:11:08.726839 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:11:08.723838 => 22:11:08.726839
[0m22:11:08.727839 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:11:08.727839 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:11:08.729839 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:11:08.730839 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:11:08.731840 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:11:08.731840 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:11:08.732841 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:11:08.732841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.732841 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:11:08.733840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:08.808564 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.808564 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:11:08.809563 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:08.810562 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.811565 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:11:08.729839 => 22:11:08.811565
[0m22:11:08.811565 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:11:08.812563 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:11:08.812563 [info ] [Thread-2 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m22:11:08.813563 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:11:08.884050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.884050 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:11:08.885050 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:11:08.886147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:08.887192 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:11:08.727839 => 22:11:08.887192
[0m22:11:08.887192 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:11:08.888192 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:11:08.888192 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.17s]
[0m22:11:08.889199 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:11:08.890154 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m22:11:08.890154 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:11:08.891196 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:11:08.891196 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:11:08.895191 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:11:08.895191 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:11:08.892194 => 22:11:08.895191
[0m22:11:08.896195 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m22:11:08.898192 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:11:08.899192 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.899192 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:11:08.899192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:08.946439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:08.946439 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.947442 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:11:08.978947 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:11:08.982947 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.982947 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:11:08.983947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:11:08.985947 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.985947 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:11:08.986947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:11:08.987947 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:11:08.988946 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.988946 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:11:08.989947 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:08.990949 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:11:08.991948 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:11:08.991948 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:11:08.993947 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:11:08.994947 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:11:08.896195 => 22:11:08.994947
[0m22:11:08.994947 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m22:11:08.995947 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DB3A9B0>]}
[0m22:11:08.995947 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.10s]
[0m22:11:08.996947 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m22:11:08.997948 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:11:08.997948 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:11:08.997948 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:11:08.998948 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:11:08.998948 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:11:08.999949 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:11:08.999949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:11:09.000947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:11:09.000947 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:11:09.001947 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:11:09.001947 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:11:09.001947 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:11:09.004947 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:11:09.009946 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:11:09.012946 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:11:09.013948 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:11:09.002947 => 22:11:09.013948
[0m22:11:09.013948 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:11:09.014948 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:11:09.010947 => 22:11:09.014948
[0m22:11:09.014948 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:11:09.005946 => 22:11:09.014948
[0m22:11:09.016948 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:11:09.017947 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:11:09.017947 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:11:09.018947 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:11:09.020947 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:11:09.022947 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:11:09.022947 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:11:09.023949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:09.023949 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:11:09.024947 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:11:09.024947 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:11:09.024947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:09.025948 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:11:09.025948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:09.070458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.071458 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:11:09.071458 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:11:09.072457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.073457 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:11:09.015948 => 22:11:09.073457
[0m22:11:09.074457 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:11:09.074457 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:11:09.075457 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:11:09.076458 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:11:09.076458 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:11:09.077458 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:11:09.077458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:11:09.078458 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:11:09.081457 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:11:09.082457 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:11:09.078458 => 22:11:09.082457
[0m22:11:09.083458 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:11:09.084458 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:11:09.085459 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:11:09.085459 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:11:09.085459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:09.130458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.131458 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:11:09.131458 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:11:09.132457 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.134457 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:11:09.020947 => 22:11:09.133457
[0m22:11:09.134457 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:11:09.134457 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:11:09.135457 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.13s]
[0m22:11:09.136457 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:11:09.162967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.163967 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:11:09.163967 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:11:09.164967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.165966 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:11:09.083458 => 22:11:09.165966
[0m22:11:09.166966 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:11:09.166966 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:11:09.167966 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m22:11:09.168967 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:11:09.200882 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.200882 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:11:09.201884 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:09.202883 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.203882 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:11:09.018947 => 22:11:09.203882
[0m22:11:09.204882 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:11:09.204882 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:11:09.205882 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.20s]
[0m22:11:09.205882 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:11:09.206883 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:11:09.206883 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:11:09.207886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m22:11:09.207886 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:11:09.210884 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.211883 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:11:09.208884 => 22:11:09.210884
[0m22:11:09.211883 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:11:09.222882 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.223883 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.224883 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:11:09.224883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:09.270766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.270766 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.270766 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m22:11:09.272766 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:11:09.274765 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.275764 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:11:09.275764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:11:09.277766 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:11:09.277766 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.277766 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:11:09.278821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:09.281332 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:11:09.283332 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:11:09.283332 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:11:09.284333 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:11:09.285339 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:11:09.211883 => 22:11:09.285339
[0m22:11:09.285339 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:11:09.286338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DC9BF10>]}
[0m22:11:09.286338 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m22:11:09.287337 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:11:09.288335 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:11:09.288335 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:11:09.288335 [info ] [Thread-3 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:11:09.289336 [info ] [Thread-1 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:11:09.289336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:11:09.290334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:11:09.290334 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:11:09.291336 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:11:09.293337 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:11:09.296332 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:11:09.297335 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:11:09.294337 => 22:11:09.297335
[0m22:11:09.297335 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:11:09.291336 => 22:11:09.297335
[0m22:11:09.298334 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:11:09.298334 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:11:09.300335 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:11:09.301338 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:11:09.302336 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:11:09.303336 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:11:09.303336 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:11:09.304338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:09.304338 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:11:09.305338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:11:09.352345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.353378 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:11:09.353378 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:09.355344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.356342 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:11:09.298334 => 22:11:09.356342
[0m22:11:09.356342 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:11:09.357341 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:11:09.358360 [warn ] [Thread-1 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.07s]
[0m22:11:09.358360 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:11:09.381846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.381846 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:11:09.382848 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:11:09.383849 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:09.384850 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:11:09.300335 => 22:11:09.384850
[0m22:11:09.385851 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:11:09.385851 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:11:09.386851 [info ] [Thread-3 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.10s]
[0m22:11:09.387851 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:11:09.387851 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:11:09.388849 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:11:09.389848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:11:09.389848 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:11:09.393847 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:11:09.394846 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:11:09.389848 => 22:11:09.394846
[0m22:11:09.394846 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:11:09.397851 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:11:09.398850 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:11:09.398850 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:11:09.399847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:11:09.445846 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.446849 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:11:09.446849 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount")
    ,sum("Beauty_amount")
    ,sum("Books_amount")
    ,sum("Clothing, Shoes & Accessories_amount")
    ,sum("Movies & TV_amount")
    ,sum("Sports, Fitness & Outdoors_amount")
    ,sum("Kitchen_amount")
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:11:09.448852 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "sum" specified more than once

[0m22:11:09.448852 [debug] [Thread-2 (]: On model.customer360.customers: ROLLBACK
[0m22:11:09.449856 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:11:09.395846 => 22:11:09.449856
[0m22:11:09.449856 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:11:09.451856 [debug] [Thread-2 (]: Database Error in model customers (models\marts\marketing\customers.sql)
  column "sum" specified more than once
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:11:09.452856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bcbdcf-8983-4acb-92ee-2ae3335f5c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DC9F1C0>]}
[0m22:11:09.452856 [error] [Thread-2 (]: 19 of 19 ERROR creating sql table model public.customers ....................... [[31mERROR[0m in 0.06s]
[0m22:11:09.453855 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:11:09.454854 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:09.454854 [debug] [MainThread]: On master: BEGIN
[0m22:11:09.455855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:09.501361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:11:09.501361 [debug] [MainThread]: On master: COMMIT
[0m22:11:09.501361 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:09.502364 [debug] [MainThread]: On master: COMMIT
[0m22:11:09.502364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:11:09.503365 [debug] [MainThread]: On master: Close
[0m22:11:09.503365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:09.504366 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:11:09.504366 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:11:09.505364 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:11:09.505364 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:11:09.505364 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:11:09.506361 [info ] [MainThread]: 
[0m22:11:09.506361 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m22:11:09.508360 [debug] [MainThread]: Command end result
[0m22:11:09.515361 [info ] [MainThread]: 
[0m22:11:09.516364 [info ] [MainThread]: [31mCompleted with 1 error and 2 warnings:[0m
[0m22:11:09.516364 [info ] [MainThread]: 
[0m22:11:09.516364 [error] [MainThread]:   Database Error in model customers (models\marts\marketing\customers.sql)
  column "sum" specified more than once
  compiled Code at target\run\customer360\models\marts\marketing\customers.sql
[0m22:11:09.517364 [info ] [MainThread]: 
[0m22:11:09.517364 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:11:09.518363 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:11:09.518363 [info ] [MainThread]: 
[0m22:11:09.519363 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:11:09.519363 [info ] [MainThread]: 
[0m22:11:09.520361 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:11:09.520361 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:11:09.520361 [info ] [MainThread]: 
[0m22:11:09.521361 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:11:09.521361 [info ] [MainThread]: 
[0m22:11:09.522361 [info ] [MainThread]: Done. PASS=16 WARN=2 ERROR=1 SKIP=0 TOTAL=19
[0m22:11:09.522361 [debug] [MainThread]: Command `dbt build` failed at 22:11:09.522361 after 1.87 seconds
[0m22:11:09.523360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964A244580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DC9BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964DCBC310>]}
[0m22:11:09.523360 [debug] [MainThread]: Flushing usage events
[0m22:14:56.081663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F12B26AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F15E22DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F15E22B60>]}


============================== 22:14:56.083662 | 4761ca19-0952-4ff3-8900-5377e63fff2a ==============================
[0m22:14:56.083662 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:14:56.084662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:56.213106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0EB62E00>]}
[0m22:14:56.273123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F15DD6CB0>]}
[0m22:14:56.274123 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:14:56.284122 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:14:56.368223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:14:56.368223 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:14:56.460875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F164280D0>]}
[0m22:14:56.467874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F161AB190>]}
[0m22:14:56.468874 [info ] [MainThread]: Found 2 seeds, 4 models, 13 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:14:56.470378 [info ] [MainThread]: 
[0m22:14:56.471381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:56.472381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:14:56.478381 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:14:56.479381 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:14:56.480381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:56.534381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:14:56.535382 [debug] [ThreadPool]: On list_dbt: Close
[0m22:14:56.536381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:14:56.540381 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:14:56.541381 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:14:56.541381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:56.586911 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.587911 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:14:56.587911 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:14:56.589911 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:14:56.590911 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:14:56.591911 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:14:56.595911 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.596911 [debug] [MainThread]: On master: BEGIN
[0m22:14:56.596911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:56.646911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.647911 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.647911 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:56.650911 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:14:56.652911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1642D6C0>]}
[0m22:14:56.652911 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:56.652911 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.653911 [debug] [MainThread]: On master: BEGIN
[0m22:14:56.653911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.653911 [debug] [MainThread]: On master: COMMIT
[0m22:14:56.654911 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.654911 [debug] [MainThread]: On master: COMMIT
[0m22:14:56.654911 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:14:56.655913 [debug] [MainThread]: On master: Close
[0m22:14:56.655913 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:14:56.656914 [info ] [MainThread]: 
[0m22:14:56.658913 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:14:56.659914 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:14:56.659914 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:14:56.659914 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:14:56.660914 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:14:56.661914 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:14:56.660914 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:14:56.661914 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:14:56.662914 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:14:56.663914 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:14:56.663914 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:14:56.664914 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:14:56.663914 => 22:14:56.663914
[0m22:14:56.664914 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:14:56.665913 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:14:56.664914 => 22:14:56.664914
[0m22:14:56.665913 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:14:56.678420 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:14:56.678420 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:14:56.698419 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:14:56.699420 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:14:56.665913 => 22:14:56.699420
[0m22:14:56.700419 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:14:56.703419 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:14:56.704420 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:14:56.704420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:14:56.705420 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:14:56.714419 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:14:56.715420 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:56.715420 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:14:56.716422 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:14:56.716422 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:14:56.767131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.767131 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:14:56.768130 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:14:56.799742 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.800743 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:14:56.800743 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:14:56.801743 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:14:56.821742 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:14:56.823744 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:14:56.853742 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:56.870312 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:14:56.916327 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:14:56.917328 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:14:56.917328 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:14:56.918328 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:14:56.918328 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:14:56.922352 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:14:56.923349 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:14:56.923770 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:14:56.932775 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:14:56.932775 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:14:56.932775 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:14:56.933776 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:14:56.934776 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:14:56.934776 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:14:56.935776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:56.935776 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:14:56.678420 => 22:14:56.935776
[0m22:14:56.936777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:56.936777 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:56.936777 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:14:56.937776 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:14:56.698419 => 22:14:56.937776
[0m22:14:56.938777 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:14:56.705420 => 22:14:56.938777
[0m22:14:56.939775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1625BD90>]}
[0m22:14:56.939775 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:14:56.940777 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:14:56.941776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1643E260>]}
[0m22:14:56.940777 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.28s]
[0m22:14:56.941776 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:14:56.942777 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:14:56.942777 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m22:14:56.943777 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m22:14:56.944776 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:14:56.944776 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:14:56.945776 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:14:56.946777 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:14:56.945776 [info ] [Thread-1 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:14:56.946777 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:14:56.947777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:14:56.946777 [info ] [Thread-2 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:14:56.947777 [info ] [Thread-3 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:14:56.948777 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:14:56.948777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:14:56.949777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:14:56.954775 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:14:56.955778 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:14:56.955778 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:14:56.958779 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:14:56.959779 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:14:56.950776 => 22:14:56.958779
[0m22:14:56.963780 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:14:56.963780 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:14:56.964780 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:14:56.956779 => 22:14:56.964780
[0m22:14:56.966780 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:14:56.966780 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:14:56.959779 => 22:14:56.966780
[0m22:14:56.966780 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:14:56.967780 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:14:56.967780 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:14:56.968779 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:14:56.971287 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:14:56.972287 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:14:56.972287 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:14:56.973287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:56.973287 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:14:56.973287 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:14:56.974286 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:14:56.974286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:56.975286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:57.020285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.021285 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:14:57.021285 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:14:57.022285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.023285 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:14:56.964780 => 22:14:57.023285
[0m22:14:57.024287 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:14:57.024287 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:14:57.025286 [info ] [Thread-1 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m22:14:57.026287 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:14:57.026287 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:14:57.027287 [info ] [Thread-1 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:14:57.027287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:14:57.028286 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:14:57.031286 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:14:57.032286 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:14:57.028286 => 22:14:57.031286
[0m22:14:57.032286 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:14:57.034286 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:14:57.035286 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:14:57.035286 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:14:57.036286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.051287 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.052287 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:14:57.052287 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:14:57.053287 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.055286 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:14:56.967780 => 22:14:57.055286
[0m22:14:57.055286 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:14:57.056289 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:14:57.057289 [info ] [Thread-2 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m22:14:57.057289 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:14:57.081796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.082796 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:14:57.082796 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:14:57.083796 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.084796 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:14:56.970282 => 22:14:57.084796
[0m22:14:57.085795 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:14:57.085795 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:14:57.086795 [warn ] [Thread-3 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m22:14:57.087796 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:14:57.087796 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m22:14:57.088798 [info ] [Thread-2 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:14:57.089797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m22:14:57.089797 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:14:57.091797 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:14:57.092797 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:14:57.089797 => 22:14:57.092797
[0m22:14:57.092797 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:14:57.114796 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:14:57.114796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.115796 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.115796 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:14:57.116797 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:14:57.116797 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:14:57.116797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:57.117798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.119144 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:14:57.032286 => 22:14:57.119144
[0m22:14:57.120148 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:14:57.120148 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:14:57.121148 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m22:14:57.122148 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:14:57.164407 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.164407 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.165409 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:14:57.199675 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:14:57.205674 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.205674 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:14:57.206673 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.208674 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.208674 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:14:57.208674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.213674 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:14:57.213674 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.214674 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:14:57.214674 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:57.218672 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:14:57.221672 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:14:57.222672 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:14:57.224674 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:14:57.225673 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:14:57.093797 => 22:14:57.224674
[0m22:14:57.225673 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m22:14:57.226674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F16532B00>]}
[0m22:14:57.226674 [info ] [Thread-2 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m22:14:57.227672 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:14:57.228672 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:14:57.228672 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:14:57.228672 [info ] [Thread-3 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:14:57.229673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:14:57.229673 [info ] [Thread-1 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:14:57.230672 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:14:57.230672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:14:57.233672 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:14:57.233672 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:14:57.237672 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:14:57.237672 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:14:57.234672 => 22:14:57.237672
[0m22:14:57.238672 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:14:57.230672 => 22:14:57.237672
[0m22:14:57.238672 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:14:57.238672 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:14:57.240672 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:14:57.241673 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:14:57.242673 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:14:57.242673 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:14:57.243673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.243673 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:14:57.244674 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:14:57.244674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:57.292185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.293186 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:14:57.293186 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:14:57.295186 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.296185 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:14:57.239672 => 22:14:57.296185
[0m22:14:57.296185 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:14:57.297185 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:14:57.297185 [info ] [Thread-1 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.07s]
[0m22:14:57.298186 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:14:57.322184 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.323185 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:14:57.323185 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:14:57.324185 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.325186 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:14:57.240672 => 22:14:57.325186
[0m22:14:57.326186 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:14:57.326186 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:14:57.327185 [info ] [Thread-3 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.10s]
[0m22:14:57.327185 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:14:57.328205 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m22:14:57.329185 [info ] [Thread-2 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:14:57.329185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:14:57.329185 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:14:57.333185 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:14:57.334185 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:14:57.330184 => 22:14:57.334185
[0m22:14:57.334185 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m22:14:57.337186 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:14:57.338186 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.338186 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:14:57.339187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:57.385695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.385695 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.386696 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:14:57.394232 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:14:57.397238 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.397238 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:14:57.398280 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.400275 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.400275 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:14:57.401279 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.402237 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:14:57.402237 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.403235 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:14:57.403235 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:57.406235 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:14:57.406235 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:14:57.407235 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:14:57.408024 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:14:57.409030 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:14:57.335185 => 22:14:57.409030
[0m22:14:57.409030 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m22:14:57.410028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1668F6D0>]}
[0m22:14:57.411030 [info ] [Thread-2 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m22:14:57.412029 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m22:14:57.412029 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:14:57.412029 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:14:57.413029 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:14:57.413029 [info ] [Thread-3 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:14:57.414030 [info ] [Thread-1 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:14:57.414030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:14:57.414030 [info ] [Thread-2 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:14:57.415030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:14:57.415030 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:14:57.416030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:14:57.416030 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:14:57.419028 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:14:57.420028 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:14:57.425029 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:14:57.428028 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:14:57.428028 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:14:57.416030 => 22:14:57.428028
[0m22:14:57.429030 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:14:57.420028 => 22:14:57.429030
[0m22:14:57.429030 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:14:57.430029 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:14:57.425029 => 22:14:57.430029
[0m22:14:57.430029 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:14:57.432028 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:14:57.432028 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:14:57.433030 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:14:57.435029 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:14:57.436029 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:14:57.437029 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:14:57.437029 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:14:57.437029 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:14:57.438029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:57.438029 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:14:57.438029 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:14:57.439029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.439029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:57.487539 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.488540 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:14:57.488540 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:14:57.489541 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.490541 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:14:57.430029 => 22:14:57.490541
[0m22:14:57.490541 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:14:57.491540 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:14:57.492540 [info ] [Thread-3 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:14:57.492540 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:14:57.493539 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:14:57.493539 [info ] [Thread-3 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:14:57.494539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:14:57.494539 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:14:57.499540 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:14:57.499540 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:14:57.495539 => 22:14:57.499540
[0m22:14:57.500540 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:14:57.501540 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:14:57.502540 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:14:57.502540 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:14:57.503540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:57.525539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.526539 [debug] [Thread-1 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:14:57.526539 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:14:57.527539 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.528539 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:14:57.432028 => 22:14:57.528539
[0m22:14:57.529539 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:14:57.529539 [debug] [Thread-1 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:14:57.530540 [info ] [Thread-1 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.12s]
[0m22:14:57.531540 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:14:57.554540 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.555541 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:14:57.555541 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:14:57.557558 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.558546 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:14:57.434028 => 22:14:57.558546
[0m22:14:57.559546 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:14:57.559546 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:14:57.560545 [info ] [Thread-2 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m22:14:57.560545 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:14:57.589603 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.590602 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:14:57.590602 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:14:57.591603 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.592604 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:14:57.500540 => 22:14:57.592604
[0m22:14:57.593602 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:14:57.593602 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:14:57.594603 [info ] [Thread-3 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m22:14:57.595608 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:14:57.596603 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:14:57.596603 [info ] [Thread-1 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:14:57.597603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m22:14:57.597603 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:14:57.600602 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.600602 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:14:57.598604 => 22:14:57.600602
[0m22:14:57.601602 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:14:57.613602 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.614602 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.614602 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:14:57.615602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.672547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.673547 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.673547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.id = transactions.contact_id
  );
[0m22:14:57.675547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:14:57.678547 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.678547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:14:57.679548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.680547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:14:57.680547 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.680547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:14:57.681547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:57.683547 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:14:57.685547 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:14:57.685547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:14:57.686547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:14:57.687547 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:14:57.601602 => 22:14:57.687547
[0m22:14:57.687547 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:14:57.688547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F16512B30>]}
[0m22:14:57.688547 [info ] [Thread-1 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.09s]
[0m22:14:57.689548 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:14:57.690548 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:14:57.690548 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:14:57.691548 [info ] [Thread-3 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:14:57.691548 [info ] [Thread-2 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:14:57.692547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:14:57.692547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:14:57.692547 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:14:57.693547 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:14:57.696547 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:14:57.699547 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:14:57.700547 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:14:57.693547 => 22:14:57.700547
[0m22:14:57.700547 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:14:57.702547 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:14:57.702547 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:14:57.696547 => 22:14:57.702547
[0m22:14:57.703547 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:14:57.703547 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:14:57.705547 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:14:57.705547 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:14:57.706548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:57.706548 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:14:57.707549 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:14:57.707549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:57.753547 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.754547 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:14:57.754547 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:14:57.755547 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.757551 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:14:57.701548 => 22:14:57.756551
[0m22:14:57.757551 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:14:57.757551 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:14:57.758551 [info ] [Thread-3 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.07s]
[0m22:14:57.759551 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:14:57.782942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.783942 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:14:57.783942 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:14:57.785944 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:14:57.786942 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:14:57.703547 => 22:14:57.786942
[0m22:14:57.786942 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:14:57.787942 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:14:57.787942 [warn ] [Thread-2 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.10s]
[0m22:14:57.788943 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:14:57.790083 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m22:14:57.790083 [info ] [Thread-1 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:14:57.791087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:14:57.791087 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m22:14:57.795086 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:14:57.795086 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 22:14:57.792086 => 22:14:57.795086
[0m22:14:57.796086 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m22:14:57.799086 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:14:57.800087 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.800087 [debug] [Thread-1 (]: On model.customer360.customers: BEGIN
[0m22:14:57.801086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.848086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.848086 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.849086 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date, birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:14:57.860095 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:14:57.862098 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.862098 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m22:14:57.863098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.865098 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.865098 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m22:14:57.866098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:14:57.867098 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m22:14:57.868098 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.868098 [debug] [Thread-1 (]: On model.customer360.customers: COMMIT
[0m22:14:57.869098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:14:57.870600 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m22:14:57.870600 [debug] [Thread-1 (]: Using postgres connection "model.customer360.customers"
[0m22:14:57.871603 [debug] [Thread-1 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m22:14:57.873246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:14:57.874243 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 22:14:57.796086 => 22:14:57.873246
[0m22:14:57.874243 [debug] [Thread-1 (]: On model.customer360.customers: Close
[0m22:14:57.875206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ca19-0952-4ff3-8900-5377e63fff2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F166F3700>]}
[0m22:14:57.875206 [info ] [Thread-1 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 10[0m in 0.08s]
[0m22:14:57.875206 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m22:14:57.876651 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:57.877655 [debug] [MainThread]: On master: BEGIN
[0m22:14:57.877655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:57.928039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:14:57.929039 [debug] [MainThread]: On master: COMMIT
[0m22:14:57.929039 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:57.929039 [debug] [MainThread]: On master: COMMIT
[0m22:14:57.930039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:14:57.930039 [debug] [MainThread]: On master: Close
[0m22:14:57.931039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:57.931039 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:14:57.931039 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:14:57.931039 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:14:57.932517 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:14:57.932517 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:14:57.932517 [info ] [MainThread]: 
[0m22:14:57.933520 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m22:14:57.935521 [debug] [MainThread]: Command end result
[0m22:14:57.942520 [info ] [MainThread]: 
[0m22:14:57.942520 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m22:14:57.943521 [info ] [MainThread]: 
[0m22:14:57.943521 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:14:57.944520 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:14:57.944520 [info ] [MainThread]: 
[0m22:14:57.945522 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:14:57.945522 [info ] [MainThread]: 
[0m22:14:57.946521 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:14:57.946521 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:14:57.946521 [info ] [MainThread]: 
[0m22:14:57.947522 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:14:57.947522 [info ] [MainThread]: 
[0m22:14:57.948522 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m22:14:57.949522 [debug] [MainThread]: Command `dbt build` succeeded at 22:14:57.949522 after 1.91 seconds
[0m22:14:57.949522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F12B26AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F15DD6CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F161A9A20>]}
[0m22:14:57.949522 [debug] [MainThread]: Flushing usage events
[0m22:31:57.567210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020309954580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CC4ACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CC4AA70>]}


============================== 22:31:57.570211 | 8420dc68-b720-4cca-9fd4-6a517e2178c0 ==============================
[0m22:31:57.570211 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:31:57.570211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:31:57.691888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CC4AD10>]}
[0m22:31:57.749399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CC01240>]}
[0m22:31:57.750399 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:31:57.759400 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:31:57.837679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m22:31:57.837679 [debug] [MainThread]: Partial parsing: added file: customer360://tests\check_last_purchase_date.sql
[0m22:31:57.838680 [debug] [MainThread]: Partial parsing: added file: customer360://tests\check_first_purchase_date.sql
[0m22:31:57.838680 [debug] [MainThread]: Partial parsing: updated file: customer360://macros\age_in_years.sql
[0m22:31:57.839680 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\customers.sql
[0m22:31:57.839680 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\contacts_joined_with_transactions.sql
[0m22:31:58.067698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D4A1720>]}
[0m22:31:58.075698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CFCB0D0>]}
[0m22:31:58.075698 [info ] [MainThread]: Found 2 seeds, 4 models, 15 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:31:58.076697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CFCABF0>]}
[0m22:31:58.077698 [info ] [MainThread]: 
[0m22:31:58.078732 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:58.079739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:31:58.085738 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:31:58.086739 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:31:58.086739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.136628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:31:58.138630 [debug] [ThreadPool]: On list_dbt: Close
[0m22:31:58.139629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:31:58.143629 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:31:58.143629 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:31:58.144630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:58.189588 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.189588 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:31:58.190590 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:31:58.192589 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:31:58.193588 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:31:58.193588 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:31:58.197588 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.198588 [debug] [MainThread]: On master: BEGIN
[0m22:31:58.198588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:58.244302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.245302 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.245302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:58.248301 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:31:58.249303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D4DEBF0>]}
[0m22:31:58.250302 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:58.250302 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.250302 [debug] [MainThread]: On master: BEGIN
[0m22:31:58.251302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.251302 [debug] [MainThread]: On master: COMMIT
[0m22:31:58.252302 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.252302 [debug] [MainThread]: On master: COMMIT
[0m22:31:58.252302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.252302 [debug] [MainThread]: On master: Close
[0m22:31:58.253302 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:31:58.254302 [info ] [MainThread]: 
[0m22:31:58.255302 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m22:31:58.256302 [info ] [Thread-1 (]: 1 of 4 START sql table model public.stg_sf__contacts ........................... [RUN]
[0m22:31:58.257302 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m22:31:58.257302 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:31:58.262300 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:31:58.262300 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:31:58.257302 => 22:31:58.262300
[0m22:31:58.263301 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:31:58.287300 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:31:58.288301 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.288301 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:31:58.288301 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:31:58.334885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.334885 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.335886 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:31:58.369963 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:31:58.376959 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.377958 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:31:58.377958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.379958 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.380958 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:31:58.380958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.392958 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:31:58.393958 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.393958 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:31:58.394959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.398960 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:31:58.400960 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:31:58.401960 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:31:58.403318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:58.404324 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:31:58.263301 => 22:31:58.404324
[0m22:31:58.405322 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m22:31:58.405322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CDD16F0>]}
[0m22:31:58.406323 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.stg_sf__contacts ...................... [[32mSELECT 11[0m in 0.15s]
[0m22:31:58.407332 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:31:58.407332 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m22:31:58.408337 [info ] [Thread-3 (]: 2 of 4 START sql table model public.stg_web__transactions ...................... [RUN]
[0m22:31:58.409342 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m22:31:58.409342 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:31:58.412340 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:31:58.412340 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:31:58.409342 => 22:31:58.412340
[0m22:31:58.413341 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m22:31:58.416340 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:31:58.416340 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.417340 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:31:58.417340 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:31:58.464849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.464849 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.465850 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:31:58.501878 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:31:58.506877 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.507876 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:31:58.507876 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.509880 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.510879 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:31:58.510879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.512880 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:31:58.512880 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.512880 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:31:58.513880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.515877 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:31:58.515877 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:31:58.516878 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:31:58.517878 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:58.518879 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:31:58.413341 => 22:31:58.518879
[0m22:31:58.519878 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m22:31:58.519878 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D4E14E0>]}
[0m22:31:58.520879 [info ] [Thread-3 (]: 2 of 4 OK created sql table model public.stg_web__transactions ................. [[32mSELECT 101[0m in 0.11s]
[0m22:31:58.520879 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m22:31:58.521878 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:31:58.522879 [info ] [Thread-1 (]: 3 of 4 START sql view model public.contacts_joined_with_transactions ........... [RUN]
[0m22:31:58.522879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m22:31:58.523878 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:31:58.525386 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.526386 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:31:58.523878 => 22:31:58.526386
[0m22:31:58.526386 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:31:58.538386 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.538386 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.539387 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:31:58.539387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:58.586387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.586387 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.587388 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m22:31:58.588387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:31:58.591388 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.591388 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:31:58.592388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.593388 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:31:58.593388 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.594388 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:31:58.594388 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.597386 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:31:58.599386 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:31:58.599386 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:31:58.600387 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:31:58.601387 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:31:58.526386 => 22:31:58.601387
[0m22:31:58.601387 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:31:58.602387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D5F0340>]}
[0m22:31:58.602387 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.contacts_joined_with_transactions ...... [[32mCREATE VIEW[0m in 0.08s]
[0m22:31:58.603387 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:31:58.604387 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m22:31:58.604387 [info ] [Thread-3 (]: 4 of 4 START sql table model public.customers .................................. [RUN]
[0m22:31:58.605388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m22:31:58.605388 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m22:31:58.608386 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:31:58.609389 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 22:31:58.605388 => 22:31:58.609389
[0m22:31:58.609389 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m22:31:58.612394 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:31:58.613389 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.613389 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m22:31:58.613389 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:31:58.779556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.779556 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.780555 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:31:58.808084 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m22:31:58.813085 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.814087 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m22:31:58.814087 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.817082 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.817082 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m22:31:58.817082 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:58.819088 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m22:31:58.819088 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.819088 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m22:31:58.820088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.822083 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m22:31:58.823083 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m22:31:58.823083 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m22:31:58.824087 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:58.825110 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 22:31:58.609389 => 22:31:58.825110
[0m22:31:58.826108 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m22:31:58.826108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8420dc68-b720-4cca-9fd4-6a517e2178c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D5A94E0>]}
[0m22:31:58.827111 [info ] [Thread-3 (]: 4 of 4 OK created sql table model public.customers ............................. [[32mSELECT 9[0m in 0.22s]
[0m22:31:58.828111 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m22:31:58.829110 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.829110 [debug] [MainThread]: On master: BEGIN
[0m22:31:58.829110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:58.875112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:58.876109 [debug] [MainThread]: On master: COMMIT
[0m22:31:58.876109 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:58.876109 [debug] [MainThread]: On master: COMMIT
[0m22:31:58.877112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:58.877112 [debug] [MainThread]: On master: Close
[0m22:31:58.878112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:58.878112 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:31:58.878112 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:31:58.879112 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m22:31:58.879112 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:31:58.879112 [info ] [MainThread]: 
[0m22:31:58.880112 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m22:31:58.881110 [debug] [MainThread]: Command end result
[0m22:31:58.888109 [info ] [MainThread]: 
[0m22:31:58.888109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:31:58.888109 [info ] [MainThread]: 
[0m22:31:58.889110 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:31:58.890108 [debug] [MainThread]: Command `dbt run` succeeded at 22:31:58.890108 after 1.36 seconds
[0m22:31:58.890108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020309954580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CC01240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030D5F7FD0>]}
[0m22:31:58.890108 [debug] [MainThread]: Flushing usage events
[0m22:32:03.813530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE89306AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8C612DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8C612B60>]}


============================== 22:32:03.816532 | 952a0e5d-3374-48f4-9243-98bbd767c506 ==============================
[0m22:32:03.816532 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:32:03.816532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:32:03.938546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE852D2E00>]}
[0m22:32:03.995764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8C5C6CB0>]}
[0m22:32:03.995764 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:32:04.004767 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:32:04.082235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:32:04.082235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:32:04.086237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CA9CF40>]}
[0m22:32:04.094236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8C99B910>]}
[0m22:32:04.095236 [info ] [MainThread]: Found 2 seeds, 4 models, 15 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:32:04.096236 [info ] [MainThread]: 
[0m22:32:04.097236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:04.098236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:32:04.105160 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:32:04.105160 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:32:04.105160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:04.158625 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:32:04.159625 [debug] [ThreadPool]: On list_dbt: Close
[0m22:32:04.161625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:32:04.165625 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:32:04.165625 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:32:04.166625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:04.212625 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.212625 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:32:04.213625 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:32:04.215628 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:32:04.216628 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:32:04.216628 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:32:04.220628 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:04.221628 [debug] [MainThread]: On master: BEGIN
[0m22:32:04.221628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:04.274851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.275851 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:04.275851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:04.278849 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:32:04.279851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CAF2710>]}
[0m22:32:04.280851 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:04.280851 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:04.280851 [debug] [MainThread]: On master: BEGIN
[0m22:32:04.281850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.281850 [debug] [MainThread]: On master: COMMIT
[0m22:32:04.281850 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:04.282849 [debug] [MainThread]: On master: COMMIT
[0m22:32:04.282849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:32:04.282849 [debug] [MainThread]: On master: Close
[0m22:32:04.283851 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:32:04.284850 [info ] [MainThread]: 
[0m22:32:04.286681 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:32:04.286681 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:32:04.287686 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:32:04.287686 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:32:04.287686 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:32:04.288686 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:32:04.288686 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:32:04.289686 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:32:04.290686 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:32:04.290686 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:32:04.290686 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:32:04.291686 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:32:04.291686 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:32:04.291686 => 22:32:04.291686
[0m22:32:04.292685 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:32:04.292685 => 22:32:04.292685
[0m22:32:04.304685 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:32:04.304685 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:32:04.305687 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:32:04.314688 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:32:04.292685 => 22:32:04.314688
[0m22:32:04.326687 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:32:04.327687 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:32:04.330194 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:32:04.330194 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:32:04.340195 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:32:04.340195 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:32:04.341194 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:04.341194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:04.342194 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:32:04.342194 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:32:04.343194 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:04.417448 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.418444 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:32:04.418444 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:32:04.446259 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:32:04.467225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.498224 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:32:04.514224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.551734 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:32:04.552937 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:32:04.552937 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:32:04.553943 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:32:04.553943 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:32:04.555943 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:32:04.559981 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:32:04.567941 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:32:04.568941 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:32:04.568941 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:32:04.581941 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:32:04.582941 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:32:04.582941 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:32:04.583942 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:32:04.584944 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:32:04.584944 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:04.584944 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.585943 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:32:04.317687 => 22:32:04.585943
[0m22:32:04.586943 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:32:04.588943 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:32:04.331194 => 22:32:04.587942
[0m22:32:04.588943 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:32:04.588943 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:32:04.589942 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:32:04.589942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CB59570>]}
[0m22:32:04.590942 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:32:04.590942 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:32:04.590942 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.30s]
[0m22:32:04.593234 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:32:04.592229 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.30s]
[0m22:32:04.593234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:04.594234 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:32:04.594234 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:32:04.595234 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:32:04.305687 => 22:32:04.595234
[0m22:32:04.595234 [info ] [Thread-2 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:32:04.596233 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:32:04.596233 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:32:04.596233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:32:04.597235 [info ] [Thread-3 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:32:04.597235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8C999360>]}
[0m22:32:04.598233 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:32:04.599234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:32:04.604233 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:32:04.599234 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.31s]
[0m22:32:04.605233 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:32:04.605233 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:32:04.608235 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:32:04.609235 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:32:04.600235 => 22:32:04.608235
[0m22:32:04.609235 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:32:04.610234 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:32:04.610234 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:32:04.606233 => 22:32:04.610234
[0m22:32:04.610234 [info ] [Thread-1 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:32:04.612235 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:32:04.612235 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:32:04.613234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:32:04.615238 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:32:04.615238 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:32:04.615238 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:32:04.616239 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:32:04.616239 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:32:04.620237 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:32:04.621237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:04.621237 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:32:04.622238 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:32:04.616239 => 22:32:04.622238
[0m22:32:04.622238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:04.622238 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:32:04.625238 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:32:04.626237 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:32:04.626237 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:32:04.626237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:04.669246 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.670246 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:32:04.670246 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:32:04.671246 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.672247 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:32:04.611233 => 22:32:04.672247
[0m22:32:04.673248 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:32:04.673248 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:32:04.675247 [info ] [Thread-2 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m22:32:04.675247 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:32:04.676247 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:32:04.676247 [info ] [Thread-2 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:32:04.677247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:32:04.677247 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:32:04.680259 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:32:04.681246 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:32:04.677247 => 22:32:04.681246
[0m22:32:04.681246 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:32:04.683246 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:32:04.684247 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:32:04.684247 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:32:04.684247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:04.699246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.699246 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:32:04.700247 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:32:04.701247 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.702247 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:32:04.613234 => 22:32:04.702247
[0m22:32:04.702247 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:32:04.703246 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:32:04.704249 [info ] [Thread-3 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m22:32:04.704249 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:32:04.728250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.729753 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:32:04.729753 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:04.730756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.731756 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:32:04.623238 => 22:32:04.731756
[0m22:32:04.732756 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:32:04.732756 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:32:04.733757 [warn ] [Thread-1 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.12s]
[0m22:32:04.734757 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:32:04.735757 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m22:32:04.735757 [info ] [Thread-3 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:32:04.736757 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m22:32:04.736757 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:32:04.738756 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:32:04.739756 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:32:04.736757 => 22:32:04.739756
[0m22:32:04.739756 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:32:04.762051 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:32:04.762051 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.763051 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:32:04.763051 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.763051 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:04.764051 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:32:04.764051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:04.765052 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.766144 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:32:04.682248 => 22:32:04.766144
[0m22:32:04.767148 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:32:04.767148 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:32:04.768148 [info ] [Thread-2 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m22:32:04.768148 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:32:04.809635 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.810635 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.810635 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:32:04.818648 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:32:04.822648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.823648 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:32:04.823648 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:04.826648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.826648 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:32:04.827647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:04.832158 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:32:04.832158 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.833157 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:32:04.833157 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:04.837158 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:32:04.840158 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:32:04.840158 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:32:04.842157 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:32:04.843158 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:32:04.740757 => 22:32:04.843158
[0m22:32:04.844158 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m22:32:04.844158 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CC978E0>]}
[0m22:32:04.845157 [info ] [Thread-3 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.11s]
[0m22:32:04.846156 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:32:04.846156 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:32:04.847157 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:32:04.847157 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:32:04.848157 [info ] [Thread-2 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:32:04.848157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:32:04.849157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:32:04.849157 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:32:04.849157 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:32:04.852156 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:32:04.855156 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:32:04.856157 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:32:04.850158 => 22:32:04.855156
[0m22:32:04.856157 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:32:04.853156 => 22:32:04.856157
[0m22:32:04.856157 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:32:04.857157 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:32:04.858157 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:32:04.860158 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:32:04.860158 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:32:04.861157 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:32:04.861157 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:32:04.861157 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:32:04.862156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:04.862156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:04.909157 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.910158 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:32:04.910158 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:04.911156 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.912158 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:32:04.858157 => 22:32:04.912158
[0m22:32:04.913158 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:32:04.913158 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:32:04.914157 [info ] [Thread-2 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.07s]
[0m22:32:04.915161 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:32:04.941172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:04.942172 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:32:04.942172 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:32:04.943171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:04.944173 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:32:04.857157 => 22:32:04.944173
[0m22:32:04.945173 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:32:04.945173 [debug] [Thread-1 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:32:04.946173 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.10s]
[0m22:32:04.947173 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:32:04.947173 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m22:32:04.948173 [info ] [Thread-3 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:32:04.949173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:32:04.949173 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:32:04.952171 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:32:04.953171 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:32:04.949173 => 22:32:04.953171
[0m22:32:04.953171 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m22:32:04.957173 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:32:04.958172 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:04.958172 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:32:04.958172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:05.005157 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.005157 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:05.006159 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:32:05.017316 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:32:05.019314 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:05.019314 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:32:05.020315 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:05.022316 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:05.022316 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:32:05.023316 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:05.024316 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:32:05.025315 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:05.025315 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:32:05.025315 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:05.027314 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:32:05.028314 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:32:05.028314 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:32:05.029817 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:32:05.030415 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:32:04.953171 => 22:32:05.030415
[0m22:32:05.031419 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m22:32:05.031419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CD27FA0>]}
[0m22:32:05.032419 [info ] [Thread-3 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m22:32:05.033420 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m22:32:05.033420 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:32:05.034420 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:32:05.034420 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:32:05.034420 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:32:05.035505 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:32:05.036585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:32:05.035505 [info ] [Thread-3 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:32:05.036585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:32:05.037584 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:32:05.037584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:32:05.037584 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:32:05.040577 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:32:05.041574 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:32:05.046574 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:32:05.049578 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:32:05.049578 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:32:05.038583 => 22:32:05.049578
[0m22:32:05.050590 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:32:05.041574 => 22:32:05.049578
[0m22:32:05.050590 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:32:05.050590 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:32:05.046574 => 22:32:05.050590
[0m22:32:05.051654 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:32:05.053577 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:32:05.053577 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:32:05.056577 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:32:05.057575 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:32:05.058576 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:32:05.058576 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:32:05.059578 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:32:05.059578 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:32:05.059578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:05.060576 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:32:05.060576 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:32:05.061513 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:05.061513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:05.106513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.107513 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:32:05.107513 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:32:05.108513 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.109512 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:32:05.051654 => 22:32:05.109512
[0m22:32:05.110512 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:32:05.110512 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:32:05.111513 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:32:05.112554 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:32:05.112554 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:32:05.112554 [info ] [Thread-1 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:32:05.113516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:32:05.114516 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:32:05.117534 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:32:05.118533 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:32:05.114516 => 22:32:05.118533
[0m22:32:05.118533 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:32:05.120521 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:32:05.121533 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:32:05.121533 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:32:05.121533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:05.139128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.139128 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:32:05.140127 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:32:05.142128 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.143127 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:32:05.054584 => 22:32:05.143127
[0m22:32:05.143127 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:32:05.144128 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:32:05.145130 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m22:32:05.145130 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:32:05.175129 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.176126 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:32:05.176126 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:05.177126 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.179150 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:32:05.056577 => 22:32:05.178173
[0m22:32:05.179150 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:32:05.180127 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:32:05.180127 [info ] [Thread-3 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m22:32:05.181127 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:32:05.202147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.203142 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:32:05.203142 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:32:05.205140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.206143 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:32:05.118533 => 22:32:05.205140
[0m22:32:05.206143 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:32:05.206143 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:32:05.207143 [info ] [Thread-1 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m22:32:05.208127 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:32:05.209128 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:32:05.209128 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:32:05.210127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m22:32:05.210127 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:32:05.212127 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.213149 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:32:05.211127 => 22:32:05.213149
[0m22:32:05.214150 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:32:05.225193 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.226183 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.226183 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:32:05.227185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:05.276777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.276777 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.277779 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m22:32:05.279778 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:32:05.281778 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.281778 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:32:05.282778 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:05.283777 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:32:05.284756 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.284756 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:32:05.284756 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:05.287778 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:32:05.289777 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:32:05.289777 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:32:05.290777 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:32:05.291776 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:32:05.214150 => 22:32:05.291776
[0m22:32:05.291776 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:32:05.292779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CD5B040>]}
[0m22:32:05.293777 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m22:32:05.293777 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:32:05.294759 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:32:05.294759 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:32:05.295756 [info ] [Thread-1 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_id .............. [RUN]
[0m22:32:05.296756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311)
[0m22:32:05.295756 [info ] [Thread-3 (]: 18 of 19 START test unique_contacts_joined_with_transactions_id ................ [RUN]
[0m22:32:05.296756 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:32:05.296756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb)
[0m22:32:05.299779 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:32:05.300778 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:32:05.303777 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:32:05.303777 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (compile): 22:32:05.297778 => 22:32:05.303777
[0m22:32:05.304780 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:32:05.304780 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (compile): 22:32:05.300778 => 22:32:05.304780
[0m22:32:05.306778 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:32:05.306778 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:32:05.308777 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:32:05.308777 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:32:05.308777 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: BEGIN
[0m22:32:05.309777 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:32:05.309777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:05.310779 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: BEGIN
[0m22:32:05.310779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:32:05.355381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.356380 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"
[0m22:32:05.356380 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts_joined_with_transactions"
where id is null



      
    ) dbt_internal_test
[0m22:32:05.357380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.359381 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311 (execute): 22:32:05.304780 => 22:32:05.358381
[0m22:32:05.359381 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: ROLLBACK
[0m22:32:05.359381 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311: Close
[0m22:32:05.360381 [info ] [Thread-1 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_id .................... [[32mPASS[0m in 0.06s]
[0m22:32:05.361381 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311
[0m22:32:05.385360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.386360 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"
[0m22:32:05.386360 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >10 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:32:05.388359 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:32:05.389359 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb (execute): 22:32:05.306778 => 22:32:05.389359
[0m22:32:05.389359 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: ROLLBACK
[0m22:32:05.390359 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb: Close
[0m22:32:05.390359 [warn ] [Thread-3 (]: 18 of 19 WARN 9 unique_contacts_joined_with_transactions_id .................... [[33mWARN 9[0m in 0.09s]
[0m22:32:05.391359 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb
[0m22:32:05.392359 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:32:05.392359 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:32:05.393360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:32:05.394359 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:32:05.398359 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:32:05.398359 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:32:05.394359 => 22:32:05.398359
[0m22:32:05.399359 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:32:05.402359 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:32:05.402359 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.403359 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:32:05.403359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:32:05.452417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.453418 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.453418 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:32:05.465416 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.0 seconds
[0m22:32:05.469417 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.469417 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m22:32:05.470417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:05.472418 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.472418 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m22:32:05.473417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:32:05.474416 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m22:32:05.475416 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.475416 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m22:32:05.476419 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:32:05.477418 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m22:32:05.478396 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:32:05.478396 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m22:32:05.480424 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:32:05.481418 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:32:05.399359 => 22:32:05.481418
[0m22:32:05.481418 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:32:05.482417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952a0e5d-3374-48f4-9243-98bbd767c506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CCBA800>]}
[0m22:32:05.482417 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 9[0m in 0.09s]
[0m22:32:05.483417 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:32:05.484438 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:05.485398 [debug] [MainThread]: On master: BEGIN
[0m22:32:05.485398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:05.535545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:32:05.536544 [debug] [MainThread]: On master: COMMIT
[0m22:32:05.536544 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:05.536544 [debug] [MainThread]: On master: COMMIT
[0m22:32:05.537747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:32:05.537747 [debug] [MainThread]: On master: Close
[0m22:32:05.538755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:05.538755 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:32:05.538755 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:32:05.538755 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311' was properly closed.
[0m22:32:05.539808 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:32:05.539808 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb' was properly closed.
[0m22:32:05.539808 [info ] [MainThread]: 
[0m22:32:05.540790 [info ] [MainThread]: Finished running 2 seeds, 13 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m22:32:05.542790 [debug] [MainThread]: Command end result
[0m22:32:05.548798 [info ] [MainThread]: 
[0m22:32:05.549688 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m22:32:05.549688 [info ] [MainThread]: 
[0m22:32:05.550742 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:32:05.550742 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:32:05.551694 [info ] [MainThread]: 
[0m22:32:05.551694 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:32:05.552694 [info ] [MainThread]: 
[0m22:32:05.552694 [warn ] [MainThread]: [33mWarning in test unique_contacts_joined_with_transactions_id (models\marts\marketing\_marketing__models.yml)[0m
[0m22:32:05.553693 [warn ] [MainThread]: Got 9 results, configured to warn if >0
[0m22:32:05.553693 [info ] [MainThread]: 
[0m22:32:05.553693 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\marts\marketing\_marketing__models.yml\unique_contacts_joined_with_transactions_id.sql
[0m22:32:05.554693 [info ] [MainThread]: 
[0m22:32:05.554693 [info ] [MainThread]: Done. PASS=17 WARN=2 ERROR=0 SKIP=0 TOTAL=19
[0m22:32:05.555694 [debug] [MainThread]: Command `dbt build` succeeded at 22:32:05.555694 after 1.78 seconds
[0m22:32:05.555694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE89306AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CD87580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE8CC94940>]}
[0m22:32:05.556694 [debug] [MainThread]: Flushing usage events
[0m22:36:21.707027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B09257220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C552E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C552B90>]}


============================== 22:36:21.710026 | edf78d24-6ce6-4609-8e79-2dbb0188311b ==============================
[0m22:36:21.710026 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:36:21.711026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:21.830544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05272E00>]}
[0m22:36:21.887385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C7991E0>]}
[0m22:36:21.888384 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:36:21.897340 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:36:21.975103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:36:21.975103 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m22:36:22.152128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CCA0B20>]}
[0m22:36:22.160127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C8DB9D0>]}
[0m22:36:22.161127 [info ] [MainThread]: Found 2 seeds, 4 models, 15 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:36:22.162704 [info ] [MainThread]: 
[0m22:36:22.162704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:22.164704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m22:36:22.170703 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m22:36:22.170703 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m22:36:22.170703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:22.221660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:36:22.222659 [debug] [ThreadPool]: On list_dbt: Close
[0m22:36:22.224659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:36:22.228657 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:36:22.228657 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:36:22.229657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:22.280980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.280980 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:36:22.282024 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:36:22.284021 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:36:22.284981 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:36:22.284981 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:36:22.288980 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.289979 [debug] [MainThread]: On master: BEGIN
[0m22:36:22.289979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:22.336491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.336491 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.337492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:36:22.340490 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:36:22.341491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CD12170>]}
[0m22:36:22.341491 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:22.342490 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.342490 [debug] [MainThread]: On master: BEGIN
[0m22:36:22.343492 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.343492 [debug] [MainThread]: On master: COMMIT
[0m22:36:22.343492 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.343492 [debug] [MainThread]: On master: COMMIT
[0m22:36:22.344490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:36:22.344490 [debug] [MainThread]: On master: Close
[0m22:36:22.345492 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:36:22.345492 [info ] [MainThread]: 
[0m22:36:22.347492 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m22:36:22.348493 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m22:36:22.348493 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:36:22.348493 [info ] [Thread-1 (]: 1 of 19 START seed file public.contacts ........................................ [RUN]
[0m22:36:22.349492 [info ] [Thread-2 (]: 2 of 19 START seed file public.transactions .................................... [RUN]
[0m22:36:22.349492 [info ] [Thread-3 (]: 3 of 19 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:36:22.350492 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m22:36:22.350492 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m22:36:22.351491 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m22:36:22.351491 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m22:36:22.352492 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m22:36:22.352492 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:36:22.352492 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 22:36:22.352492 => 22:36:22.352492
[0m22:36:22.353491 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 22:36:22.352492 => 22:36:22.352492
[0m22:36:22.364492 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:36:22.365492 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m22:36:22.365492 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m22:36:22.374492 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:36:22.353491 => 22:36:22.374492
[0m22:36:22.388490 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:36:22.390492 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:36:22.390492 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:36:22.391491 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m22:36:22.391491 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m22:36:22.401492 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:36:22.401492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:36:22.402491 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:22.402491 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:36:22.403491 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:36:22.403491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:36:22.483645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.483645 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:36:22.484644 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m22:36:22.514107 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:36:22.536610 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:36:22.536610 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.537610 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:36:22.537610 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:36:22.538610 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:36:22.538610 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m22:36:22.542610 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m22:36:22.542610 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:22.551610 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:36:22.553610 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:36:22.392491 => 22:36:22.553610
[0m22:36:22.553610 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m22:36:22.554610 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:36:22.554610 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m22:36:22.555610 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:36:22.556611 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:22.556611 [info ] [Thread-3 (]: 3 of 19 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.20s]
[0m22:36:22.557621 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 22:36:22.365492 => 22:36:22.557621
[0m22:36:22.558611 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:36:22.558611 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.558611 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m22:36:22.559611 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:36:22.559611 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:36:22.560610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CD65A20>]}
[0m22:36:22.560610 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m22:36:22.560610 [info ] [Thread-3 (]: 4 of 19 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:36:22.561610 [info ] [Thread-1 (]: 1 of 19 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.21s]
[0m22:36:22.562611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:36:22.562611 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m22:36:22.563611 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:36:22.563611 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:36:22.568611 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:36:22.568611 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m22:36:22.569610 [info ] [Thread-1 (]: 5 of 19 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:36:22.656189 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:36:22.564611 => 22:36:22.656189
[0m22:36:22.656189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:36:22.667189 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:36:22.668232 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:36:22.668232 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:36:22.669238 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m22:36:22.670281 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:36:22.673280 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:36:22.674275 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:36:22.675238 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:36:22.675238 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:36:22.671275 => 22:36:22.675238
[0m22:36:22.676237 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m22:36:22.676237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:22.676237 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:36:22.677238 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m22:36:22.679237 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:36:22.680238 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:36:22.681237 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:36:22.681237 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m22:36:22.682238 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m22:36:22.682238 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:36:22.682238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:22.684237 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:22.684237 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 22:36:22.375493 => 22:36:22.684237
[0m22:36:22.685238 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m22:36:22.685238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CD059F0>]}
[0m22:36:22.686238 [info ] [Thread-2 (]: 2 of 19 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.33s]
[0m22:36:22.687237 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m22:36:22.688237 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:36:22.688237 [info ] [Thread-2 (]: 6 of 19 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:36:22.689251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:36:22.690256 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:36:22.694257 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:36:22.695256 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:36:22.690256 => 22:36:22.695256
[0m22:36:22.695256 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:36:22.697255 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:36:22.698255 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:36:22.698255 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:36:22.698255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:36:22.730260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.730260 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:36:22.730260 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:36:22.731260 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:22.732764 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:36:22.669238 => 22:36:22.732764
[0m22:36:22.733768 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:36:22.733768 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:36:22.734768 [info ] [Thread-3 (]: 4 of 19 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m22:36:22.734768 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:36:22.735770 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:36:22.735770 [info ] [Thread-3 (]: 7 of 19 START test source_unique_web_transactions_id ........................... [RUN]
[0m22:36:22.736768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:36:22.737769 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:36:22.740767 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:36:22.740767 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:36:22.737769 => 22:36:22.740767
[0m22:36:22.741768 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:36:22.742768 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:36:22.743768 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:36:22.743768 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:36:22.744768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:22.767767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.768768 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:36:22.768768 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:36:22.769768 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:22.770769 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:36:22.678237 => 22:36:22.770769
[0m22:36:22.771767 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:36:22.771767 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:36:22.772768 [info ] [Thread-1 (]: 5 of 19 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.12s]
[0m22:36:22.772768 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:36:22.798768 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.799770 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:36:22.799770 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:22.800770 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:22.801769 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:36:22.695256 => 22:36:22.801769
[0m22:36:22.802769 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:36:22.802769 [debug] [Thread-2 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:36:22.803769 [warn ] [Thread-2 (]: 6 of 19 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.11s]
[0m22:36:22.804769 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:36:22.805768 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m22:36:22.805768 [info ] [Thread-1 (]: 8 of 19 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m22:36:22.806769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m22:36:22.806769 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m22:36:22.808768 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m22:36:22.809768 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 22:36:22.806769 => 22:36:22.809768
[0m22:36:22.809768 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m22:36:22.832771 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m22:36:22.834034 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.834034 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:36:22.834034 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:22.835035 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.835035 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m22:36:22.836034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:22.836034 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:22.837033 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:36:22.741768 => 22:36:22.837033
[0m22:36:22.838035 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:36:22.838035 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:36:22.839033 [info ] [Thread-3 (]: 7 of 19 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m22:36:22.839033 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:36:22.884032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:22.885034 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.885034 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m22:36:22.920131 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m22:36:22.926122 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.926122 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m22:36:22.927124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:22.929128 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.929128 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m22:36:22.930126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:22.934643 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:36:22.934643 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.934643 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m22:36:22.935949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:22.939953 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m22:36:22.942953 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m22:36:22.942953 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m22:36:22.944954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:36:22.945721 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 22:36:22.810768 => 22:36:22.945721
[0m22:36:22.946766 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m22:36:22.946766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CEFBEE0>]}
[0m22:36:22.947764 [info ] [Thread-1 (]: 8 of 19 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m22:36:22.948726 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m22:36:22.948726 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:36:22.949726 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:36:22.949726 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:36:22.950726 [info ] [Thread-3 (]: 10 of 19 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:36:22.950726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m22:36:22.951726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:36:22.951726 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:36:22.952725 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:36:22.955726 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:36:22.957725 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:36:22.958725 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:36:22.952725 => 22:36:22.958725
[0m22:36:22.958725 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:36:22.955726 => 22:36:22.958725
[0m22:36:22.959726 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:36:22.959726 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:36:22.961725 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:36:22.962725 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:36:22.963724 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:36:22.964725 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:36:22.964725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:36:22.964725 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:36:22.965725 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:36:22.965725 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:23.014725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.015725 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:36:23.015725 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:36:23.016725 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.019729 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:36:22.960725 => 22:36:23.018730
[0m22:36:23.019729 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:36:23.019729 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:36:23.020728 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m22:36:23.021729 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:36:23.045237 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.045237 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:36:23.046236 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:23.047237 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.048236 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:36:22.961725 => 22:36:23.048236
[0m22:36:23.048236 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:36:23.049236 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:36:23.049236 [info ] [Thread-3 (]: 10 of 19 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m22:36:23.050237 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:36:23.051238 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m22:36:23.051238 [info ] [Thread-1 (]: 11 of 19 START sql table model public.stg_web__transactions .................... [RUN]
[0m22:36:23.052236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m22:36:23.052236 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m22:36:23.095236 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m22:36:23.096237 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 22:36:23.052236 => 22:36:23.096237
[0m22:36:23.096237 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m22:36:23.100236 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m22:36:23.100236 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.101237 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: BEGIN
[0m22:36:23.101237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:23.158745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.159745 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.159745 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m22:36:23.193745 [debug] [Thread-1 (]: SQL status: SELECT 101 in 0.0 seconds
[0m22:36:23.196745 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.196745 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m22:36:23.197745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:23.199746 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.199746 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m22:36:23.200745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:23.201745 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:36:23.202745 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.202745 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: COMMIT
[0m22:36:23.203746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:23.204745 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m22:36:23.205745 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m22:36:23.205745 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m22:36:23.207746 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:36:23.208746 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 22:36:23.097237 => 22:36:23.208746
[0m22:36:23.208746 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: Close
[0m22:36:23.209745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CD94520>]}
[0m22:36:23.210745 [info ] [Thread-1 (]: 11 of 19 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.16s]
[0m22:36:23.211747 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m22:36:23.211747 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:36:23.212745 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:36:23.212745 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:36:23.212745 [info ] [Thread-3 (]: 12 of 19 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m22:36:23.213746 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:36:23.213746 [info ] [Thread-1 (]: 14 of 19 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:36:23.214746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:36:23.214746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:36:23.215745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:36:23.215745 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:36:23.215745 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:36:23.216745 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:36:23.219748 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:36:23.224749 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:36:23.228749 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:36:23.229750 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:36:23.216745 => 22:36:23.229750
[0m22:36:23.230749 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:36:23.219748 => 22:36:23.230749
[0m22:36:23.230749 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:36:23.225751 => 22:36:23.230749
[0m22:36:23.230749 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:36:23.231749 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:36:23.231749 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:36:23.234260 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:36:23.235259 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:36:23.237259 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:36:23.238260 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:36:23.238260 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:36:23.238260 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:36:23.239260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:23.239260 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:36:23.240259 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:36:23.240259 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:36:23.241259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:36:23.241259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:23.287258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.287258 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:36:23.288258 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:36:23.288258 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.290257 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:36:23.231749 => 22:36:23.289258
[0m22:36:23.290257 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:36:23.290257 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:36:23.291258 [info ] [Thread-3 (]: 12 of 19 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m22:36:23.292258 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:36:23.292258 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:36:23.293258 [info ] [Thread-3 (]: 15 of 19 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:36:23.294258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:36:23.294258 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:36:23.298258 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:36:23.298258 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:36:23.294258 => 22:36:23.298258
[0m22:36:23.299258 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:36:23.300258 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:36:23.301258 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:36:23.302260 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:36:23.302260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:23.316767 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.317767 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:36:23.317767 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:36:23.319770 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.320770 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:36:23.234260 => 22:36:23.320770
[0m22:36:23.320770 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:36:23.321770 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:36:23.321770 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m22:36:23.322770 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:36:23.350228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.351226 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:36:23.351226 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:23.353228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.354228 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:36:23.236258 => 22:36:23.354228
[0m22:36:23.355234 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:36:23.355234 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:36:23.356231 [info ] [Thread-1 (]: 14 of 19 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m22:36:23.357243 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:36:23.494206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.495206 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:36:23.495206 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:36:23.496206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.497207 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:36:23.299258 => 22:36:23.497207
[0m22:36:23.498206 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:36:23.498206 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:36:23.499206 [info ] [Thread-3 (]: 15 of 19 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.21s]
[0m22:36:23.500206 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:36:23.501204 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m22:36:23.501204 [info ] [Thread-2 (]: 16 of 19 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m22:36:23.502206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m22:36:23.502206 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m22:36:23.505205 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.506205 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 22:36:23.503206 => 22:36:23.506205
[0m22:36:23.506205 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m22:36:23.518205 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.519207 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.519207 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m22:36:23.520208 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:36:23.567714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.568714 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.568714 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m22:36:23.570715 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:36:23.572713 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.573713 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m22:36:23.573713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:23.574714 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:36:23.575714 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.575714 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m22:36:23.576647 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:23.578653 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m22:36:23.580653 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m22:36:23.580975 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m22:36:23.580975 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:36:23.581982 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 22:36:23.506205 => 22:36:23.581982
[0m22:36:23.583023 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m22:36:23.583023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C799210>]}
[0m22:36:23.584022 [info ] [Thread-2 (]: 16 of 19 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m22:36:23.584022 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m22:36:23.585019 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:36:23.585019 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:36:23.585981 [info ] [Thread-3 (]: 17 of 19 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m22:36:23.586981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m22:36:23.585981 [info ] [Thread-1 (]: 18 of 19 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m22:36:23.586981 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:36:23.587980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m22:36:23.590980 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:36:23.590980 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:36:23.593980 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:36:23.593980 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 22:36:23.587980 => 22:36:23.593980
[0m22:36:23.594980 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:36:23.595980 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:36:23.596980 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 22:36:23.591980 => 22:36:23.596980
[0m22:36:23.596980 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:36:23.598981 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:36:23.598981 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:36:23.599981 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m22:36:23.599981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:36:23.600981 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:36:23.600981 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m22:36:23.601980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:23.653592 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.654592 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:36:23.654592 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:36:23.655592 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.657592 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 22:36:23.594980 => 22:36:23.657592
[0m22:36:23.657592 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m22:36:23.658592 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m22:36:23.658592 [info ] [Thread-3 (]: 17 of 19 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.07s]
[0m22:36:23.659592 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:36:23.690592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.690592 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:36:23.691592 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:23.692592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:36:23.693592 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 22:36:23.597980 => 22:36:23.693592
[0m22:36:23.694592 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m22:36:23.694592 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m22:36:23.695592 [info ] [Thread-1 (]: 18 of 19 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.11s]
[0m22:36:23.696592 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:36:23.696592 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m22:36:23.697592 [info ] [Thread-2 (]: 19 of 19 START sql table model public.customers ................................ [RUN]
[0m22:36:23.698594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m22:36:23.698594 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m22:36:23.703592 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m22:36:23.704592 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 22:36:23.698594 => 22:36:23.704592
[0m22:36:23.704592 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m22:36:23.707592 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m22:36:23.708592 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.708592 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m22:36:23.708592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:36:23.867169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.867169 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.868169 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m22:36:23.904910 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.0 seconds
[0m22:36:23.909895 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.909895 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m22:36:23.910896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:23.912897 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.912897 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m22:36:23.913896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:23.914898 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m22:36:23.915897 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.915897 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m22:36:23.916897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:23.917898 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m22:36:23.918896 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m22:36:23.918896 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m22:36:23.920905 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:36:23.921905 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 22:36:23.705593 => 22:36:23.921905
[0m22:36:23.921905 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m22:36:23.922904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edf78d24-6ce6-4609-8e79-2dbb0188311b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C9D7A60>]}
[0m22:36:23.922904 [info ] [Thread-2 (]: 19 of 19 OK created sql table model public.customers ........................... [[32mSELECT 9[0m in 0.23s]
[0m22:36:23.923903 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m22:36:23.924902 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:23.925904 [debug] [MainThread]: On master: BEGIN
[0m22:36:23.925904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:23.974815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:36:23.975815 [debug] [MainThread]: On master: COMMIT
[0m22:36:23.975815 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:23.975815 [debug] [MainThread]: On master: COMMIT
[0m22:36:23.976814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:36:23.976814 [debug] [MainThread]: On master: Close
[0m22:36:23.977815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:23.977815 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m22:36:23.977815 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:36:23.978815 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5' was properly closed.
[0m22:36:23.978815 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m22:36:23.978815 [debug] [MainThread]: Connection 'test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca' was properly closed.
[0m22:36:23.979816 [info ] [MainThread]: 
[0m22:36:23.979816 [info ] [MainThread]: Finished running 13 tests, 2 seeds, 3 table models, 1 view model in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m22:36:23.981814 [debug] [MainThread]: Command end result
[0m22:36:23.987814 [info ] [MainThread]: 
[0m22:36:23.988814 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:36:23.988814 [info ] [MainThread]: 
[0m22:36:23.988814 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:36:23.989815 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:36:23.989815 [info ] [MainThread]: 
[0m22:36:23.990815 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:36:23.990815 [info ] [MainThread]: 
[0m22:36:23.991823 [info ] [MainThread]: Done. PASS=18 WARN=1 ERROR=0 SKIP=0 TOTAL=19
[0m22:36:23.992815 [debug] [MainThread]: Command `dbt build` succeeded at 22:36:23.992815 after 2.33 seconds
[0m22:36:23.992815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B09257220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0CCF23E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0C9D7D90>]}
[0m22:36:23.992815 [debug] [MainThread]: Flushing usage events
[0m22:45:47.287987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54E325090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55161AD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55161AB00>]}


============================== 22:45:47.291029 | eb94dabd-aa04-4349-9df9-5bc990e0f3c4 ==============================
[0m22:45:47.291029 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:45:47.291992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:45:47.410499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54A2E2E00>]}
[0m22:45:47.467006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5515D0F70>]}
[0m22:45:47.468006 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:45:47.477006 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:45:47.555146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:45:47.555648 [debug] [MainThread]: Partial parsing: added file: customer360://tests\check_valid_customers.sql
[0m22:45:47.621179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E551BBC3A0>]}
[0m22:45:47.629246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E551B16F80>]}
[0m22:45:47.629246 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:45:47.630245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E551B17D00>]}
[0m22:45:47.631246 [info ] [MainThread]: 
[0m22:45:47.632245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:45:47.633246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:45:47.639751 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:45:47.640751 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:45:47.640751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:47.689316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.689316 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:45:47.690316 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:45:47.692315 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:45:47.693317 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:45:47.693317 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:45:47.698317 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:47.698317 [debug] [MainThread]: On master: BEGIN
[0m22:45:47.698317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:47.749620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.750623 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:47.750623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:45:47.753616 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:45:47.754626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb94dabd-aa04-4349-9df9-5bc990e0f3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E551AF1780>]}
[0m22:45:47.755616 [debug] [MainThread]: On master: ROLLBACK
[0m22:45:47.755616 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:47.756620 [debug] [MainThread]: On master: BEGIN
[0m22:45:47.756620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.756620 [debug] [MainThread]: On master: COMMIT
[0m22:45:47.757623 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:47.757623 [debug] [MainThread]: On master: COMMIT
[0m22:45:47.757623 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:45:47.758618 [debug] [MainThread]: On master: Close
[0m22:45:47.758618 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:45:47.759622 [info ] [MainThread]: 
[0m22:45:47.761577 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:45:47.761577 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:45:47.762577 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:45:47.762577 [info ] [Thread-1 (]: 1 of 14 START test check_valid_customers ....................................... [RUN]
[0m22:45:47.762577 [info ] [Thread-2 (]: 2 of 14 START test not_null_contacts_joined_with_transactions_transaction_id ... [RUN]
[0m22:45:47.763794 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:45:47.763794 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:45:47.764799 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca'
[0m22:45:47.765800 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m22:45:47.765800 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:45:47.765800 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:45:47.766799 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:45:47.770798 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:45:47.778806 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:45:47.781799 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:45:47.782798 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 22:45:47.770798 => 22:45:47.782798
[0m22:45:47.782798 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:45:47.778806 => 22:45:47.782798
[0m22:45:47.783799 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:45:47.766799 => 22:45:47.783799
[0m22:45:47.783799 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:45:47.784798 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:45:47.784798 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:45:47.793798 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:45:47.794798 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:45:47.796798 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:45:47.797798 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:45:47.797798 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:45:47.798798 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:45:47.798798 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m22:45:47.798798 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:45:47.799799 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:45:47.799799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:47.799799 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:45:47.800798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:47.844306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.845307 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:45:47.845307 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:45:47.846306 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:47.848308 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:45:47.793798 => 22:45:47.848308
[0m22:45:47.848308 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:45:47.849307 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:45:47.849307 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.08s]
[0m22:45:47.850306 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:45:47.850306 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:45:47.851307 [info ] [Thread-3 (]: 4 of 14 START test not_null_stg_web__transactions_id ........................... [RUN]
[0m22:45:47.852307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:45:47.852307 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:45:47.856308 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:45:47.856308 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:45:47.852307 => 22:45:47.856308
[0m22:45:47.857307 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:45:47.858306 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:45:47.859307 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:45:47.859307 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:45:47.860306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:45:47.876306 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.877306 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:45:47.877306 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:45:47.878306 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:47.879306 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 22:45:47.784798 => 22:45:47.879306
[0m22:45:47.880306 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m22:45:47.880306 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m22:45:47.881307 [info ] [Thread-2 (]: 2 of 14 PASS not_null_contacts_joined_with_transactions_transaction_id ......... [[32mPASS[0m in 0.12s]
[0m22:45:47.882307 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:45:47.882307 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:45:47.883309 [info ] [Thread-2 (]: 5 of 14 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:45:47.884309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:45:47.884309 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:45:47.891306 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:45:47.892308 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:45:47.884309 => 22:45:47.892308
[0m22:45:47.892308 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:45:47.894307 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:45:47.895308 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:45:47.895308 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:45:47.895308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:45:47.908306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.908306 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:45:47.909308 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	ref('customers')
where
	new_id not in (
	select
		new_id
	from
		ref('stg_sf__contacts'))
      
    ) dbt_internal_test
[0m22:45:47.909308 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function ref(unknown) does not exist
LINE 10:  ref('customers')
          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m22:45:47.910306 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:45:47.910306 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:45:47.795798 => 22:45:47.910306
[0m22:45:47.911306 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:45:47.913308 [debug] [Thread-1 (]: Database Error in test check_valid_customers (tests\check_valid_customers.sql)
  function ref(unknown) does not exist
  LINE 10:  ref('customers')
            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\customer360\tests\check_valid_customers.sql
[0m22:45:47.914307 [error] [Thread-1 (]: 1 of 14 ERROR check_valid_customers ............................................ [[31mERROR[0m in 0.15s]
[0m22:45:47.914307 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:45:47.915308 [debug] [Thread-1 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:45:47.915308 [info ] [Thread-1 (]: 6 of 14 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:45:47.916306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_valid_customers, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m22:45:47.916306 [debug] [Thread-1 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:45:47.924311 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:45:47.925312 [debug] [Thread-1 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:45:47.917307 => 22:45:47.925312
[0m22:45:47.926310 [debug] [Thread-1 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:45:47.927310 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:45:47.928311 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:45:47.928311 [debug] [Thread-1 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:45:47.929311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:47.938821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.938821 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:45:47.939818 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:45:47.940818 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:47.941817 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:45:47.857307 => 22:45:47.941817
[0m22:45:47.941817 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:45:47.942817 [debug] [Thread-3 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:45:47.943817 [info ] [Thread-3 (]: 4 of 14 PASS not_null_stg_web__transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m22:45:47.943817 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:45:47.944818 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:45:47.944818 [info ] [Thread-3 (]: 7 of 14 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:45:47.945818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:45:47.945818 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:45:47.949817 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:45:47.949817 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:45:47.945818 => 22:45:47.949817
[0m22:45:47.950817 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:45:47.951819 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:45:47.952818 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:45:47.952818 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:45:47.953818 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:45:47.969818 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:47.969818 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:45:47.969818 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:45:47.971817 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:47.972817 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:45:47.892308 => 22:45:47.972817
[0m22:45:47.972817 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:45:47.973817 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:45:47.974819 [info ] [Thread-2 (]: 5 of 14 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.09s]
[0m22:45:47.974819 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:45:47.975818 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:45:47.975818 [info ] [Thread-2 (]: 8 of 14 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:45:47.976817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:45:47.976817 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:45:47.980818 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:45:47.980818 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:45:47.976817 => 22:45:47.980818
[0m22:45:47.981817 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:45:47.983817 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:45:47.984818 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:45:47.984818 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:45:47.985817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:45:47.999817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.000817 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:45:48.000817 [debug] [Thread-1 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:45:48.002819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.003817 [debug] [Thread-1 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:45:47.926310 => 22:45:48.003817
[0m22:45:48.003817 [debug] [Thread-1 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:45:48.004817 [debug] [Thread-1 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:45:48.004817 [info ] [Thread-1 (]: 6 of 14 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.09s]
[0m22:45:48.005819 [debug] [Thread-1 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:45:48.006817 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:45:48.006817 [info ] [Thread-1 (]: 9 of 14 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:45:48.007818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:45:48.007818 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:45:48.012817 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:45:48.013817 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:45:48.008817 => 22:45:48.013817
[0m22:45:48.013817 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:45:48.015817 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:45:48.016818 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:45:48.016818 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:45:48.017817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:48.031821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.032822 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:45:48.032822 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:45:48.034821 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.034821 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:45:47.950817 => 22:45:48.034821
[0m22:45:48.036323 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:45:48.036323 [debug] [Thread-3 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:45:48.037326 [info ] [Thread-3 (]: 7 of 14 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m22:45:48.037326 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:45:48.038327 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:45:48.038327 [info ] [Thread-3 (]: 10 of 14 START test source_unique_web_transactions_id .......................... [RUN]
[0m22:45:48.039327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:45:48.039327 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:45:48.043326 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:45:48.043326 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:45:48.040328 => 22:45:48.043326
[0m22:45:48.044329 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:45:48.046327 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:45:48.046327 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:45:48.047327 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:45:48.047327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:45:48.063244 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.064244 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:45:48.064244 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:45:48.065244 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.066244 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:45:47.981817 => 22:45:48.066244
[0m22:45:48.067245 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:45:48.067245 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:45:48.068244 [info ] [Thread-2 (]: 8 of 14 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.09s]
[0m22:45:48.069244 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:45:48.069244 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:45:48.070245 [info ] [Thread-2 (]: 11 of 14 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m22:45:48.071245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m22:45:48.071245 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:45:48.074245 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:45:48.075244 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 22:45:48.071245 => 22:45:48.075244
[0m22:45:48.075244 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:45:48.077244 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:45:48.078244 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:45:48.078244 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m22:45:48.078244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:45:48.095244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.096244 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:45:48.096244 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:48.097244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.099245 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:45:48.014818 => 22:45:48.098244
[0m22:45:48.099245 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:45:48.099245 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:45:48.100245 [warn ] [Thread-1 (]: 9 of 14 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.09s]
[0m22:45:48.101245 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:45:48.101245 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:45:48.102245 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:45:48.102245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:45:48.103245 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:45:48.106244 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:45:48.107244 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:45:48.103245 => 22:45:48.106244
[0m22:45:48.107244 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:45:48.109245 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:45:48.110246 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:45:48.110246 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:45:48.111245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:48.126249 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.126249 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:45:48.127249 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:48.128249 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.129250 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:45:48.044329 => 22:45:48.129250
[0m22:45:48.129250 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:45:48.130250 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:45:48.131250 [info ] [Thread-3 (]: 10 of 14 PASS source_unique_web_transactions_id ................................ [[32mPASS[0m in 0.09s]
[0m22:45:48.131250 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:45:48.131250 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:45:48.132537 [info ] [Thread-3 (]: 13 of 14 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:45:48.133541 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:45:48.133541 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:45:48.136543 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:45:48.136543 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:45:48.133541 => 22:45:48.136543
[0m22:45:48.138030 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:45:48.140032 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:45:48.140032 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:45:48.141031 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:45:48.141031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:45:48.157030 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.158032 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:45:48.158032 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:48.159032 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.161030 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 22:45:48.076245 => 22:45:48.160030
[0m22:45:48.161030 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m22:45:48.161030 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m22:45:48.162031 [info ] [Thread-2 (]: 11 of 14 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.09s]
[0m22:45:48.163031 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:45:48.163031 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:45:48.164032 [info ] [Thread-2 (]: 14 of 14 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:45:48.164032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:45:48.165032 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:45:48.169030 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:45:48.169030 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:45:48.165032 => 22:45:48.169030
[0m22:45:48.170030 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:45:48.171031 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:45:48.172030 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:45:48.172030 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:45:48.173031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:45:48.190030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.191030 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:45:48.191030 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:48.193031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.194030 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:45:48.107244 => 22:45:48.194030
[0m22:45:48.194030 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:45:48.195030 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:45:48.196049 [info ] [Thread-1 (]: 12 of 14 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m22:45:48.196049 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:45:48.220030 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.221031 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:45:48.221031 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:48.223033 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.224034 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:45:48.138030 => 22:45:48.224034
[0m22:45:48.224034 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:45:48.224034 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:45:48.225034 [info ] [Thread-3 (]: 13 of 14 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m22:45:48.226033 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:45:48.254546 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.254546 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:45:48.254546 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:45:48.256546 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:45:48.257545 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:45:48.170030 => 22:45:48.256546
[0m22:45:48.257545 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:45:48.258547 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:45:48.258547 [info ] [Thread-2 (]: 14 of 14 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m22:45:48.259547 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:45:48.260547 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:48.261547 [debug] [MainThread]: On master: BEGIN
[0m22:45:48.261547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:48.307546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:45:48.307546 [debug] [MainThread]: On master: COMMIT
[0m22:45:48.308547 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:48.308547 [debug] [MainThread]: On master: COMMIT
[0m22:45:48.308547 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:45:48.309547 [debug] [MainThread]: On master: Close
[0m22:45:48.309547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:48.310546 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:45:48.310546 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m22:45:48.310546 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m22:45:48.311556 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m22:45:48.311556 [info ] [MainThread]: 
[0m22:45:48.312547 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m22:45:48.313546 [debug] [MainThread]: Command end result
[0m22:45:48.319546 [info ] [MainThread]: 
[0m22:45:48.320547 [info ] [MainThread]: [31mCompleted with 1 error and 1 warning:[0m
[0m22:45:48.320547 [info ] [MainThread]: 
[0m22:45:48.321545 [error] [MainThread]:   Database Error in test check_valid_customers (tests\check_valid_customers.sql)
  function ref(unknown) does not exist
  LINE 10:  ref('customers')
            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\customer360\tests\check_valid_customers.sql
[0m22:45:48.321545 [info ] [MainThread]: 
[0m22:45:48.322549 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:45:48.322549 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:45:48.322549 [info ] [MainThread]: 
[0m22:45:48.323549 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:45:48.323549 [info ] [MainThread]: 
[0m22:45:48.324549 [info ] [MainThread]: Done. PASS=12 WARN=1 ERROR=1 SKIP=0 TOTAL=14
[0m22:45:48.325550 [debug] [MainThread]: Command `dbt test` failed at 22:45:48.325550 after 1.08 seconds
[0m22:45:48.325550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54E325090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5515D0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E551B17A00>]}
[0m22:45:48.326549 [debug] [MainThread]: Flushing usage events
[0m22:46:48.247762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021486D66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A05AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A05AAA0>]}


============================== 22:46:48.250762 | 6ad1c11e-c5c1-4362-ae23-7c0fc891001a ==============================
[0m22:46:48.250762 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:46:48.250762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:48.371273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021482D12E00>]}
[0m22:46:48.428444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A058D30>]}
[0m22:46:48.429444 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:46:48.437496 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:46:48.514948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:48.514948 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_valid_customers.sql
[0m22:46:48.581952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A604400>]}
[0m22:46:48.589951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A5566E0>]}
[0m22:46:48.589951 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:46:48.590951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A557D00>]}
[0m22:46:48.591951 [info ] [MainThread]: 
[0m22:46:48.593030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:48.594073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:46:48.601571 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:46:48.602571 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:46:48.602571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:48.651446 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.651446 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:46:48.652440 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:46:48.654440 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:46:48.655441 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:46:48.655441 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:46:48.660440 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:48.660440 [debug] [MainThread]: On master: BEGIN
[0m22:46:48.660440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:48.706939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.720622 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:48.721623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:46:48.724621 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:46:48.725621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad1c11e-c5c1-4362-ae23-7c0fc891001a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A509090>]}
[0m22:46:48.725621 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:48.726621 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:48.726621 [debug] [MainThread]: On master: BEGIN
[0m22:46:48.726621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.727621 [debug] [MainThread]: On master: COMMIT
[0m22:46:48.727621 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:48.727621 [debug] [MainThread]: On master: COMMIT
[0m22:46:48.728621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:48.728621 [debug] [MainThread]: On master: Close
[0m22:46:48.729621 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:46:48.729621 [info ] [MainThread]: 
[0m22:46:48.731622 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:46:48.732621 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:46:48.732621 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:46:48.732621 [info ] [Thread-1 (]: 1 of 14 START test check_valid_customers ....................................... [RUN]
[0m22:46:48.733621 [info ] [Thread-2 (]: 2 of 14 START test not_null_contacts_joined_with_transactions_transaction_id ... [RUN]
[0m22:46:48.734622 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:46:48.733621 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:46:48.734622 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca'
[0m22:46:48.735621 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:46:48.735621 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m22:46:48.736621 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:46:48.741621 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:46:48.741621 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:46:48.749622 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:46:48.752621 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:46:48.753621 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:46:48.736621 => 22:46:48.752621
[0m22:46:48.753621 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 22:46:48.741621 => 22:46:48.753621
[0m22:46:48.754622 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:46:48.754622 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:46:48.750621 => 22:46:48.754622
[0m22:46:48.754622 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:46:48.763621 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:46:48.763621 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:46:48.765621 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:46:48.766621 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:46:48.767621 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:46:48.768634 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:46:48.768634 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:46:48.769623 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:46:48.769623 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m22:46:48.769623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:48.770622 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:46:48.770622 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:48.771622 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:48.819133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.819133 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:46:48.820133 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:46:48.821133 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.822133 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:46:48.755621 => 22:46:48.822133
[0m22:46:48.823133 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:46:48.823133 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:46:48.824133 [info ] [Thread-1 (]: 1 of 14 PASS check_valid_customers ............................................. [[32mPASS[0m in 0.09s]
[0m22:46:48.824133 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:46:48.825133 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:46:48.825133 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_web__transactions_id ........................... [RUN]
[0m22:46:48.826133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_valid_customers, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:46:48.826133 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:46:48.830134 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:46:48.831133 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:46:48.827133 => 22:46:48.831133
[0m22:46:48.831133 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:46:48.833133 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:46:48.833133 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:46:48.834133 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:46:48.834133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:48.850140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.850140 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:46:48.851140 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:46:48.852133 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.854133 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 22:46:48.763621 => 22:46:48.853134
[0m22:46:48.854133 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m22:46:48.854133 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m22:46:48.855133 [info ] [Thread-2 (]: 2 of 14 PASS not_null_contacts_joined_with_transactions_transaction_id ......... [[32mPASS[0m in 0.12s]
[0m22:46:48.856133 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:46:48.856133 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:46:48.857173 [info ] [Thread-2 (]: 5 of 14 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:46:48.857173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:46:48.858178 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:46:48.864177 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:46:48.865178 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:46:48.858178 => 22:46:48.865178
[0m22:46:48.866178 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:46:48.867687 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:46:48.868688 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:46:48.868688 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:46:48.868688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:48.880687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.881687 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:46:48.881687 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:46:48.882687 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.883686 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:46:48.765621 => 22:46:48.883686
[0m22:46:48.884686 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:46:48.884686 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:46:48.885686 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.15s]
[0m22:46:48.885686 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:46:48.886688 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:46:48.886688 [info ] [Thread-3 (]: 6 of 14 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:46:48.887687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m22:46:48.887687 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:46:48.895687 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:46:48.896691 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:46:48.888687 => 22:46:48.896691
[0m22:46:48.896691 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:46:48.898686 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:46:48.899687 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:46:48.899687 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:46:48.899687 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:46:48.912690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.913690 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:46:48.913690 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:46:48.915194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.916197 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:46:48.831133 => 22:46:48.916197
[0m22:46:48.916197 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:46:48.917196 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:46:48.917196 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_web__transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m22:46:48.918198 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:46:48.919198 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:46:48.919198 [info ] [Thread-1 (]: 7 of 14 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:46:48.920198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:46:48.920198 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:46:48.924197 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:46:48.924197 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:46:48.921198 => 22:46:48.924197
[0m22:46:48.925197 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:46:48.926200 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:46:48.927198 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:46:48.927198 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:46:48.928197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:48.943196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.943196 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:46:48.944197 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:46:48.945196 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.947197 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:46:48.866178 => 22:46:48.946198
[0m22:46:48.947197 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:46:48.948197 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:46:48.949198 [info ] [Thread-2 (]: 5 of 14 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.09s]
[0m22:46:48.949198 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:46:48.950198 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:46:48.950198 [info ] [Thread-2 (]: 8 of 14 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:46:48.951197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:46:48.951197 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:46:48.954197 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:46:48.955197 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:46:48.951197 => 22:46:48.955197
[0m22:46:48.955197 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:46:48.958198 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:46:48.959197 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:46:48.959197 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:46:48.960198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:48.974198 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:48.975197 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:46:48.975197 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:46:48.976196 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:48.977201 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:46:48.897691 => 22:46:48.977201
[0m22:46:48.978201 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:46:48.978201 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:46:48.979198 [info ] [Thread-3 (]: 6 of 14 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.09s]
[0m22:46:48.980196 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:46:48.980196 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:46:48.981198 [info ] [Thread-3 (]: 9 of 14 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:46:48.981198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:46:48.982197 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:46:48.987198 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:46:48.987198 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:46:48.982197 => 22:46:48.987198
[0m22:46:48.988197 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:46:48.990198 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:46:48.990198 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:46:48.991202 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:46:48.991202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:46:49.005200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.006202 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:46:49.006202 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:46:49.007201 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.008200 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:46:48.925197 => 22:46:49.008200
[0m22:46:49.009200 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:46:49.009200 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:46:49.010200 [info ] [Thread-1 (]: 7 of 14 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m22:46:49.011200 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:46:49.011200 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:46:49.012200 [info ] [Thread-1 (]: 10 of 14 START test source_unique_web_transactions_id .......................... [RUN]
[0m22:46:49.012200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:46:49.013200 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:46:49.015706 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:46:49.016704 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:46:49.013200 => 22:46:49.016704
[0m22:46:49.016704 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:46:49.018706 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:46:49.019706 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:46:49.019706 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:46:49.020706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:49.037705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.037705 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:46:49.038706 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:46:49.039708 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.040706 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:46:48.956197 => 22:46:49.040706
[0m22:46:49.041706 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:46:49.041706 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:46:49.042705 [info ] [Thread-2 (]: 8 of 14 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.09s]
[0m22:46:49.042705 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:46:49.043706 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:46:49.043706 [info ] [Thread-2 (]: 11 of 14 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m22:46:49.044705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m22:46:49.044705 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:46:49.047705 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:46:49.048705 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 22:46:49.045707 => 22:46:49.048705
[0m22:46:49.049705 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:46:49.050706 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:46:49.051705 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:46:49.051705 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m22:46:49.052705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:46:49.068707 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.069706 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:46:49.069706 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:49.070705 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.072706 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:46:48.988197 => 22:46:49.071706
[0m22:46:49.072706 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:46:49.072706 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:46:49.073705 [warn ] [Thread-3 (]: 9 of 14 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.09s]
[0m22:46:49.074705 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:46:49.074705 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:46:49.075706 [info ] [Thread-3 (]: 12 of 14 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:46:49.075706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:46:49.076705 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:46:49.079708 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:46:49.080705 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:46:49.076705 => 22:46:49.079708
[0m22:46:49.080705 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:46:49.083705 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:46:49.083705 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:46:49.084705 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:46:49.084705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:46:49.101218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.102218 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:46:49.102218 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:49.103218 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.105218 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:46:49.017714 => 22:46:49.104218
[0m22:46:49.105218 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:46:49.105218 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:46:49.106220 [info ] [Thread-1 (]: 10 of 14 PASS source_unique_web_transactions_id ................................ [[32mPASS[0m in 0.09s]
[0m22:46:49.107219 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:46:49.107219 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:46:49.108220 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:46:49.109219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:46:49.109219 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:46:49.112218 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:46:49.113218 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:46:49.109219 => 22:46:49.113218
[0m22:46:49.113218 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:46:49.114721 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:46:49.115724 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:46:49.115724 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:46:49.116725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:49.165358 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.165358 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:46:49.166358 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:49.167359 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.168360 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:46:49.080705 => 22:46:49.168360
[0m22:46:49.168360 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:46:49.169358 [debug] [Thread-3 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:46:49.170359 [info ] [Thread-3 (]: 12 of 14 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m22:46:49.170359 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:46:49.171360 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:46:49.171360 [info ] [Thread-3 (]: 14 of 14 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:46:49.172359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:46:49.172359 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:46:49.176358 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:46:49.177360 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:46:49.173359 => 22:46:49.176358
[0m22:46:49.177360 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:46:49.179358 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:46:49.179358 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:46:49.180358 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:46:49.180358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:46:49.197358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.198359 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:46:49.198359 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:49.200363 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.201363 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:46:49.113218 => 22:46:49.201363
[0m22:46:49.201363 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:46:49.202364 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:46:49.202364 [info ] [Thread-1 (]: 13 of 14 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.09s]
[0m22:46:49.203363 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:46:49.227028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.227028 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:46:49.228028 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:46:49.229028 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.230027 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:46:49.177360 => 22:46:49.230027
[0m22:46:49.230027 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:46:49.231026 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:46:49.232027 [info ] [Thread-3 (]: 14 of 14 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.06s]
[0m22:46:49.232027 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:46:49.248026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.249026 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:46:49.249026 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:49.251027 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:46:49.252027 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 22:46:49.049705 => 22:46:49.252027
[0m22:46:49.252027 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m22:46:49.253028 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m22:46:49.253028 [info ] [Thread-2 (]: 11 of 14 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.21s]
[0m22:46:49.254028 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:46:49.255252 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:49.256256 [debug] [MainThread]: On master: BEGIN
[0m22:46:49.256256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:49.307259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:49.307259 [debug] [MainThread]: On master: COMMIT
[0m22:46:49.307259 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:49.308259 [debug] [MainThread]: On master: COMMIT
[0m22:46:49.308259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:49.309259 [debug] [MainThread]: On master: Close
[0m22:46:49.309259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:49.310259 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:46:49.310259 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m22:46:49.310259 [debug] [MainThread]: Connection 'test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5' was properly closed.
[0m22:46:49.311259 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m22:46:49.311259 [info ] [MainThread]: 
[0m22:46:49.311259 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m22:46:49.313259 [debug] [MainThread]: Command end result
[0m22:46:49.319765 [info ] [MainThread]: 
[0m22:46:49.320765 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:46:49.320765 [info ] [MainThread]: 
[0m22:46:49.321765 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:46:49.321765 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:46:49.322765 [info ] [MainThread]: 
[0m22:46:49.322765 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:46:49.322765 [info ] [MainThread]: 
[0m22:46:49.323765 [info ] [MainThread]: Done. PASS=13 WARN=1 ERROR=0 SKIP=0 TOTAL=14
[0m22:46:49.324765 [debug] [MainThread]: Command `dbt test` succeeded at 22:46:49.324765 after 1.12 seconds
[0m22:46:49.324765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021486D66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A75F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148A4D3C10>]}
[0m22:46:49.325764 [debug] [MainThread]: Flushing usage events
[0m22:54:38.095378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CA9D7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CDCCAD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CDCCAAD0>]}


============================== 22:54:38.097377 | c0bd8307-bead-492b-ae0d-c08312787110 ==============================
[0m22:54:38.097377 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:54:38.098377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:38.219894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189C69D2E00>]}
[0m22:54:38.279403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CDF16D10>]}
[0m22:54:38.280405 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:54:38.289403 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:54:38.367914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:38.368914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:38.372914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CE151390>]}
[0m22:54:38.379914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CE057BB0>]}
[0m22:54:38.380915 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:54:38.380915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CE057BE0>]}
[0m22:54:38.382914 [info ] [MainThread]: 
[0m22:54:38.383322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:54:38.384367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:54:38.391484 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:54:38.392483 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:54:38.392483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:38.442545 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.442545 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:54:38.443546 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:54:38.445544 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:54:38.446544 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:54:38.446544 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:54:38.450545 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:38.451544 [debug] [MainThread]: On master: BEGIN
[0m22:54:38.451544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:38.498191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.498191 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:38.499197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:54:38.502236 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:54:38.503232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0bd8307-bead-492b-ae0d-c08312787110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CDF358D0>]}
[0m22:54:38.504196 [debug] [MainThread]: On master: ROLLBACK
[0m22:54:38.504196 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:38.504196 [debug] [MainThread]: On master: BEGIN
[0m22:54:38.505233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.505233 [debug] [MainThread]: On master: COMMIT
[0m22:54:38.505233 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:38.506196 [debug] [MainThread]: On master: COMMIT
[0m22:54:38.506196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:54:38.506196 [debug] [MainThread]: On master: Close
[0m22:54:38.507209 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:54:38.507209 [info ] [MainThread]: 
[0m22:54:38.509197 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:54:38.510195 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:54:38.510195 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:54:38.510195 [info ] [Thread-1 (]: 1 of 14 START test check_valid_customers ....................................... [RUN]
[0m22:54:38.511195 [info ] [Thread-2 (]: 2 of 14 START test not_null_contacts_joined_with_transactions_transaction_id ... [RUN]
[0m22:54:38.511195 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m22:54:38.512195 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:54:38.513196 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca'
[0m22:54:38.513196 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_sf__contacts_new_id.346de3589b'
[0m22:54:38.513196 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:54:38.514196 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:54:38.514196 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:54:38.520199 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:54:38.528197 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:54:38.530197 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:54:38.531700 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:54:38.514196 => 22:54:38.531700
[0m22:54:38.532705 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 22:54:38.521198 => 22:54:38.532705
[0m22:54:38.532705 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:54:38.532705 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:54:38.534054 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 22:54:38.528197 => 22:54:38.532705
[0m22:54:38.543057 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:54:38.544057 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:54:38.545057 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:54:38.547057 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:54:38.547057 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:54:38.548059 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:54:38.548059 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:54:38.548059 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:54:38.549058 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m22:54:38.549058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:54:38.550058 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m22:54:38.550058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:54:38.551066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:54:38.595320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.596322 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:54:38.596322 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:54:38.597321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.599320 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:54:38.534054 => 22:54:38.598320
[0m22:54:38.599320 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:54:38.599320 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:54:38.600321 [info ] [Thread-1 (]: 1 of 14 PASS check_valid_customers ............................................. [[32mPASS[0m in 0.09s]
[0m22:54:38.601321 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:54:38.601321 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:54:38.602322 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_web__transactions_id ........................... [RUN]
[0m22:54:38.602322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_valid_customers, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m22:54:38.603321 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:54:38.606321 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:54:38.607321 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 22:54:38.603321 => 22:54:38.607321
[0m22:54:38.607321 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:54:38.609321 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:54:38.610322 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:54:38.610322 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m22:54:38.610322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:38.627326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.628329 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m22:54:38.628329 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m22:54:38.630326 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.631829 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 22:54:38.543057 => 22:54:38.631829
[0m22:54:38.631829 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m22:54:38.631829 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m22:54:38.632832 [info ] [Thread-2 (]: 2 of 14 PASS not_null_contacts_joined_with_transactions_transaction_id ......... [[32mPASS[0m in 0.12s]
[0m22:54:38.633832 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m22:54:38.633832 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:54:38.634898 [info ] [Thread-2 (]: 5 of 14 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m22:54:38.634898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m22:54:38.635902 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:54:38.641903 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:54:38.642904 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 22:54:38.635902 => 22:54:38.641903
[0m22:54:38.642904 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:54:38.644901 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:54:38.644901 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:54:38.645902 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m22:54:38.645902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:38.661902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.661902 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m22:54:38.661902 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m22:54:38.662903 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.663902 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 22:54:38.545057 => 22:54:38.663902
[0m22:54:38.664901 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m22:54:38.664901 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m22:54:38.665902 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.15s]
[0m22:54:38.666902 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m22:54:38.666902 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:54:38.667903 [info ] [Thread-3 (]: 6 of 14 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m22:54:38.667903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m22:54:38.668903 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:54:38.676901 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:54:38.677902 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 22:54:38.668903 => 22:54:38.677902
[0m22:54:38.677902 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:54:38.679902 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:54:38.680902 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:54:38.680902 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m22:54:38.680902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:38.696901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.696901 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m22:54:38.697902 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m22:54:38.698901 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.699904 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 22:54:38.607321 => 22:54:38.699904
[0m22:54:38.699904 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m22:54:38.700902 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m22:54:38.700902 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_web__transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m22:54:38.701902 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m22:54:38.702902 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:54:38.702902 [info ] [Thread-1 (]: 7 of 14 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m22:54:38.703903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m22:54:38.703903 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:54:38.706902 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:54:38.707901 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 22:54:38.703903 => 22:54:38.707901
[0m22:54:38.708903 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:54:38.710902 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:54:38.710902 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:54:38.711903 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m22:54:38.711903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:38.756411 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.756411 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m22:54:38.757412 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m22:54:38.758411 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.759410 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 22:54:38.677902 => 22:54:38.759410
[0m22:54:38.759410 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m22:54:38.760410 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m22:54:38.761412 [info ] [Thread-3 (]: 6 of 14 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.09s]
[0m22:54:38.761412 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m22:54:38.762423 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:54:38.762423 [info ] [Thread-3 (]: 8 of 14 START test source_not_null_web_transactions_id ......................... [RUN]
[0m22:54:38.763411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m22:54:38.763411 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:54:38.766412 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:54:38.767411 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 22:54:38.763411 => 22:54:38.767411
[0m22:54:38.767411 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:54:38.769411 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:54:38.770411 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:54:38.770411 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m22:54:38.770411 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:38.786411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.786411 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m22:54:38.787411 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m22:54:38.787411 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.789412 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 22:54:38.708903 => 22:54:38.788412
[0m22:54:38.789412 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m22:54:38.789412 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m22:54:38.790411 [info ] [Thread-1 (]: 7 of 14 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.09s]
[0m22:54:38.791411 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m22:54:38.792411 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:54:38.792411 [info ] [Thread-1 (]: 9 of 14 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m22:54:38.793412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m22:54:38.793412 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:54:38.798411 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:54:38.799411 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 22:54:38.793412 => 22:54:38.798411
[0m22:54:38.799411 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:54:38.801411 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:54:38.801411 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:54:38.802412 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m22:54:38.802412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:38.817416 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.817416 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m22:54:38.818416 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m22:54:38.819416 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.820418 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 22:54:38.768411 => 22:54:38.820418
[0m22:54:38.820418 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m22:54:38.821417 [debug] [Thread-3 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m22:54:38.821417 [info ] [Thread-3 (]: 8 of 14 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.06s]
[0m22:54:38.822417 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m22:54:38.822417 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:54:38.823416 [info ] [Thread-3 (]: 10 of 14 START test source_unique_web_transactions_id .......................... [RUN]
[0m22:54:38.824416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m22:54:38.824416 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:54:38.828416 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:54:38.828416 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.829417 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m22:54:38.829417 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 22:54:38.824416 => 22:54:38.829417
[0m22:54:38.830416 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:54:38.830416 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:54:38.832927 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:54:38.832927 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.833926 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 22:54:38.642904 => 22:54:38.833926
[0m22:54:38.834926 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m22:54:38.834926 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:54:38.834926 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m22:54:38.835926 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m22:54:38.836927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:38.836927 [info ] [Thread-2 (]: 5 of 14 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.20s]
[0m22:54:38.837927 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m22:54:38.837927 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:54:38.838926 [info ] [Thread-2 (]: 11 of 14 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m22:54:38.838926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m22:54:38.839927 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:54:38.842926 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:54:38.843927 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 22:54:38.839927 => 22:54:38.843927
[0m22:54:38.843927 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:54:38.845928 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:54:38.845928 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:54:38.846926 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m22:54:38.846926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:38.850925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.850925 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m22:54:38.851927 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:38.852927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.853927 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 22:54:38.799411 => 22:54:38.853927
[0m22:54:38.853927 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m22:54:38.854927 [debug] [Thread-1 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m22:54:38.855951 [warn ] [Thread-1 (]: 9 of 14 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.06s]
[0m22:54:38.855951 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m22:54:38.856928 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:54:38.856928 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m22:54:38.857927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m22:54:38.857927 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:54:38.860926 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:54:38.861925 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 22:54:38.858927 => 22:54:38.861925
[0m22:54:38.861925 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:54:38.863926 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:54:38.864927 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:54:38.864927 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m22:54:38.864927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:38.883926 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.883926 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m22:54:38.883926 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:38.885926 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.886926 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 22:54:38.830416 => 22:54:38.886926
[0m22:54:38.886926 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m22:54:38.887926 [debug] [Thread-3 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m22:54:38.887926 [info ] [Thread-3 (]: 10 of 14 PASS source_unique_web_transactions_id ................................ [[32mPASS[0m in 0.06s]
[0m22:54:38.888926 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m22:54:38.888926 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:54:38.889927 [info ] [Thread-3 (]: 13 of 14 START test unique_stg_web__transactions_id ............................ [RUN]
[0m22:54:38.890927 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m22:54:38.890927 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:54:38.893927 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:54:38.894928 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 22:54:38.890927 => 22:54:38.894928
[0m22:54:38.895927 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:54:38.896926 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:54:38.897926 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:54:38.897926 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m22:54:38.898927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:38.915925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.915925 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m22:54:38.916927 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:38.918932 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.919930 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 22:54:38.843927 => 22:54:38.919930
[0m22:54:38.919930 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m22:54:38.920930 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m22:54:38.921930 [info ] [Thread-2 (]: 11 of 14 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.08s]
[0m22:54:38.921930 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m22:54:38.922932 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:54:38.922932 [info ] [Thread-2 (]: 14 of 14 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m22:54:38.924932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m22:54:38.924932 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:54:38.928930 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:54:38.929930 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 22:54:38.925931 => 22:54:38.928930
[0m22:54:38.929930 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:54:38.931931 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:54:38.932435 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:54:38.932435 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m22:54:38.932435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:54:38.949438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.950438 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m22:54:38.950438 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:38.951438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.952438 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 22:54:38.862926 => 22:54:38.952438
[0m22:54:38.953438 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m22:54:38.953438 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m22:54:38.954437 [info ] [Thread-1 (]: 12 of 14 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m22:54:38.955439 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m22:54:38.983437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:38.983437 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m22:54:38.984439 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:38.985438 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:38.986438 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 22:54:38.895927 => 22:54:38.986438
[0m22:54:38.986438 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m22:54:38.987437 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m22:54:38.988440 [info ] [Thread-3 (]: 13 of 14 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.10s]
[0m22:54:38.989439 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m22:54:39.014438 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:54:39.014438 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m22:54:39.015438 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m22:54:39.016444 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:54:39.017456 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 22:54:38.929930 => 22:54:39.017456
[0m22:54:39.018450 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m22:54:39.018450 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m22:54:39.019450 [info ] [Thread-2 (]: 14 of 14 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.09s]
[0m22:54:39.019450 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m22:54:39.021450 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:39.021450 [debug] [MainThread]: On master: BEGIN
[0m22:54:39.021450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:39.068985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:54:39.069985 [debug] [MainThread]: On master: COMMIT
[0m22:54:39.069985 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:39.069985 [debug] [MainThread]: On master: COMMIT
[0m22:54:39.070984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:54:39.070984 [debug] [MainThread]: On master: Close
[0m22:54:39.071984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:39.071984 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:54:39.071984 [debug] [MainThread]: Connection 'test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2' was properly closed.
[0m22:54:39.072984 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m22:54:39.072984 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m22:54:39.072984 [info ] [MainThread]: 
[0m22:54:39.073985 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m22:54:39.074986 [debug] [MainThread]: Command end result
[0m22:54:39.081985 [info ] [MainThread]: 
[0m22:54:39.081985 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:54:39.082987 [info ] [MainThread]: 
[0m22:54:39.082987 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m22:54:39.082987 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m22:54:39.083985 [info ] [MainThread]: 
[0m22:54:39.083985 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m22:54:39.084985 [info ] [MainThread]: 
[0m22:54:39.084985 [info ] [MainThread]: Done. PASS=13 WARN=1 ERROR=0 SKIP=0 TOTAL=14
[0m22:54:39.085985 [debug] [MainThread]: Command `dbt test` succeeded at 22:54:39.085985 after 1.03 seconds
[0m22:54:39.085985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CA9D7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CE26EA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189CE10BBE0>]}
[0m22:54:39.086985 [debug] [MainThread]: Flushing usage events
[0m22:55:10.290718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885A6B4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885D9AECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885D9AEA70>]}


============================== 22:55:10.293719 | 9551aee1-4239-4bc1-b2e2-30f67fc363d1 ==============================
[0m22:55:10.293719 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:55:10.294712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:10.417571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018856722E30>]}
[0m22:55:10.473637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885D964AF0>]}
[0m22:55:10.474637 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:55:10.483286 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:55:10.562449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:10.563449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:10.566451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DE41330>]}
[0m22:55:10.575453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DD2FA90>]}
[0m22:55:10.575453 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:55:10.576404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DD2FB50>]}
[0m22:55:10.577412 [info ] [MainThread]: 
[0m22:55:10.577412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:55:10.578448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:55:10.585077 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:55:10.586080 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:55:10.586080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:10.636114 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:55:10.637115 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:55:10.637115 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:55:10.639114 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:55:10.640114 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:55:10.641114 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:55:10.645115 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.645115 [debug] [MainThread]: On master: BEGIN
[0m22:55:10.645115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:10.701234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:10.701234 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.701234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:55:10.704233 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:55:10.706235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9551aee1-4239-4bc1-b2e2-30f67fc363d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DD2DEA0>]}
[0m22:55:10.706235 [debug] [MainThread]: On master: ROLLBACK
[0m22:55:10.706235 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.707234 [debug] [MainThread]: On master: BEGIN
[0m22:55:10.707234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:10.707234 [debug] [MainThread]: On master: COMMIT
[0m22:55:10.708234 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.708234 [debug] [MainThread]: On master: COMMIT
[0m22:55:10.708234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:10.709233 [debug] [MainThread]: On master: Close
[0m22:55:10.709233 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:55:10.710234 [info ] [MainThread]: 
[0m22:55:10.712233 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:55:10.712233 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:55:10.713235 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:55:10.713235 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:55:10.718232 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:55:10.719233 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:55:10.713235 => 22:55:10.718232
[0m22:55:10.719233 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:55:10.728232 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:55:10.729232 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:55:10.729232 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:55:10.730233 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:10.777236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:55:10.778236 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:55:10.778236 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:55:10.779237 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:55:10.780742 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:55:10.719233 => 22:55:10.780742
[0m22:55:10.781745 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:55:10.781745 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:55:10.782745 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:55:10.782745 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:55:10.783747 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.784746 [debug] [MainThread]: On master: BEGIN
[0m22:55:10.784746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:10.831745 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:10.832745 [debug] [MainThread]: On master: COMMIT
[0m22:55:10.832745 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:10.833746 [debug] [MainThread]: On master: COMMIT
[0m22:55:10.833746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:10.834746 [debug] [MainThread]: On master: Close
[0m22:55:10.834746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:10.835745 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:55:10.835745 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:55:10.835745 [info ] [MainThread]: 
[0m22:55:10.836747 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m22:55:10.836747 [debug] [MainThread]: Command end result
[0m22:55:10.842746 [info ] [MainThread]: 
[0m22:55:10.842746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:10.843746 [info ] [MainThread]: 
[0m22:55:10.843746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:55:10.844746 [debug] [MainThread]: Command `dbt test` succeeded at 22:55:10.844746 after 0.59 seconds
[0m22:55:10.844746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885A6B4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DA237F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001885DEC15D0>]}
[0m22:55:10.845746 [debug] [MainThread]: Flushing usage events
[0m22:55:58.138939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66B66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D69E5ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D69E5EAD0>]}


============================== 22:55:58.141944 | 25100a2d-5409-46d9-a72d-176ddc581a7e ==============================
[0m22:55:58.141944 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:55:58.141944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:58.261453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62B42E30>]}
[0m22:55:58.319496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A09AD10>]}
[0m22:55:58.320454 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:55:58.329496 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:55:58.407003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:58.408003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:58.412005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A2F1390>]}
[0m22:55:58.420003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A1DFBB0>]}
[0m22:55:58.420003 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:55:58.420003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A1DFBE0>]}
[0m22:55:58.421004 [info ] [MainThread]: 
[0m22:55:58.422003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:55:58.423003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:55:58.430009 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:55:58.430009 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:55:58.430009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:58.481816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:55:58.482776 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:55:58.482776 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:55:58.485775 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:55:58.485775 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:55:58.486774 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:55:58.490774 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.490774 [debug] [MainThread]: On master: BEGIN
[0m22:55:58.490774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:58.535778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:58.535778 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.536779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:55:58.539778 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:55:58.540281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25100a2d-5409-46d9-a72d-176ddc581a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A1DDEA0>]}
[0m22:55:58.541284 [debug] [MainThread]: On master: ROLLBACK
[0m22:55:58.541284 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.542284 [debug] [MainThread]: On master: BEGIN
[0m22:55:58.542284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:58.542284 [debug] [MainThread]: On master: COMMIT
[0m22:55:58.543285 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.543285 [debug] [MainThread]: On master: COMMIT
[0m22:55:58.543285 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:58.544285 [debug] [MainThread]: On master: Close
[0m22:55:58.544285 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:55:58.545285 [info ] [MainThread]: 
[0m22:55:58.547314 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:55:58.547314 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:55:58.548315 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:55:58.548315 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:55:58.553315 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:55:58.553315 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:55:58.548315 => 22:55:58.553315
[0m22:55:58.554314 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:55:58.563315 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:55:58.564314 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:55:58.564314 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:55:58.565314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:58.613314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:55:58.613314 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:55:58.614314 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:55:58.615314 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:55:58.616314 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:55:58.554314 => 22:55:58.616314
[0m22:55:58.616314 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:55:58.617314 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:55:58.618314 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:55:58.618314 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:55:58.619316 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.620315 [debug] [MainThread]: On master: BEGIN
[0m22:55:58.620315 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:58.669947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:58.670947 [debug] [MainThread]: On master: COMMIT
[0m22:55:58.670947 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:58.670947 [debug] [MainThread]: On master: COMMIT
[0m22:55:58.671946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:58.671946 [debug] [MainThread]: On master: Close
[0m22:55:58.672947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:58.672947 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:55:58.672947 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:55:58.673946 [info ] [MainThread]: 
[0m22:55:58.673946 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:55:58.674947 [debug] [MainThread]: Command end result
[0m22:55:58.680947 [info ] [MainThread]: 
[0m22:55:58.680947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:58.681946 [info ] [MainThread]: 
[0m22:55:58.681946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:55:58.682947 [debug] [MainThread]: Command `dbt test` succeeded at 22:55:58.682947 after 0.58 seconds
[0m22:55:58.682947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66B66AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A371630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6A29FBE0>]}
[0m22:55:58.683946 [debug] [MainThread]: Flushing usage events
[0m22:56:34.643154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E52D55090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E5604EDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E5604EB30>]}


============================== 22:56:34.646155 | 5f34fd2b-90f1-4f68-947b-9b7e74e49ffa ==============================
[0m22:56:34.646155 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:56:34.647155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:56:34.767396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E4ECF2E30>]}
[0m22:56:34.825207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E5629A440>]}
[0m22:56:34.825207 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:56:34.835211 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:56:34.912232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:34.912232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:34.916232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E564E13F0>]}
[0m22:56:34.923639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E563DBB80>]}
[0m22:56:34.924686 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:56:34.924686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E563DBC10>]}
[0m22:56:34.925638 [info ] [MainThread]: 
[0m22:56:34.926637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:56:34.927636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:56:34.934636 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:56:34.934636 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:56:34.934636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:34.984142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:56:34.985146 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:56:34.985146 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:56:34.987146 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:56:34.988145 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:56:34.989146 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:56:34.993146 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:34.993146 [debug] [MainThread]: On master: BEGIN
[0m22:56:34.993146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:35.042489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:56:35.042489 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:35.043488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:56:35.046487 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:56:35.047490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f34fd2b-90f1-4f68-947b-9b7e74e49ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E563D9F60>]}
[0m22:56:35.048490 [debug] [MainThread]: On master: ROLLBACK
[0m22:56:35.048490 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:35.048490 [debug] [MainThread]: On master: BEGIN
[0m22:56:35.049488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:56:35.049488 [debug] [MainThread]: On master: COMMIT
[0m22:56:35.049488 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:35.050488 [debug] [MainThread]: On master: COMMIT
[0m22:56:35.050488 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:56:35.050488 [debug] [MainThread]: On master: Close
[0m22:56:35.051489 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:56:35.052489 [info ] [MainThread]: 
[0m22:56:35.054489 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:56:35.054489 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:56:35.055488 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:56:35.055488 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:56:35.060489 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:56:35.060489 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:56:35.055488 => 22:56:35.060489
[0m22:56:35.061490 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:56:35.071491 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:56:35.072491 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:56:35.072491 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:56:35.072491 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:56:35.122195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:56:35.122195 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:56:35.123233 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:56:35.124242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:56:35.125233 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:56:35.061490 => 22:56:35.125233
[0m22:56:35.125233 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:56:35.126240 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:56:35.126240 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:56:35.127234 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:56:35.128197 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:35.129196 [debug] [MainThread]: On master: BEGIN
[0m22:56:35.129196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:35.173588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:56:35.174590 [debug] [MainThread]: On master: COMMIT
[0m22:56:35.174590 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:35.174590 [debug] [MainThread]: On master: COMMIT
[0m22:56:35.175589 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:56:35.175589 [debug] [MainThread]: On master: Close
[0m22:56:35.176590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:35.176590 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:56:35.176590 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:56:35.177589 [info ] [MainThread]: 
[0m22:56:35.177589 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:56:35.178590 [debug] [MainThread]: Command end result
[0m22:56:35.184097 [info ] [MainThread]: 
[0m22:56:35.184097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:35.185146 [info ] [MainThread]: 
[0m22:56:35.185146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:56:35.186145 [debug] [MainThread]: Command `dbt test` succeeded at 22:56:35.186145 after 0.58 seconds
[0m22:56:35.186145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E52D55090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E5648FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E56561690>]}
[0m22:56:35.187147 [debug] [MainThread]: Flushing usage events
[0m22:57:13.768485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11C015270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F30EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F30EB90>]}


============================== 22:57:13.771485 | 2458dca2-5c15-43fa-9471-725297996de3 ==============================
[0m22:57:13.771485 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:57:13.772484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test -s customers', 'send_anonymous_usage_stats': 'True'}
[0m22:57:13.893526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B118042E30>]}
[0m22:57:13.951035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F54C7F0>]}
[0m22:57:13.952035 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:57:13.961037 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:57:14.038543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:57:14.038543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:57:14.042543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F79D450>]}
[0m22:57:14.050543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F69BC70>]}
[0m22:57:14.050543 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:57:14.051543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F69BCA0>]}
[0m22:57:14.052543 [info ] [MainThread]: 
[0m22:57:14.052543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:57:14.054544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:57:14.060543 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:57:14.060543 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:57:14.061543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:14.110354 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:57:14.110354 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:57:14.110354 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:57:14.113355 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:57:14.114355 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:57:14.114355 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:57:14.118357 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.119357 [debug] [MainThread]: On master: BEGIN
[0m22:57:14.119357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:14.170094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:57:14.171094 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.171094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:57:14.174094 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:57:14.175094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2458dca2-5c15-43fa-9471-725297996de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F699F60>]}
[0m22:57:14.175094 [debug] [MainThread]: On master: ROLLBACK
[0m22:57:14.176094 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.176094 [debug] [MainThread]: On master: BEGIN
[0m22:57:14.177094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:57:14.177094 [debug] [MainThread]: On master: COMMIT
[0m22:57:14.177094 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.178094 [debug] [MainThread]: On master: COMMIT
[0m22:57:14.178094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:57:14.178094 [debug] [MainThread]: On master: Close
[0m22:57:14.179094 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:57:14.179094 [info ] [MainThread]: 
[0m22:57:14.181095 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:57:14.182094 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:57:14.183094 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:57:14.183094 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:57:14.188093 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:57:14.188093 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:57:14.183094 => 22:57:14.188093
[0m22:57:14.189094 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:57:14.199093 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:57:14.199093 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:57:14.200094 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:57:14.200094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:14.245603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:57:14.246605 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:57:14.246605 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:57:14.247604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:57:14.249603 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:57:14.189094 => 22:57:14.249603
[0m22:57:14.249603 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:57:14.250603 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:57:14.250603 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:57:14.251605 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:57:14.252606 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.252606 [debug] [MainThread]: On master: BEGIN
[0m22:57:14.253649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:14.298651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:57:14.298651 [debug] [MainThread]: On master: COMMIT
[0m22:57:14.299653 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:14.299653 [debug] [MainThread]: On master: COMMIT
[0m22:57:14.300653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:57:14.300653 [debug] [MainThread]: On master: Close
[0m22:57:14.301653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:14.301653 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:57:14.302652 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:57:14.302652 [info ] [MainThread]: 
[0m22:57:14.303653 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:57:14.303653 [debug] [MainThread]: Command end result
[0m22:57:14.309651 [info ] [MainThread]: 
[0m22:57:14.309651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:14.310653 [info ] [MainThread]: 
[0m22:57:14.310653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:57:14.311652 [debug] [MainThread]: Command `dbt test` succeeded at 22:57:14.311652 after 0.58 seconds
[0m22:57:14.311652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11C015270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F82BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11F74BCA0>]}
[0m22:57:14.312652 [debug] [MainThread]: Flushing usage events
[0m22:58:05.825945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F263B5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F296AEDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F296AEB30>]}


============================== 22:58:05.827943 | b93804db-6c3e-4b1e-85c8-9610fc4f86f7 ==============================
[0m22:58:05.827943 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:58:05.828944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test -s customers', 'send_anonymous_usage_stats': 'True'}
[0m22:58:05.949456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F22452E30>]}
[0m22:58:06.009074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F298F2440>]}
[0m22:58:06.010074 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:58:06.019582 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:58:06.095744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:06.095744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:06.099746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29B3D3F0>]}
[0m22:58:06.107748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29A3BB80>]}
[0m22:58:06.107748 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:58:06.108747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29A3BC10>]}
[0m22:58:06.109749 [info ] [MainThread]: 
[0m22:58:06.109749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:58:06.111252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:58:06.119257 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:06.119257 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:58:06.119257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:06.167848 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:06.167848 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:06.168849 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:58:06.170848 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:58:06.171848 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:58:06.171848 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:58:06.176938 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.176938 [debug] [MainThread]: On master: BEGIN
[0m22:58:06.176938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:06.225153 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:06.226158 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.226158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:58:06.229116 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:58:06.230117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b93804db-6c3e-4b1e-85c8-9610fc4f86f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29A39F60>]}
[0m22:58:06.231115 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:06.231115 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.232115 [debug] [MainThread]: On master: BEGIN
[0m22:58:06.232115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:06.232115 [debug] [MainThread]: On master: COMMIT
[0m22:58:06.233115 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.233115 [debug] [MainThread]: On master: COMMIT
[0m22:58:06.233115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:06.234115 [debug] [MainThread]: On master: Close
[0m22:58:06.234115 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:58:06.235116 [info ] [MainThread]: 
[0m22:58:06.237049 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:58:06.237049 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:58:06.238055 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:58:06.239055 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:58:06.244054 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:58:06.244054 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:58:06.239055 => 22:58:06.244054
[0m22:58:06.245054 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:58:06.255054 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:58:06.255054 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:06.256053 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:58:06.256053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:06.311782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:06.311782 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:06.312896 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:58:06.313896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:58:06.314896 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:58:06.245054 => 22:58:06.314896
[0m22:58:06.315896 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:58:06.315896 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:58:06.316896 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.08s]
[0m22:58:06.316896 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:58:06.318895 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.318895 [debug] [MainThread]: On master: BEGIN
[0m22:58:06.318895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:06.364895 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:06.365896 [debug] [MainThread]: On master: COMMIT
[0m22:58:06.365896 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:06.366895 [debug] [MainThread]: On master: COMMIT
[0m22:58:06.366895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:06.366895 [debug] [MainThread]: On master: Close
[0m22:58:06.367896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:06.367896 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:58:06.368896 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:58:06.368896 [info ] [MainThread]: 
[0m22:58:06.368896 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m22:58:06.369895 [debug] [MainThread]: Command end result
[0m22:58:06.375896 [info ] [MainThread]: 
[0m22:58:06.375896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:06.376894 [info ] [MainThread]: 
[0m22:58:06.376894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:58:06.377899 [debug] [MainThread]: Command `dbt test` succeeded at 22:58:06.377899 after 0.59 seconds
[0m22:58:06.378895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F263B5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29AEBC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F29BC1690>]}
[0m22:58:06.378895 [debug] [MainThread]: Flushing usage events
[0m22:58:31.454272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149AD6F4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B09EED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B09EEAA0>]}


============================== 22:58:31.457273 | 45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb ==============================
[0m22:58:31.457273 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:58:31.458272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test -s customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:58:31.577824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149A96C2E30>]}
[0m22:58:31.636021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B09EDDB0>]}
[0m22:58:31.637021 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:58:31.644927 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:58:31.722881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:31.722881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:31.726881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0E81360>]}
[0m22:58:31.734885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0D6F8B0>]}
[0m22:58:31.734885 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:58:31.735885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0D6FB80>]}
[0m22:58:31.736885 [info ] [MainThread]: 
[0m22:58:31.737885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:58:31.738885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:58:31.745394 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:31.746395 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:58:31.746395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:31.796779 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:31.797779 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:31.797779 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:58:31.799778 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:58:31.800779 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:58:31.801778 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:58:31.805779 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.805779 [debug] [MainThread]: On master: BEGIN
[0m22:58:31.806794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:31.851737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:31.851737 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.851737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:58:31.854736 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:58:31.855737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45894bc9-cbbf-4c43-b4a9-b7ec8d49d5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0D6DED0>]}
[0m22:58:31.856738 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:31.856738 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.857737 [debug] [MainThread]: On master: BEGIN
[0m22:58:31.857737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:31.857737 [debug] [MainThread]: On master: COMMIT
[0m22:58:31.858737 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.858737 [debug] [MainThread]: On master: COMMIT
[0m22:58:31.858737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:31.859736 [debug] [MainThread]: On master: Close
[0m22:58:31.859736 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:58:31.860736 [info ] [MainThread]: 
[0m22:58:31.862736 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:58:31.862736 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:58:31.863737 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:58:31.863737 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:58:31.868735 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:58:31.869737 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:58:31.863737 => 22:58:31.869737
[0m22:58:31.869737 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:58:31.879736 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:58:31.880735 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:31.880735 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:58:31.881736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:31.927738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:31.927738 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:31.928739 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:58:31.929738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:58:31.930740 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:58:31.869737 => 22:58:31.930740
[0m22:58:31.931740 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:58:31.931740 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:58:31.932739 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:58:31.933739 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:58:31.934739 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.934739 [debug] [MainThread]: On master: BEGIN
[0m22:58:31.935739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:31.981265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:31.982266 [debug] [MainThread]: On master: COMMIT
[0m22:58:31.982266 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:31.983265 [debug] [MainThread]: On master: COMMIT
[0m22:58:31.983265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:31.983265 [debug] [MainThread]: On master: Close
[0m22:58:31.984264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:31.984264 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:58:31.984264 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:58:31.985266 [info ] [MainThread]: 
[0m22:58:31.985266 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:58:31.986265 [debug] [MainThread]: Command end result
[0m22:58:31.992265 [info ] [MainThread]: 
[0m22:58:31.992265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:31.993266 [info ] [MainThread]: 
[0m22:58:31.993266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:58:31.994266 [debug] [MainThread]: Command `dbt test` succeeded at 22:58:31.994266 after 0.58 seconds
[0m22:58:31.995265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149AD6F4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0B30460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149B0F01600>]}
[0m22:58:31.995265 [debug] [MainThread]: Flushing usage events
[0m22:58:48.608482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270B8636AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BB92ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BB92EAD0>]}


============================== 22:58:48.611486 | e0c6a6e5-29a6-4ba2-b190-338df89efd95 ==============================
[0m22:58:48.611486 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:58:48.611486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test -s customers', 'send_anonymous_usage_stats': 'True'}
[0m22:58:48.731434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270B4642E30>]}
[0m22:58:48.788943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBB72D10>]}
[0m22:58:48.789943 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:58:48.799489 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:58:48.875614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:48.876614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:48.880614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBDBD390>]}
[0m22:58:48.888614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBCAFBB0>]}
[0m22:58:48.888614 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:58:48.889615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBCAFBE0>]}
[0m22:58:48.890614 [info ] [MainThread]: 
[0m22:58:48.890614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:58:48.891735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:58:48.898781 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:48.898781 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:58:48.898781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:48.950334 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:48.950334 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:58:48.950334 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:58:48.953334 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:58:48.954334 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:58:48.954334 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:58:48.958436 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:48.958436 [debug] [MainThread]: On master: BEGIN
[0m22:58:48.959436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:49.004942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:49.005942 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:49.005942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:58:49.008942 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:58:49.009942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c6a6e5-29a6-4ba2-b190-338df89efd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBCADEA0>]}
[0m22:58:49.010942 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:49.010942 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:49.010942 [debug] [MainThread]: On master: BEGIN
[0m22:58:49.011942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:49.011942 [debug] [MainThread]: On master: COMMIT
[0m22:58:49.011942 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:49.012942 [debug] [MainThread]: On master: COMMIT
[0m22:58:49.012942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:49.012942 [debug] [MainThread]: On master: Close
[0m22:58:49.013942 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:58:49.013942 [info ] [MainThread]: 
[0m22:58:49.015942 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:58:49.016942 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:58:49.017942 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:58:49.017942 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:58:49.022942 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:58:49.022942 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:58:49.017942 => 22:58:49.022942
[0m22:58:49.023942 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:58:49.033942 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:58:49.033942 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:49.034942 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:58:49.034942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:49.081451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:49.082451 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:58:49.082451 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:58:49.083451 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:58:49.085451 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:58:49.023942 => 22:58:49.084451
[0m22:58:49.085451 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:58:49.085451 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:58:49.086451 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:58:49.087468 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:58:49.088453 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:49.089452 [debug] [MainThread]: On master: BEGIN
[0m22:58:49.089452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:49.136001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:49.136001 [debug] [MainThread]: On master: COMMIT
[0m22:58:49.137003 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:49.137003 [debug] [MainThread]: On master: COMMIT
[0m22:58:49.138002 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:49.138002 [debug] [MainThread]: On master: Close
[0m22:58:49.139008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:49.139008 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:58:49.139008 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:58:49.140003 [info ] [MainThread]: 
[0m22:58:49.140003 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:58:49.141002 [debug] [MainThread]: Command end result
[0m22:58:49.147004 [info ] [MainThread]: 
[0m22:58:49.147004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:49.148006 [info ] [MainThread]: 
[0m22:58:49.148006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:58:49.149005 [debug] [MainThread]: Command `dbt test` succeeded at 22:58:49.149005 after 0.58 seconds
[0m22:58:49.149005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270B8636AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBE41630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270BBD6BBE0>]}
[0m22:58:49.150004 [debug] [MainThread]: Flushing usage events
[0m22:59:13.238283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B9885090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCB7EDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCB7EB30>]}


============================== 22:59:13.240286 | 8529088c-52aa-463a-8598-390ce385ebb4 ==============================
[0m22:59:13.240286 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:59:13.241286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test -s customers', 'send_anonymous_usage_stats': 'True'}
[0m22:59:13.361887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B58C2E30>]}
[0m22:59:13.419394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCDCA440>]}
[0m22:59:13.419394 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m22:59:13.428437 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:59:13.506950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:13.507950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:13.511950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BD0113F0>]}
[0m22:59:13.519114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCF0BB20>]}
[0m22:59:13.520121 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m22:59:13.520121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCF0BC10>]}
[0m22:59:13.522121 [info ] [MainThread]: 
[0m22:59:13.522338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:13.523465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m22:59:13.530057 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:59:13.531094 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m22:59:13.531094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:13.579562 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:59:13.579562 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m22:59:13.580567 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:59:13.582566 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:59:13.583565 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m22:59:13.583565 [debug] [ThreadPool]: On list_dbt_public: Close
[0m22:59:13.587567 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.588566 [debug] [MainThread]: On master: BEGIN
[0m22:59:13.588566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:13.635072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:13.636073 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.636073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:13.639072 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:59:13.640072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8529088c-52aa-463a-8598-390ce385ebb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCF09F60>]}
[0m22:59:13.641072 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:13.641072 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.642072 [debug] [MainThread]: On master: BEGIN
[0m22:59:13.642072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:13.642072 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.643072 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.643072 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.643072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:59:13.644072 [debug] [MainThread]: On master: Close
[0m22:59:13.644072 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m22:59:13.645072 [info ] [MainThread]: 
[0m22:59:13.647072 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m22:59:13.648072 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m22:59:13.648072 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m22:59:13.649072 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m22:59:13.653073 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m22:59:13.654073 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 22:59:13.649072 => 22:59:13.654073
[0m22:59:13.655074 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m22:59:13.665072 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m22:59:13.666072 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:59:13.666072 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m22:59:13.667073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:13.712580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:59:13.712580 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m22:59:13.713580 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m22:59:13.714581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:59:13.716581 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 22:59:13.655074 => 22:59:13.715581
[0m22:59:13.716581 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m22:59:13.716581 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m22:59:13.717580 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m22:59:13.718581 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m22:59:13.719581 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.719581 [debug] [MainThread]: On master: BEGIN
[0m22:59:13.719581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:13.766582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:59:13.767582 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.767582 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.767582 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.768582 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:59:13.768582 [debug] [MainThread]: On master: Close
[0m22:59:13.769581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:13.769581 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m22:59:13.769581 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m22:59:13.770582 [info ] [MainThread]: 
[0m22:59:13.770582 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:59:13.771582 [debug] [MainThread]: Command end result
[0m22:59:13.777582 [info ] [MainThread]: 
[0m22:59:13.777582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:13.778581 [info ] [MainThread]: 
[0m22:59:13.778581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:59:13.779582 [debug] [MainThread]: Command `dbt test` succeeded at 22:59:13.779582 after 0.58 seconds
[0m22:59:13.779582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B9885090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BCFBBC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BD095690>]}
[0m22:59:13.780586 [debug] [MainThread]: Flushing usage events
[0m23:00:22.117204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97B97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9AE8ED70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9AE8EB00>]}


============================== 23:00:22.119205 | a05d1160-9f83-4f1a-8d52-35d932f3ffef ==============================
[0m23:00:22.119205 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:00:22.120205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:22.239760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A93BC2E30>]}
[0m23:00:22.296602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9AE453F0>]}
[0m23:00:22.297601 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:00:22.306603 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:00:22.385208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:22.385208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:22.389208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B3253C0>]}
[0m23:00:22.397209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B21BBE0>]}
[0m23:00:22.398209 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:00:22.398209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B21BC10>]}
[0m23:00:22.399210 [info ] [MainThread]: 
[0m23:00:22.400209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:22.401210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:00:22.408209 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:00:22.408209 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:00:22.409210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:22.457499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:22.457499 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:00:22.457499 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:22.460500 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:00:22.461499 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:00:22.461499 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:00:22.465498 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.465498 [debug] [MainThread]: On master: BEGIN
[0m23:00:22.466498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:22.511498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:22.512498 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.512498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:22.515497 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:00:22.516497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05d1160-9f83-4f1a-8d52-35d932f3ffef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B219ED0>]}
[0m23:00:22.517497 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:22.517497 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.518498 [debug] [MainThread]: On master: BEGIN
[0m23:00:22.518498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:22.518498 [debug] [MainThread]: On master: COMMIT
[0m23:00:22.519499 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.519499 [debug] [MainThread]: On master: COMMIT
[0m23:00:22.519499 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:22.520499 [debug] [MainThread]: On master: Close
[0m23:00:22.520499 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:00:22.521498 [info ] [MainThread]: 
[0m23:00:22.523498 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m23:00:22.523498 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m23:00:22.524500 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m23:00:22.524500 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m23:00:22.529500 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:00:22.530500 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 23:00:22.525498 => 23:00:22.530500
[0m23:00:22.530500 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m23:00:22.541501 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:00:22.541501 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:00:22.542502 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:00:22.542502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:00:22.589681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:22.590681 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:00:22.590681 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:00:22.591681 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:00:22.593681 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 23:00:22.531500 => 23:00:22.593681
[0m23:00:22.593681 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:00:22.593681 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m23:00:22.595681 [info ] [Thread-1 (]: 1 of 1 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.07s]
[0m23:00:22.595681 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m23:00:22.596681 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.597681 [debug] [MainThread]: On master: BEGIN
[0m23:00:22.597681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:22.643685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:22.644686 [debug] [MainThread]: On master: COMMIT
[0m23:00:22.644686 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:22.645687 [debug] [MainThread]: On master: COMMIT
[0m23:00:22.645687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:22.645687 [debug] [MainThread]: On master: Close
[0m23:00:22.646684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:22.646684 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:00:22.647685 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:00:22.647685 [info ] [MainThread]: 
[0m23:00:22.648685 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m23:00:22.648685 [debug] [MainThread]: Command end result
[0m23:00:22.654191 [info ] [MainThread]: 
[0m23:00:22.655191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:22.655191 [info ] [MainThread]: 
[0m23:00:22.656191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:00:22.657191 [debug] [MainThread]: Command `dbt test` succeeded at 23:00:22.656191 after 0.58 seconds
[0m23:00:22.657191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97B97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B3A1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9B2CFC10>]}
[0m23:00:22.657191 [debug] [MainThread]: Flushing usage events
[0m23:00:37.509604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7D794580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00C1ED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00C1EAA0>]}


============================== 23:00:37.511604 | e0470425-9eed-4525-bc0c-4cd912b1453b ==============================
[0m23:00:37.511604 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:00:37.512605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -s customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:37.635850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B797B2E30>]}
[0m23:00:37.693379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00C1DDB0>]}
[0m23:00:37.693379 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:00:37.702553 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:00:37.779025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:37.779025 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_valid_customers.sql
[0m23:00:37.845024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B011D0400>]}
[0m23:00:37.853027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B011295A0>]}
[0m23:00:37.853027 [info ] [MainThread]: Found 2 seeds, 4 models, 16 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:00:37.854027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B01129510>]}
[0m23:00:37.855027 [info ] [MainThread]: 
[0m23:00:37.856027 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:37.857027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:00:37.863027 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:00:37.863027 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:00:37.864027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:37.915918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:00:37.915918 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:00:37.915918 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:37.918918 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:00:37.919918 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:00:37.919918 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:00:37.924425 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:37.924425 [debug] [MainThread]: On master: BEGIN
[0m23:00:37.924425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:37.969935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:37.969935 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:37.969935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:37.972934 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:00:37.974935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0470425-9eed-4525-bc0c-4cd912b1453b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B011292A0>]}
[0m23:00:37.974935 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:37.974935 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:37.975935 [debug] [MainThread]: On master: BEGIN
[0m23:00:37.976388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:37.976388 [debug] [MainThread]: On master: COMMIT
[0m23:00:37.976388 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:37.977395 [debug] [MainThread]: On master: COMMIT
[0m23:00:37.977395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:37.977395 [debug] [MainThread]: On master: Close
[0m23:00:37.978434 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:00:37.978434 [info ] [MainThread]: 
[0m23:00:37.980395 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m23:00:37.981394 [info ] [Thread-1 (]: 1 of 1 START test check_valid_customers ........................................ [RUN]
[0m23:00:37.981394 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m23:00:37.982395 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m23:00:37.987392 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:00:37.987392 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 23:00:37.982395 => 23:00:37.987392
[0m23:00:37.988393 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m23:00:37.997392 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:00:37.998393 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:00:37.999394 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:00:37.999394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:00:38.048393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:00:38.048393 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:00:38.049395 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	--"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:00:38.049395 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "where"
LINE 11: where
         ^

[0m23:00:38.050394 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:00:38.050394 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 23:00:37.988393 => 23:00:38.050394
[0m23:00:38.051397 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m23:00:38.053397 [debug] [Thread-1 (]: Database Error in test check_valid_customers (tests\check_valid_customers.sql)
  syntax error at or near "where"
  LINE 11: where
           ^
  compiled Code at target\run\customer360\tests\check_valid_customers.sql
[0m23:00:38.053397 [error] [Thread-1 (]: 1 of 1 ERROR check_valid_customers ............................................. [[31mERROR[0m in 0.07s]
[0m23:00:38.054397 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m23:00:38.055397 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:38.055397 [debug] [MainThread]: On master: BEGIN
[0m23:00:38.056397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:38.100902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:00:38.101902 [debug] [MainThread]: On master: COMMIT
[0m23:00:38.101902 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:38.102902 [debug] [MainThread]: On master: COMMIT
[0m23:00:38.102902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:00:38.102902 [debug] [MainThread]: On master: Close
[0m23:00:38.103902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:38.103902 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:00:38.103902 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:00:38.104902 [info ] [MainThread]: 
[0m23:00:38.104902 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m23:00:38.105902 [debug] [MainThread]: Command end result
[0m23:00:38.111921 [info ] [MainThread]: 
[0m23:00:38.112902 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:00:38.112902 [info ] [MainThread]: 
[0m23:00:38.113903 [error] [MainThread]:   Database Error in test check_valid_customers (tests\check_valid_customers.sql)
  syntax error at or near "where"
  LINE 11: where
           ^
  compiled Code at target\run\customer360\tests\check_valid_customers.sql
[0m23:00:38.113903 [info ] [MainThread]: 
[0m23:00:38.114903 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:00:38.115903 [debug] [MainThread]: Command `dbt test` failed at 23:00:38.114903 after 0.65 seconds
[0m23:00:38.115903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7D794580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B00C1DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B010A22C0>]}
[0m23:00:38.115903 [debug] [MainThread]: Flushing usage events
[0m23:01:06.066787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9434580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADC72ED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADC72EAA0>]}


============================== 23:01:06.069786 | 3518cabb-1e53-46a5-93de-a96c28e849d7 ==============================
[0m23:01:06.069786 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:01:06.069786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test -s customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:01:06.192585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD5442E30>]}
[0m23:01:06.249588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADC72DDB0>]}
[0m23:01:06.250588 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:01:06.258588 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:01:06.339241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:01:06.339241 [debug] [MainThread]: Partial parsing: added file: customer360://tests\check_purchase_amount_above_zero.sql
[0m23:01:06.340249 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_valid_customers.sql
[0m23:01:06.410753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCCF7EB0>]}
[0m23:01:06.418754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCAAFC40>]}
[0m23:01:06.418754 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:01:06.419698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCAAFBE0>]}
[0m23:01:06.420704 [info ] [MainThread]: 
[0m23:01:06.421704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:06.422704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:01:06.428702 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:01:06.428702 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:01:06.429703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:06.480391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.481392 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:01:06.481392 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:06.484390 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:01:06.485392 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:01:06.485392 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:01:06.489801 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.489801 [debug] [MainThread]: On master: BEGIN
[0m23:01:06.490801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:06.535299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.535299 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.536301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:06.539299 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:01:06.540299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3518cabb-1e53-46a5-93de-a96c28e849d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCAADC00>]}
[0m23:01:06.540299 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:06.541299 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.541299 [debug] [MainThread]: On master: BEGIN
[0m23:01:06.542299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.542299 [debug] [MainThread]: On master: COMMIT
[0m23:01:06.542299 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.542299 [debug] [MainThread]: On master: COMMIT
[0m23:01:06.543299 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:06.543299 [debug] [MainThread]: On master: Close
[0m23:01:06.544299 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:01:06.544299 [info ] [MainThread]: 
[0m23:01:06.547299 [debug] [Thread-1 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:01:06.547299 [debug] [Thread-2 (]: Began running node test.customer360.check_valid_customers
[0m23:01:06.547299 [info ] [Thread-1 (]: 1 of 2 START test check_purchase_amount_above_zero ............................. [RUN]
[0m23:01:06.548300 [info ] [Thread-2 (]: 2 of 2 START test check_valid_customers ........................................ [RUN]
[0m23:01:06.548300 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_purchase_amount_above_zero'
[0m23:01:06.549300 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m23:01:06.549300 [debug] [Thread-1 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:01:06.549300 [debug] [Thread-2 (]: Began compiling node test.customer360.check_valid_customers
[0m23:01:06.554299 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:01:06.556299 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:01:06.557299 [debug] [Thread-1 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:01:06.550299 => 23:01:06.557299
[0m23:01:06.557299 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (compile): 23:01:06.554299 => 23:01:06.557299
[0m23:01:06.558301 [debug] [Thread-1 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:01:06.558301 [debug] [Thread-2 (]: Began executing node test.customer360.check_valid_customers
[0m23:01:06.568299 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:01:06.570301 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:01:06.571301 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:01:06.571301 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:01:06.571301 [debug] [Thread-1 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:01:06.572300 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:01:06.572300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:01:06.572300 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:01:06.619808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.620809 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:01:06.620809 [debug] [Thread-1 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:01:06.621811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:01:06.623808 [debug] [Thread-1 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:01:06.558301 => 23:01:06.623808
[0m23:01:06.623808 [debug] [Thread-1 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:01:06.624809 [debug] [Thread-1 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:01:06.624809 [info ] [Thread-1 (]: 1 of 2 PASS check_purchase_amount_above_zero ................................... [[32mPASS[0m in 0.08s]
[0m23:01:06.625810 [debug] [Thread-1 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:01:06.650809 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.650809 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:01:06.650809 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:01:06.651808 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:01:06.653808 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (execute): 23:01:06.568299 => 23:01:06.652808
[0m23:01:06.653808 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:01:06.653808 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: Close
[0m23:01:06.654808 [info ] [Thread-2 (]: 2 of 2 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.11s]
[0m23:01:06.655810 [debug] [Thread-2 (]: Finished running node test.customer360.check_valid_customers
[0m23:01:06.656809 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.657809 [debug] [MainThread]: On master: BEGIN
[0m23:01:06.657809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:06.703321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:06.703321 [debug] [MainThread]: On master: COMMIT
[0m23:01:06.704322 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:06.704322 [debug] [MainThread]: On master: COMMIT
[0m23:01:06.704322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:06.705321 [debug] [MainThread]: On master: Close
[0m23:01:06.705321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:06.705321 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:01:06.706321 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:01:06.706321 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:01:06.706321 [info ] [MainThread]: 
[0m23:01:06.707322 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:01:06.707322 [debug] [MainThread]: Command end result
[0m23:01:06.713322 [info ] [MainThread]: 
[0m23:01:06.713322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:06.714322 [info ] [MainThread]: 
[0m23:01:06.714322 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:01:06.715327 [debug] [MainThread]: Command `dbt test` succeeded at 23:01:06.715327 after 0.69 seconds
[0m23:01:06.716324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD9434580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCBB64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EADCBABE50>]}
[0m23:01:06.716324 [debug] [MainThread]: Flushing usage events
[0m23:10:39.845765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342F6342E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343293EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343293EB60>]}


============================== 23:10:39.847764 | 8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c ==============================
[0m23:10:39.847764 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:10:39.848764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:39.968274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342B5E2E30>]}
[0m23:10:40.025782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234328F4C10>]}
[0m23:10:40.026782 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:10:40.035103 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:10:40.111570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:40.112570 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_first_purchase_date.sql
[0m23:10:40.178569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432EEC9A0>]}
[0m23:10:40.186570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432E65120>]}
[0m23:10:40.186570 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:10:40.187553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432E65630>]}
[0m23:10:40.188597 [info ] [MainThread]: 
[0m23:10:40.189559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:40.190560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:10:40.196560 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:10:40.196560 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:10:40.197560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:40.245389 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.246388 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:10:40.246388 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:10:40.248388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:10:40.249389 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:10:40.250390 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:10:40.254388 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.254388 [debug] [MainThread]: On master: BEGIN
[0m23:10:40.254388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:40.299391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.300391 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.300391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:40.303391 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:10:40.304393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c8ab47d-3c66-4cad-8f53-ee3cdef45b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432E641F0>]}
[0m23:10:40.305393 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:40.305393 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.305393 [debug] [MainThread]: On master: BEGIN
[0m23:10:40.306392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.306392 [debug] [MainThread]: On master: COMMIT
[0m23:10:40.306392 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.307392 [debug] [MainThread]: On master: COMMIT
[0m23:10:40.307392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:40.307392 [debug] [MainThread]: On master: Close
[0m23:10:40.308392 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:10:40.309392 [info ] [MainThread]: 
[0m23:10:40.310895 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m23:10:40.310895 [debug] [Thread-2 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:10:40.311901 [debug] [Thread-3 (]: Began running node test.customer360.check_valid_customers
[0m23:10:40.311901 [info ] [Thread-1 (]: 1 of 3 START test check_first_purchase_date .................................... [RUN]
[0m23:10:40.311901 [info ] [Thread-2 (]: 2 of 3 START test check_purchase_amount_above_zero ............................. [RUN]
[0m23:10:40.312900 [info ] [Thread-3 (]: 3 of 3 START test check_valid_customers ........................................ [RUN]
[0m23:10:40.312900 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_first_purchase_date'
[0m23:10:40.313900 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.check_purchase_amount_above_zero'
[0m23:10:40.313900 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.check_valid_customers'
[0m23:10:40.314900 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m23:10:40.314900 [debug] [Thread-2 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:10:40.314900 [debug] [Thread-3 (]: Began compiling node test.customer360.check_valid_customers
[0m23:10:40.320899 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m23:10:40.321899 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:10:40.324901 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:10:40.325900 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 23:10:40.315900 => 23:10:40.324901
[0m23:10:40.325900 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:10:40.320899 => 23:10:40.325900
[0m23:10:40.325900 [debug] [Thread-3 (]: Timing info for test.customer360.check_valid_customers (compile): 23:10:40.322899 => 23:10:40.325900
[0m23:10:40.325900 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m23:10:40.326900 [debug] [Thread-2 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:10:40.326900 [debug] [Thread-3 (]: Began executing node test.customer360.check_valid_customers
[0m23:10:40.336899 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m23:10:40.338900 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:10:40.339901 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:10:40.340900 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:10:40.340900 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:10:40.341901 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:10:40.341901 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:10:40.341901 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m23:10:40.342901 [debug] [Thread-3 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:10:40.342901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:40.342901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:40.343900 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:40.389157 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.390157 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:10:40.390157 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:10:40.391156 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:10:40.393158 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:10:40.336899 => 23:10:40.393158
[0m23:10:40.393158 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:10:40.394157 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:10:40.395157 [info ] [Thread-2 (]: 2 of 3 PASS check_purchase_amount_above_zero ................................... [[32mPASS[0m in 0.08s]
[0m23:10:40.395157 [debug] [Thread-2 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:10:40.419872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.420872 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:10:40.420872 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m23:10:40.422872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:10:40.424874 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 23:10:40.326900 => 23:10:40.423873
[0m23:10:40.424874 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m23:10:40.425872 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m23:10:40.425872 [info ] [Thread-1 (]: 1 of 3 PASS check_first_purchase_date .......................................... [[32mPASS[0m in 0.11s]
[0m23:10:40.426874 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m23:10:40.449872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.450873 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:10:40.450873 [debug] [Thread-3 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:10:40.451873 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:10:40.452873 [debug] [Thread-3 (]: Timing info for test.customer360.check_valid_customers (execute): 23:10:40.338900 => 23:10:40.452873
[0m23:10:40.453874 [debug] [Thread-3 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:10:40.453874 [debug] [Thread-3 (]: On test.customer360.check_valid_customers: Close
[0m23:10:40.454873 [info ] [Thread-3 (]: 3 of 3 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.14s]
[0m23:10:40.455874 [debug] [Thread-3 (]: Finished running node test.customer360.check_valid_customers
[0m23:10:40.456873 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.456873 [debug] [MainThread]: On master: BEGIN
[0m23:10:40.456873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:40.503875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:40.503875 [debug] [MainThread]: On master: COMMIT
[0m23:10:40.504875 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:40.504875 [debug] [MainThread]: On master: COMMIT
[0m23:10:40.504875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:40.505875 [debug] [MainThread]: On master: Close
[0m23:10:40.505875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:40.506876 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:10:40.506876 [debug] [MainThread]: Connection 'test.customer360.check_first_purchase_date' was properly closed.
[0m23:10:40.506876 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:10:40.507875 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:10:40.507875 [info ] [MainThread]: 
[0m23:10:40.507875 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m23:10:40.508876 [debug] [MainThread]: Command end result
[0m23:10:40.515381 [info ] [MainThread]: 
[0m23:10:40.515381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:40.515381 [info ] [MainThread]: 
[0m23:10:40.516383 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:10:40.517382 [debug] [MainThread]: Command `dbt test` succeeded at 23:10:40.517382 after 0.71 seconds
[0m23:10:40.517382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342F6342E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432DA0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023432DC0670>]}
[0m23:10:40.518383 [debug] [MainThread]: Flushing usage events
[0m23:11:44.225667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011860D76AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001186406ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001186406EAD0>]}


============================== 23:11:44.227668 | f4ae76bb-6cc0-47eb-b64a-243f1ebdce02 ==============================
[0m23:11:44.227668 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:11:44.228668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -s customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:44.351177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001185CD92E30>]}
[0m23:11:44.408839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118642B2D10>]}
[0m23:11:44.409839 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:11:44.419254 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:11:44.496338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:44.496338 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_last_purchase_date.sql
[0m23:11:44.563337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001186461C9D0>]}
[0m23:11:44.570482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118645203A0>]}
[0m23:11:44.571498 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:11:44.571498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118645217B0>]}
[0m23:11:44.573526 [info ] [MainThread]: 
[0m23:11:44.573526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:44.575489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:11:44.581487 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:11:44.581487 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:11:44.582487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:44.629939 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.629939 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:11:44.630939 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:11:44.632940 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:11:44.633941 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:11:44.634939 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:11:44.638940 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.638940 [debug] [MainThread]: On master: BEGIN
[0m23:11:44.638940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:44.684538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.685499 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.686047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:44.689090 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:11:44.690091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ae76bb-6cc0-47eb-b64a-243f1ebdce02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118645208B0>]}
[0m23:11:44.690091 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:44.691088 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.691088 [debug] [MainThread]: On master: BEGIN
[0m23:11:44.691088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.692089 [debug] [MainThread]: On master: COMMIT
[0m23:11:44.692089 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.692089 [debug] [MainThread]: On master: COMMIT
[0m23:11:44.693089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:44.693089 [debug] [MainThread]: On master: Close
[0m23:11:44.694084 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:11:44.694084 [info ] [MainThread]: 
[0m23:11:44.696092 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m23:11:44.697051 [debug] [Thread-2 (]: Began running node test.customer360.check_last_purchase_date
[0m23:11:44.697051 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:11:44.697051 [info ] [Thread-1 (]: 1 of 4 START test check_first_purchase_date .................................... [RUN]
[0m23:11:44.698050 [info ] [Thread-2 (]: 2 of 4 START test check_last_purchase_date ..................................... [RUN]
[0m23:11:44.698050 [info ] [Thread-3 (]: 3 of 4 START test check_purchase_amount_above_zero ............................. [RUN]
[0m23:11:44.699050 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_first_purchase_date'
[0m23:11:44.699050 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.check_last_purchase_date'
[0m23:11:44.700051 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.check_purchase_amount_above_zero'
[0m23:11:44.700051 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m23:11:44.701051 [debug] [Thread-2 (]: Began compiling node test.customer360.check_last_purchase_date
[0m23:11:44.701051 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:11:44.706050 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m23:11:44.708049 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m23:11:44.710049 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:11:44.711050 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 23:11:44.701051 => 23:11:44.711050
[0m23:11:44.712051 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (compile): 23:11:44.706050 => 23:11:44.711050
[0m23:11:44.712051 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m23:11:44.712051 [debug] [Thread-2 (]: Began executing node test.customer360.check_last_purchase_date
[0m23:11:44.713052 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:11:44.708049 => 23:11:44.712051
[0m23:11:44.722050 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m23:11:44.724050 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m23:11:44.724050 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:11:44.726050 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:11:44.726050 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:11:44.727050 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:11:44.727050 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m23:11:44.728050 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:11:44.728050 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m23:11:44.728050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:44.729050 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:11:44.729050 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:44.729050 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:11:44.775192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.775192 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:11:44.776194 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m23:11:44.778193 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:44.779194 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 23:11:44.713052 => 23:11:44.779194
[0m23:11:44.779194 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m23:11:44.780194 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m23:11:44.781194 [info ] [Thread-1 (]: 1 of 4 PASS check_first_purchase_date .......................................... [[32mPASS[0m in 0.08s]
[0m23:11:44.781194 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m23:11:44.782193 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m23:11:44.782193 [info ] [Thread-1 (]: 4 of 4 START test check_valid_customers ........................................ [RUN]
[0m23:11:44.783193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m23:11:44.784192 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m23:11:44.786705 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:11:44.786705 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 23:11:44.784192 => 23:11:44.786705
[0m23:11:44.787705 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m23:11:44.788703 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:11:44.789845 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:11:44.789845 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:11:44.790849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:44.805849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.805849 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:11:44.806851 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
ast_purchase_date <> last_date
      
    ) dbt_internal_test
[0m23:11:44.807849 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "ast_purchase_date" does not exist
LINE 30: ast_purchase_date <> last_date
         ^
HINT:  Perhaps you meant to reference the column "comparing_table.last_purchase_date".

[0m23:11:44.808850 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m23:11:44.808850 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (execute): 23:11:44.723050 => 23:11:44.808850
[0m23:11:44.809848 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: Close
[0m23:11:44.811849 [debug] [Thread-2 (]: Database Error in test check_last_purchase_date (tests\check_last_purchase_date.sql)
  column "ast_purchase_date" does not exist
  LINE 30: ast_purchase_date <> last_date
           ^
  HINT:  Perhaps you meant to reference the column "comparing_table.last_purchase_date".
  compiled Code at target\run\customer360\tests\check_last_purchase_date.sql
[0m23:11:44.811849 [error] [Thread-2 (]: 2 of 4 ERROR check_last_purchase_date .......................................... [[31mERROR[0m in 0.11s]
[0m23:11:44.812848 [debug] [Thread-2 (]: Finished running node test.customer360.check_last_purchase_date
[0m23:11:44.835849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.835849 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:11:44.836849 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:11:44.837848 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:44.838848 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:11:44.725050 => 23:11:44.838848
[0m23:11:44.838848 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:11:44.839848 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:11:44.839848 [info ] [Thread-3 (]: 3 of 4 PASS check_purchase_amount_above_zero ................................... [[32mPASS[0m in 0.14s]
[0m23:11:44.840851 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:11:44.864848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.865849 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:11:44.865849 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:11:44.866848 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:44.867848 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 23:11:44.787705 => 23:11:44.867848
[0m23:11:44.868848 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:11:44.868848 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m23:11:44.869848 [info ] [Thread-1 (]: 4 of 4 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.09s]
[0m23:11:44.870849 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m23:11:44.871852 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.871852 [debug] [MainThread]: On master: BEGIN
[0m23:11:44.871852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:44.920607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:44.920607 [debug] [MainThread]: On master: COMMIT
[0m23:11:44.921608 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:44.921608 [debug] [MainThread]: On master: COMMIT
[0m23:11:44.921608 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:44.922607 [debug] [MainThread]: On master: Close
[0m23:11:44.922607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:44.923607 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:11:44.923607 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:11:44.923607 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m23:11:44.924750 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:11:44.924750 [info ] [MainThread]: 
[0m23:11:44.924750 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m23:11:44.925754 [debug] [MainThread]: Command end result
[0m23:11:44.932753 [info ] [MainThread]: 
[0m23:11:44.932753 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:44.933754 [info ] [MainThread]: 
[0m23:11:44.933754 [error] [MainThread]:   Database Error in test check_last_purchase_date (tests\check_last_purchase_date.sql)
  column "ast_purchase_date" does not exist
  LINE 30: ast_purchase_date <> last_date
           ^
  HINT:  Perhaps you meant to reference the column "comparing_table.last_purchase_date".
  compiled Code at target\run\customer360\tests\check_last_purchase_date.sql
[0m23:11:44.934754 [info ] [MainThread]: 
[0m23:11:44.934754 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:11:44.935753 [debug] [MainThread]: Command `dbt test` failed at 23:11:44.935753 after 0.75 seconds
[0m23:11:44.935753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011860D76AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118644FA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118646A2D40>]}
[0m23:11:44.936753 [debug] [MainThread]: Flushing usage events
[0m23:11:58.165553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027247886AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724AB7ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724AB7EAD0>]}


============================== 23:11:58.168551 | e3d479ac-5b0f-4ea4-9170-40933fae2c29 ==============================
[0m23:11:58.168551 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:11:58.168551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -s customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:58.289071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027243832E30>]}
[0m23:11:58.348831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724ADC2D10>]}
[0m23:11:58.348831 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:11:58.357696 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:11:58.436283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:58.437283 [debug] [MainThread]: Partial parsing: updated file: customer360://tests\check_last_purchase_date.sql
[0m23:11:58.504320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724B12C9D0>]}
[0m23:11:58.513359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724B0A5600>]}
[0m23:11:58.513359 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:11:58.514359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724B0A55D0>]}
[0m23:11:58.515360 [info ] [MainThread]: 
[0m23:11:58.516361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:58.517359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:11:58.523358 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:11:58.523358 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:11:58.523358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:58.575402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.575402 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:11:58.576401 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:11:58.578402 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:11:58.579402 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:11:58.579402 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:11:58.584401 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.584401 [debug] [MainThread]: On master: BEGIN
[0m23:11:58.584401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:58.629951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.630951 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.630951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:58.633952 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:11:58.635952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d479ac-5b0f-4ea4-9170-40933fae2c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724B0A4250>]}
[0m23:11:58.635952 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:58.635952 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.636954 [debug] [MainThread]: On master: BEGIN
[0m23:11:58.636954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.636954 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.637951 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.637951 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.637951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:58.638951 [debug] [MainThread]: On master: Close
[0m23:11:58.638951 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:11:58.639951 [info ] [MainThread]: 
[0m23:11:58.641960 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m23:11:58.641960 [debug] [Thread-2 (]: Began running node test.customer360.check_last_purchase_date
[0m23:11:58.642952 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:11:58.642952 [info ] [Thread-1 (]: 1 of 4 START test check_first_purchase_date .................................... [RUN]
[0m23:11:58.642952 [info ] [Thread-2 (]: 2 of 4 START test check_last_purchase_date ..................................... [RUN]
[0m23:11:58.643951 [info ] [Thread-3 (]: 3 of 4 START test check_purchase_amount_above_zero ............................. [RUN]
[0m23:11:58.643951 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.customer360.check_first_purchase_date'
[0m23:11:58.644952 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.check_last_purchase_date'
[0m23:11:58.645951 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.check_purchase_amount_above_zero'
[0m23:11:58.645951 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m23:11:58.645951 [debug] [Thread-2 (]: Began compiling node test.customer360.check_last_purchase_date
[0m23:11:58.646951 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:11:58.651968 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m23:11:58.653930 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m23:11:58.655930 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:11:58.656930 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (compile): 23:11:58.651968 => 23:11:58.656930
[0m23:11:58.656930 [debug] [Thread-2 (]: Began executing node test.customer360.check_last_purchase_date
[0m23:11:58.657930 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 23:11:58.646951 => 23:11:58.657930
[0m23:11:58.657930 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:11:58.653930 => 23:11:58.657930
[0m23:11:58.667930 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m23:11:58.668952 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m23:11:58.668952 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:11:58.670931 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m23:11:58.672931 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:11:58.672931 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:11:58.673931 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m23:11:58.673931 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:11:58.674931 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m23:11:58.674931 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:11:58.673931 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:58.674931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:58.675930 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:11:58.676930 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:11:58.721477 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.721477 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:11:58.722478 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m23:11:58.723477 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:58.725477 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (execute): 23:11:58.657930 => 23:11:58.725477
[0m23:11:58.725477 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m23:11:58.725477 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: Close
[0m23:11:58.726477 [info ] [Thread-2 (]: 2 of 4 PASS check_last_purchase_date ........................................... [[32mPASS[0m in 0.08s]
[0m23:11:58.727477 [debug] [Thread-2 (]: Finished running node test.customer360.check_last_purchase_date
[0m23:11:58.727477 [debug] [Thread-2 (]: Began running node test.customer360.check_valid_customers
[0m23:11:58.728478 [info ] [Thread-2 (]: 4 of 4 START test check_valid_customers ........................................ [RUN]
[0m23:11:58.728478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.check_last_purchase_date, now test.customer360.check_valid_customers)
[0m23:11:58.729479 [debug] [Thread-2 (]: Began compiling node test.customer360.check_valid_customers
[0m23:11:58.731507 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:11:58.732500 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (compile): 23:11:58.729479 => 23:11:58.731507
[0m23:11:58.732500 [debug] [Thread-2 (]: Began executing node test.customer360.check_valid_customers
[0m23:11:58.734499 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:11:58.734499 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:11:58.735503 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:11:58.735503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:11:58.756477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.756477 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:11:58.757476 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m23:11:58.758476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:58.760476 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 23:11:58.669932 => 23:11:58.759476
[0m23:11:58.760476 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m23:11:58.760476 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m23:11:58.761479 [info ] [Thread-1 (]: 1 of 4 PASS check_first_purchase_date .......................................... [[32mPASS[0m in 0.12s]
[0m23:11:58.762477 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m23:11:58.786499 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.787498 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:11:58.787498 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:11:58.788498 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:58.789533 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:11:58.670931 => 23:11:58.789533
[0m23:11:58.790533 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:11:58.790533 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:11:58.791542 [info ] [Thread-3 (]: 3 of 4 PASS check_purchase_amount_above_zero ................................... [[32mPASS[0m in 0.15s]
[0m23:11:58.792512 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:11:58.823185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.824182 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:11:58.824182 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:11:58.825182 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:11:58.826186 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (execute): 23:11:58.732500 => 23:11:58.826186
[0m23:11:58.827187 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:11:58.827187 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: Close
[0m23:11:58.828187 [info ] [Thread-2 (]: 4 of 4 PASS check_valid_customers .............................................. [[32mPASS[0m in 0.10s]
[0m23:11:58.829182 [debug] [Thread-2 (]: Finished running node test.customer360.check_valid_customers
[0m23:11:58.830182 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.830182 [debug] [MainThread]: On master: BEGIN
[0m23:11:58.830182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:58.880203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:58.880203 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.880203 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.881203 [debug] [MainThread]: On master: COMMIT
[0m23:11:58.881203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:58.881203 [debug] [MainThread]: On master: Close
[0m23:11:58.882203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:58.882203 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:11:58.883182 [debug] [MainThread]: Connection 'test.customer360.check_first_purchase_date' was properly closed.
[0m23:11:58.883182 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:11:58.883182 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:11:58.884203 [info ] [MainThread]: 
[0m23:11:58.884203 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:11:58.885203 [debug] [MainThread]: Command end result
[0m23:11:58.891216 [info ] [MainThread]: 
[0m23:11:58.892236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:58.892236 [info ] [MainThread]: 
[0m23:11:58.893237 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:11:58.894236 [debug] [MainThread]: Command `dbt test` succeeded at 23:11:58.894236 after 0.77 seconds
[0m23:11:58.894236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027247886AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724AFFC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002724AE2ADD0>]}
[0m23:11:58.895235 [debug] [MainThread]: Flushing usage events
[0m23:22:27.197574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DC0C42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF3C2E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF3C2BF0>]}


============================== 23:22:27.200575 | 247040a4-1276-4799-b44a-817d22d23bef ==============================
[0m23:22:27.200575 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:22:27.200575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:22:27.320039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D8142E00>]}
[0m23:22:27.377603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF608E20>]}
[0m23:22:27.378603 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:22:27.387602 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:22:27.425603 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:22:27.426604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF628DF0>]}
[0m23:22:28.249049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integration_tests.staging
- models.integration_tests.marts
[0m23:22:28.252346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DFA26830>]}
[0m23:22:28.260345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF541630>]}
[0m23:22:28.261346 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:22:28.263346 [info ] [MainThread]: 
[0m23:22:28.264346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:28.265346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:22:28.272345 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:22:28.273346 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:22:28.273346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:28.321282 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:22:28.322283 [debug] [ThreadPool]: On list_dbt: Close
[0m23:22:28.324283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:22:28.328282 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:22:28.328282 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:22:28.329282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:28.374791 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.375792 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:22:28.375792 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:22:28.378793 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:22:28.379791 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:22:28.379791 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:22:28.383792 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:28.384707 [debug] [MainThread]: On master: BEGIN
[0m23:22:28.384707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:28.429812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.429812 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:28.430813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:22:28.433813 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:22:28.434817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF8C57B0>]}
[0m23:22:28.434817 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:28.435816 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:28.435816 [debug] [MainThread]: On master: BEGIN
[0m23:22:28.435816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.436817 [debug] [MainThread]: On master: COMMIT
[0m23:22:28.436817 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:28.436817 [debug] [MainThread]: On master: COMMIT
[0m23:22:28.437816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:22:28.437816 [debug] [MainThread]: On master: Close
[0m23:22:28.438816 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:22:28.438816 [info ] [MainThread]: 
[0m23:22:28.441817 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m23:22:28.441817 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m23:22:28.441817 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:22:28.442817 [info ] [Thread-1 (]: 1 of 23 START seed file public.contacts ........................................ [RUN]
[0m23:22:28.442817 [info ] [Thread-2 (]: 2 of 23 START seed file public.transactions .................................... [RUN]
[0m23:22:28.443817 [info ] [Thread-3 (]: 3 of 23 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m23:22:28.443817 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m23:22:28.444817 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m23:22:28.445818 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m23:22:28.445818 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m23:22:28.446817 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m23:22:28.446817 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:22:28.447817 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 23:22:28.446817 => 23:22:28.446817
[0m23:22:28.447817 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 23:22:28.447817 => 23:22:28.447817
[0m23:22:28.454324 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:22:28.455325 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m23:22:28.455325 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m23:22:28.465325 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 23:22:28.447817 => 23:22:28.464325
[0m23:22:28.477324 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:22:28.478325 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:22:28.480325 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:22:28.480325 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m23:22:28.490481 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:22:28.490481 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m23:22:28.490481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:22:28.491480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:22:28.491480 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:22:28.492487 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m23:22:28.492487 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:22:28.536443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.537443 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:22:28.537443 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m23:22:28.542443 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:22:28.565949 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:22:28.566949 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m23:22:28.567949 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m23:22:28.570949 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m23:22:28.571949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.580949 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:22:28.580949 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:22:28.581951 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:22:28.581951 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m23:22:28.581951 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:22:28.583951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:28.584950 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 23:22:28.456325 => 23:22:28.584950
[0m23:22:28.585949 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m23:22:28.585949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF989990>]}
[0m23:22:28.586949 [info ] [Thread-1 (]: 1 of 23 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.14s]
[0m23:22:28.587952 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m23:22:28.587952 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:22:28.587952 [info ] [Thread-1 (]: 4 of 23 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m23:22:28.588951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m23:22:28.588951 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:22:28.589951 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:22:28.652929 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.688856 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:22:28.694855 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:22:28.695855 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:22:28.695855 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m23:22:28.696855 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 23:22:28.684876 => 23:22:28.696855
[0m23:22:28.696855 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m23:22:28.697855 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:22:28.699855 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:22:28.699855 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m23:22:28.700855 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m23:22:28.700855 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:22:28.701856 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m23:22:28.701856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:28.702855 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:22:28.703855 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:22:28.703855 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:22:28.704855 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:28.704855 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:28.706351 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 23:22:28.465325 => 23:22:28.706351
[0m23:22:28.708359 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m23:22:28.708359 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 23:22:28.480325 => 23:22:28.708359
[0m23:22:28.709380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF775330>]}
[0m23:22:28.709380 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m23:22:28.710383 [info ] [Thread-2 (]: 2 of 23 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.26s]
[0m23:22:28.711568 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m23:22:28.710383 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m23:22:28.711568 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:22:28.712574 [info ] [Thread-3 (]: 3 of 23 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.27s]
[0m23:22:28.712574 [info ] [Thread-2 (]: 5 of 23 START test source_not_null_web_transactions_id ......................... [RUN]
[0m23:22:28.713574 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:22:28.713574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m23:22:28.714576 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:22:28.714576 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:22:28.715574 [info ] [Thread-3 (]: 6 of 23 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m23:22:28.718575 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:22:28.719574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m23:22:28.719574 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:22:28.720574 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 23:22:28.715574 => 23:22:28.720574
[0m23:22:28.725573 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:22:28.725573 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:22:28.727574 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:22:28.728573 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 23:22:28.720574 => 23:22:28.727574
[0m23:22:28.728573 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:22:28.730573 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:22:28.730573 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:22:28.730573 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m23:22:28.731574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:28.731574 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:22:28.732575 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m23:22:28.732575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:28.751089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.752089 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:22:28.752089 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m23:22:28.753090 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:28.754089 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 23:22:28.697855 => 23:22:28.754089
[0m23:22:28.755089 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m23:22:28.755089 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m23:22:28.756089 [info ] [Thread-1 (]: 4 of 23 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.17s]
[0m23:22:28.757089 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:22:28.757089 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:22:28.758090 [info ] [Thread-1 (]: 7 of 23 START test source_unique_web_transactions_id ........................... [RUN]
[0m23:22:28.758090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m23:22:28.759090 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:22:28.762089 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:22:28.763089 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 23:22:28.759090 => 23:22:28.763089
[0m23:22:28.763089 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:22:28.765090 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:22:28.766118 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:22:28.766118 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m23:22:28.767093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:28.782089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.783089 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:22:28.783089 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m23:22:28.784089 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:28.785089 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 23:22:28.726574 => 23:22:28.785089
[0m23:22:28.785089 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m23:22:28.786089 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m23:22:28.787089 [info ] [Thread-2 (]: 5 of 23 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.07s]
[0m23:22:28.787089 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:22:28.812111 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.813113 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:22:28.813113 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:22:28.815111 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:28.816096 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 23:22:28.728573 => 23:22:28.816096
[0m23:22:28.816096 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m23:22:28.817110 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m23:22:28.817110 [warn ] [Thread-3 (]: 6 of 23 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.10s]
[0m23:22:28.818110 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:22:28.819111 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m23:22:28.819111 [info ] [Thread-2 (]: 8 of 23 START sql table model public.stg_sf__contacts .......................... [RUN]
[0m23:22:28.820110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m23:22:28.820110 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m23:22:28.823112 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m23:22:28.823112 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 23:22:28.821110 => 23:22:28.823112
[0m23:22:28.824090 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m23:22:28.846093 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m23:22:28.847093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:28.848093 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:28.848093 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:22:28.848093 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m23:22:28.849094 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:22:28.849094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:28.850599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:28.851604 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 23:22:28.764091 => 23:22:28.851604
[0m23:22:28.851604 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m23:22:28.852605 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m23:22:28.852605 [info ] [Thread-1 (]: 7 of 23 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m23:22:28.853604 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:22:29.017127 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.017127 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:29.018134 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m23:22:29.024678 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m23:22:29.029146 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:29.029146 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m23:22:29.030147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.032147 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:29.032147 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m23:22:29.033146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.038151 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:22:29.038151 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:29.038151 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:22:29.039283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:29.042286 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_sf__contacts__dbt_backup"
[0m23:22:29.045286 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:22:29.046286 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public"."stg_sf__contacts__dbt_backup" cascade
[0m23:22:29.047288 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:22:29.048289 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 23:22:28.824090 => 23:22:29.048289
[0m23:22:29.049287 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m23:22:29.049287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E0E729E0>]}
[0m23:22:29.049287 [info ] [Thread-2 (]: 8 of 23 OK created sql table model public.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.23s]
[0m23:22:29.050792 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m23:22:29.051796 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:22:29.051796 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:22:29.052796 [info ] [Thread-3 (]: 9 of 23 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m23:22:29.052796 [info ] [Thread-1 (]: 10 of 23 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m23:22:29.053796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m23:22:29.053796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m23:22:29.053796 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:22:29.054797 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:22:29.057795 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:22:29.060796 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:22:29.060796 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 23:22:29.054797 => 23:22:29.060796
[0m23:22:29.061796 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 23:22:29.057795 => 23:22:29.061796
[0m23:22:29.061796 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:22:29.061796 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:22:29.063797 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:22:29.065795 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:22:29.066794 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:22:29.066794 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m23:22:29.067796 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:22:29.067796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:29.067796 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m23:22:29.068796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:29.116437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.117438 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:22:29.117438 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m23:22:29.118438 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.119438 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 23:22:29.062796 => 23:22:29.119438
[0m23:22:29.119438 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m23:22:29.120437 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m23:22:29.121440 [info ] [Thread-3 (]: 9 of 23 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m23:22:29.121440 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:22:29.149142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.149142 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:22:29.149142 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:22:29.150687 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.151730 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 23:22:29.063797 => 23:22:29.151730
[0m23:22:29.152692 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m23:22:29.152692 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m23:22:29.153691 [info ] [Thread-1 (]: 10 of 23 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m23:22:29.153691 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:22:29.155079 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m23:22:29.155079 [info ] [Thread-2 (]: 11 of 23 START sql table model public.stg_web__transactions .................... [RUN]
[0m23:22:29.156083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m23:22:29.156083 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m23:22:29.159082 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m23:22:29.159082 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 23:22:29.156083 => 23:22:29.159082
[0m23:22:29.160082 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m23:22:29.163082 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m23:22:29.163082 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.164082 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m23:22:29.164082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:29.209082 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.210083 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.210083 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m23:22:29.218096 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m23:22:29.220094 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.220094 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m23:22:29.221094 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.223094 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.223094 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m23:22:29.224095 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.225094 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:22:29.225094 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.226094 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:22:29.226094 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:29.228095 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_web__transactions__dbt_backup"
[0m23:22:29.229095 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:22:29.229095 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public"."stg_web__transactions__dbt_backup" cascade
[0m23:22:29.230376 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:22:29.231382 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 23:22:29.160082 => 23:22:29.231382
[0m23:22:29.232381 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m23:22:29.232381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DF8E2BF0>]}
[0m23:22:29.233381 [info ] [Thread-2 (]: 11 of 23 OK created sql table model public.stg_web__transactions ............... [[32mSELECT 101[0m in 0.08s]
[0m23:22:29.234381 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m23:22:29.234381 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:22:29.235381 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:22:29.235381 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:22:29.235381 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m23:22:29.236386 [info ] [Thread-3 (]: 13 of 23 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m23:22:29.236386 [info ] [Thread-2 (]: 14 of 23 START test unique_stg_web__transactions_id ............................ [RUN]
[0m23:22:29.238384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m23:22:29.237385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m23:22:29.238384 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:22:29.238384 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:22:29.237385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m23:22:29.242386 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:22:29.244387 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:22:29.245387 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:22:29.245387 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 23:22:29.239384 => 23:22:29.245387
[0m23:22:29.246386 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 23:22:29.242386 => 23:22:29.246386
[0m23:22:29.249387 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:22:29.250890 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:22:29.250890 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:22:29.252894 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:22:29.253894 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 23:22:29.246386 => 23:22:29.252894
[0m23:22:29.254894 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:22:29.255894 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:22:29.255894 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:22:29.256897 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m23:22:29.258895 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:22:29.258895 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:22:29.258895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:29.259894 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m23:22:29.259894 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:22:29.260894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:29.260894 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m23:22:29.261895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:29.311894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.311894 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:22:29.312895 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:22:29.313896 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.314895 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 23:22:29.251894 => 23:22:29.314895
[0m23:22:29.314895 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m23:22:29.315895 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m23:22:29.316914 [info ] [Thread-3 (]: 13 of 23 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.08s]
[0m23:22:29.316914 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:22:29.317894 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:22:29.317894 [info ] [Thread-3 (]: 15 of 23 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m23:22:29.318893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m23:22:29.318893 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:22:29.322895 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:22:29.323894 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 23:22:29.319894 => 23:22:29.322895
[0m23:22:29.323894 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:22:29.325895 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:22:29.326895 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:22:29.326895 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m23:22:29.326895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:29.352027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.352027 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:22:29.353027 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:22:29.354029 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.355028 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 23:22:29.253894 => 23:22:29.355028
[0m23:22:29.356030 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m23:22:29.356030 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m23:22:29.357029 [info ] [Thread-2 (]: 14 of 23 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.12s]
[0m23:22:29.358029 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:22:29.391030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.391030 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:22:29.391030 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m23:22:29.392028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.394028 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 23:22:29.256897 => 23:22:29.393030
[0m23:22:29.394028 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m23:22:29.394028 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m23:22:29.395028 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.16s]
[0m23:22:29.396029 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:22:29.421029 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.422028 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:22:29.422028 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m23:22:29.423028 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.424029 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 23:22:29.323894 => 23:22:29.424029
[0m23:22:29.425028 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m23:22:29.425028 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m23:22:29.426029 [info ] [Thread-3 (]: 15 of 23 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.11s]
[0m23:22:29.427029 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:22:29.427029 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m23:22:29.428029 [info ] [Thread-2 (]: 16 of 23 START sql view model public.contacts_joined_with_transactions ......... [RUN]
[0m23:22:29.429030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m23:22:29.429030 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m23:22:29.431028 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.432028 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 23:22:29.429030 => 23:22:29.432028
[0m23:22:29.432028 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m23:22:29.445030 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.445030 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.446030 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m23:22:29.446030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:29.495035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.496034 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.496034 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m23:22:29.498034 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:22:29.501033 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.501033 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m23:22:29.502035 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.503034 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:22:29.503034 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.503034 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:22:29.504380 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:29.505385 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."contacts_joined_with_transactions__dbt_backup"
[0m23:22:29.507384 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:22:29.508384 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public"."contacts_joined_with_transactions__dbt_backup" cascade
[0m23:22:29.508384 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:22:29.509384 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 23:22:29.433028 => 23:22:29.509384
[0m23:22:29.510385 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m23:22:29.510385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E0EC85E0>]}
[0m23:22:29.511385 [info ] [Thread-2 (]: 16 of 23 OK created sql view model public.contacts_joined_with_transactions .... [[32mCREATE VIEW[0m in 0.08s]
[0m23:22:29.512386 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m23:22:29.512386 [debug] [Thread-3 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:22:29.513388 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:22:29.513388 [info ] [Thread-3 (]: 17 of 23 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m23:22:29.513388 [info ] [Thread-1 (]: 18 of 23 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m23:22:29.514385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m23:22:29.515386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m23:22:29.515386 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:22:29.515386 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:22:29.518386 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:22:29.521384 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:22:29.522385 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 23:22:29.515386 => 23:22:29.521384
[0m23:22:29.522385 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 23:22:29.519386 => 23:22:29.522385
[0m23:22:29.522385 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:22:29.523385 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:22:29.524386 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:22:29.526384 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:22:29.526384 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:22:29.527386 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m23:22:29.527386 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:22:29.528385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:29.528385 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m23:22:29.528385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:29.573897 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.574898 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:22:29.574898 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m23:22:29.575898 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.577898 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 23:22:29.523385 => 23:22:29.576897
[0m23:22:29.577898 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m23:22:29.577898 [debug] [Thread-3 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m23:22:29.578897 [info ] [Thread-3 (]: 17 of 23 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.06s]
[0m23:22:29.579897 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:22:29.607318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.608318 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:22:29.608318 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:22:29.610319 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.611319 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 23:22:29.524386 => 23:22:29.611319
[0m23:22:29.611319 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m23:22:29.612318 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m23:22:29.613319 [info ] [Thread-1 (]: 18 of 23 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.10s]
[0m23:22:29.613319 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:22:29.614319 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m23:22:29.615320 [info ] [Thread-2 (]: 19 of 23 START sql table model public.customers ................................ [RUN]
[0m23:22:29.616318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m23:22:29.616318 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m23:22:29.621317 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m23:22:29.622321 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 23:22:29.616318 => 23:22:29.621317
[0m23:22:29.622321 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m23:22:29.625008 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m23:22:29.625985 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.625985 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m23:22:29.626963 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:29.781866 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.782904 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.782904 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m23:22:29.790581 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.0 seconds
[0m23:22:29.793583 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.793583 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers" rename to "customers__dbt_backup"
[0m23:22:29.794582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.796582 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.796582 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public"."customers__dbt_tmp" rename to "customers"
[0m23:22:29.797582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:22:29.798583 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m23:22:29.799582 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.799582 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m23:22:29.799582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:22:29.801582 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."customers__dbt_backup"
[0m23:22:29.802582 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m23:22:29.802582 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public"."customers__dbt_backup" cascade
[0m23:22:29.804583 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:22:29.805583 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 23:22:29.622957 => 23:22:29.805583
[0m23:22:29.805583 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m23:22:29.806582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247040a4-1276-4799-b44a-817d22d23bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E0E1B070>]}
[0m23:22:29.806582 [info ] [Thread-2 (]: 19 of 23 OK created sql table model public.customers ........................... [[32mSELECT 9[0m in 0.19s]
[0m23:22:29.807582 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m23:22:29.808588 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m23:22:29.808588 [debug] [Thread-3 (]: Began running node test.customer360.check_last_purchase_date
[0m23:22:29.808588 [debug] [Thread-2 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:22:29.809583 [info ] [Thread-1 (]: 20 of 23 START test check_first_purchase_date .................................. [RUN]
[0m23:22:29.809583 [info ] [Thread-3 (]: 21 of 23 START test check_last_purchase_date ................................... [RUN]
[0m23:22:29.810584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_first_purchase_date)
[0m23:22:29.810584 [info ] [Thread-2 (]: 22 of 23 START test check_purchase_amount_above_zero ........................... [RUN]
[0m23:22:29.811583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_last_purchase_date)
[0m23:22:29.811583 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m23:22:29.812583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m23:22:29.812583 [debug] [Thread-3 (]: Began compiling node test.customer360.check_last_purchase_date
[0m23:22:29.814582 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m23:22:29.814582 [debug] [Thread-2 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:22:29.816584 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m23:22:29.818584 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:22:29.819583 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 23:22:29.812583 => 23:22:29.819583
[0m23:22:29.819583 [debug] [Thread-3 (]: Timing info for test.customer360.check_last_purchase_date (compile): 23:22:29.815583 => 23:22:29.819583
[0m23:22:29.820582 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m23:22:29.820582 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:22:29.817584 => 23:22:29.820582
[0m23:22:29.820582 [debug] [Thread-3 (]: Began executing node test.customer360.check_last_purchase_date
[0m23:22:29.823582 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m23:22:29.823582 [debug] [Thread-2 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:22:29.825583 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m23:22:29.826583 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:22:29.827583 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:22:29.827583 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m23:22:29.828585 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:22:29.828585 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:22:29.828585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:29.829583 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m23:22:29.829583 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:22:29.830583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:22:29.830583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:22:29.881244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.882243 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:22:29.882243 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m23:22:29.884244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.885244 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 23:22:29.821583 => 23:22:29.885244
[0m23:22:29.885244 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m23:22:29.886244 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m23:22:29.886244 [info ] [Thread-1 (]: 20 of 23 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.08s]
[0m23:22:29.887244 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m23:22:29.888244 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m23:22:29.888244 [info ] [Thread-1 (]: 23 of 23 START test check_valid_customers ...................................... [RUN]
[0m23:22:29.889244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m23:22:29.889244 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m23:22:29.892245 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:22:29.892245 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 23:22:29.890244 => 23:22:29.892245
[0m23:22:29.893245 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m23:22:29.894245 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:22:29.895246 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:22:29.895246 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:22:29.896284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:29.917245 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.918245 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:22:29.918245 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."public"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."public"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m23:22:29.920246 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.921246 [debug] [Thread-3 (]: Timing info for test.customer360.check_last_purchase_date (execute): 23:22:29.823582 => 23:22:29.921246
[0m23:22:29.922245 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m23:22:29.922245 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: Close
[0m23:22:29.923247 [info ] [Thread-3 (]: 21 of 23 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.11s]
[0m23:22:29.924245 [debug] [Thread-3 (]: Finished running node test.customer360.check_last_purchase_date
[0m23:22:29.949249 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.950249 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:22:29.950249 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:22:29.951751 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.952755 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:22:29.825583 => 23:22:29.952755
[0m23:22:29.952755 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:22:29.953754 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:22:29.953754 [info ] [Thread-2 (]: 22 of 23 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.14s]
[0m23:22:29.954757 [debug] [Thread-2 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:22:29.980756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:22:29.981756 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:22:29.981756 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:22:29.982755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:22:29.984757 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 23:22:29.893245 => 23:22:29.983756
[0m23:22:29.984757 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:22:29.984757 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m23:22:29.985756 [info ] [Thread-1 (]: 23 of 23 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.10s]
[0m23:22:29.986756 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m23:22:29.987756 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:29.987756 [debug] [MainThread]: On master: BEGIN
[0m23:22:29.988756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:30.039758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:22:30.039758 [debug] [MainThread]: On master: COMMIT
[0m23:22:30.040759 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:30.040759 [debug] [MainThread]: On master: COMMIT
[0m23:22:30.040759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:22:30.041759 [debug] [MainThread]: On master: Close
[0m23:22:30.041759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:30.042759 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m23:22:30.042759 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:22:30.042759 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:22:30.042759 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:22:30.043758 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m23:22:30.043758 [info ] [MainThread]: 
[0m23:22:30.044758 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 3 table models, 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m23:22:30.046758 [debug] [MainThread]: Command end result
[0m23:22:30.053263 [info ] [MainThread]: 
[0m23:22:30.053263 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:22:30.054264 [info ] [MainThread]: 
[0m23:22:30.054264 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m23:22:30.055264 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m23:22:30.055264 [info ] [MainThread]: 
[0m23:22:30.056264 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m23:22:30.056264 [info ] [MainThread]: 
[0m23:22:30.057265 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 TOTAL=23
[0m23:22:30.058265 [debug] [MainThread]: Command `dbt build` succeeded at 23:22:30.057265 after 2.90 seconds
[0m23:22:30.058265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DC0C42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E0E16860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DFB61660>]}
[0m23:22:30.058265 [debug] [MainThread]: Flushing usage events
[0m23:34:11.735237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774A2A7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D5A2E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D5A2B90>]}


============================== 23:34:11.737240 | dede8526-8013-4b4e-90a9-bb66df42b574 ==============================
[0m23:34:11.737240 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:34:11.739359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:34:11.858994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277462F2E00>]}
[0m23:34:11.918314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D7E91E0>]}
[0m23:34:11.919142 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:34:11.929150 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:34:11.971492 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:34:11.971492 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:34:11.972492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D7E8370>]}
[0m23:34:12.832440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D8F8C10>]}
[0m23:34:12.840397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DC2A050>]}
[0m23:34:12.840397 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:34:12.842755 [info ] [MainThread]: 
[0m23:34:12.843357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:12.844364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:34:12.845363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:34:12.846363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:34:12.852380 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:34:12.853381 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:34:12.854380 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:34:12.855379 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:34:12.855379 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:34:12.855379 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:34:12.856380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:12.856380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:12.856380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:12.907160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:34:12.908662 [debug] [ThreadPool]: On list_dbt: Close
[0m23:34:12.937162 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:34:12.938664 [debug] [ThreadPool]: On list_dbt: Close
[0m23:34:12.974309 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:34:12.975311 [debug] [ThreadPool]: On list_dbt: Close
[0m23:34:12.976311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_public_staging)
[0m23:34:12.977310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_public_marts)
[0m23:34:12.977310 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "public_staging"
"
[0m23:34:12.978311 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "public_marts"
"
[0m23:34:12.982408 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_staging"
[0m23:34:12.983410 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_marts"
[0m23:34:12.983410 [debug] [ThreadPool]: On create_dbt_public_staging: BEGIN
[0m23:34:12.984409 [debug] [ThreadPool]: On create_dbt_public_marts: BEGIN
[0m23:34:12.984409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:12.985409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:13.041466 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.041466 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_staging"
[0m23:34:13.041466 [debug] [ThreadPool]: On create_dbt_public_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_public_staging"} */
create schema if not exists "public_staging"
[0m23:34:13.043466 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:34:13.044467 [debug] [ThreadPool]: On create_dbt_public_staging: COMMIT
[0m23:34:13.044467 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_staging"
[0m23:34:13.044467 [debug] [ThreadPool]: On create_dbt_public_staging: COMMIT
[0m23:34:13.045470 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.045470 [debug] [ThreadPool]: On create_dbt_public_staging: Close
[0m23:34:13.071358 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.071358 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_marts"
[0m23:34:13.072357 [debug] [ThreadPool]: On create_dbt_public_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_public_marts"} */
create schema if not exists "public_marts"
[0m23:34:13.072357 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:34:13.073358 [debug] [ThreadPool]: On create_dbt_public_marts: COMMIT
[0m23:34:13.073358 [debug] [ThreadPool]: Using postgres connection "create_dbt_public_marts"
[0m23:34:13.074359 [debug] [ThreadPool]: On create_dbt_public_marts: COMMIT
[0m23:34:13.074359 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.075358 [debug] [ThreadPool]: On create_dbt_public_marts: Close
[0m23:34:13.076358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:34:13.077359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_staging'
[0m23:34:13.081860 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:34:13.081860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_marts'
[0m23:34:13.083859 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:34:13.083859 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:34:13.085860 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:34:13.085860 [debug] [ThreadPool]: On list_dbt_public_staging: BEGIN
[0m23:34:13.085860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:13.086862 [debug] [ThreadPool]: On list_dbt_public_marts: BEGIN
[0m23:34:13.086862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:13.086862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:13.133214 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.134214 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:34:13.134214 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:34:13.136216 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:34:13.137216 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:34:13.138215 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:34:13.163415 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.164415 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:34:13.164415 [debug] [ThreadPool]: On list_dbt_public_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:34:13.166417 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:34:13.167416 [debug] [ThreadPool]: On list_dbt_public_staging: ROLLBACK
[0m23:34:13.167416 [debug] [ThreadPool]: On list_dbt_public_staging: Close
[0m23:34:13.195057 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.195057 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:34:13.195057 [debug] [ThreadPool]: On list_dbt_public_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:34:13.197564 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:34:13.199069 [debug] [ThreadPool]: On list_dbt_public_marts: ROLLBACK
[0m23:34:13.199069 [debug] [ThreadPool]: On list_dbt_public_marts: Close
[0m23:34:13.203073 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.203073 [debug] [MainThread]: On master: BEGIN
[0m23:34:13.203073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:13.371343 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.371343 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.372318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:13.375324 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:34:13.377317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DF95E70>]}
[0m23:34:13.377317 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:13.377317 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.378321 [debug] [MainThread]: On master: BEGIN
[0m23:34:13.378889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.378889 [debug] [MainThread]: On master: COMMIT
[0m23:34:13.379432 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.379432 [debug] [MainThread]: On master: COMMIT
[0m23:34:13.379432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.380474 [debug] [MainThread]: On master: Close
[0m23:34:13.380474 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:34:13.381490 [info ] [MainThread]: 
[0m23:34:13.383436 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m23:34:13.383436 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m23:34:13.384435 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:34:13.384435 [info ] [Thread-1 (]: 1 of 23 START seed file public.contacts ........................................ [RUN]
[0m23:34:13.384435 [info ] [Thread-2 (]: 2 of 23 START seed file public.transactions .................................... [RUN]
[0m23:34:13.385436 [info ] [Thread-3 (]: 3 of 23 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m23:34:13.386436 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m23:34:13.386436 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m23:34:13.387435 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m23:34:13.387435 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m23:34:13.388436 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m23:34:13.388436 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:34:13.388939 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 23:34:13.388939 => 23:34:13.388939
[0m23:34:13.389442 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 23:34:13.389442 => 23:34:13.389442
[0m23:34:13.395445 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:34:13.395445 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m23:34:13.396445 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m23:34:13.409998 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 23:34:13.389442 => 23:34:13.408994
[0m23:34:13.416997 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:34:13.419993 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:34:13.423339 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:34:13.424332 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m23:34:13.438352 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:34:13.438856 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m23:34:13.439358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:34:13.439358 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:34:13.440362 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:34:13.440600 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m23:34:13.441604 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:13.491718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.491718 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:34:13.491718 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m23:34:13.498223 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:34:13.520281 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:34:13.520281 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m23:34:13.521281 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m23:34:13.525281 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m23:34:13.531350 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.535350 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:34:13.536351 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:34:13.536351 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:34:13.537351 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m23:34:13.537351 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:34:13.539357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.540361 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 23:34:13.396948 => 23:34:13.540361
[0m23:34:13.540361 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m23:34:13.541361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774D922590>]}
[0m23:34:13.542362 [info ] [Thread-1 (]: 1 of 23 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.16s]
[0m23:34:13.542362 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m23:34:13.543362 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:34:13.543362 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:34:13.543362 [info ] [Thread-1 (]: 4 of 23 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m23:34:13.626023 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.645020 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:34:13.646020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m23:34:13.646020 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m23:34:13.647020 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m23:34:13.647020 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:34:13.647020 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m23:34:13.653123 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:34:13.653123 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m23:34:13.655123 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m23:34:13.655123 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 23:34:13.648523 => 23:34:13.655123
[0m23:34:13.656123 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:34:13.657123 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:34:13.657123 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:34:13.659154 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:34:13.659154 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:34:13.660157 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:34:13.660157 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m23:34:13.661157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:13.661157 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.661157 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.662157 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 23:34:13.408486 => 23:34:13.662157
[0m23:34:13.663157 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 23:34:13.424332 => 23:34:13.663157
[0m23:34:13.664156 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m23:34:13.664156 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m23:34:13.665157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DFD1870>]}
[0m23:34:13.665157 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m23:34:13.666157 [info ] [Thread-2 (]: 2 of 23 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m23:34:13.667157 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m23:34:13.666157 [info ] [Thread-3 (]: 3 of 23 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m23:34:13.668157 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:34:13.668157 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m23:34:13.669036 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:34:13.669036 [info ] [Thread-2 (]: 5 of 23 START test source_not_null_web_transactions_id ......................... [RUN]
[0m23:34:13.670039 [info ] [Thread-3 (]: 6 of 23 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m23:34:13.670039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m23:34:13.671040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m23:34:13.671040 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:34:13.671040 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:34:13.675040 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:34:13.680055 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:34:13.680140 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 23:34:13.672039 => 23:34:13.680140
[0m23:34:13.681143 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 23:34:13.675040 => 23:34:13.681143
[0m23:34:13.681143 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:34:13.682143 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:34:13.683143 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:34:13.685143 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:34:13.686143 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:34:13.686143 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m23:34:13.687143 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:34:13.687143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:13.687143 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m23:34:13.687143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:13.715224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.716227 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m23:34:13.716227 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m23:34:13.717225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.718729 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 23:34:13.657123 => 23:34:13.718224
[0m23:34:13.718729 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m23:34:13.719231 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m23:34:13.720193 [info ] [Thread-1 (]: 4 of 23 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m23:34:13.720193 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m23:34:13.721235 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:34:13.721235 [info ] [Thread-1 (]: 7 of 23 START test source_unique_web_transactions_id ........................... [RUN]
[0m23:34:13.722235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m23:34:13.722235 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:34:13.726234 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:34:13.727234 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 23:34:13.722235 => 23:34:13.727234
[0m23:34:13.727234 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:34:13.729242 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:34:13.730246 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:34:13.730246 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m23:34:13.730246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:13.746470 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.746470 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m23:34:13.746470 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m23:34:13.747469 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.749193 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 23:34:13.682143 => 23:34:13.749193
[0m23:34:13.749193 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m23:34:13.750198 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m23:34:13.750198 [info ] [Thread-2 (]: 5 of 23 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m23:34:13.751203 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m23:34:13.776342 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.776342 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m23:34:13.777342 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:34:13.778342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.780300 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 23:34:13.684143 => 23:34:13.779295
[0m23:34:13.780402 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m23:34:13.780402 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m23:34:13.781407 [warn ] [Thread-3 (]: 6 of 23 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.11s]
[0m23:34:13.782405 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m23:34:13.783406 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m23:34:13.783406 [info ] [Thread-2 (]: 8 of 23 START sql table model public_staging.stg_sf__contacts .................. [RUN]
[0m23:34:13.784406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m23:34:13.784406 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m23:34:13.787405 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m23:34:13.788407 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 23:34:13.785405 => 23:34:13.787405
[0m23:34:13.788407 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m23:34:13.810071 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m23:34:13.811070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.811070 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:34:13.812071 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m23:34:13.812071 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m23:34:13.813071 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:34:13.813071 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:13.814070 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.815071 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 23:34:13.728234 => 23:34:13.815071
[0m23:34:13.816072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m23:34:13.816072 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m23:34:13.817071 [info ] [Thread-1 (]: 7 of 23 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m23:34:13.817071 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m23:34:13.861215 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.861215 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:34:13.862214 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."public_staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m23:34:13.869219 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m23:34:13.873726 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:34:13.874724 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."public_staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m23:34:13.874724 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:13.878232 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:34:13.879235 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:34:13.879235 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:34:13.880255 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.884253 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public_staging"."stg_sf__contacts__dbt_backup"
[0m23:34:13.887254 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:34:13.888256 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."public_staging"."stg_sf__contacts__dbt_backup" cascade
[0m23:34:13.888256 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:13.889327 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 23:34:13.788912 => 23:34:13.889327
[0m23:34:13.890331 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m23:34:13.890845 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774F0EDCC0>]}
[0m23:34:13.890845 [info ] [Thread-2 (]: 8 of 23 OK created sql table model public_staging.stg_sf__contacts ............. [[32mSELECT 11[0m in 0.11s]
[0m23:34:13.891851 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m23:34:13.892852 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:34:13.892852 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:34:13.893850 [info ] [Thread-3 (]: 9 of 23 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m23:34:13.893850 [info ] [Thread-1 (]: 10 of 23 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m23:34:13.894851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m23:34:13.894851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m23:34:13.895850 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:34:13.895850 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:34:13.900297 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:34:13.903297 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:34:13.904297 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 23:34:13.895850 => 23:34:13.903297
[0m23:34:13.904297 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 23:34:13.900297 => 23:34:13.904297
[0m23:34:13.904297 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:34:13.905297 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:34:13.906297 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:34:13.908297 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:34:13.908297 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:34:13.909400 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:34:13.909400 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m23:34:13.910394 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m23:34:13.910394 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:13.910898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:13.964068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.964068 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m23:34:13.965068 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."public_staging"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m23:34:13.966068 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.967068 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 23:34:13.905297 => 23:34:13.967068
[0m23:34:13.967068 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m23:34:13.968570 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m23:34:13.969078 [info ] [Thread-3 (]: 9 of 23 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m23:34:13.970082 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m23:34:13.994162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.994162 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m23:34:13.995162 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."public_staging"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:34:13.996162 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.997665 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 23:34:13.907297 => 23:34:13.997162
[0m23:34:13.997665 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m23:34:13.998168 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m23:34:13.998168 [info ] [Thread-1 (]: 10 of 23 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m23:34:13.999171 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m23:34:14.000207 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m23:34:14.000711 [info ] [Thread-2 (]: 11 of 23 START sql table model public_staging.stg_web__transactions ............ [RUN]
[0m23:34:14.000711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m23:34:14.001714 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m23:34:14.004714 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m23:34:14.005714 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 23:34:14.001714 => 23:34:14.004714
[0m23:34:14.005714 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m23:34:14.008218 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m23:34:14.009724 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:34:14.009724 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m23:34:14.009724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:14.056822 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.056822 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:34:14.056822 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."public_staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."public_staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m23:34:14.064887 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m23:34:14.066887 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:34:14.068390 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."public_staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m23:34:14.068390 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:14.069394 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:34:14.070414 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:34:14.070414 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:34:14.071414 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:14.073414 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public_staging"."stg_web__transactions__dbt_backup"
[0m23:34:14.074414 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:34:14.074414 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."public_staging"."stg_web__transactions__dbt_backup" cascade
[0m23:34:14.075414 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:14.076415 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 23:34:14.005714 => 23:34:14.075414
[0m23:34:14.076415 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m23:34:14.077414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774F1406D0>]}
[0m23:34:14.077414 [info ] [Thread-2 (]: 11 of 23 OK created sql table model public_staging.stg_web__transactions ....... [[32mSELECT 101[0m in 0.08s]
[0m23:34:14.078414 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m23:34:14.079100 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:34:14.079100 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:34:14.080180 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:34:14.080180 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m23:34:14.080180 [info ] [Thread-3 (]: 13 of 23 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m23:34:14.081184 [info ] [Thread-2 (]: 14 of 23 START test unique_stg_web__transactions_id ............................ [RUN]
[0m23:34:14.081184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m23:34:14.082184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m23:34:14.082184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m23:34:14.083184 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:34:14.083184 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:34:14.083184 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:34:14.087183 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:34:14.090200 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:34:14.092202 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:34:14.093202 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 23:34:14.084184 => 23:34:14.093202
[0m23:34:14.094204 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 23:34:14.087183 => 23:34:14.093202
[0m23:34:14.094204 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:34:14.095204 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 23:34:14.090200 => 23:34:14.094204
[0m23:34:14.095204 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:34:14.096204 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:34:14.097204 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:34:14.099297 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:34:14.101428 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:34:14.101428 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:34:14.102427 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m23:34:14.102427 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:34:14.102427 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:34:14.103428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:14.103428 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m23:34:14.103428 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m23:34:14.104428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:14.104428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:14.152898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.153898 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m23:34:14.153898 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."public_staging"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m23:34:14.154897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.155899 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 23:34:14.095204 => 23:34:14.155899
[0m23:34:14.156897 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m23:34:14.156897 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m23:34:14.156897 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m23:34:14.158402 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m23:34:14.159406 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:34:14.159406 [info ] [Thread-1 (]: 15 of 23 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m23:34:14.159406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m23:34:14.160700 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:34:14.163699 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:34:14.163699 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 23:34:14.160700 => 23:34:14.163699
[0m23:34:14.164699 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:34:14.166701 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:34:14.168205 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:34:14.168205 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m23:34:14.168205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:14.190079 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.191008 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m23:34:14.191008 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."public_staging"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."public_staging"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:34:14.192008 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.194008 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 23:34:14.097204 => 23:34:14.194008
[0m23:34:14.194008 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m23:34:14.195008 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m23:34:14.195008 [info ] [Thread-3 (]: 13 of 23 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m23:34:14.196008 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m23:34:14.220218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.221217 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m23:34:14.221217 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public_staging"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:34:14.223218 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.224218 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 23:34:14.099297 => 23:34:14.224218
[0m23:34:14.224218 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m23:34:14.225216 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m23:34:14.226217 [info ] [Thread-2 (]: 14 of 23 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m23:34:14.226217 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m23:34:14.256436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.257435 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m23:34:14.257435 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."public_staging"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m23:34:14.258435 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.259350 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 23:34:14.164699 => 23:34:14.259350
[0m23:34:14.260359 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m23:34:14.260359 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m23:34:14.261358 [info ] [Thread-1 (]: 15 of 23 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m23:34:14.262357 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m23:34:14.263358 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m23:34:14.263358 [info ] [Thread-3 (]: 16 of 23 START sql view model public_marts.contacts_joined_with_transactions ... [RUN]
[0m23:34:14.264356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m23:34:14.264356 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m23:34:14.266385 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.267378 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 23:34:14.264356 => 23:34:14.267378
[0m23:34:14.267378 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m23:34:14.280236 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.281298 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.282281 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m23:34:14.282281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:14.339171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.340346 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.340346 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."public_marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."public_staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."public_staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m23:34:14.342353 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:34:14.345350 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.345350 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."public_marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m23:34:14.346350 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:14.347350 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:34:14.347350 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.348350 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:34:14.348350 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:14.350251 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public_marts"."contacts_joined_with_transactions__dbt_backup"
[0m23:34:14.352251 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:34:14.353251 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."public_marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m23:34:14.353251 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:34:14.354251 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 23:34:14.268377 => 23:34:14.354251
[0m23:34:14.355250 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m23:34:14.355250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774F12C940>]}
[0m23:34:14.356251 [info ] [Thread-3 (]: 16 of 23 OK created sql view model public_marts.contacts_joined_with_transactions  [[32mCREATE VIEW[0m in 0.09s]
[0m23:34:14.356251 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m23:34:14.357289 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:34:14.357289 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:34:14.358254 [info ] [Thread-1 (]: 17 of 23 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m23:34:14.359469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m23:34:14.358254 [info ] [Thread-2 (]: 18 of 23 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m23:34:14.359469 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:34:14.360410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m23:34:14.362920 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:34:14.363920 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:34:14.365920 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:34:14.366920 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 23:34:14.360410 => 23:34:14.366920
[0m23:34:14.366920 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:34:14.366920 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 23:34:14.363920 => 23:34:14.366920
[0m23:34:14.369933 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:34:14.370938 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:34:14.371938 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:34:14.372938 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:34:14.372938 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m23:34:14.373983 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:34:14.373983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:14.373983 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m23:34:14.374940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:14.421435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.422475 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m23:34:14.422475 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."public_marts"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m23:34:14.424473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.425474 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 23:34:14.366920 => 23:34:14.425474
[0m23:34:14.425474 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m23:34:14.426474 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m23:34:14.427470 [info ] [Thread-1 (]: 17 of 23 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.07s]
[0m23:34:14.427470 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m23:34:14.567078 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.567078 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m23:34:14.567078 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."public_marts"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:34:14.569092 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.571096 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 23:34:14.370938 => 23:34:14.570189
[0m23:34:14.571096 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m23:34:14.571096 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m23:34:14.572096 [info ] [Thread-2 (]: 18 of 23 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.21s]
[0m23:34:14.573096 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m23:34:14.573096 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m23:34:14.574096 [info ] [Thread-3 (]: 19 of 23 START sql table model public_marts.customers .......................... [RUN]
[0m23:34:14.575095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m23:34:14.575095 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m23:34:14.579113 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m23:34:14.579113 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 23:34:14.575095 => 23:34:14.579113
[0m23:34:14.580121 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m23:34:14.583126 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m23:34:14.583126 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:34:14.584126 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m23:34:14.584126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:14.636031 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.637030 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:34:14.637030 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."public_marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."public_marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m23:34:14.644640 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m23:34:14.646635 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:34:14.646635 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."public_marts"."customers__dbt_tmp" rename to "customers"
[0m23:34:14.648138 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:14.649648 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m23:34:14.649648 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:34:14.649648 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m23:34:14.650652 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:14.652651 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public_marts"."customers__dbt_backup"
[0m23:34:14.653651 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:34:14.653651 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."public_marts"."customers__dbt_backup" cascade
[0m23:34:14.653651 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:14.654653 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 23:34:14.580121 => 23:34:14.654653
[0m23:34:14.655652 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m23:34:14.655652 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dede8526-8013-4b4e-90a9-bb66df42b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774E0621A0>]}
[0m23:34:14.656652 [info ] [Thread-3 (]: 19 of 23 OK created sql table model public_marts.customers ..................... [[32mSELECT 9[0m in 0.08s]
[0m23:34:14.656652 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m23:34:14.658157 [debug] [Thread-2 (]: Began running node test.customer360.check_first_purchase_date
[0m23:34:14.658157 [debug] [Thread-1 (]: Began running node test.customer360.check_last_purchase_date
[0m23:34:14.659162 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m23:34:14.659667 [info ] [Thread-2 (]: 20 of 23 START test check_first_purchase_date .................................. [RUN]
[0m23:34:14.659667 [info ] [Thread-1 (]: 21 of 23 START test check_last_purchase_date ................................... [RUN]
[0m23:34:14.660174 [info ] [Thread-3 (]: 22 of 23 START test check_purchase_amount_above_zero ........................... [RUN]
[0m23:34:14.660679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_first_purchase_date)
[0m23:34:14.661687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_last_purchase_date)
[0m23:34:14.661687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m23:34:14.661687 [debug] [Thread-2 (]: Began compiling node test.customer360.check_first_purchase_date
[0m23:34:14.662684 [debug] [Thread-1 (]: Began compiling node test.customer360.check_last_purchase_date
[0m23:34:14.662684 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m23:34:14.664682 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m23:34:14.668193 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m23:34:14.669705 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m23:34:14.670708 [debug] [Thread-2 (]: Timing info for test.customer360.check_first_purchase_date (compile): 23:34:14.662684 => 23:34:14.670708
[0m23:34:14.671711 [debug] [Thread-1 (]: Timing info for test.customer360.check_last_purchase_date (compile): 23:34:14.665683 => 23:34:14.671711
[0m23:34:14.671711 [debug] [Thread-2 (]: Began executing node test.customer360.check_first_purchase_date
[0m23:34:14.671711 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 23:34:14.668193 => 23:34:14.671711
[0m23:34:14.672712 [debug] [Thread-1 (]: Began executing node test.customer360.check_last_purchase_date
[0m23:34:14.674708 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m23:34:14.674708 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m23:34:14.676709 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m23:34:14.678213 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m23:34:14.678213 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:34:14.679218 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m23:34:14.679723 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:34:14.680175 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:34:14.680175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:14.680175 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m23:34:14.681180 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m23:34:14.681180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:14.681180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:34:14.726958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.726958 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m23:34:14.726958 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."public_marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."public_marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m23:34:14.728992 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.730997 [debug] [Thread-2 (]: Timing info for test.customer360.check_first_purchase_date (execute): 23:34:14.672712 => 23:34:14.729995
[0m23:34:14.730997 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m23:34:14.730997 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: Close
[0m23:34:14.731995 [info ] [Thread-2 (]: 20 of 23 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.07s]
[0m23:34:14.732999 [debug] [Thread-2 (]: Finished running node test.customer360.check_first_purchase_date
[0m23:34:14.732999 [debug] [Thread-2 (]: Began running node test.customer360.check_valid_customers
[0m23:34:14.733999 [info ] [Thread-2 (]: 23 of 23 START test check_valid_customers ...................................... [RUN]
[0m23:34:14.733999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m23:34:14.734997 [debug] [Thread-2 (]: Began compiling node test.customer360.check_valid_customers
[0m23:34:14.736998 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m23:34:14.736998 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (compile): 23:34:14.734997 => 23:34:14.736998
[0m23:34:14.736998 [debug] [Thread-2 (]: Began executing node test.customer360.check_valid_customers
[0m23:34:14.740023 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m23:34:14.740560 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:34:14.740560 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: BEGIN
[0m23:34:14.741566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:14.759104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.759104 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m23:34:14.760110 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."public_marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."public_marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m23:34:14.762118 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.763118 [debug] [Thread-1 (]: Timing info for test.customer360.check_last_purchase_date (execute): 23:34:14.674708 => 23:34:14.763118
[0m23:34:14.763118 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m23:34:14.764118 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: Close
[0m23:34:14.764118 [info ] [Thread-1 (]: 21 of 23 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.10s]
[0m23:34:14.765117 [debug] [Thread-1 (]: Finished running node test.customer360.check_last_purchase_date
[0m23:34:14.819325 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.820329 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m23:34:14.820329 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public_marts"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."public_staging"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m23:34:14.821330 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.822332 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (execute): 23:34:14.738501 => 23:34:14.822332
[0m23:34:14.823328 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m23:34:14.823328 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: Close
[0m23:34:14.824330 [info ] [Thread-2 (]: 23 of 23 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.09s]
[0m23:34:14.825332 [debug] [Thread-2 (]: Finished running node test.customer360.check_valid_customers
[0m23:34:14.900479 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.901480 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m23:34:14.901480 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."public_marts"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m23:34:14.902479 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:14.904478 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 23:34:14.676709 => 23:34:14.903479
[0m23:34:14.904478 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m23:34:14.904478 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m23:34:14.905479 [info ] [Thread-3 (]: 22 of 23 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.24s]
[0m23:34:14.906479 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m23:34:14.907480 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:14.907480 [debug] [MainThread]: On master: BEGIN
[0m23:34:14.908481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:14.956488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:14.956488 [debug] [MainThread]: On master: COMMIT
[0m23:34:14.957488 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:14.957488 [debug] [MainThread]: On master: COMMIT
[0m23:34:14.958488 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:14.958488 [debug] [MainThread]: On master: Close
[0m23:34:14.958990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:14.958990 [debug] [MainThread]: Connection 'create_dbt_public_staging' was properly closed.
[0m23:34:14.959994 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m23:34:14.959994 [debug] [MainThread]: Connection 'create_dbt_public_marts' was properly closed.
[0m23:34:14.960514 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:34:14.960514 [debug] [MainThread]: Connection 'list_dbt_public_staging' was properly closed.
[0m23:34:14.960514 [debug] [MainThread]: Connection 'list_dbt_public_marts' was properly closed.
[0m23:34:14.961517 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m23:34:14.961517 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m23:34:14.961517 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m23:34:14.961517 [info ] [MainThread]: 
[0m23:34:14.962517 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 3 table models, 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m23:34:14.964538 [debug] [MainThread]: Command end result
[0m23:34:14.972023 [info ] [MainThread]: 
[0m23:34:14.973023 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:34:14.973023 [info ] [MainThread]: 
[0m23:34:14.974023 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m23:34:14.974023 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m23:34:14.975023 [info ] [MainThread]: 
[0m23:34:14.975023 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m23:34:14.976023 [info ] [MainThread]: 
[0m23:34:14.976023 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 TOTAL=23
[0m23:34:14.977023 [debug] [MainThread]: Command `dbt build` succeeded at 23:34:14.977023 after 3.28 seconds
[0m23:34:14.977023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774A2A7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DC2A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774DD016C0>]}
[0m23:34:14.977023 [debug] [MainThread]: Flushing usage events
[0m23:36:08.968140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B757220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EA4AD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EA4AAD0>]}


============================== 23:36:08.971141 | 49b02374-2b03-4a86-969f-624323b5b4bc ==============================
[0m23:36:08.971141 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:36:08.972140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:36:09.092586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EA4AD70>]}
[0m23:36:09.151251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EA02CE0>]}
[0m23:36:09.152254 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:36:09.161216 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:36:09.241380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:09.241380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:09.245381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EED9900>]}
[0m23:36:09.254380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EE931C0>]}
[0m23:36:09.254380 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:36:09.255380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EEA8070>]}
[0m23:36:09.256380 [info ] [MainThread]: 
[0m23:36:09.256380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:09.257380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:36:09.264382 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:36:09.265381 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:36:09.265381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:09.313999 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:36:09.314999 [debug] [ThreadPool]: On list_dbt: Close
[0m23:36:09.315999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_public)
[0m23:36:09.317019 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "public"
"
[0m23:36:09.319998 [debug] [ThreadPool]: Using postgres connection "create_dbt_public"
[0m23:36:09.320998 [debug] [ThreadPool]: On create_dbt_public: BEGIN
[0m23:36:09.320998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:09.368707 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.368707 [debug] [ThreadPool]: Using postgres connection "create_dbt_public"
[0m23:36:09.368707 [debug] [ThreadPool]: On create_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_public"} */
create schema if not exists "public"
[0m23:36:09.369714 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:36:09.370752 [debug] [ThreadPool]: On create_dbt_public: COMMIT
[0m23:36:09.370752 [debug] [ThreadPool]: Using postgres connection "create_dbt_public"
[0m23:36:09.371752 [debug] [ThreadPool]: On create_dbt_public: COMMIT
[0m23:36:09.371752 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:36:09.371752 [debug] [ThreadPool]: On create_dbt_public: Close
[0m23:36:09.373712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_marts'
[0m23:36:09.374712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:36:09.378711 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:36:09.378711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_staging'
[0m23:36:09.379711 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:36:09.380711 [debug] [ThreadPool]: On list_dbt_public_marts: BEGIN
[0m23:36:09.381711 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:36:09.381711 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:36:09.382711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:09.382711 [debug] [ThreadPool]: On list_dbt_public_staging: BEGIN
[0m23:36:09.382711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:09.383711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:09.434738 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.434738 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:36:09.435740 [debug] [ThreadPool]: On list_dbt_public_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:36:09.437738 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:36:09.438738 [debug] [ThreadPool]: On list_dbt_public_marts: ROLLBACK
[0m23:36:09.439738 [debug] [ThreadPool]: On list_dbt_public_marts: Close
[0m23:36:09.464738 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.465739 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:36:09.465739 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:36:09.467738 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:36:09.468738 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:36:09.469738 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:36:09.494753 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.494753 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:36:09.494753 [debug] [ThreadPool]: On list_dbt_public_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:36:09.497752 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:36:09.498752 [debug] [ThreadPool]: On list_dbt_public_staging: ROLLBACK
[0m23:36:09.498752 [debug] [ThreadPool]: On list_dbt_public_staging: Close
[0m23:36:09.501752 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.502752 [debug] [MainThread]: On master: BEGIN
[0m23:36:09.502752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:09.549026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.550067 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.550067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:09.553027 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:36:09.554026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EE92CE0>]}
[0m23:36:09.555026 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:09.555026 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.556025 [debug] [MainThread]: On master: BEGIN
[0m23:36:09.556025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.556025 [debug] [MainThread]: On master: COMMIT
[0m23:36:09.557026 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.557026 [debug] [MainThread]: On master: COMMIT
[0m23:36:09.557026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:09.558026 [debug] [MainThread]: On master: Close
[0m23:36:09.558026 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:36:09.559026 [info ] [MainThread]: 
[0m23:36:09.561025 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m23:36:09.562026 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m23:36:09.562339 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m23:36:09.562844 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m23:36:09.562844 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m23:36:09.563848 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m23:36:09.563848 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m23:36:09.564848 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m23:36:09.564848 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 23:36:09.564848 => 23:36:09.564848
[0m23:36:09.564848 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 23:36:09.564848 => 23:36:09.564848
[0m23:36:09.565849 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m23:36:09.565849 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m23:36:09.585847 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:36:09.587848 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:36:09.588849 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m23:36:09.588849 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m23:36:09.588849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:09.589848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:09.635999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.635999 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:36:09.636998 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */

    create table "dbt"."public"."contacts" ("id" text,"username" text,"name" text,"gender" text,"address" text,"mail" text,"birthdate" date,"_loaded_at_utc" timestamp)
  
[0m23:36:09.642997 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m23:36:09.664997 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:36:09.665998 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m23:36:09.666998 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m23:36:09.669996 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m23:36:09.680998 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:36:09.681999 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.681999 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:36:09.681999 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:36:09.682997 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:36:09.682997 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */

    create table "dbt"."public"."transactions" ("contact_id" text,"id" text,"transaction_date" text,"amount" float8,"item_count" integer,"category" text,"_loaded_at_utc" timestamp)
  
[0m23:36:09.683998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:09.683998 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 23:36:09.565849 => 23:36:09.683998
[0m23:36:09.684998 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m23:36:09.685998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EE93280>]}
[0m23:36:09.685998 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.12s]
[0m23:36:09.687287 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m23:36:09.688290 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m23:36:09.783801 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:36:09.784801 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m23:36:09.786801 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m23:36:09.787803 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m23:36:09.788803 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:36:09.789803 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:36:09.789803 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:36:09.790784 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:09.790784 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 23:36:09.575847 => 23:36:09.790784
[0m23:36:09.791793 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m23:36:09.791793 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b02374-2b03-4a86-969f-624323b5b4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EF1CAC0>]}
[0m23:36:09.792795 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.23s]
[0m23:36:09.793827 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m23:36:09.794802 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.794802 [debug] [MainThread]: On master: BEGIN
[0m23:36:09.795800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:09.848312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:09.848312 [debug] [MainThread]: On master: COMMIT
[0m23:36:09.848312 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:09.849313 [debug] [MainThread]: On master: COMMIT
[0m23:36:09.849313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:09.850312 [debug] [MainThread]: On master: Close
[0m23:36:09.850312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:09.851312 [debug] [MainThread]: Connection 'create_dbt_public' was properly closed.
[0m23:36:09.851312 [debug] [MainThread]: Connection 'list_dbt_public_marts' was properly closed.
[0m23:36:09.851312 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:36:09.852311 [debug] [MainThread]: Connection 'list_dbt_public_staging' was properly closed.
[0m23:36:09.852311 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m23:36:09.852311 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m23:36:09.853308 [info ] [MainThread]: 
[0m23:36:09.853308 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:36:09.854309 [debug] [MainThread]: Command end result
[0m23:36:09.860311 [info ] [MainThread]: 
[0m23:36:09.860311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:09.861310 [info ] [MainThread]: 
[0m23:36:09.861310 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:36:09.862311 [debug] [MainThread]: Command `dbt seed` succeeded at 23:36:09.862311 after 0.93 seconds
[0m23:36:09.862311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758B757220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EA02CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001758EEA80A0>]}
[0m23:36:09.863309 [debug] [MainThread]: Flushing usage events
[0m23:38:52.455544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6362E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6395EAD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6395EAB00>]}


============================== 23:38:52.458543 | 7e777b9c-baa7-4649-9f11-d706436beeb6 ==============================
[0m23:38:52.458543 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:38:52.459544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:38:52.585051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6395EADA0>]}
[0m23:38:52.642641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6395E8D60>]}
[0m23:38:52.643642 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:38:52.653643 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:38:52.692758 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:52.693759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63985E590>]}
[0m23:38:53.526799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639A356F0>]}
[0m23:38:53.534801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639B107F0>]}
[0m23:38:53.535802 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:38:53.536801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639D68A00>]}
[0m23:38:53.537800 [info ] [MainThread]: 
[0m23:38:53.538800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:53.539801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:38:53.545799 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:38:53.545799 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:38:53.545799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:53.594801 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:38:53.595802 [debug] [ThreadPool]: On list_dbt: Close
[0m23:38:53.597803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_marts'
[0m23:38:53.597803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_staging'
[0m23:38:53.601804 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:38:53.602804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:38:53.603805 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:38:53.603805 [debug] [ThreadPool]: On list_dbt_public_marts: BEGIN
[0m23:38:53.605805 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:38:53.605805 [debug] [ThreadPool]: On list_dbt_public_staging: BEGIN
[0m23:38:53.605805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:53.606805 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:38:53.606805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:53.606805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:53.660311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.660311 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:38:53.661312 [debug] [ThreadPool]: On list_dbt_public_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:38:53.663310 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:38:53.664310 [debug] [ThreadPool]: On list_dbt_public_marts: ROLLBACK
[0m23:38:53.665310 [debug] [ThreadPool]: On list_dbt_public_marts: Close
[0m23:38:53.690311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.691312 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:38:53.691312 [debug] [ThreadPool]: On list_dbt_public_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:38:53.693310 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:38:53.694311 [debug] [ThreadPool]: On list_dbt_public_staging: ROLLBACK
[0m23:38:53.694311 [debug] [ThreadPool]: On list_dbt_public_staging: Close
[0m23:38:53.719819 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.719819 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:38:53.719819 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:38:53.722821 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:38:53.723820 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:38:53.723820 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:38:53.727820 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:53.727820 [debug] [MainThread]: On master: BEGIN
[0m23:38:53.727820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:53.773820 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.774820 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:53.774820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:38:53.777820 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:38:53.778820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63991C9A0>]}
[0m23:38:53.778820 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:53.779818 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:53.779818 [debug] [MainThread]: On master: BEGIN
[0m23:38:53.779818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.780819 [debug] [MainThread]: On master: COMMIT
[0m23:38:53.780819 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:53.780819 [debug] [MainThread]: On master: COMMIT
[0m23:38:53.781819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:38:53.781819 [debug] [MainThread]: On master: Close
[0m23:38:53.782819 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:38:53.782819 [info ] [MainThread]: 
[0m23:38:53.784820 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m23:38:53.785819 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m23:38:53.785819 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m23:38:53.786820 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m23:38:53.787264 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m23:38:53.787264 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m23:38:53.788309 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m23:38:53.788309 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m23:38:53.789312 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 23:38:53.788309 => 23:38:53.788309
[0m23:38:53.789312 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 23:38:53.789312 => 23:38:53.789312
[0m23:38:53.789312 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m23:38:53.790311 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m23:38:53.811318 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:38:53.813319 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:38:53.813319 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m23:38:53.814822 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m23:38:53.814822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:53.815825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:53.890825 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:38:53.891826 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:38:53.891826 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m23:38:53.898003 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:38:54.002555 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:38:54.002555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:38:54.003517 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m23:38:54.003517 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:38:54.004517 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m23:38:54.006516 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m23:38:54.009557 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m23:38:54.010556 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:38:54.019019 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:38:54.032020 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:38:54.033020 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:38:54.033020 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m23:38:54.033020 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:38:54.034020 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m23:38:54.035020 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m23:38:54.035020 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:38:54.036020 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 23:38:53.799316 => 23:38:54.036020
[0m23:38:54.037020 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:38:54.037020 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m23:38:54.038021 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:38:54.039021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639964D90>]}
[0m23:38:54.039021 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:38:54.039021 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.25s]
[0m23:38:54.040021 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m23:38:54.041021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:38:54.041021 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 23:38:53.790311 => 23:38:54.041021
[0m23:38:54.042021 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m23:38:54.042021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e777b9c-baa7-4649-9f11-d706436beeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63991E350>]}
[0m23:38:54.043022 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.25s]
[0m23:38:54.043022 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m23:38:54.044020 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:54.045021 [debug] [MainThread]: On master: BEGIN
[0m23:38:54.045021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:54.091662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:38:54.092661 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.092661 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:54.092661 [debug] [MainThread]: On master: COMMIT
[0m23:38:54.093662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:38:54.093662 [debug] [MainThread]: On master: Close
[0m23:38:54.094661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:54.094661 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m23:38:54.094661 [debug] [MainThread]: Connection 'list_dbt_public_marts' was properly closed.
[0m23:38:54.095662 [debug] [MainThread]: Connection 'list_dbt_public_staging' was properly closed.
[0m23:38:54.095662 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:38:54.095662 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m23:38:54.096662 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m23:38:54.096662 [info ] [MainThread]: 
[0m23:38:54.096662 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m23:38:54.097660 [debug] [MainThread]: Command end result
[0m23:38:54.103663 [info ] [MainThread]: 
[0m23:38:54.104663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:54.104663 [info ] [MainThread]: 
[0m23:38:54.105663 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:38:54.106664 [debug] [MainThread]: Command `dbt seed` succeeded at 23:38:54.105663 after 1.69 seconds
[0m23:38:54.106664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6362E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6395EADA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639CF5480>]}
[0m23:38:54.106664 [debug] [MainThread]: Flushing usage events
[0m23:39:55.956104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205F566AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002206285AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002206285AAA0>]}


============================== 23:39:55.959105 | 67c3044e-e046-4317-96c0-2a263135f08f ==============================
[0m23:39:55.959105 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:39:55.960104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:39:56.080621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002206285AD40>]}
[0m23:39:56.137126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062811660>]}
[0m23:39:56.137126 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:39:56.148126 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:39:56.224861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:56.224861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:56.228861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062CF18D0>]}
[0m23:39:56.236861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062CBC160>]}
[0m23:39:56.236861 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 404 macros, 0 groups, 0 semantic models
[0m23:39:56.237861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062CBC280>]}
[0m23:39:56.238863 [info ] [MainThread]: 
[0m23:39:56.239861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:56.240861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:39:56.246861 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:39:56.246861 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:39:56.247861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:56.295698 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:39:56.296706 [debug] [ThreadPool]: On list_dbt: Close
[0m23:39:56.298705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:39:56.302746 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:39:56.303706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_marts'
[0m23:39:56.303706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public_staging'
[0m23:39:56.304704 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:39:56.305704 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:39:56.306706 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:39:56.307705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:56.307705 [debug] [ThreadPool]: On list_dbt_public_marts: BEGIN
[0m23:39:56.307705 [debug] [ThreadPool]: On list_dbt_public_staging: BEGIN
[0m23:39:56.308704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:56.308704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:56.352704 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.353704 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:39:56.353704 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:39:56.355706 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:39:56.356706 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:39:56.356706 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:39:56.382712 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.382712 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_marts"
[0m23:39:56.383711 [debug] [ThreadPool]: On list_dbt_public_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:39:56.385713 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:39:56.385713 [debug] [ThreadPool]: On list_dbt_public_marts: ROLLBACK
[0m23:39:56.387218 [debug] [ThreadPool]: On list_dbt_public_marts: Close
[0m23:39:56.411221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.412222 [debug] [ThreadPool]: Using postgres connection "list_dbt_public_staging"
[0m23:39:56.412222 [debug] [ThreadPool]: On list_dbt_public_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:39:56.415222 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:39:56.415222 [debug] [ThreadPool]: On list_dbt_public_staging: ROLLBACK
[0m23:39:56.416223 [debug] [ThreadPool]: On list_dbt_public_staging: Close
[0m23:39:56.419223 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.420221 [debug] [MainThread]: On master: BEGIN
[0m23:39:56.420221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:56.466340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.467340 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.467340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:56.470341 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:39:56.471342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062CA6E90>]}
[0m23:39:56.472341 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:56.472341 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.473346 [debug] [MainThread]: On master: BEGIN
[0m23:39:56.473346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.474346 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.474346 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.474346 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.475345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:39:56.475345 [debug] [MainThread]: On master: Close
[0m23:39:56.476345 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:39:56.476345 [info ] [MainThread]: 
[0m23:39:56.478391 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m23:39:56.479391 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m23:39:56.479391 [info ] [Thread-1 (]: 1 of 2 START seed file public.contacts ......................................... [RUN]
[0m23:39:56.480392 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m23:39:56.479391 [info ] [Thread-2 (]: 2 of 2 START seed file public.transactions ..................................... [RUN]
[0m23:39:56.480392 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m23:39:56.481392 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m23:39:56.481392 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 23:39:56.481392 => 23:39:56.481392
[0m23:39:56.482393 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m23:39:56.482393 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m23:39:56.482393 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 23:39:56.482393 => 23:39:56.482393
[0m23:39:56.492509 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m23:39:56.503509 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:39:56.505507 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m23:39:56.508507 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:39:56.508507 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:56.509508 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m23:39:56.509508 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:56.558507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.558507 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:39:56.559507 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m23:39:56.564507 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:39:56.585511 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:39:56.586511 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m23:39:56.587512 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m23:39:56.591021 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m23:39:56.591021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.598023 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:39:56.601023 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:39:56.601023 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m23:39:56.601023 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m23:39:56.602022 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m23:39:56.603022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:39:56.604022 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 23:39:56.483393 => 23:39:56.604022
[0m23:39:56.604022 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m23:39:56.605022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062D75EA0>]}
[0m23:39:56.605022 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.contacts ..................................... [[32mINSERT 11[0m in 0.12s]
[0m23:39:56.606045 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m23:39:56.607022 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m23:39:56.704529 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:39:56.704529 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m23:39:56.707400 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m23:39:56.707400 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m23:39:56.709408 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:39:56.709408 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m23:39:56.710406 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m23:39:56.711109 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:39:56.712118 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 23:39:56.503509 => 23:39:56.712118
[0m23:39:56.712118 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m23:39:56.713116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67c3044e-e046-4317-96c0-2a263135f08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062D8ADD0>]}
[0m23:39:56.713116 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.transactions ................................. [[32mINSERT 102[0m in 0.23s]
[0m23:39:56.714116 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m23:39:56.716116 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.716116 [debug] [MainThread]: On master: BEGIN
[0m23:39:56.716116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:56.762113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.762113 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.763115 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.763115 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.763115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:39:56.764114 [debug] [MainThread]: On master: Close
[0m23:39:56.764114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:56.765118 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m23:39:56.765118 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:39:56.765118 [debug] [MainThread]: Connection 'list_dbt_public_marts' was properly closed.
[0m23:39:56.766117 [debug] [MainThread]: Connection 'list_dbt_public_staging' was properly closed.
[0m23:39:56.766117 [debug] [MainThread]: Connection 'seed.integration_tests.contacts' was properly closed.
[0m23:39:56.766117 [debug] [MainThread]: Connection 'seed.integration_tests.transactions' was properly closed.
[0m23:39:56.767119 [info ] [MainThread]: 
[0m23:39:56.767119 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m23:39:56.768117 [debug] [MainThread]: Command end result
[0m23:39:56.774118 [info ] [MainThread]: 
[0m23:39:56.774118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:56.775118 [info ] [MainThread]: 
[0m23:39:56.775118 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:39:56.776118 [debug] [MainThread]: Command `dbt seed` succeeded at 23:39:56.776118 after 0.86 seconds
[0m23:39:56.776118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205F566AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062811660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022062A65300>]}
[0m23:39:56.777117 [debug] [MainThread]: Flushing usage events
[0m23:51:44.229601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCC787220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFA7AD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFA7AAD0>]}


============================== 23:51:44.232601 | ee353433-f62b-4b72-9cc5-6b38bf029d63 ==============================
[0m23:51:44.232601 [info ] [MainThread]: Running with dbt=1.7.2
[0m23:51:44.233104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:51:44.354658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFA7AD70>]}
[0m23:51:44.413221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFA34370>]}
[0m23:51:44.414363 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m23:51:44.423371 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m23:51:44.463599 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:51:44.464601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFCEDB70>]}
[0m23:51:45.321753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFE30730>]}
[0m23:51:45.329353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFFDA560>]}
[0m23:51:45.329353 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m23:51:45.330356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABD022FFA0>]}
[0m23:51:45.331355 [info ] [MainThread]: 
[0m23:51:45.332354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:45.333564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:51:45.334530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:51:45.341527 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:51:45.343075 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:51:45.343607 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:51:45.343676 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:51:45.343676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:45.344728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:45.393590 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:51:45.394630 [debug] [ThreadPool]: On list_dbt: Close
[0m23:51:45.422522 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:51:45.423547 [debug] [ThreadPool]: On list_dbt: Close
[0m23:51:45.424561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_staging)
[0m23:51:45.425554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_marts)
[0m23:51:45.425554 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "staging"
"
[0m23:51:45.426576 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "marts"
"
[0m23:51:45.430565 [debug] [ThreadPool]: Using postgres connection "create_dbt_staging"
[0m23:51:45.431577 [debug] [ThreadPool]: Using postgres connection "create_dbt_marts"
[0m23:51:45.431577 [debug] [ThreadPool]: On create_dbt_staging: BEGIN
[0m23:51:45.432577 [debug] [ThreadPool]: On create_dbt_marts: BEGIN
[0m23:51:45.433101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:45.433101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:45.485276 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.485276 [debug] [ThreadPool]: Using postgres connection "create_dbt_staging"
[0m23:51:45.486255 [debug] [ThreadPool]: On create_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_staging"} */
create schema if not exists "staging"
[0m23:51:45.486255 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:51:45.487256 [debug] [ThreadPool]: On create_dbt_staging: COMMIT
[0m23:51:45.488255 [debug] [ThreadPool]: Using postgres connection "create_dbt_staging"
[0m23:51:45.488255 [debug] [ThreadPool]: On create_dbt_staging: COMMIT
[0m23:51:45.489256 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.489256 [debug] [ThreadPool]: On create_dbt_staging: Close
[0m23:51:45.518684 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.519735 [debug] [ThreadPool]: Using postgres connection "create_dbt_marts"
[0m23:51:45.519735 [debug] [ThreadPool]: On create_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_marts"} */
create schema if not exists "marts"
[0m23:51:45.520683 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:51:45.521684 [debug] [ThreadPool]: On create_dbt_marts: COMMIT
[0m23:51:45.521684 [debug] [ThreadPool]: Using postgres connection "create_dbt_marts"
[0m23:51:45.521684 [debug] [ThreadPool]: On create_dbt_marts: COMMIT
[0m23:51:45.523189 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.523189 [debug] [ThreadPool]: On create_dbt_marts: Close
[0m23:51:45.524712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m23:51:45.525716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m23:51:45.529715 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:51:45.530715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m23:51:45.531717 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m23:51:45.531717 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m23:51:45.533220 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m23:51:45.534224 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m23:51:45.534224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:45.534224 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m23:51:45.534224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:45.535225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:45.582306 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.582306 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m23:51:45.583392 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:51:45.585562 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:45.586562 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m23:51:45.586562 [debug] [ThreadPool]: On list_dbt_public: Close
[0m23:51:45.611202 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.611202 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m23:51:45.612707 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:51:45.615224 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:51:45.615224 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m23:51:45.616226 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m23:51:45.640788 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.640788 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m23:51:45.642292 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m23:51:45.644842 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:51:45.644842 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m23:51:45.645848 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m23:51:45.648846 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:45.649846 [debug] [MainThread]: On master: BEGIN
[0m23:51:45.649846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:45.696286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.696286 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:45.696286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:45.699793 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:45.700793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFF62E00>]}
[0m23:51:45.700793 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:45.702295 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:45.702295 [debug] [MainThread]: On master: BEGIN
[0m23:51:45.702295 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.703300 [debug] [MainThread]: On master: COMMIT
[0m23:51:45.703300 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:45.703300 [debug] [MainThread]: On master: COMMIT
[0m23:51:45.704318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.704318 [debug] [MainThread]: On master: Close
[0m23:51:45.705319 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m23:51:45.705319 [info ] [MainThread]: 
[0m23:51:45.707319 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m23:51:45.708320 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m23:51:45.709320 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m23:51:45.709320 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m23:51:45.714580 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m23:51:45.715464 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 23:51:45.709320 => 23:51:45.715464
[0m23:51:45.715464 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m23:51:45.739941 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m23:51:45.740942 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:51:45.740942 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m23:51:45.740942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:45.790609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.790609 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:51:45.791610 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc
    from source     
)

select * from renamed
  );
  
[0m23:51:45.797616 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m23:51:45.803624 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:51:45.803624 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m23:51:45.803624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:45.814640 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:51:45.815641 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:51:45.815641 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m23:51:45.816740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.820744 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m23:51:45.823754 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m23:51:45.823754 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m23:51:45.824758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:51:45.825758 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 23:51:45.716465 => 23:51:45.825758
[0m23:51:45.825758 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m23:51:45.826757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABD022FFD0>]}
[0m23:51:45.827759 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m23:51:45.827759 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m23:51:45.828759 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m23:51:45.829759 [info ] [Thread-3 (]: 2 of 4 START sql table model staging.stg_web__transactions ..................... [RUN]
[0m23:51:45.829759 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m23:51:45.830759 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m23:51:45.832261 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m23:51:45.833264 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 23:51:45.830759 => 23:51:45.833264
[0m23:51:45.833264 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m23:51:45.836369 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m23:51:45.837370 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:51:45.838375 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m23:51:45.838375 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:51:45.890626 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.891627 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:51:45.891627 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m23:51:45.898990 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m23:51:45.900988 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:51:45.900988 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m23:51:45.900988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:45.903495 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:51:45.903495 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:51:45.904411 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m23:51:45.904515 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.906515 [debug] [Thread-3 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m23:51:45.907515 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m23:51:45.907515 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m23:51:45.907515 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:51:45.908516 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 23:51:45.834369 => 23:51:45.908516
[0m23:51:45.909516 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m23:51:45.909516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABD048DF00>]}
[0m23:51:45.910516 [info ] [Thread-3 (]: 2 of 4 OK created sql table model staging.stg_web__transactions ................ [[32mSELECT 101[0m in 0.08s]
[0m23:51:45.911517 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m23:51:45.911517 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m23:51:45.912516 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m23:51:45.913174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m23:51:45.913174 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m23:51:45.915179 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.916177 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 23:51:45.913174 => 23:51:45.916177
[0m23:51:45.916177 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m23:51:45.928725 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.929723 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.930724 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m23:51:45.930724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:45.979211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:45.980212 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.980212 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m23:51:45.982716 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:51:45.985291 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.985291 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m23:51:45.985291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:45.987289 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:51:45.987289 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.987289 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m23:51:45.988486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:45.989491 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m23:51:45.991490 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m23:51:45.992490 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m23:51:45.993171 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:51:45.994175 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 23:51:45.917178 => 23:51:45.993171
[0m23:51:45.994175 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m23:51:45.995176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFF30A90>]}
[0m23:51:45.995176 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.08s]
[0m23:51:45.996185 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m23:51:45.996185 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m23:51:45.996185 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m23:51:45.997690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m23:51:45.997690 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m23:51:46.000693 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m23:51:46.001693 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 23:51:45.998695 => 23:51:46.001693
[0m23:51:46.002695 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m23:51:46.005209 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m23:51:46.005209 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:51:46.006208 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m23:51:46.006208 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:46.053541 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:46.054545 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:51:46.054545 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m23:51:46.061117 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m23:51:46.064754 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:51:46.064754 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m23:51:46.065753 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:46.066754 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m23:51:46.067753 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:51:46.067753 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m23:51:46.068754 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:46.069754 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m23:51:46.070753 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m23:51:46.072255 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m23:51:46.072255 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:51:46.073259 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 23:51:46.002695 => 23:51:46.073259
[0m23:51:46.073259 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m23:51:46.074278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee353433-f62b-4b72-9cc5-6b38bf029d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABD057FFD0>]}
[0m23:51:46.075284 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.08s]
[0m23:51:46.075284 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m23:51:46.076283 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:46.077284 [debug] [MainThread]: On master: BEGIN
[0m23:51:46.077284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:46.123480 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:46.124506 [debug] [MainThread]: On master: COMMIT
[0m23:51:46.124506 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:46.125506 [debug] [MainThread]: On master: COMMIT
[0m23:51:46.125506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:46.125506 [debug] [MainThread]: On master: Close
[0m23:51:46.126506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:46.126506 [debug] [MainThread]: Connection 'create_dbt_staging' was properly closed.
[0m23:51:46.127507 [debug] [MainThread]: Connection 'create_dbt_marts' was properly closed.
[0m23:51:46.127507 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m23:51:46.127507 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m23:51:46.127507 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m23:51:46.128507 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m23:51:46.128507 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m23:51:46.128507 [info ] [MainThread]: 
[0m23:51:46.129508 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m23:51:46.130506 [debug] [MainThread]: Command end result
[0m23:51:46.136935 [info ] [MainThread]: 
[0m23:51:46.136935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:46.136935 [info ] [MainThread]: 
[0m23:51:46.137935 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:51:46.138935 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:46.138935 after 1.95 seconds
[0m23:51:46.138935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCC787220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABCFC852D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABD00453F0>]}
[0m23:51:46.139936 [debug] [MainThread]: Flushing usage events
[0m00:14:11.230318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189D7EA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB1AAD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB1AAB00>]}


============================== 00:14:11.233458 | 5d7aa623-3ded-48d5-9c11-9835d9d67d14 ==============================
[0m00:14:11.233458 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:14:11.234580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:11.360829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB1AADA0>]}
[0m00:14:11.420681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB1A8D60>]}
[0m00:14:11.421681 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:14:11.431691 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:14:11.513420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:14:11.513420 [debug] [MainThread]: Partial parsing: added file: customer360://snapshots\stg_sf__contacts_snapshot.sql
[0m00:14:11.514403 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\stg_sf__contacts.sql
[0m00:14:11.791551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DBAF40D0>]}
[0m00:14:11.799293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB6101C0>]}
[0m00:14:11.799293 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:14:11.800294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB6105B0>]}
[0m00:14:11.801298 [info ] [MainThread]: 
[0m00:14:11.801298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:11.803522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:14:11.809485 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:14:11.810486 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:14:11.810486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:11.871341 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m00:14:11.872950 [debug] [ThreadPool]: On list_dbt: Close
[0m00:14:11.873550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_snapshots)
[0m00:14:11.874643 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "snapshots"
"
[0m00:14:11.877614 [debug] [ThreadPool]: Using postgres connection "create_dbt_snapshots"
[0m00:14:11.878613 [debug] [ThreadPool]: On create_dbt_snapshots: BEGIN
[0m00:14:11.878613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:11.931211 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:11.931211 [debug] [ThreadPool]: Using postgres connection "create_dbt_snapshots"
[0m00:14:11.931211 [debug] [ThreadPool]: On create_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "create_dbt_snapshots"} */
create schema if not exists "snapshots"
[0m00:14:11.932715 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:14:11.932715 [debug] [ThreadPool]: On create_dbt_snapshots: COMMIT
[0m00:14:11.933760 [debug] [ThreadPool]: Using postgres connection "create_dbt_snapshots"
[0m00:14:11.933760 [debug] [ThreadPool]: On create_dbt_snapshots: COMMIT
[0m00:14:11.934266 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:14:11.934266 [debug] [ThreadPool]: On create_dbt_snapshots: Close
[0m00:14:11.936271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:14:11.937272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:14:11.940781 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:14:11.940781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:14:11.942781 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:14:11.943286 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:14:11.943790 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:14:11.944795 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:14:11.944795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:11.945308 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:14:11.945308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:11.946312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:11.991636 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:11.992636 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:14:11.993176 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:14:11.994762 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:11.995734 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:14:11.996732 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:14:11.997732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_staging, now list_dbt_snapshots)
[0m00:14:11.999733 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:14:11.999733 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:14:12.000773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:12.071637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.072636 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:14:12.073143 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:14:12.074731 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:12.075661 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:14:12.076661 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:14:12.101116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.101116 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:14:12.101116 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:14:12.104149 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:14:12.105155 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:14:12.105155 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:14:12.131866 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.131866 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:14:12.132868 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:14:12.134994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:12.135895 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:14:12.135895 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:14:12.140405 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.140405 [debug] [MainThread]: On master: BEGIN
[0m00:14:12.140405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:12.190855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.191855 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.191855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:14:12.195432 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:12.196462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DBB76AA0>]}
[0m00:14:12.196462 [debug] [MainThread]: On master: ROLLBACK
[0m00:14:12.197462 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.197462 [debug] [MainThread]: On master: BEGIN
[0m00:14:12.197462 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.198461 [debug] [MainThread]: On master: COMMIT
[0m00:14:12.198461 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.199446 [debug] [MainThread]: On master: COMMIT
[0m00:14:12.199446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:14:12.199446 [debug] [MainThread]: On master: Close
[0m00:14:12.200464 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:14:12.201445 [info ] [MainThread]: 
[0m00:14:12.203474 [debug] [Thread-1 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:12.203474 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stg_sf__contacts_snapshot ...................... [RUN]
[0m00:14:12.204490 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.customer360.stg_sf__contacts_snapshot'
[0m00:14:12.204490 [debug] [Thread-1 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:12.210483 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:14:12.205486 => 00:14:12.210483
[0m00:14:12.210483 [debug] [Thread-1 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:12.239285 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:12.241285 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:12.241285 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:14:12.241285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:12.291181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.291181 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:12.291181 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."stg_sf__contacts_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        





select * from "dbt"."staging"."stg_sf__contacts"

    ) sbq



  );
  
  
[0m00:14:12.292685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                          ^

[0m00:14:12.292685 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: ROLLBACK
[0m00:14:12.294196 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:14:12.211506 => 00:14:12.293691
[0m00:14:12.294196 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:14:12.296208 [debug] [Thread-1 (]: Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:14:12.297201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d7aa623-3ded-48d5-9c11-9835d9d67d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB5F35E0>]}
[0m00:14:12.297201 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stg_sf__contacts_snapshot .................. [[31mERROR[0m in 0.09s]
[0m00:14:12.298228 [debug] [Thread-1 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:12.299228 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.300202 [debug] [MainThread]: On master: BEGIN
[0m00:14:12.300202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:12.473483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:12.473483 [debug] [MainThread]: On master: COMMIT
[0m00:14:12.474437 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:12.474437 [debug] [MainThread]: On master: COMMIT
[0m00:14:12.474940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:14:12.474940 [debug] [MainThread]: On master: Close
[0m00:14:12.475943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:12.475943 [debug] [MainThread]: Connection 'create_dbt_snapshots' was properly closed.
[0m00:14:12.475943 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:14:12.476944 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:14:12.476944 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:14:12.476944 [debug] [MainThread]: Connection 'snapshot.customer360.stg_sf__contacts_snapshot' was properly closed.
[0m00:14:12.476944 [info ] [MainThread]: 
[0m00:14:12.477944 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m00:14:12.478945 [debug] [MainThread]: Command end result
[0m00:14:12.484449 [info ] [MainThread]: 
[0m00:14:12.485449 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:12.485449 [info ] [MainThread]: 
[0m00:14:12.486451 [error] [MainThread]:   Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:14:12.487450 [info ] [MainThread]: 
[0m00:14:12.487450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:14:12.488450 [debug] [MainThread]: Command `dbt snapshot` failed at 00:14:12.488450 after 1.30 seconds
[0m00:14:12.489454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189D7EA5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB1A8D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB6106D0>]}
[0m00:14:12.489454 [debug] [MainThread]: Flushing usage events
[0m00:14:41.217892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A708884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70BB82DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70BB82B30>]}


============================== 00:14:41.220897 | 04c89046-5c46-4b02-96b5-aebb2536d04d ==============================
[0m00:14:41.220897 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:14:41.220897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:41.345922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7048C2E00>]}
[0m00:14:41.403942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70BDCA440>]}
[0m00:14:41.404942 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:14:41.414941 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:14:41.494453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:41.495453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:41.499454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C022140>]}
[0m00:14:41.507453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70BFE85E0>]}
[0m00:14:41.508454 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:14:41.510455 [info ] [MainThread]: 
[0m00:14:41.511455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:41.512455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:14:41.512455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:14:41.513453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:14:41.519454 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:14:41.521455 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:14:41.522453 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:14:41.523454 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:14:41.523454 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:14:41.524454 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:14:41.524454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.524454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.525454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.585428 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:14:41.586428 [debug] [ThreadPool]: On list_dbt: Close
[0m00:14:41.588428 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:14:41.588428 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:14:41.589428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.617508 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:14:41.619508 [debug] [ThreadPool]: On list_dbt: Close
[0m00:14:41.641508 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:14:41.642508 [debug] [ThreadPool]: On list_dbt: Close
[0m00:14:41.672018 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:14:41.673018 [debug] [ThreadPool]: On list_dbt: Close
[0m00:14:41.675023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:14:41.675023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:14:41.676019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m00:14:41.680018 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:14:41.681018 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:14:41.683018 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:14:41.683018 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:14:41.684018 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:14:41.684018 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:14:41.684018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.685019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.685019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:41.732018 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.733019 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:14:41.733019 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:14:41.735018 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:41.736019 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:14:41.737022 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:14:41.737022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_staging, now list_dbt_public)
[0m00:14:41.739019 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:14:41.740018 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:14:41.740018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.763527 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.764527 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:14:41.764527 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:14:41.766528 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:41.767527 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:14:41.767527 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:14:41.799528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.799528 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:14:41.800528 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:14:41.802528 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:14:41.803528 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:14:41.803528 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:14:41.830527 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.830527 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:14:41.830527 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:14:41.833527 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:41.834528 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:14:41.834528 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:14:41.838529 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:41.838529 [debug] [MainThread]: On master: BEGIN
[0m00:14:41.838529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:41.885036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.885036 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:41.886036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:14:41.889036 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:14:41.890036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C012230>]}
[0m00:14:41.890036 [debug] [MainThread]: On master: ROLLBACK
[0m00:14:41.891036 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:41.891036 [debug] [MainThread]: On master: BEGIN
[0m00:14:41.891036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.892036 [debug] [MainThread]: On master: COMMIT
[0m00:14:41.892036 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:41.892036 [debug] [MainThread]: On master: COMMIT
[0m00:14:41.893036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:14:41.893036 [debug] [MainThread]: On master: Close
[0m00:14:41.893036 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:14:41.894036 [info ] [MainThread]: 
[0m00:14:41.896036 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m00:14:41.896036 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m00:14:41.897036 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:14:41.897036 [info ] [Thread-1 (]: 1 of 24 START seed file public.contacts ........................................ [RUN]
[0m00:14:41.898036 [info ] [Thread-2 (]: 2 of 24 START seed file public.transactions .................................... [RUN]
[0m00:14:41.899036 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m00:14:41.898036 [info ] [Thread-3 (]: 3 of 24 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m00:14:41.899036 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m00:14:41.900036 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m00:14:41.901036 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m00:14:41.901036 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m00:14:41.902036 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 00:14:41.901036 => 00:14:41.901036
[0m00:14:41.902036 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:14:41.902036 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 00:14:41.902036 => 00:14:41.902036
[0m00:14:41.903036 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m00:14:41.915035 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:14:41.915035 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m00:14:41.934035 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:14:41.937036 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 00:14:41.903036 => 00:14:41.936036
[0m00:14:41.937036 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m00:14:41.940037 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:14:41.941036 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:14:41.941036 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:41.941036 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m00:14:41.951054 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:14:41.951054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:14:41.953040 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:14:41.953040 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m00:14:41.954040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:14:41.999545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:41.999545 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:14:42.000545 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m00:14:42.029545 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.029545 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:14:42.030545 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m00:14:42.033546 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m00:14:42.054549 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m00:14:42.055550 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:14:42.102054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.133511 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m00:14:42.150515 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:14:42.151514 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:14:42.151514 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m00:14:42.151514 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m00:14:42.152514 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m00:14:42.156513 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m00:14:42.156513 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m00:14:42.157514 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m00:14:42.166025 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m00:14:42.167023 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:14:42.167023 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m00:14:42.168025 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m00:14:42.168025 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:14:42.169024 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m00:14:42.169024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:42.170024 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 00:14:41.916036 => 00:14:42.170024
[0m00:14:42.170024 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:42.171025 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.171025 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m00:14:42.172025 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 00:14:41.935036 => 00:14:42.172025
[0m00:14:42.173024 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 00:14:41.942036 => 00:14:42.173024
[0m00:14:42.174025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C0DB850>]}
[0m00:14:42.174025 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m00:14:42.174025 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m00:14:42.176030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C09A5C0>]}
[0m00:14:42.175025 [info ] [Thread-1 (]: 1 of 24 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.28s]
[0m00:14:42.176030 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m00:14:42.177025 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m00:14:42.176030 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m00:14:42.178025 [info ] [Thread-3 (]: 3 of 24 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m00:14:42.178025 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:14:42.179151 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m00:14:42.179151 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:14:42.180155 [info ] [Thread-1 (]: 4 of 24 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m00:14:42.180155 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:14:42.181155 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:14:42.181155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m00:14:42.182156 [info ] [Thread-2 (]: 5 of 24 START test source_not_null_web_transactions_id ......................... [RUN]
[0m00:14:42.182156 [info ] [Thread-3 (]: 6 of 24 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m00:14:42.183155 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:14:42.183155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m00:14:42.184156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m00:14:42.189154 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:14:42.189154 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:14:42.190155 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:14:42.193156 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:14:42.193156 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 00:14:42.184156 => 00:14:42.193156
[0m00:14:42.197156 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:14:42.198156 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:14:42.198156 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 00:14:42.190155 => 00:14:42.198156
[0m00:14:42.200156 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:14:42.200156 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 00:14:42.193156 => 00:14:42.200156
[0m00:14:42.201154 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:14:42.201154 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:14:42.203155 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:14:42.203155 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:14:42.205155 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:14:42.205155 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m00:14:42.206156 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:14:42.206156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:42.206156 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m00:14:42.207156 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:14:42.207156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:42.207156 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m00:14:42.208157 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:42.253158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.253158 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:14:42.254158 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m00:14:42.254158 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.256159 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 00:14:42.199156 => 00:14:42.256159
[0m00:14:42.257159 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m00:14:42.257159 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m00:14:42.258158 [info ] [Thread-1 (]: 4 of 24 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m00:14:42.259157 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:14:42.259157 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:14:42.260158 [info ] [Thread-1 (]: 7 of 24 START test source_unique_web_transactions_id ........................... [RUN]
[0m00:14:42.260158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m00:14:42.260158 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:14:42.263698 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:14:42.264698 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 00:14:42.261437 => 00:14:42.264698
[0m00:14:42.264698 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:14:42.266700 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:14:42.267699 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:14:42.267699 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m00:14:42.268699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:42.284698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.284698 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:14:42.285700 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m00:14:42.286701 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.287700 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 00:14:42.201154 => 00:14:42.287700
[0m00:14:42.287700 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m00:14:42.288699 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m00:14:42.288699 [info ] [Thread-2 (]: 5 of 24 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m00:14:42.289700 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:14:42.314698 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.315698 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:14:42.315698 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:42.316698 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.317698 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 00:14:42.203155 => 00:14:42.317698
[0m00:14:42.318698 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m00:14:42.318698 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m00:14:42.319698 [warn ] [Thread-3 (]: 6 of 24 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m00:14:42.320698 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:14:42.320698 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m00:14:42.321698 [info ] [Thread-2 (]: 8 of 24 START sql table model staging.stg_sf__contacts ......................... [RUN]
[0m00:14:42.322698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m00:14:42.322698 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m00:14:42.324698 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m00:14:42.325699 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 00:14:42.322698 => 00:14:42.325699
[0m00:14:42.326699 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m00:14:42.348207 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m00:14:42.348207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.349208 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.349208 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:14:42.349208 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m00:14:42.350207 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:42.350207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:42.352207 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.353209 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 00:14:42.265699 => 00:14:42.353209
[0m00:14:42.353209 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m00:14:42.354208 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m00:14:42.355209 [info ] [Thread-1 (]: 7 of 24 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m00:14:42.355209 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:14:42.407714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.408715 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.408715 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as unpdated_at
    from source     
)

select * from renamed
  );
  
[0m00:14:42.443507 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m00:14:42.447511 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.448512 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m00:14:42.448512 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:42.450511 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.451511 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m00:14:42.451511 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:42.456511 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:14:42.456511 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.457510 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:14:42.457510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:42.462018 [debug] [Thread-2 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m00:14:42.465017 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:14:42.466017 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m00:14:42.468018 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:14:42.469017 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 00:14:42.326699 => 00:14:42.468018
[0m00:14:42.469017 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m00:14:42.470017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C0B44F0>]}
[0m00:14:42.470017 [info ] [Thread-2 (]: 8 of 24 OK created sql table model staging.stg_sf__contacts .................... [[32mSELECT 11[0m in 0.15s]
[0m00:14:42.471018 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m00:14:42.472019 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:14:42.472019 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:14:42.472019 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m00:14:42.473018 [info ] [Thread-1 (]: 10 of 24 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m00:14:42.473018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m00:14:42.474018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m00:14:42.474018 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:14:42.475018 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:14:42.478017 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:14:42.480019 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:14:42.481019 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 00:14:42.475018 => 00:14:42.481019
[0m00:14:42.482017 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:14:42.482017 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 00:14:42.478017 => 00:14:42.482017
[0m00:14:42.484017 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:14:42.485017 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:14:42.486018 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:14:42.487017 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:14:42.487017 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m00:14:42.488018 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:14:42.488018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:42.488018 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m00:14:42.489017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:42.544017 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.545018 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:14:42.545018 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."staging"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m00:14:42.546024 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.547021 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 00:14:42.482017 => 00:14:42.547021
[0m00:14:42.548022 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m00:14:42.548022 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m00:14:42.549022 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.08s]
[0m00:14:42.550023 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:14:42.568527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.569529 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:14:42.569529 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:42.570528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.572528 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 00:14:42.485017 => 00:14:42.571528
[0m00:14:42.572528 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m00:14:42.572528 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m00:14:42.573527 [info ] [Thread-1 (]: 10 of 24 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m00:14:42.574529 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:14:42.574529 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m00:14:42.575529 [debug] [Thread-3 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:42.575529 [info ] [Thread-2 (]: 11 of 24 START sql table model staging.stg_web__transactions ................... [RUN]
[0m00:14:42.576529 [info ] [Thread-3 (]: 12 of 24 START snapshot snapshots.stg_sf__contacts_snapshot .................... [RUN]
[0m00:14:42.576529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m00:14:42.577529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now snapshot.customer360.stg_sf__contacts_snapshot)
[0m00:14:42.578528 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m00:14:42.578528 [debug] [Thread-3 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:42.581527 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m00:14:42.583527 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:14:42.581527 => 00:14:42.583527
[0m00:14:42.584527 [debug] [Thread-3 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:42.590528 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 00:14:42.578528 => 00:14:42.590528
[0m00:14:42.606527 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:42.607528 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m00:14:42.610528 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m00:14:42.610528 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:42.610528 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:14:42.611528 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.611528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:42.611528 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m00:14:42.612527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:42.658532 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.658532 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:14:42.658532 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."stg_sf__contacts_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        





select * from "dbt"."staging"."stg_sf__contacts"

    ) sbq



  );
  
  
[0m00:14:42.659532 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                          ^
HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".

[0m00:14:42.660532 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: ROLLBACK
[0m00:14:42.661035 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:14:42.584527 => 00:14:42.661035
[0m00:14:42.661035 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:14:42.663039 [debug] [Thread-3 (]: Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:14:42.664039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C2C12D0>]}
[0m00:14:42.664039 [error] [Thread-3 (]: 12 of 24 ERROR snapshotting snapshots.stg_sf__contacts_snapshot ................ [[31mERROR[0m in 0.09s]
[0m00:14:42.665039 [debug] [Thread-3 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:14:42.691038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.691038 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.692038 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m00:14:42.726142 [debug] [Thread-2 (]: SQL status: SELECT 101 in 0.0 seconds
[0m00:14:42.729145 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.730145 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m00:14:42.730145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:42.732145 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.733145 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m00:14:42.733145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:42.735145 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:14:42.735145 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.735145 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:14:42.736145 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:42.738145 [debug] [Thread-2 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m00:14:42.738145 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:14:42.739145 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m00:14:42.739933 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:14:42.740938 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 00:14:42.607528 => 00:14:42.740938
[0m00:14:42.741938 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m00:14:42.741938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C257C10>]}
[0m00:14:42.742937 [info ] [Thread-2 (]: 11 of 24 OK created sql table model staging.stg_web__transactions .............. [[32mSELECT 101[0m in 0.17s]
[0m00:14:42.742937 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m00:14:42.743937 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:14:42.743937 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:14:42.744938 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:14:42.744938 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m00:14:42.745942 [info ] [Thread-3 (]: 14 of 24 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m00:14:42.745942 [info ] [Thread-2 (]: 15 of 24 START test unique_stg_web__transactions_id ............................ [RUN]
[0m00:14:42.746942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m00:14:42.746942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.customer360.stg_sf__contacts_snapshot, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m00:14:42.747942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m00:14:42.747942 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:14:42.747942 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:14:42.748942 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:14:42.751941 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:14:42.757943 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:14:42.760444 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:14:42.760444 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 00:14:42.748942 => 00:14:42.760444
[0m00:14:42.761447 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:14:42.761447 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 00:14:42.751941 => 00:14:42.761447
[0m00:14:42.762447 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 00:14:42.757943 => 00:14:42.761447
[0m00:14:42.763447 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:14:42.764447 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:14:42.764447 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:14:42.766448 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:14:42.767448 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:14:42.767448 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:14:42.768448 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:14:42.768448 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m00:14:42.769447 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:14:42.769447 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m00:14:42.770447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:42.770447 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m00:14:42.770447 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:42.771447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:42.817701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.817701 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:14:42.818701 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."staging"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m00:14:42.819701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.820701 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 00:14:42.762447 => 00:14:42.820701
[0m00:14:42.820701 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m00:14:42.821701 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m00:14:42.821701 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.07s]
[0m00:14:42.822701 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:14:42.823720 [debug] [Thread-1 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:14:42.823720 [info ] [Thread-1 (]: 16 of 24 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m00:14:42.824703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m00:14:42.824703 [debug] [Thread-1 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:14:42.828706 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:14:42.829710 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 00:14:42.825706 => 00:14:42.828706
[0m00:14:42.829710 [debug] [Thread-1 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:14:42.831710 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:14:42.831710 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:14:42.832711 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m00:14:42.832711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:42.847216 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.848216 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:14:42.848216 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."staging"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."staging"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:14:42.850218 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.851216 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 00:14:42.764447 => 00:14:42.851216
[0m00:14:42.851216 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m00:14:42.852216 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m00:14:42.852216 [info ] [Thread-3 (]: 14 of 24 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m00:14:42.853217 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:14:42.877230 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.878230 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:14:42.878230 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:42.879230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.880230 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 00:14:42.766448 => 00:14:42.880230
[0m00:14:42.881231 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m00:14:42.881231 [debug] [Thread-2 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m00:14:42.882230 [info ] [Thread-2 (]: 15 of 24 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.13s]
[0m00:14:42.883231 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:14:42.916231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.916231 [debug] [Thread-1 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:14:42.917230 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."staging"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m00:14:42.918231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:42.919231 [debug] [Thread-1 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 00:14:42.829710 => 00:14:42.919231
[0m00:14:42.919231 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m00:14:42.920230 [debug] [Thread-1 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m00:14:42.920230 [info ] [Thread-1 (]: 16 of 24 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m00:14:42.921232 [debug] [Thread-1 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:14:42.922409 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m00:14:42.922409 [info ] [Thread-3 (]: 17 of 24 START sql view model marts.contacts_joined_with_transactions .......... [RUN]
[0m00:14:42.923413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m00:14:42.924414 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m00:14:42.926413 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.927412 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 00:14:42.924414 => 00:14:42.927412
[0m00:14:42.927412 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m00:14:42.939412 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.940412 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.940412 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m00:14:42.941412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:42.988385 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:42.989346 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.989346 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m00:14:42.991344 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:14:42.993344 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.994344 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m00:14:42.994344 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:42.995344 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:14:42.996344 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:14:42.996344 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:14:42.997223 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:42.998228 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m00:14:43.000227 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:14:43.001227 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m00:14:43.001227 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:14:43.002227 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 00:14:42.927412 => 00:14:43.002227
[0m00:14:43.003228 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m00:14:43.003228 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C09A710>]}
[0m00:14:43.004228 [info ] [Thread-3 (]: 17 of 24 OK created sql view model marts.contacts_joined_with_transactions ..... [[32mCREATE VIEW[0m in 0.08s]
[0m00:14:43.005229 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m00:14:43.005229 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:14:43.006228 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:14:43.006228 [info ] [Thread-1 (]: 18 of 24 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m00:14:43.006228 [info ] [Thread-2 (]: 19 of 24 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m00:14:43.007228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m00:14:43.008228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m00:14:43.008228 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:14:43.008228 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:14:43.011227 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:14:43.014229 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:14:43.015228 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 00:14:43.009229 => 00:14:43.015228
[0m00:14:43.015228 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:14:43.016228 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 00:14:43.012228 => 00:14:43.015228
[0m00:14:43.017227 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:14:43.018227 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:14:43.019229 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:14:43.020229 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:14:43.020229 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m00:14:43.021229 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:14:43.021229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:43.021229 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m00:14:43.022227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:43.071339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.071339 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:14:43.072338 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m00:14:43.073339 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.074339 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 00:14:43.016228 => 00:14:43.074339
[0m00:14:43.075340 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m00:14:43.075340 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m00:14:43.076339 [info ] [Thread-1 (]: 18 of 24 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.07s]
[0m00:14:43.077338 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:14:43.103339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.103339 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:14:43.104339 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:43.105340 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.106339 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 00:14:43.018227 => 00:14:43.106339
[0m00:14:43.107340 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m00:14:43.107340 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m00:14:43.108340 [info ] [Thread-2 (]: 19 of 24 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.10s]
[0m00:14:43.109338 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:14:43.109338 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m00:14:43.110338 [info ] [Thread-3 (]: 20 of 24 START sql table model marts.customers ................................. [RUN]
[0m00:14:43.111339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m00:14:43.111339 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m00:14:43.117337 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m00:14:43.117337 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 00:14:43.111339 => 00:14:43.117337
[0m00:14:43.118337 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m00:14:43.120339 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m00:14:43.121339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.121339 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m00:14:43.122339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:43.169846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.170847 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.170847 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m00:14:43.180247 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m00:14:43.183250 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.183250 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m00:14:43.183250 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:43.186250 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.186250 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m00:14:43.186250 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:14:43.188251 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:14:43.188251 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.188251 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:14:43.189250 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:14:43.191250 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m00:14:43.191250 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:14:43.192250 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m00:14:43.193251 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:14:43.194251 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 00:14:43.118337 => 00:14:43.194251
[0m00:14:43.194251 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m00:14:43.195250 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04c89046-5c46-4b02-96b5-aebb2536d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C2677F0>]}
[0m00:14:43.196252 [info ] [Thread-3 (]: 20 of 24 OK created sql table model marts.customers ............................ [[32mSELECT 9[0m in 0.08s]
[0m00:14:43.196252 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m00:14:43.197252 [debug] [Thread-2 (]: Began running node test.customer360.check_first_purchase_date
[0m00:14:43.197252 [debug] [Thread-1 (]: Began running node test.customer360.check_last_purchase_date
[0m00:14:43.198252 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m00:14:43.198252 [info ] [Thread-2 (]: 21 of 24 START test check_first_purchase_date .................................. [RUN]
[0m00:14:43.198252 [info ] [Thread-1 (]: 22 of 24 START test check_last_purchase_date ................................... [RUN]
[0m00:14:43.199251 [info ] [Thread-3 (]: 23 of 24 START test check_purchase_amount_above_zero ........................... [RUN]
[0m00:14:43.199251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_first_purchase_date)
[0m00:14:43.200252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_last_purchase_date)
[0m00:14:43.200252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m00:14:43.201252 [debug] [Thread-2 (]: Began compiling node test.customer360.check_first_purchase_date
[0m00:14:43.201252 [debug] [Thread-1 (]: Began compiling node test.customer360.check_last_purchase_date
[0m00:14:43.202251 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m00:14:43.204252 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m00:14:43.205251 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m00:14:43.208252 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m00:14:43.208252 [debug] [Thread-2 (]: Timing info for test.customer360.check_first_purchase_date (compile): 00:14:43.202251 => 00:14:43.208252
[0m00:14:43.209252 [debug] [Thread-2 (]: Began executing node test.customer360.check_first_purchase_date
[0m00:14:43.209252 [debug] [Thread-1 (]: Timing info for test.customer360.check_last_purchase_date (compile): 00:14:43.204252 => 00:14:43.209252
[0m00:14:43.210251 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 00:14:43.206250 => 00:14:43.209252
[0m00:14:43.211251 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m00:14:43.211251 [debug] [Thread-1 (]: Began executing node test.customer360.check_last_purchase_date
[0m00:14:43.212252 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m00:14:43.213251 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m00:14:43.214251 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m00:14:43.215252 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m00:14:43.216251 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m00:14:43.216251 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m00:14:43.216251 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m00:14:43.217252 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m00:14:43.217252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:43.218251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:43.218251 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m00:14:43.219251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:14:43.266762 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.266762 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m00:14:43.267761 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m00:14:43.269763 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.270761 [debug] [Thread-2 (]: Timing info for test.customer360.check_first_purchase_date (execute): 00:14:43.210251 => 00:14:43.270761
[0m00:14:43.270761 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m00:14:43.271760 [debug] [Thread-2 (]: On test.customer360.check_first_purchase_date: Close
[0m00:14:43.271760 [info ] [Thread-2 (]: 21 of 24 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.07s]
[0m00:14:43.272760 [debug] [Thread-2 (]: Finished running node test.customer360.check_first_purchase_date
[0m00:14:43.273760 [debug] [Thread-2 (]: Began running node test.customer360.check_valid_customers
[0m00:14:43.273760 [info ] [Thread-2 (]: 24 of 24 START test check_valid_customers ...................................... [RUN]
[0m00:14:43.274761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m00:14:43.274761 [debug] [Thread-2 (]: Began compiling node test.customer360.check_valid_customers
[0m00:14:43.276760 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m00:14:43.277761 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (compile): 00:14:43.274761 => 00:14:43.277761
[0m00:14:43.277761 [debug] [Thread-2 (]: Began executing node test.customer360.check_valid_customers
[0m00:14:43.279760 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m00:14:43.280762 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m00:14:43.280762 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: BEGIN
[0m00:14:43.280762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:14:43.300760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.300760 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m00:14:43.301761 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m00:14:43.303762 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.304761 [debug] [Thread-1 (]: Timing info for test.customer360.check_last_purchase_date (execute): 00:14:43.212252 => 00:14:43.304761
[0m00:14:43.304761 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m00:14:43.305760 [debug] [Thread-1 (]: On test.customer360.check_last_purchase_date: Close
[0m00:14:43.305760 [info ] [Thread-1 (]: 22 of 24 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.11s]
[0m00:14:43.306761 [debug] [Thread-1 (]: Finished running node test.customer360.check_last_purchase_date
[0m00:14:43.331762 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.332761 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m00:14:43.332761 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m00:14:43.333760 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.334761 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 00:14:43.214251 => 00:14:43.334761
[0m00:14:43.335760 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m00:14:43.335760 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m00:14:43.336761 [info ] [Thread-3 (]: 23 of 24 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.14s]
[0m00:14:43.337761 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m00:14:43.368272 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.368272 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m00:14:43.369271 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."staging"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m00:14:43.370272 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:14:43.371271 [debug] [Thread-2 (]: Timing info for test.customer360.check_valid_customers (execute): 00:14:43.277761 => 00:14:43.371271
[0m00:14:43.371271 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m00:14:43.372271 [debug] [Thread-2 (]: On test.customer360.check_valid_customers: Close
[0m00:14:43.372271 [info ] [Thread-2 (]: 24 of 24 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.10s]
[0m00:14:43.373271 [debug] [Thread-2 (]: Finished running node test.customer360.check_valid_customers
[0m00:14:43.374271 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:43.375272 [debug] [MainThread]: On master: BEGIN
[0m00:14:43.375272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:43.431270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:14:43.432271 [debug] [MainThread]: On master: COMMIT
[0m00:14:43.432271 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:43.432271 [debug] [MainThread]: On master: COMMIT
[0m00:14:43.433270 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:14:43.433270 [debug] [MainThread]: On master: Close
[0m00:14:43.434272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:43.434272 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:14:43.434272 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:14:43.435272 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:14:43.435272 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:14:43.435272 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:14:43.435272 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:14:43.436272 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m00:14:43.436272 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m00:14:43.436272 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m00:14:43.437272 [info ] [MainThread]: 
[0m00:14:43.437272 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 3 table models, 1 snapshot, 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m00:14:43.440271 [debug] [MainThread]: Command end result
[0m00:14:43.447276 [info ] [MainThread]: 
[0m00:14:43.447276 [info ] [MainThread]: [31mCompleted with 1 error and 1 warning:[0m
[0m00:14:43.448275 [info ] [MainThread]: 
[0m00:14:43.448275 [error] [MainThread]:   Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:14:43.449274 [info ] [MainThread]: 
[0m00:14:43.449274 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m00:14:43.450274 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m00:14:43.450274 [info ] [MainThread]: 
[0m00:14:43.450274 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m00:14:43.451274 [info ] [MainThread]: 
[0m00:14:43.451274 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=1 SKIP=0 TOTAL=24
[0m00:14:43.452273 [debug] [MainThread]: Command `dbt build` failed at 00:14:43.452273 after 2.27 seconds
[0m00:14:43.452273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A708884580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70C1CF760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A70BFE85E0>]}
[0m00:14:43.453274 [debug] [MainThread]: Flushing usage events
[0m00:15:40.755541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAC365090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAF65AD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAF65AB00>]}


============================== 00:15:40.758540 | 5e97fb80-4e94-493f-84ba-4109ca3eb7cb ==============================
[0m00:15:40.758540 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:15:40.758540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:15:40.880049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAF65ADA0>]}
[0m00:15:40.937557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAF658D60>]}
[0m00:15:40.938558 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:15:40.947558 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:15:41.029071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:41.030071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:41.034071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFB02110>]}
[0m00:15:41.042072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFAC85B0>]}
[0m00:15:41.042072 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:15:41.043071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFAC8D30>]}
[0m00:15:41.044070 [info ] [MainThread]: 
[0m00:15:41.045072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:15:41.046071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:15:41.047070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:15:41.053071 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:15:41.054071 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:15:41.055070 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:15:41.055070 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:15:41.055070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:41.056070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:41.114349 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:15:41.115349 [debug] [ThreadPool]: On list_dbt: Close
[0m00:15:41.137718 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:15:41.138718 [debug] [ThreadPool]: On list_dbt: Close
[0m00:15:41.140718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:15:41.141718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:15:41.145718 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:15:41.145718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:15:41.147719 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:15:41.147719 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:15:41.148719 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:15:41.149718 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:15:41.149718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:41.149718 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:15:41.150718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:41.150718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:41.197975 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.198964 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:15:41.198964 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:15:41.200998 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:15:41.201997 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:15:41.202995 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:15:41.203910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_staging, now list_dbt_snapshots)
[0m00:15:41.205994 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:15:41.205994 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:15:41.205994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:41.227542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.227542 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:15:41.228542 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:15:41.230542 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:15:41.231542 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:15:41.231542 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:15:41.258542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.258542 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:15:41.258542 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:15:41.261544 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:15:41.262542 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:15:41.262542 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:15:41.289542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.290541 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:15:41.290541 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:15:41.292542 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:15:41.293542 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:15:41.293542 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:15:41.298176 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:41.298176 [debug] [MainThread]: On master: BEGIN
[0m00:15:41.299173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:41.354770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.355770 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:41.355770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:15:41.358770 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:15:41.360770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFB8C220>]}
[0m00:15:41.360770 [debug] [MainThread]: On master: ROLLBACK
[0m00:15:41.360770 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:41.361770 [debug] [MainThread]: On master: BEGIN
[0m00:15:41.362273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.362273 [debug] [MainThread]: On master: COMMIT
[0m00:15:41.362273 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:41.363279 [debug] [MainThread]: On master: COMMIT
[0m00:15:41.363279 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:15:41.363279 [debug] [MainThread]: On master: Close
[0m00:15:41.364316 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:15:41.364316 [info ] [MainThread]: 
[0m00:15:41.366279 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m00:15:41.367731 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m00:15:41.367731 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m00:15:41.368737 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m00:15:41.373736 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m00:15:41.373736 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 00:15:41.368737 => 00:15:41.373736
[0m00:15:41.374736 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m00:15:41.398735 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m00:15:41.398735 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.399735 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m00:15:41.399735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:15:41.446276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.447232 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.447232 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as unpdated_at
    from source     
)

select * from renamed
  );
  
[0m00:15:41.528014 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m00:15:41.538980 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.539980 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m00:15:41.539980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.541979 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.542980 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m00:15:41.542980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.554979 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:15:41.554979 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.555979 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:15:41.556426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:15:41.560430 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m00:15:41.563431 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:15:41.564431 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m00:15:41.565430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:15:41.566431 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 00:15:41.374736 => 00:15:41.566431
[0m00:15:41.567430 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m00:15:41.567430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFBC5ED0>]}
[0m00:15:41.568430 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.20s]
[0m00:15:41.569430 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m00:15:41.569430 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m00:15:41.570430 [info ] [Thread-3 (]: 2 of 4 START sql table model staging.stg_web__transactions ..................... [RUN]
[0m00:15:41.571430 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m00:15:41.571430 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m00:15:41.574429 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m00:15:41.575480 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 00:15:41.571430 => 00:15:41.575480
[0m00:15:41.575480 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m00:15:41.578087 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m00:15:41.579091 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.579091 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m00:15:41.580091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:15:41.626142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.626142 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.627142 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m00:15:41.712494 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m00:15:41.719495 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.720488 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m00:15:41.720488 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.723996 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.724995 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m00:15:41.725669 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.726678 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:15:41.727676 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.727676 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:15:41.728676 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:15:41.729716 [debug] [Thread-3 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m00:15:41.730715 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:15:41.730715 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m00:15:41.732718 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:15:41.733677 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 00:15:41.575480 => 00:15:41.733677
[0m00:15:41.733677 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m00:15:41.734676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFC1BE20>]}
[0m00:15:41.734676 [info ] [Thread-3 (]: 2 of 4 OK created sql table model staging.stg_web__transactions ................ [[32mSELECT 101[0m in 0.16s]
[0m00:15:41.735677 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m00:15:41.736676 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m00:15:41.736676 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m00:15:41.737675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m00:15:41.737675 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m00:15:41.739674 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.740674 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 00:15:41.737675 => 00:15:41.740674
[0m00:15:41.740674 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m00:15:41.752676 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.753676 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.753676 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m00:15:41.753676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:41.801675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.801675 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.802675 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m00:15:41.804675 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:15:41.806677 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.806677 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m00:15:41.807676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.808681 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:15:41.808681 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.809681 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:15:41.809681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:15:41.811681 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m00:15:41.813681 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:15:41.813681 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m00:15:41.814681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:15:41.815681 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 00:15:41.740674 => 00:15:41.815681
[0m00:15:41.815681 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m00:15:41.816680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFBA0E80>]}
[0m00:15:41.816680 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.08s]
[0m00:15:41.817681 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m00:15:41.818680 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m00:15:41.818680 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m00:15:41.819680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m00:15:41.819680 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m00:15:41.824185 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m00:15:41.824185 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 00:15:41.819680 => 00:15:41.824185
[0m00:15:41.825185 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m00:15:41.827185 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m00:15:41.828186 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.828186 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m00:15:41.829184 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:15:41.876185 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:15:41.876185 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.877186 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m00:15:41.956378 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m00:15:41.959339 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.959339 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m00:15:41.960337 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.962375 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.963374 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m00:15:41.964338 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:15:41.965337 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:15:41.966336 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.967338 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:15:41.968339 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:15:41.970338 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m00:15:41.971338 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:15:41.972338 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m00:15:41.973337 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:15:41.975335 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 00:15:41.825185 => 00:15:41.974338
[0m00:15:41.975335 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m00:15:41.976337 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e97fb80-4e94-493f-84ba-4109ca3eb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFC27760>]}
[0m00:15:41.976337 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.16s]
[0m00:15:41.977339 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m00:15:41.979336 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:41.979336 [debug] [MainThread]: On master: BEGIN
[0m00:15:41.980337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:42.028882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:15:42.028882 [debug] [MainThread]: On master: COMMIT
[0m00:15:42.029883 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:42.029883 [debug] [MainThread]: On master: COMMIT
[0m00:15:42.030882 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:15:42.030882 [debug] [MainThread]: On master: Close
[0m00:15:42.031884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:42.031884 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:15:42.031884 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:15:42.031884 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:15:42.032884 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:15:42.032884 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:15:42.032884 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m00:15:42.033883 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m00:15:42.033883 [info ] [MainThread]: 
[0m00:15:42.033883 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m00:15:42.034883 [debug] [MainThread]: Command end result
[0m00:15:42.041884 [info ] [MainThread]: 
[0m00:15:42.041884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:15:42.042884 [info ] [MainThread]: 
[0m00:15:42.043883 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:15:42.044883 [debug] [MainThread]: Command `dbt run` succeeded at 00:15:42.043883 after 1.33 seconds
[0m00:15:42.044883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAC365090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAF658D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CAFAA7250>]}
[0m00:15:42.044883 [debug] [MainThread]: Flushing usage events
[0m00:16:25.707351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440BBA6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440EE9AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440EE9AAA0>]}


============================== 00:16:25.710349 | 609ef1d0-382c-419d-ab27-1539ea18be28 ==============================
[0m00:16:25.710349 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:16:25.711351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:25.831863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440EE9AD40>]}
[0m00:16:25.888006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440EE571C0>]}
[0m00:16:25.889006 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:16:25.899563 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:16:25.975722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:25.975722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:25.979723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F3420B0>]}
[0m00:16:25.987233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F308850>]}
[0m00:16:25.988234 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:16:25.988234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F308CD0>]}
[0m00:16:25.990234 [info ] [MainThread]: 
[0m00:16:25.991233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:16:25.992233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:16:25.998234 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:16:25.998234 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:16:25.998234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:26.052905 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:16:26.053906 [debug] [ThreadPool]: On list_dbt: Close
[0m00:16:26.055906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:16:26.055906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:16:26.056906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:16:26.060905 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:16:26.061906 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:16:26.062905 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:16:26.063905 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:16:26.063905 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:16:26.064714 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:16:26.064714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:26.064714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:26.064714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:26.111273 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.112272 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:16:26.112272 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:16:26.115290 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:16:26.116270 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:16:26.116270 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:16:26.117277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_public, now list_dbt_snapshots)
[0m00:16:26.119271 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:16:26.120271 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:16:26.120271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:26.146945 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.146945 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:16:26.147901 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:16:26.149944 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:16:26.150948 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:16:26.150948 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:16:26.176803 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.177812 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:16:26.177812 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:16:26.179817 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:16:26.181359 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:16:26.181359 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:16:26.207377 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.207377 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:16:26.207377 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:16:26.210377 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:16:26.211405 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:16:26.211405 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:16:26.214399 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.215398 [debug] [MainThread]: On master: BEGIN
[0m00:16:26.215398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:26.268422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.269422 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.269422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:26.272422 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:16:26.274421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F38E800>]}
[0m00:16:26.274421 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:26.275422 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.275422 [debug] [MainThread]: On master: BEGIN
[0m00:16:26.275422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.276422 [debug] [MainThread]: On master: COMMIT
[0m00:16:26.276422 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.276422 [debug] [MainThread]: On master: COMMIT
[0m00:16:26.277421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:16:26.277421 [debug] [MainThread]: On master: Close
[0m00:16:26.278423 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:16:26.278423 [info ] [MainThread]: 
[0m00:16:26.281929 [debug] [Thread-1 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:16:26.281929 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stg_sf__contacts_snapshot ...................... [RUN]
[0m00:16:26.282929 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.customer360.stg_sf__contacts_snapshot'
[0m00:16:26.282929 [debug] [Thread-1 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:16:26.287929 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:16:26.282929 => 00:16:26.287929
[0m00:16:26.287929 [debug] [Thread-1 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:16:26.317929 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:16:26.334928 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:16:26.335929 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:16:26.335929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:26.422441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.423441 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:16:26.423441 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."stg_sf__contacts_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        





select * from "dbt"."staging"."stg_sf__contacts"

    ) sbq



  );
  
  
[0m00:16:26.424439 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                          ^
HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".

[0m00:16:26.424439 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: ROLLBACK
[0m00:16:26.425440 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:16:26.288930 => 00:16:26.425440
[0m00:16:26.425440 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:16:26.427439 [debug] [Thread-1 (]: Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:16:26.428440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '609ef1d0-382c-419d-ab27-1539ea18be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F3BDBD0>]}
[0m00:16:26.428440 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stg_sf__contacts_snapshot .................. [[31mERROR[0m in 0.15s]
[0m00:16:26.429440 [debug] [Thread-1 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:16:26.430441 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.431440 [debug] [MainThread]: On master: BEGIN
[0m00:16:26.431440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:26.492950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:16:26.493951 [debug] [MainThread]: On master: COMMIT
[0m00:16:26.493951 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:26.493951 [debug] [MainThread]: On master: COMMIT
[0m00:16:26.494951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:16:26.494951 [debug] [MainThread]: On master: Close
[0m00:16:26.495951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:26.495951 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:16:26.495951 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:16:26.496952 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:16:26.496952 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m00:16:26.496952 [debug] [MainThread]: Connection 'snapshot.customer360.stg_sf__contacts_snapshot' was properly closed.
[0m00:16:26.497951 [info ] [MainThread]: 
[0m00:16:26.497951 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:16:26.498952 [debug] [MainThread]: Command end result
[0m00:16:26.504951 [info ] [MainThread]: 
[0m00:16:26.504951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:26.505951 [info ] [MainThread]: 
[0m00:16:26.505951 [error] [MainThread]:   Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:16:26.506951 [info ] [MainThread]: 
[0m00:16:26.506951 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:16:26.508952 [debug] [MainThread]: Command `dbt snapshot` failed at 00:16:26.507951 after 0.84 seconds
[0m00:16:26.508952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440BBA6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F0A1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002440F142320>]}
[0m00:16:26.508952 [debug] [MainThread]: Flushing usage events
[0m00:17:00.424462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C922A5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C9559AD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C9559AB00>]}


============================== 00:17:00.427510 | 5c20da1f-a470-4f82-bc60-7382000c9267 ==============================
[0m00:17:00.427510 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:17:00.428468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:00.546975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C9559ADA0>]}
[0m00:17:00.603975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95598D60>]}
[0m00:17:00.604977 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:17:00.614949 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:17:00.691872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:00.692872 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\salesforce\stg_sf__contacts.sql
[0m00:17:00.871553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95D60160>]}
[0m00:17:00.879507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95A08880>]}
[0m00:17:00.879507 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:17:00.880512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95A08A60>]}
[0m00:17:00.881506 [info ] [MainThread]: 
[0m00:17:00.882314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:00.883319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:00.889320 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:00.889320 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:00.890321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.941194 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:00.942194 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:00.943196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m00:17:00.944194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:17:00.945194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:17:00.948193 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:00.950194 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:00.951194 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:00.952194 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:17:00.952194 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:17:00.952194 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:17:00.953194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.953194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:00.953194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:01.007197 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.007197 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:01.008197 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:17:01.010197 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:17:01.011199 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:17:01.011199 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:17:01.012198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_snapshots, now list_dbt_staging)
[0m00:17:01.014197 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:01.014197 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:17:01.015197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:01.041713 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.042706 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:01.042706 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:17:01.044705 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:01.045704 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:17:01.045704 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:17:01.073047 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.073047 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:01.074047 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:17:01.076055 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:01.077059 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:17:01.077059 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:17:01.114010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.114010 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:01.115010 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:17:01.117012 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:01.118012 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:17:01.118012 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:17:01.122519 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.122519 [debug] [MainThread]: On master: BEGIN
[0m00:17:01.122519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:01.167587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.167587 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.168587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:01.171585 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:01.172587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C959E7580>]}
[0m00:17:01.172587 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:01.173586 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.173586 [debug] [MainThread]: On master: BEGIN
[0m00:17:01.173586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.174586 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.174586 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.174586 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.175586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:01.175586 [debug] [MainThread]: On master: Close
[0m00:17:01.176586 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:17:01.176586 [info ] [MainThread]: 
[0m00:17:01.178923 [debug] [Thread-1 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:01.178923 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stg_sf__contacts_snapshot ...................... [RUN]
[0m00:17:01.179922 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.customer360.stg_sf__contacts_snapshot'
[0m00:17:01.179922 [debug] [Thread-1 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:01.184923 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:17:01.180924 => 00:17:01.184923
[0m00:17:01.185924 [debug] [Thread-1 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:01.215927 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:01.215927 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:01.216927 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:17:01.216927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:01.265436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.265436 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:01.266436 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."stg_sf__contacts_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        





select * from "dbt"."staging"."stg_sf__contacts"

    ) sbq



  );
  
  
[0m00:17:01.266436 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                          ^
HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".

[0m00:17:01.267435 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: ROLLBACK
[0m00:17:01.267435 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:17:01.185924 => 00:17:01.267435
[0m00:17:01.268435 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:17:01.270435 [debug] [Thread-1 (]: Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:17:01.270435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c20da1f-a470-4f82-bc60-7382000c9267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95E02D40>]}
[0m00:17:01.271435 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.stg_sf__contacts_snapshot .................. [[31mERROR[0m in 0.09s]
[0m00:17:01.272436 [debug] [Thread-1 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:01.273436 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.273436 [debug] [MainThread]: On master: BEGIN
[0m00:17:01.273436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:01.319942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:01.320946 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.320946 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:01.321946 [debug] [MainThread]: On master: COMMIT
[0m00:17:01.321946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:01.321946 [debug] [MainThread]: On master: Close
[0m00:17:01.322946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:01.322946 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:01.322946 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m00:17:01.323946 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:17:01.323946 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:17:01.323946 [debug] [MainThread]: Connection 'snapshot.customer360.stg_sf__contacts_snapshot' was properly closed.
[0m00:17:01.324947 [info ] [MainThread]: 
[0m00:17:01.324947 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:17:01.325946 [debug] [MainThread]: Command end result
[0m00:17:01.332946 [info ] [MainThread]: 
[0m00:17:01.332946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:01.333946 [info ] [MainThread]: 
[0m00:17:01.333946 [error] [MainThread]:   Database Error in snapshot stg_sf__contacts_snapshot (snapshots\stg_sf__contacts_snapshot.sql)
  column "updated_at" does not exist
  LINE 17:          || '|' || coalesce(cast(updated_at as varchar ), ''...
                                            ^
  HINT:  Perhaps you meant to reference the column "sbq.unpdated_at".
  compiled Code at target\run\customer360\snapshots\stg_sf__contacts_snapshot.sql
[0m00:17:01.334946 [info ] [MainThread]: 
[0m00:17:01.334946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:17:01.335947 [debug] [MainThread]: Command `dbt snapshot` failed at 00:17:01.335947 after 0.95 seconds
[0m00:17:01.336946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C922A5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95598D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C95A08880>]}
[0m00:17:01.336946 [debug] [MainThread]: Flushing usage events
[0m00:17:09.946017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029079E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D12AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D12AAA0>]}


============================== 00:17:09.949065 | e346e97a-6fd9-42de-8aaf-c64fb5f1559f ==============================
[0m00:17:09.949065 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:17:09.950022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:10.068529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D12AD40>]}
[0m00:17:10.125579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D0E1660>]}
[0m00:17:10.126580 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:17:10.135741 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:17:10.214394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:10.214394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:10.218397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D5D20B0>]}
[0m00:17:10.226397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D598880>]}
[0m00:17:10.226397 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:17:10.227397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D598CD0>]}
[0m00:17:10.228398 [info ] [MainThread]: 
[0m00:17:10.229902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:10.230906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:10.230906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:10.237907 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:10.239907 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:10.239907 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:10.239907 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:10.240906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:10.240906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:10.290364 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:10.291365 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:10.319028 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:10.320028 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:10.322029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:17:10.323029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m00:17:10.326028 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:10.327028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:17:10.328028 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:10.329028 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:17:10.330532 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:10.330532 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:17:10.330532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:10.331535 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:17:10.331535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:10.331535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:10.376044 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.377045 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:10.377045 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:17:10.380045 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:10.381044 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:17:10.381044 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:17:10.382046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_marts, now list_dbt_public)
[0m00:17:10.384045 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:10.384045 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:17:10.384045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:10.416142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.416142 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:10.417144 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:17:10.419142 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:17:10.420144 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:17:10.420144 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:17:10.444650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.444650 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:10.445651 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:17:10.447650 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:10.448650 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:17:10.448650 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:17:10.473650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.473650 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:10.474650 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:17:10.476650 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:10.477650 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:17:10.477650 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:17:10.482650 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:10.482650 [debug] [MainThread]: On master: BEGIN
[0m00:17:10.482650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:10.528548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.528548 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:10.528548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:10.532151 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:10.533110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D655EA0>]}
[0m00:17:10.534158 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:10.534158 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:10.534158 [debug] [MainThread]: On master: BEGIN
[0m00:17:10.535109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.535109 [debug] [MainThread]: On master: COMMIT
[0m00:17:10.536110 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:10.536110 [debug] [MainThread]: On master: COMMIT
[0m00:17:10.536110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:10.537150 [debug] [MainThread]: On master: Close
[0m00:17:10.537150 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:17:10.538109 [info ] [MainThread]: 
[0m00:17:10.540109 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m00:17:10.541108 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m00:17:10.541108 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m00:17:10.542109 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m00:17:10.546108 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m00:17:10.547108 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 00:17:10.542109 => 00:17:10.547108
[0m00:17:10.547108 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m00:17:10.572108 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m00:17:10.572108 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.573108 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m00:17:10.573108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:10.621110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.621110 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.622110 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m00:17:10.656054 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m00:17:10.664049 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.664049 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m00:17:10.665049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.667048 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.667048 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m00:17:10.667967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.678971 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:17:10.679970 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.679970 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:17:10.680971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:10.684970 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m00:17:10.687970 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:10.687970 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m00:17:10.689971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:10.690971 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 00:17:10.548108 => 00:17:10.690971
[0m00:17:10.691971 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m00:17:10.691971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D62AC80>]}
[0m00:17:10.692972 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.15s]
[0m00:17:10.692972 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m00:17:10.693972 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m00:17:10.694991 [info ] [Thread-3 (]: 2 of 4 START sql table model staging.stg_web__transactions ..................... [RUN]
[0m00:17:10.695996 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m00:17:10.695996 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m00:17:10.698996 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m00:17:10.699996 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 00:17:10.695996 => 00:17:10.699996
[0m00:17:10.699996 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m00:17:10.702994 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m00:17:10.703995 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.703995 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m00:17:10.703995 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:10.750350 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.750350 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.751349 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m00:17:10.758986 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m00:17:10.762001 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.762001 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m00:17:10.763002 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.765001 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.765001 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m00:17:10.765001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.767001 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:17:10.767001 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.768002 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:17:10.768479 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:10.769484 [debug] [Thread-3 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m00:17:10.770483 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:10.770483 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m00:17:10.772484 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:10.773484 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 00:17:10.700996 => 00:17:10.773484
[0m00:17:10.773484 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m00:17:10.774483 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D63D360>]}
[0m00:17:10.774483 [info ] [Thread-3 (]: 2 of 4 OK created sql table model staging.stg_web__transactions ................ [[32mSELECT 101[0m in 0.08s]
[0m00:17:10.775486 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m00:17:10.776483 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m00:17:10.776483 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m00:17:10.777484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m00:17:10.777484 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m00:17:10.779483 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.780483 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 00:17:10.777484 => 00:17:10.780483
[0m00:17:10.780483 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m00:17:10.792484 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.793483 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.794484 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m00:17:10.794484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:10.841975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.842975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.842975 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m00:17:10.844975 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:17:10.846975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.847975 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m00:17:10.847975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.848976 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:17:10.849975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.849975 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:17:10.850975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:10.852975 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m00:17:10.853975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:10.854975 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m00:17:10.854975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:17:10.855975 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 00:17:10.780483 => 00:17:10.855975
[0m00:17:10.856975 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m00:17:10.856975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D66D000>]}
[0m00:17:10.857975 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.08s]
[0m00:17:10.858976 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m00:17:10.858976 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m00:17:10.859976 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m00:17:10.859976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m00:17:10.860977 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m00:17:10.863974 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m00:17:10.864975 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 00:17:10.860977 => 00:17:10.864975
[0m00:17:10.864975 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m00:17:10.868977 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m00:17:10.868977 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.869976 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m00:17:10.869976 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:10.915948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:10.916949 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.916949 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m00:17:10.952425 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m00:17:10.956419 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.957419 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m00:17:10.957419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.959419 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.960418 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m00:17:10.960418 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:10.962418 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:17:10.962418 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.963416 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:17:10.964417 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:10.965417 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m00:17:10.966416 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:10.966416 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m00:17:10.968418 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:10.969417 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 00:17:10.865975 => 00:17:10.968418
[0m00:17:10.969417 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m00:17:10.970426 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e346e97a-6fd9-42de-8aaf-c64fb5f1559f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D6FDF60>]}
[0m00:17:10.970426 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.11s]
[0m00:17:10.972417 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m00:17:10.973417 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:10.973417 [debug] [MainThread]: On master: BEGIN
[0m00:17:10.974418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:11.021157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:11.022157 [debug] [MainThread]: On master: COMMIT
[0m00:17:11.022157 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:11.022157 [debug] [MainThread]: On master: COMMIT
[0m00:17:11.023156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:11.023156 [debug] [MainThread]: On master: Close
[0m00:17:11.024156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:11.024156 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:11.024156 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:11.025156 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:17:11.025156 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:17:11.025156 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m00:17:11.025156 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m00:17:11.026157 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m00:17:11.026157 [info ] [MainThread]: 
[0m00:17:11.026157 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m00:17:11.027158 [debug] [MainThread]: Command end result
[0m00:17:11.032664 [info ] [MainThread]: 
[0m00:17:11.033664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:11.034667 [info ] [MainThread]: 
[0m00:17:11.034667 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:17:11.035665 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:11.035665 after 1.13 seconds
[0m00:17:11.036665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029079E36AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D6FB670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907D62AC80>]}
[0m00:17:11.036665 [debug] [MainThread]: Flushing usage events
[0m00:17:44.378719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6D044580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7033ACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7033AA70>]}


============================== 00:17:44.380720 | 866f0763-41a2-4908-9fe7-9f755fe7a347 ==============================
[0m00:17:44.380720 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:17:44.381719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:44.502172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7033AD10>]}
[0m00:17:44.559174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A702F1240>]}
[0m00:17:44.559174 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:17:44.568679 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:17:44.645679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:44.646680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:44.649679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A707E2080>]}
[0m00:17:44.658682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A707A4760>]}
[0m00:17:44.658682 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:17:44.659684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A707A4CA0>]}
[0m00:17:44.660682 [info ] [MainThread]: 
[0m00:17:44.660682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:44.661682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:44.668186 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:44.668186 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:44.669192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:44.718003 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:44.719004 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:44.721004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:17:44.721004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m00:17:44.725002 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:44.725002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m00:17:44.727004 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:44.727004 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:17:44.728004 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:44.729004 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:17:44.729485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:44.729485 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:17:44.729485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:44.730491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:44.781001 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.782002 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:44.782002 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:17:44.784001 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:44.785001 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:17:44.785001 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:17:44.786002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_public, now list_dbt_staging)
[0m00:17:44.788033 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:44.789036 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:17:44.789036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:44.809420 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.810420 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:44.810420 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:17:44.812420 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:44.813420 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:17:44.814420 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:17:44.839511 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.840512 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:44.840512 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:17:44.842513 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:17:44.844512 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:17:44.844512 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:17:44.870068 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.871069 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:44.871069 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:17:44.873070 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:44.874071 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:17:44.875069 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:17:44.878070 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:44.879070 [debug] [MainThread]: On master: BEGIN
[0m00:17:44.879070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:44.924593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.924593 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:44.925593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:44.928593 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:44.929593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A7082F760>]}
[0m00:17:44.929593 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:44.930594 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:44.930594 [debug] [MainThread]: On master: BEGIN
[0m00:17:44.930594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:44.931594 [debug] [MainThread]: On master: COMMIT
[0m00:17:44.931594 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:44.931594 [debug] [MainThread]: On master: COMMIT
[0m00:17:44.932594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:44.932594 [debug] [MainThread]: On master: Close
[0m00:17:44.933596 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:17:44.933596 [info ] [MainThread]: 
[0m00:17:44.936593 [debug] [Thread-1 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:44.936593 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stg_sf__contacts_snapshot ...................... [RUN]
[0m00:17:44.937593 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.customer360.stg_sf__contacts_snapshot'
[0m00:17:44.938594 [debug] [Thread-1 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:44.942593 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:17:44.938594 => 00:17:44.942593
[0m00:17:44.943593 [debug] [Thread-1 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:44.971102 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:44.972103 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:44.972103 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:17:44.973103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:45.028262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:45.028262 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:45.028262 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."stg_sf__contacts_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        





select * from "dbt"."staging"."stg_sf__contacts"

    ) sbq



  );
  
  
[0m00:17:45.063439 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m00:17:45.076950 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m00:17:45.076950 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:45.077949 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m00:17:45.077949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:45.078950 [debug] [Thread-1 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:17:44.943593 => 00:17:45.078950
[0m00:17:45.078950 [debug] [Thread-1 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:17:45.079951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '866f0763-41a2-4908-9fe7-9f755fe7a347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A705E22C0>]}
[0m00:17:45.080952 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stg_sf__contacts_snapshot ...................... [[32mSELECT 11[0m in 0.14s]
[0m00:17:45.080952 [debug] [Thread-1 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:45.083096 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:45.083096 [debug] [MainThread]: On master: BEGIN
[0m00:17:45.083096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:45.128425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:45.129426 [debug] [MainThread]: On master: COMMIT
[0m00:17:45.129426 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:45.129426 [debug] [MainThread]: On master: COMMIT
[0m00:17:45.130425 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:45.130425 [debug] [MainThread]: On master: Close
[0m00:17:45.131426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:45.131426 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:45.131426 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m00:17:45.131426 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:17:45.132820 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:17:45.132820 [debug] [MainThread]: Connection 'snapshot.customer360.stg_sf__contacts_snapshot' was properly closed.
[0m00:17:45.132820 [info ] [MainThread]: 
[0m00:17:45.133825 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:17:45.134825 [debug] [MainThread]: Command end result
[0m00:17:45.140826 [info ] [MainThread]: 
[0m00:17:45.140826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:45.141825 [info ] [MainThread]: 
[0m00:17:45.141825 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:17:45.142825 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:17:45.142825 after 0.80 seconds
[0m00:17:45.142825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6D044580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A702F1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A707A4970>]}
[0m00:17:45.143824 [debug] [MainThread]: Flushing usage events
[0m00:17:52.855063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDA7E76AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB172DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB172B60>]}


============================== 00:17:52.858062 | 86acd1bf-cfa4-42d7-a010-cdc3009e7d4d ==============================
[0m00:17:52.858062 [info ] [MainThread]: Running with dbt=1.7.2
[0m00:17:52.859063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:52.981087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDA3E82E00>]}
[0m00:17:53.038089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB128310>]}
[0m00:17:53.039089 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m00:17:53.048089 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m00:17:53.129449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:53.129449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:53.133449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB612170>]}
[0m00:17:53.142449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB5C8B20>]}
[0m00:17:53.142449 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m00:17:53.144449 [info ] [MainThread]: 
[0m00:17:53.145449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:53.146499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:53.152545 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:53.153505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:53.153505 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:53.154505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:53.155503 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:53.155503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.156503 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:53.157503 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:53.157503 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:53.158503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.158503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.208597 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:53.209596 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:53.211597 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:53.212596 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:53.212596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:53.235596 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:53.236596 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:53.265599 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:53.266599 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:53.295733 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:17:53.296733 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:53.298735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m00:17:53.298735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m00:17:53.302733 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:53.303733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:17:53.304733 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:53.304733 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m00:17:53.306733 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:53.306733 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m00:17:53.307733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.307733 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:17:53.307733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.308733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:53.355733 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.356734 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m00:17:53.356734 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:17:53.358734 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:53.359733 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m00:17:53.359733 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m00:17:53.360733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_staging, now list_dbt_marts)
[0m00:17:53.363737 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:53.363737 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m00:17:53.363737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:53.388421 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.389416 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m00:17:53.389416 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m00:17:53.392417 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:53.393419 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m00:17:53.393419 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m00:17:53.417283 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.418284 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:53.418284 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:17:53.420283 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:53.421284 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:17:53.421284 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:17:53.449283 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.449283 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m00:17:53.450284 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m00:17:53.452284 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:53.453283 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m00:17:53.453283 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m00:17:53.457266 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:53.458286 [debug] [MainThread]: On master: BEGIN
[0m00:17:53.458286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:53.509444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.510443 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:53.510443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:53.513443 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:17:53.514443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB68D840>]}
[0m00:17:53.515443 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:53.515443 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:53.516443 [debug] [MainThread]: On master: BEGIN
[0m00:17:53.516443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.516443 [debug] [MainThread]: On master: COMMIT
[0m00:17:53.516443 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:53.516443 [debug] [MainThread]: On master: COMMIT
[0m00:17:53.517973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:53.517973 [debug] [MainThread]: On master: Close
[0m00:17:53.519016 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m00:17:53.519016 [info ] [MainThread]: 
[0m00:17:53.521014 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m00:17:53.521990 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m00:17:53.521990 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:17:53.521990 [info ] [Thread-1 (]: 1 of 24 START seed file public.contacts ........................................ [RUN]
[0m00:17:53.523190 [info ] [Thread-2 (]: 2 of 24 START seed file public.transactions .................................... [RUN]
[0m00:17:53.523190 [info ] [Thread-3 (]: 3 of 24 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m00:17:53.524240 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m00:17:53.525197 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m00:17:53.525197 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m00:17:53.526197 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m00:17:53.526197 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m00:17:53.527196 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:17:53.527196 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 00:17:53.527196 => 00:17:53.527196
[0m00:17:53.528196 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 00:17:53.527196 => 00:17:53.527196
[0m00:17:53.540195 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:17:53.540195 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m00:17:53.541195 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m00:17:53.554195 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 00:17:53.528196 => 00:17:53.553197
[0m00:17:53.562200 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:17:53.564199 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:17:53.567200 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:17:53.567200 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m00:17:53.577310 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:17:53.578308 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m00:17:53.578308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:53.579307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:17:53.579307 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:17:53.580310 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m00:17:53.580310 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:53.629307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.629307 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:17:53.630307 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m00:17:53.661307 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.661307 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:17:53.662311 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m00:17:53.672309 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m00:17:53.691816 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m00:17:53.694819 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:17:53.723820 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.771820 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m00:17:53.798325 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:17:53.798325 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m00:17:53.799325 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m00:17:53.799325 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m00:17:53.799325 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m00:17:53.804325 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m00:17:53.804325 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m00:17:53.805325 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m00:17:53.813325 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m00:17:53.815325 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m00:17:53.815325 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m00:17:53.815325 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m00:17:53.816325 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m00:17:53.816325 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m00:17:53.817325 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:53.818325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:53.818325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:53.819325 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 00:17:53.562200 => 00:17:53.818325
[0m00:17:53.819325 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 00:17:53.541195 => 00:17:53.819325
[0m00:17:53.821325 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 00:17:53.568200 => 00:17:53.820325
[0m00:17:53.821325 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m00:17:53.821325 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m00:17:53.822325 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m00:17:53.822325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB2B35B0>]}
[0m00:17:53.823326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB71EDD0>]}
[0m00:17:53.824326 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m00:17:53.824326 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.30s]
[0m00:17:53.824326 [info ] [Thread-1 (]: 1 of 24 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.30s]
[0m00:17:53.825326 [info ] [Thread-3 (]: 3 of 24 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.30s]
[0m00:17:53.826326 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m00:17:53.826326 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m00:17:53.827325 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m00:17:53.827325 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:17:53.828325 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:17:53.828325 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:17:53.828325 [info ] [Thread-2 (]: 4 of 24 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m00:17:53.829325 [info ] [Thread-1 (]: 5 of 24 START test source_not_null_web_transactions_id ......................... [RUN]
[0m00:17:53.829325 [info ] [Thread-3 (]: 6 of 24 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m00:17:53.830325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m00:17:53.830325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m00:17:53.831326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m00:17:53.832325 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:17:53.832325 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:17:53.832325 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:17:53.837325 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:17:53.840326 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:17:53.845325 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:17:53.845325 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 00:17:53.833325 => 00:17:53.845325
[0m00:17:53.846325 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 00:17:53.838325 => 00:17:53.846325
[0m00:17:53.846325 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:17:53.847325 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 00:17:53.841326 => 00:17:53.846325
[0m00:17:53.847325 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:17:53.849325 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:17:53.849325 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:17:53.851325 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:17:53.853325 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:17:53.853325 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:17:53.854325 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:17:53.854325 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m00:17:53.855325 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m00:17:53.855325 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:17:53.855325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:53.856325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:53.856325 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m00:17:53.857325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:53.907021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.907021 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m00:17:53.907021 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m00:17:53.908021 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:53.909021 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 00:17:53.847325 => 00:17:53.909021
[0m00:17:53.910021 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m00:17:53.910021 [debug] [Thread-2 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m00:17:53.911022 [info ] [Thread-2 (]: 4 of 24 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.08s]
[0m00:17:53.912022 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m00:17:53.912022 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:17:53.913022 [info ] [Thread-2 (]: 7 of 24 START test source_unique_web_transactions_id ........................... [RUN]
[0m00:17:53.914021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m00:17:53.914021 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:17:53.917021 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:17:53.918021 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 00:17:53.914021 => 00:17:53.917021
[0m00:17:53.918021 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:17:53.920022 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:17:53.920022 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:17:53.921021 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m00:17:53.921021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:53.938021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.939022 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m00:17:53.939022 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m00:17:53.940021 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:53.942021 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 00:17:53.849325 => 00:17:53.941023
[0m00:17:53.942021 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m00:17:53.942021 [debug] [Thread-1 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m00:17:53.943021 [info ] [Thread-1 (]: 5 of 24 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.11s]
[0m00:17:53.944022 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m00:17:53.969288 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:53.970290 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m00:17:53.970290 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:17:53.972290 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:53.973290 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 00:17:53.851325 => 00:17:53.973290
[0m00:17:53.973290 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m00:17:53.974289 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m00:17:53.974289 [warn ] [Thread-3 (]: 6 of 24 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.14s]
[0m00:17:53.975291 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m00:17:53.976290 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m00:17:53.976290 [info ] [Thread-1 (]: 8 of 24 START sql table model staging.stg_sf__contacts ......................... [RUN]
[0m00:17:53.977334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m00:17:53.977334 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m00:17:53.980334 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m00:17:53.980334 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 00:17:53.978335 => 00:17:53.980334
[0m00:17:53.981334 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m00:17:54.002334 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m00:17:54.003334 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.003334 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.003334 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m00:17:54.004335 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m00:17:54.004335 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:17:54.005334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:54.006334 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.007334 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 00:17:53.918021 => 00:17:54.007334
[0m00:17:54.007334 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m00:17:54.008335 [debug] [Thread-2 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m00:17:54.008335 [info ] [Thread-2 (]: 7 of 24 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m00:17:54.009335 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m00:17:54.162469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.163473 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.163473 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m00:17:54.183975 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m00:17:54.188975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.188975 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m00:17:54.189975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.192975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.192975 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m00:17:54.192975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.197977 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:17:54.197977 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.198977 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m00:17:54.198977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:54.202975 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m00:17:54.205975 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m00:17:54.205975 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m00:17:54.207976 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:54.208976 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 00:17:53.981334 => 00:17:54.208976
[0m00:17:54.208976 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m00:17:54.209975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB834070>]}
[0m00:17:54.209975 [info ] [Thread-1 (]: 8 of 24 OK created sql table model staging.stg_sf__contacts .................... [[32mSELECT 11[0m in 0.23s]
[0m00:17:54.210980 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m00:17:54.211979 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:17:54.211979 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:17:54.212980 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m00:17:54.212980 [info ] [Thread-2 (]: 10 of 24 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m00:17:54.213979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m00:17:54.213979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m00:17:54.214980 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:17:54.214980 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:17:54.217979 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:17:54.219979 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:17:54.220979 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 00:17:54.214980 => 00:17:54.220979
[0m00:17:54.220979 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 00:17:54.217979 => 00:17:54.220979
[0m00:17:54.221979 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:17:54.221979 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:17:54.224016 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:17:54.225015 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:17:54.226021 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:17:54.226021 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m00:17:54.227022 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:17:54.227022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:54.227022 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m00:17:54.228028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:54.274979 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.274979 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m00:17:54.274979 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."staging"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m00:17:54.277485 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.278484 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 00:17:54.221979 => 00:17:54.278484
[0m00:17:54.278484 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m00:17:54.279485 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m00:17:54.279485 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m00:17:54.280487 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m00:17:54.304484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.304484 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m00:17:54.304484 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:17:54.306485 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.307484 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 00:17:54.224016 => 00:17:54.307484
[0m00:17:54.307484 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m00:17:54.307484 [debug] [Thread-2 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m00:17:54.308484 [info ] [Thread-2 (]: 10 of 24 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.09s]
[0m00:17:54.309487 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m00:17:54.310487 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m00:17:54.310487 [debug] [Thread-3 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:54.311484 [info ] [Thread-1 (]: 11 of 24 START sql table model staging.stg_web__transactions ................... [RUN]
[0m00:17:54.311484 [info ] [Thread-3 (]: 12 of 24 START snapshot snapshots.stg_sf__contacts_snapshot .................... [RUN]
[0m00:17:54.312484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m00:17:54.312484 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now snapshot.customer360.stg_sf__contacts_snapshot)
[0m00:17:54.312484 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m00:17:54.313484 [debug] [Thread-3 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:54.316484 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m00:17:54.319484 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 00:17:54.316484 => 00:17:54.319484
[0m00:17:54.319484 [debug] [Thread-3 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:54.320485 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 00:17:54.313484 => 00:17:54.320485
[0m00:17:54.343484 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.344485 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m00:17:54.344485 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m00:17:54.347486 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m00:17:54.348484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:54.348484 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.349484 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: BEGIN
[0m00:17:54.349484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:54.395993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.396994 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.396994 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:17:54.404993 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m00:17:54.414995 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.415994 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

        
  
    

  create temporary table "stg_sf__contacts_snapshot__dbt_tmp001754410994"
  
  
    as
  
  (
    with snapshot_query as (

        





select * from "dbt"."staging"."stg_sf__contacts"


    ),

    snapshotted_data as (

        select *,
            new_id as dbt_unique_key

        from "dbt"."snapshots"."stg_sf__contacts_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m00:17:54.418994 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.0 seconds
[0m00:17:54.420994 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.420994 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp001754410994'
        
      order by ordinal_position

  
[0m00:17:54.423994 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m00:17:54.425994 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.425994 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:17:54.428993 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m00:17:54.430993 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.430993 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp001754410994'
        
      order by ordinal_position

  
[0m00:17:54.432994 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m00:17:54.435994 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.436993 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m00:17:54.436993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.436993 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.437994 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."transactions"
),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
[0m00:17:54.438993 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m00:17:54.442993 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.442993 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp001754410994'
        
      order by ordinal_position

  
[0m00:17:54.445994 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m00:17:54.448993 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.449993 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.449993 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      update "dbt"."snapshots"."stg_sf__contacts_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_sf__contacts_snapshot__dbt_tmp001754410994" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_valid_to is null;

    insert into "dbt"."snapshots"."stg_sf__contacts_snapshot" ("id", "new_id", "user_name", "name", "gender", "address", "email_address", "birth_date", "_loaded_at_utc", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."new_id",DBT_INTERNAL_SOURCE."user_name",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."gender",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."email_address",DBT_INTERNAL_SOURCE."birth_date",DBT_INTERNAL_SOURCE."_loaded_at_utc",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_sf__contacts_snapshot__dbt_tmp001754410994" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m00:17:54.459001 [debug] [Thread-1 (]: SQL status: SELECT 101 in 0.0 seconds
[0m00:17:54.459001 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m00:17:54.461000 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.462003 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m00:17:54.463003 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m00:17:54.463003 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m00:17:54.464003 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m00:17:54.464003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.466511 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.466511 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:54.466511 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m00:17:54.468514 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 00:17:54.320485 => 00:17:54.468514
[0m00:17:54.469514 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m00:17:54.469514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.470515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB89C670>]}
[0m00:17:54.471516 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:17:54.472515 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.472515 [info ] [Thread-3 (]: 12 of 24 OK snapshotted snapshots.stg_sf__contacts_snapshot .................... [[32mINSERT 0 11[0m in 0.16s]
[0m00:17:54.473515 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: COMMIT
[0m00:17:54.473515 [debug] [Thread-3 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m00:17:54.474515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:54.477020 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m00:17:54.477020 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m00:17:54.478024 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m00:17:54.479026 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:54.480025 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 00:17:54.344485 => 00:17:54.480025
[0m00:17:54.481023 [debug] [Thread-1 (]: On model.customer360.stg_web__transactions: Close
[0m00:17:54.481023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB6B6290>]}
[0m00:17:54.482321 [info ] [Thread-1 (]: 11 of 24 OK created sql table model staging.stg_web__transactions .............. [[32mSELECT 101[0m in 0.17s]
[0m00:17:54.482321 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m00:17:54.483614 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:17:54.483614 [debug] [Thread-3 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:17:54.484895 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:17:54.484895 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m00:17:54.484895 [info ] [Thread-3 (]: 14 of 24 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m00:17:54.485898 [info ] [Thread-1 (]: 15 of 24 START test unique_stg_web__transactions_id ............................ [RUN]
[0m00:17:54.486898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m00:17:54.486898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.customer360.stg_sf__contacts_snapshot, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m00:17:54.486898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m00:17:54.488163 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:17:54.488163 [debug] [Thread-3 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:17:54.489167 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:17:54.492166 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:17:54.498166 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:17:54.501166 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:17:54.502166 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 00:17:54.489167 => 00:17:54.501166
[0m00:17:54.502166 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 00:17:54.492166 => 00:17:54.502166
[0m00:17:54.503166 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:17:54.503166 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 00:17:54.499167 => 00:17:54.503166
[0m00:17:54.503166 [debug] [Thread-3 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:17:54.505166 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:17:54.505166 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:17:54.507167 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:17:54.509167 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:17:54.509167 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:17:54.510167 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:17:54.510167 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m00:17:54.510167 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m00:17:54.511166 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:17:54.511166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:54.511166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:54.512167 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m00:17:54.512167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:54.562169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.563169 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m00:17:54.563169 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."staging"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m00:17:54.564169 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.565169 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 00:17:54.504166 => 00:17:54.565169
[0m00:17:54.566169 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m00:17:54.566169 [debug] [Thread-2 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m00:17:54.567175 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m00:17:54.567175 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m00:17:54.568171 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:17:54.568171 [info ] [Thread-2 (]: 16 of 24 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m00:17:54.569169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m00:17:54.569169 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:17:54.573169 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:17:54.574169 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 00:17:54.570170 => 00:17:54.573169
[0m00:17:54.574169 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:17:54.575169 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:17:54.576672 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:17:54.577676 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m00:17:54.577676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:54.596675 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.596675 [debug] [Thread-3 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m00:17:54.597676 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."staging"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."staging"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:17:54.598675 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.599676 [debug] [Thread-3 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 00:17:54.506167 => 00:17:54.599676
[0m00:17:54.600676 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m00:17:54.600676 [debug] [Thread-3 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m00:17:54.601676 [info ] [Thread-3 (]: 14 of 24 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m00:17:54.602676 [debug] [Thread-3 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m00:17:54.630677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.631677 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m00:17:54.631677 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:17:54.632676 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.634675 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 00:17:54.507167 => 00:17:54.633677
[0m00:17:54.634675 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m00:17:54.634675 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m00:17:54.635675 [info ] [Thread-1 (]: 15 of 24 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.15s]
[0m00:17:54.636676 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m00:17:54.661675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.662678 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m00:17:54.662678 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."staging"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m00:17:54.663678 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.664678 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 00:17:54.574169 => 00:17:54.664678
[0m00:17:54.665678 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m00:17:54.665678 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m00:17:54.666679 [info ] [Thread-2 (]: 16 of 24 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.10s]
[0m00:17:54.667680 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m00:17:54.667680 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m00:17:54.668678 [info ] [Thread-3 (]: 17 of 24 START sql view model marts.contacts_joined_with_transactions .......... [RUN]
[0m00:17:54.669681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m00:17:54.669681 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m00:17:54.672678 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.672678 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 00:17:54.670680 => 00:17:54.672678
[0m00:17:54.673678 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m00:17:54.685184 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.686187 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.686187 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m00:17:54.687185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:54.735185 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.735185 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.735185 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m00:17:54.737184 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:17:54.740185 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.740185 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m00:17:54.740185 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.742184 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:17:54.742184 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.742184 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m00:17:54.743184 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:54.744184 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m00:17:54.747184 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m00:17:54.747184 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m00:17:54.747184 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:17:54.748185 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 00:17:54.673678 => 00:17:54.748185
[0m00:17:54.749185 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m00:17:54.749185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB82BDC0>]}
[0m00:17:54.750184 [info ] [Thread-3 (]: 17 of 24 OK created sql view model marts.contacts_joined_with_transactions ..... [[32mCREATE VIEW[0m in 0.08s]
[0m00:17:54.751186 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m00:17:54.751186 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:17:54.751186 [debug] [Thread-1 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:17:54.752186 [info ] [Thread-2 (]: 18 of 24 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m00:17:54.752186 [info ] [Thread-1 (]: 19 of 24 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m00:17:54.753186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m00:17:54.753186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m00:17:54.754185 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:17:54.754185 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:17:54.757184 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:17:54.760184 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:17:54.760184 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 00:17:54.754185 => 00:17:54.760184
[0m00:17:54.761185 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 00:17:54.757184 => 00:17:54.760184
[0m00:17:54.761185 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:17:54.761185 [debug] [Thread-1 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:17:54.763188 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:17:54.765188 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:17:54.765188 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:17:54.766189 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m00:17:54.766189 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:17:54.766189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:54.767190 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m00:17:54.767190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:54.812697 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.813697 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m00:17:54.813697 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m00:17:54.815698 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.816699 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 00:17:54.762189 => 00:17:54.816699
[0m00:17:54.816699 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m00:17:54.817698 [debug] [Thread-2 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m00:17:54.817698 [info ] [Thread-2 (]: 18 of 24 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.06s]
[0m00:17:54.818698 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m00:17:54.841697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.842697 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m00:17:54.842697 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:17:54.844696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:54.845696 [debug] [Thread-1 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 00:17:54.763188 => 00:17:54.845696
[0m00:17:54.845696 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m00:17:54.846696 [debug] [Thread-1 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m00:17:54.847697 [info ] [Thread-1 (]: 19 of 24 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.09s]
[0m00:17:54.847697 [debug] [Thread-1 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m00:17:54.848697 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m00:17:54.849697 [info ] [Thread-3 (]: 20 of 24 START sql table model marts.customers ................................. [RUN]
[0m00:17:54.849697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m00:17:54.850698 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m00:17:54.855696 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m00:17:54.856696 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 00:17:54.850698 => 00:17:54.856696
[0m00:17:54.856696 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m00:17:54.859696 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m00:17:54.860696 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.860696 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m00:17:54.861696 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:54.908206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:54.909207 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.909207 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m00:17:54.920362 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m00:17:54.923366 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.923366 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m00:17:54.924367 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.925366 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.926365 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m00:17:54.926365 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:54.928366 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:17:54.928366 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.928366 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m00:17:54.929566 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:54.930571 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m00:17:54.931570 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m00:17:54.931570 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m00:17:54.933571 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:17:54.934571 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 00:17:54.857696 => 00:17:54.933571
[0m00:17:54.934571 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m00:17:54.935571 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86acd1bf-cfa4-42d7-a010-cdc3009e7d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB9145B0>]}
[0m00:17:54.935571 [info ] [Thread-3 (]: 20 of 24 OK created sql table model marts.customers ............................ [[32mSELECT 9[0m in 0.08s]
[0m00:17:54.936878 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m00:17:54.936878 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m00:17:54.936878 [debug] [Thread-2 (]: Began running node test.customer360.check_last_purchase_date
[0m00:17:54.937884 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m00:17:54.937884 [info ] [Thread-1 (]: 21 of 24 START test check_first_purchase_date .................................. [RUN]
[0m00:17:54.938883 [info ] [Thread-2 (]: 22 of 24 START test check_last_purchase_date ................................... [RUN]
[0m00:17:54.938883 [info ] [Thread-3 (]: 23 of 24 START test check_purchase_amount_above_zero ........................... [RUN]
[0m00:17:54.938883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_first_purchase_date)
[0m00:17:54.939884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_last_purchase_date)
[0m00:17:54.940884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m00:17:54.940884 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m00:17:54.940884 [debug] [Thread-2 (]: Began compiling node test.customer360.check_last_purchase_date
[0m00:17:54.941884 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m00:17:54.943884 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m00:17:54.945882 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m00:17:54.946884 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m00:17:54.947883 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 00:17:54.941884 => 00:17:54.947883
[0m00:17:54.947883 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (compile): 00:17:54.943884 => 00:17:54.947883
[0m00:17:54.948883 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m00:17:54.948883 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 00:17:54.945882 => 00:17:54.948883
[0m00:17:54.948883 [debug] [Thread-2 (]: Began executing node test.customer360.check_last_purchase_date
[0m00:17:54.951882 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m00:17:54.951882 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m00:17:54.953883 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m00:17:54.954883 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m00:17:54.955884 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m00:17:54.955884 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m00:17:54.956883 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m00:17:54.956883 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m00:17:54.956883 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m00:17:54.957883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:54.957883 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m00:17:54.957883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:17:54.958884 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:17:55.012392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:55.012392 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m00:17:55.013393 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m00:17:55.015394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:55.016392 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 00:17:54.949883 => 00:17:55.016392
[0m00:17:55.016392 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m00:17:55.016392 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m00:17:55.017392 [info ] [Thread-1 (]: 21 of 24 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.08s]
[0m00:17:55.018392 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m00:17:55.019392 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m00:17:55.019392 [info ] [Thread-1 (]: 24 of 24 START test check_valid_customers ...................................... [RUN]
[0m00:17:55.020392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m00:17:55.020392 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m00:17:55.022391 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m00:17:55.023391 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 00:17:55.020392 => 00:17:55.023391
[0m00:17:55.023391 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m00:17:55.025391 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m00:17:55.025391 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m00:17:55.026391 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m00:17:55.026391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:55.047391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:55.047391 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m00:17:55.048392 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m00:17:55.050392 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:55.051393 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (execute): 00:17:54.952883 => 00:17:55.051393
[0m00:17:55.051393 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m00:17:55.052393 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: Close
[0m00:17:55.052393 [info ] [Thread-2 (]: 22 of 24 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.11s]
[0m00:17:55.053392 [debug] [Thread-2 (]: Finished running node test.customer360.check_last_purchase_date
[0m00:17:55.080343 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:55.081344 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m00:17:55.081344 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m00:17:55.082343 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:55.084344 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 00:17:54.953883 => 00:17:55.083343
[0m00:17:55.084344 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m00:17:55.084344 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m00:17:55.085343 [info ] [Thread-3 (]: 23 of 24 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.15s]
[0m00:17:55.086344 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m00:17:55.110342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:55.111343 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m00:17:55.111343 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."staging"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m00:17:55.112341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:17:55.114342 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 00:17:55.023391 => 00:17:55.113344
[0m00:17:55.114342 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m00:17:55.114342 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m00:17:55.115342 [info ] [Thread-1 (]: 24 of 24 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.10s]
[0m00:17:55.116342 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m00:17:55.117342 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:55.117342 [debug] [MainThread]: On master: BEGIN
[0m00:17:55.117342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:55.163347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:55.164348 [debug] [MainThread]: On master: COMMIT
[0m00:17:55.164348 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:55.164348 [debug] [MainThread]: On master: COMMIT
[0m00:17:55.165346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:55.165346 [debug] [MainThread]: On master: Close
[0m00:17:55.166347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:55.166347 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:55.166347 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:55.167346 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m00:17:55.167346 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m00:17:55.167346 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m00:17:55.168346 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m00:17:55.168346 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m00:17:55.168346 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m00:17:55.168346 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m00:17:55.169347 [info ] [MainThread]: 
[0m00:17:55.169347 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 3 table models, 1 snapshot, 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m00:17:55.172346 [debug] [MainThread]: Command end result
[0m00:17:55.178854 [info ] [MainThread]: 
[0m00:17:55.178854 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m00:17:55.179854 [info ] [MainThread]: 
[0m00:17:55.179854 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m00:17:55.180469 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m00:17:55.180469 [info ] [MainThread]: 
[0m00:17:55.180469 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m00:17:55.181475 [info ] [MainThread]: 
[0m00:17:55.181475 [info ] [MainThread]: Done. PASS=23 WARN=1 ERROR=0 SKIP=0 TOTAL=24
[0m00:17:55.182475 [debug] [MainThread]: Command `dbt build` succeeded at 00:17:55.182475 after 2.37 seconds
[0m00:17:55.183476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDA7E76AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB68D480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDAB9ADB70>]}
[0m00:17:55.183476 [debug] [MainThread]: Flushing usage events
[0m09:44:02.704840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E8D37220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC02AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC02AAA0>]}


============================== 09:44:02.707839 | 5116c2df-abe8-4ba6-a666-74a27ff87087 ==============================
[0m09:44:02.707839 [info ] [MainThread]: Running with dbt=1.7.2
[0m09:44:02.708839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:02.834547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5116c2df-abe8-4ba6-a666-74a27ff87087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC02AD40>]}
[0m09:44:02.891556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5116c2df-abe8-4ba6-a666-74a27ff87087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EBFDD660>]}
[0m09:47:09.769252 [error] [MainThread]: Encountered an error:

[0m09:47:09.776989 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Python\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Python\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m09:47:09.780998 [debug] [MainThread]: Command `dbt docs serve` failed at 09:47:09.780998 after 187.12 seconds
[0m09:47:09.781999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E8D37220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC274850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC277A30>]}
[0m09:47:09.781999 [debug] [MainThread]: Flushing usage events
[0m09:47:26.459622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263503F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263536EEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263536EEB90>]}


============================== 09:47:26.462621 | a6ba9f19-bab0-494f-8545-944090b83418 ==============================
[0m09:47:26.462621 [info ] [MainThread]: Running with dbt=1.7.2
[0m09:47:26.462621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:47:26.584687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ba9f19-bab0-494f-8545-944090b83418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263536EEE30>]}
[0m09:47:26.641727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ba9f19-bab0-494f-8545-944090b83418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026353935AE0>]}
[0m09:47:26.642723 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m09:47:26.651689 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m09:47:26.734197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:47:26.734197 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m09:47:26.735197 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m09:47:26.743198 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ doc("customers_desc")  }}: 'doc' is undefined
[0m09:47:26.745200 [debug] [MainThread]: Command `dbt docs generate` failed at 09:47:26.744198 after 0.32 seconds
[0m09:47:26.745200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263503F6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026353BD6A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026353BD6EF0>]}
[0m09:47:26.745200 [debug] [MainThread]: Flushing usage events
[0m09:49:11.145231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB8FD4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC2D2DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC2D2B30>]}


============================== 09:49:11.148167 | 11f3aece-bed7-47c1-8235-d1db7c662c1a ==============================
[0m09:49:11.148167 [info ] [MainThread]: Running with dbt=1.7.2
[0m09:49:11.148167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m09:49:11.271040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f3aece-bed7-47c1-8235-d1db7c662c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC2D2DD0>]}
[0m09:49:11.328556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f3aece-bed7-47c1-8235-d1db7c662c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC515360>]}
[0m09:49:11.329556 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m09:49:11.339556 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m09:49:11.420927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:49:11.421928 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m09:49:11.421928 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m09:49:11.430932 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ doc("customers_desc")  }}: 'doc' is undefined
[0m09:49:11.431927 [debug] [MainThread]: Command `dbt docs generate` failed at 09:49:11.431927 after 0.33 seconds
[0m09:49:11.432933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB8FD4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC7B6A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDBC7B6EF0>]}
[0m09:49:11.432933 [debug] [MainThread]: Flushing usage events
[0m09:59:57.881872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD8C96AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDBF8EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDBF8EB90>]}


============================== 09:59:57.884870 | f0ca0940-b1a3-41a0-b423-baf1e69625f7 ==============================
[0m09:59:57.884870 [info ] [MainThread]: Running with dbt=1.7.2
[0m09:59:57.885870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:58.006486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0ca0940-b1a3-41a0-b423-baf1e69625f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDBF8EE30>]}
[0m09:59:58.066489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0ca0940-b1a3-41a0-b423-baf1e69625f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDC1D5AE0>]}
[0m09:59:58.068020 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m09:59:58.078059 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m09:59:58.160043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:59:58.160043 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m09:59:58.161063 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m09:59:58.169649 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ doc("customers_desc")  }}: 'doc' is undefined
[0m09:59:58.170649 [debug] [MainThread]: Command `dbt docs generate` failed at 09:59:58.170649 after 0.33 seconds
[0m09:59:58.171648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD8C96AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDC472A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FDC472EF0>]}
[0m09:59:58.171648 [debug] [MainThread]: Flushing usage events
[0m10:35:06.331027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024230125630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024233422D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024233422B00>]}


============================== 10:35:06.334025 | ba836f0e-5ce1-4a5e-9474-3929260d6ff7 ==============================
[0m10:35:06.334025 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:35:06.334025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m10:35:06.465623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba836f0e-5ce1-4a5e-9474-3929260d6ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024233422DA0>]}
[0m10:35:06.532193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba836f0e-5ce1-4a5e-9474-3929260d6ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242333D4F70>]}
[0m10:35:06.532193 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m10:35:06.542193 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m10:35:06.630750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:35:06.631768 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m10:35:06.631768 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m10:35:06.643759 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ doc("customers_desc")  }}: 'doc' is undefined
[0m10:35:06.644747 [debug] [MainThread]: Command `dbt docs generate` failed at 10:35:06.644747 after 0.36 seconds
[0m10:35:06.644747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024230125630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242339069E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024233906EF0>]}
[0m10:35:06.645747 [debug] [MainThread]: Flushing usage events
[0m10:39:36.556906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CE9F24580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED222DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED222B60>]}


============================== 10:39:36.559920 | 196a8da8-d44d-4dac-9379-65682eadc741 ==============================
[0m10:39:36.559920 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:39:36.560920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:36.682363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196a8da8-d44d-4dac-9379-65682eadc741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED222E00>]}
[0m10:39:36.738411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196a8da8-d44d-4dac-9379-65682eadc741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED1D6CB0>]}
[0m10:39:36.739411 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m10:39:36.748997 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m10:39:36.827473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:39:36.828474 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m10:39:36.828474 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m10:39:36.917225 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ doc("contacts_trans_desc") }}: 'doc' is undefined
[0m10:39:36.919224 [debug] [MainThread]: Command `dbt docs generate` failed at 10:39:36.919224 after 0.40 seconds
[0m10:39:36.919224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CE9F24580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED862DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CED863A90>]}
[0m10:39:36.920229 [debug] [MainThread]: Flushing usage events
[0m10:42:15.218197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F46B7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F79AEE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F79AEBC0>]}


============================== 10:42:15.220196 | 33a5e987-dfd8-49db-9456-ccae5ba3ca7a ==============================
[0m10:42:15.220196 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:42:15.221196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:42:15.340709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F79AEE60>]}
[0m10:42:15.397711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F7BF5EA0>]}
[0m10:42:15.398711 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m10:42:15.409220 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m10:42:15.486218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:42:15.486218 [debug] [MainThread]: Partial parsing: added file: customer360://models\marts\marketing\_marts_doc.md
[0m10:42:15.487218 [debug] [MainThread]: Partial parsing: updated file: customer360://models\marts\marketing\_marketing__models.yml
[0m10:42:15.666243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F81783D0>]}
[0m10:42:15.668243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F7D38AC0>]}
[0m10:42:15.669243 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m10:42:15.669243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F7D38A90>]}
[0m10:42:15.671282 [info ] [MainThread]: 
[0m10:42:15.671282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:15.673243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m10:42:15.673243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m10:42:15.680241 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m10:42:15.681242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m10:42:15.682243 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m10:42:15.683242 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m10:42:15.684243 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m10:42:15.685242 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m10:42:15.685242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:15.685242 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m10:42:15.686242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:15.686242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:15.740841 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:42:15.741842 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m10:42:15.741842 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:42:15.744842 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:42:15.745842 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m10:42:15.745842 [debug] [ThreadPool]: On list_dbt_public: Close
[0m10:42:15.746841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_public, now list_dbt_marts)
[0m10:42:15.748842 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m10:42:15.748842 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m10:42:15.748842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:15.772841 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:42:15.773842 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m10:42:15.773842 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m10:42:15.775842 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:42:15.776843 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m10:42:15.777841 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m10:42:15.802597 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:42:15.802597 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m10:42:15.802597 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m10:42:15.806106 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m10:42:15.807107 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m10:42:15.807107 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m10:42:15.831844 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:42:15.831844 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m10:42:15.831844 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m10:42:15.834844 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:42:15.835846 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m10:42:15.835846 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m10:42:15.839844 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:15.839844 [debug] [MainThread]: On master: BEGIN
[0m10:42:15.839844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:15.884899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:42:15.885898 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:15.885898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:15.888899 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m10:42:15.890903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a5e987-dfd8-49db-9456-ccae5ba3ca7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F7DFA980>]}
[0m10:42:15.890903 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:15.890903 [debug] [MainThread]: On master: Close
[0m10:42:15.891902 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m10:42:15.891902 [info ] [MainThread]: 
[0m10:42:15.894903 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m10:42:15.894903 [debug] [Thread-2 (]: Began running node seed.integration_tests.contacts
[0m10:42:15.895904 [debug] [Thread-3 (]: Began running node seed.integration_tests.transactions
[0m10:42:15.895904 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m10:42:15.896903 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m10:42:15.896903 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m10:42:15.897904 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m10:42:15.897904 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.contacts
[0m10:42:15.897904 [debug] [Thread-3 (]: Began compiling node seed.integration_tests.transactions
[0m10:42:15.902904 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m10:42:15.904408 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (compile): 10:42:15.902904 => 10:42:15.902904
[0m10:42:15.905414 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (compile): 10:42:15.904408 => 10:42:15.905414
[0m10:42:15.905414 [debug] [Thread-2 (]: Began executing node seed.integration_tests.contacts
[0m10:42:15.906413 [debug] [Thread-3 (]: Began executing node seed.integration_tests.transactions
[0m10:42:15.906413 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 10:42:15.898903 => 10:42:15.906413
[0m10:42:15.906413 [debug] [Thread-2 (]: Timing info for seed.integration_tests.contacts (execute): 10:42:15.906413 => 10:42:15.906413
[0m10:42:15.907412 [debug] [Thread-3 (]: Timing info for seed.integration_tests.transactions (execute): 10:42:15.907412 => 10:42:15.907412
[0m10:42:15.907412 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m10:42:15.908413 [debug] [Thread-2 (]: Finished running node seed.integration_tests.contacts
[0m10:42:15.908413 [debug] [Thread-3 (]: Finished running node seed.integration_tests.transactions
[0m10:42:15.909413 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 10:42:15.909413 => 10:42:15.909413
[0m10:42:15.909413 [debug] [Thread-2 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m10:42:15.910413 [debug] [Thread-3 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m10:42:15.910413 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m10:42:15.911415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5)
[0m10:42:15.911415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m10:42:15.912413 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m10:42:15.912413 [debug] [Thread-2 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m10:42:15.913413 [debug] [Thread-3 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m10:42:15.913413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m10:42:15.922411 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m10:42:15.928412 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m10:42:15.928412 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m10:42:15.931411 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m10:42:15.931411 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 10:42:15.913413 => 10:42:15.931411
[0m10:42:15.932411 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 10:42:15.922411 => 10:42:15.932411
[0m10:42:15.932411 [debug] [Thread-2 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m10:42:15.933412 [debug] [Thread-3 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m10:42:15.933412 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 10:42:15.929421 => 10:42:15.933412
[0m10:42:15.933412 [debug] [Thread-2 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 10:42:15.933412 => 10:42:15.933412
[0m10:42:15.934412 [debug] [Thread-3 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 10:42:15.934412 => 10:42:15.934412
[0m10:42:15.934412 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m10:42:15.935413 [debug] [Thread-2 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m10:42:15.935413 [debug] [Thread-3 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m10:42:15.936412 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 10:42:15.936412 => 10:42:15.936412
[0m10:42:15.936412 [debug] [Thread-2 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m10:42:15.936412 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m10:42:15.937413 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m10:42:15.938417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m10:42:15.939413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m10:42:15.939413 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m10:42:15.939413 [debug] [Thread-2 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m10:42:15.940414 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m10:42:15.940414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_web__transactions)
[0m10:42:15.945412 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m10:42:15.948414 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m10:42:15.948414 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m10:42:15.951413 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m10:42:15.952413 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 10:42:15.941413 => 10:42:15.951413
[0m10:42:15.952413 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 10:42:15.945412 => 10:42:15.952413
[0m10:42:15.953412 [debug] [Thread-2 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m10:42:15.953412 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 10:42:15.949413 => 10:42:15.953412
[0m10:42:15.953412 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m10:42:15.954414 [debug] [Thread-2 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 10:42:15.954414 => 10:42:15.954414
[0m10:42:15.954414 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m10:42:15.955412 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 10:42:15.955412 => 10:42:15.955412
[0m10:42:15.955412 [debug] [Thread-2 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m10:42:15.956414 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 10:42:15.956414 => 10:42:15.956414
[0m10:42:15.956414 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m10:42:15.957412 [debug] [Thread-2 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m10:42:15.957412 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m10:42:15.958414 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m10:42:15.958414 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now snapshot.customer360.stg_sf__contacts_snapshot)
[0m10:42:15.959412 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m10:42:15.959412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m10:42:15.960412 [debug] [Thread-2 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m10:42:15.960412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m10:42:15.961412 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m10:42:15.963411 [debug] [Thread-2 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 10:42:15.961412 => 10:42:15.962412
[0m10:42:15.963411 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m10:42:15.966414 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m10:42:15.966414 [debug] [Thread-2 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m10:42:15.969413 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m10:42:15.969413 [debug] [Thread-2 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 10:42:15.969413 => 10:42:15.969413
[0m10:42:15.970413 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 10:42:15.963411 => 10:42:15.970413
[0m10:42:15.970413 [debug] [Thread-2 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m10:42:15.971412 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 10:42:15.967412 => 10:42:15.971412
[0m10:42:15.971412 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m10:42:15.972413 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m10:42:15.972413 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m10:42:15.972413 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 10:42:15.972413 => 10:42:15.972413
[0m10:42:15.973413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.customer360.stg_sf__contacts_snapshot, now model.customer360.contacts_joined_with_transactions)
[0m10:42:15.973413 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 10:42:15.973413 => 10:42:15.973413
[0m10:42:15.974412 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m10:42:15.974412 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m10:42:15.975413 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m10:42:15.975413 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m10:42:15.977413 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m10:42:15.978413 [debug] [Thread-1 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m10:42:15.978413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m10:42:15.979412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m10:42:15.979412 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m10:42:15.979412 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 10:42:15.975413 => 10:42:15.979412
[0m10:42:15.980412 [debug] [Thread-1 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m10:42:15.982411 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m10:42:15.983411 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m10:42:15.988413 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m10:42:15.989412 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 10:42:15.989412 => 10:42:15.989412
[0m10:42:15.989412 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 10:42:15.980412 => 10:42:15.989412
[0m10:42:15.990415 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m10:42:15.991415 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 10:42:15.983411 => 10:42:15.990415
[0m10:42:15.991415 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m10:42:15.991415 [debug] [Thread-2 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m10:42:15.992416 [debug] [Thread-1 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m10:42:15.992416 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 10:42:15.992416 => 10:42:15.992416
[0m10:42:15.993416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m10:42:15.993416 [debug] [Thread-1 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 10:42:15.993416 => 10:42:15.993416
[0m10:42:15.994417 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m10:42:15.994417 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m10:42:15.994417 [debug] [Thread-1 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m10:42:15.995417 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m10:42:15.997417 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m10:42:15.998417 [debug] [Thread-1 (]: Began running node model.customer360.customers
[0m10:42:15.998417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m10:42:15.999415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.customers)
[0m10:42:15.999415 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m10:42:16.000415 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 10:42:15.995417 => 10:42:15.999415
[0m10:42:16.000415 [debug] [Thread-1 (]: Began compiling node model.customer360.customers
[0m10:42:16.003417 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m10:42:16.003417 [debug] [Thread-2 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m10:42:16.006925 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.customers"
[0m10:42:16.007924 [debug] [Thread-2 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 10:42:16.007924 => 10:42:16.007924
[0m10:42:16.007924 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 10:42:16.000415 => 10:42:16.007924
[0m10:42:16.008925 [debug] [Thread-1 (]: Timing info for model.customer360.customers (compile): 10:42:16.003417 => 10:42:16.008925
[0m10:42:16.008925 [debug] [Thread-2 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m10:42:16.009926 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m10:42:16.009926 [debug] [Thread-1 (]: Began executing node model.customer360.customers
[0m10:42:16.009926 [debug] [Thread-2 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m10:42:16.010926 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 10:42:16.010926 => 10:42:16.010926
[0m10:42:16.010926 [debug] [Thread-1 (]: Timing info for model.customer360.customers (execute): 10:42:16.010926 => 10:42:16.010926
[0m10:42:16.011926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m10:42:16.011926 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m10:42:16.012925 [debug] [Thread-1 (]: Finished running node model.customer360.customers
[0m10:42:16.012925 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m10:42:16.013925 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m10:42:16.013925 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m10:42:16.016924 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m10:42:16.016924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m10:42:16.017925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_first_purchase_date)
[0m10:42:16.017925 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m10:42:16.018927 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m10:42:16.018927 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 10:42:16.013925 => 10:42:16.018927
[0m10:42:16.020924 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m10:42:16.022926 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m10:42:16.023925 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m10:42:16.023925 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 10:42:16.023925 => 10:42:16.023925
[0m10:42:16.024926 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m10:42:16.024926 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 10:42:16.021924 => 10:42:16.024926
[0m10:42:16.025926 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 10:42:16.018927 => 10:42:16.024926
[0m10:42:16.025926 [debug] [Thread-2 (]: Began running node test.customer360.check_last_purchase_date
[0m10:42:16.025926 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m10:42:16.026925 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m10:42:16.026925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_last_purchase_date)
[0m10:42:16.027926 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 10:42:16.026925 => 10:42:16.026925
[0m10:42:16.027926 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 10:42:16.027926 => 10:42:16.027926
[0m10:42:16.027926 [debug] [Thread-2 (]: Began compiling node test.customer360.check_last_purchase_date
[0m10:42:16.028926 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m10:42:16.028926 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m10:42:16.031924 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m10:42:16.031924 [debug] [Thread-1 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m10:42:16.032925 [debug] [Thread-3 (]: Began running node test.customer360.check_valid_customers
[0m10:42:16.032925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_purchase_amount_above_zero)
[0m10:42:16.033936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_valid_customers)
[0m10:42:16.033936 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (compile): 10:42:16.029926 => 10:42:16.033936
[0m10:42:16.033936 [debug] [Thread-1 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m10:42:16.034925 [debug] [Thread-3 (]: Began compiling node test.customer360.check_valid_customers
[0m10:42:16.034925 [debug] [Thread-2 (]: Began executing node test.customer360.check_last_purchase_date
[0m10:42:16.036926 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m10:42:16.038926 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m10:42:16.038926 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (execute): 10:42:16.038926 => 10:42:16.038926
[0m10:42:16.039925 [debug] [Thread-1 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 10:42:16.034925 => 10:42:16.039925
[0m10:42:16.040925 [debug] [Thread-2 (]: Finished running node test.customer360.check_last_purchase_date
[0m10:42:16.040925 [debug] [Thread-3 (]: Timing info for test.customer360.check_valid_customers (compile): 10:42:16.036926 => 10:42:16.040925
[0m10:42:16.040925 [debug] [Thread-1 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m10:42:16.041925 [debug] [Thread-3 (]: Began executing node test.customer360.check_valid_customers
[0m10:42:16.041925 [debug] [Thread-1 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 10:42:16.041925 => 10:42:16.041925
[0m10:42:16.042926 [debug] [Thread-3 (]: Timing info for test.customer360.check_valid_customers (execute): 10:42:16.041925 => 10:42:16.041925
[0m10:42:16.042926 [debug] [Thread-1 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m10:42:16.043925 [debug] [Thread-3 (]: Finished running node test.customer360.check_valid_customers
[0m10:42:16.044924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:16.044924 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m10:42:16.044924 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m10:42:16.045926 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m10:42:16.045926 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m10:42:16.045926 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m10:42:16.045926 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m10:42:16.047926 [debug] [MainThread]: Command end result
[0m10:42:16.056926 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:42:16.056926 [info ] [MainThread]: Building catalog
[0m10:42:16.057926 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt.information_schema'
[0m10:42:16.062926 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m10:42:16.062926 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m10:42:16.063669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:16.119688 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:42:16.119688 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m10:42:16.120690 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transactions')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('marts') and
           upper(tbl.relname) = upper('contacts_joined_with_transactions')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_sf__contacts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('contacts')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_web__transactions')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('stg_sf__contacts_snapshot')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:42:16.123688 [debug] [ThreadPool]: SQL status: SELECT 73 in 0.0 seconds
[0m10:42:16.126688 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m10:42:16.127688 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m10:42:16.136688 [info ] [MainThread]: Catalog written to C:\Users\Samuel\Desktop\customer360\integration_tests\target\catalog.json
[0m10:42:16.138689 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:42:16.137688 after 0.96 seconds
[0m10:42:16.138689 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:42:16.138689 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m10:42:16.139688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F46B7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F79AEE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F7B31E40>]}
[0m10:42:16.139688 [debug] [MainThread]: Flushing usage events
[0m10:43:05.240795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E109204580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C4FACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C4FAA40>]}


============================== 10:43:05.243796 | b8f0cbdd-f378-4be1-b288-932dd730cbda ==============================
[0m10:43:05.243796 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:43:05.244795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:43:05.365558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f0cbdd-f378-4be1-b288-932dd730cbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C573E80>]}
[0m10:43:05.422461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f0cbdd-f378-4be1-b288-932dd730cbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C4AF6A0>]}
[0m10:45:20.814928 [error] [MainThread]: Encountered an error:

[0m10:45:20.820910 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\Samuel\Desktop\customer360\integration_tests\venv\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Python\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Python\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m10:45:20.823414 [debug] [MainThread]: Command `dbt docs serve` failed at 10:45:20.823414 after 135.62 seconds
[0m10:45:20.823414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E109204580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C764EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10C765EA0>]}
[0m10:45:20.824419 [debug] [MainThread]: Flushing usage events
[0m11:41:11.784366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED5397220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED868AD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED868AAD0>]}


============================== 11:41:11.787365 | 747e5245-11ad-4982-9af4-9a59feb51a4e ==============================
[0m11:41:11.787365 [info ] [MainThread]: Running with dbt=1.7.2
[0m11:41:11.788365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:11.909450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED868AD70>]}
[0m11:41:11.969093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8644BE0>]}
[0m11:41:11.970094 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m11:41:11.979121 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m11:41:12.059092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:12.060094 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m11:41:12.258200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8E85C30>]}
[0m11:41:12.265714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8AF8A90>]}
[0m11:41:12.266712 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m11:41:12.266712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8AF8D30>]}
[0m11:41:12.268714 [info ] [MainThread]: 
[0m11:41:12.268714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:12.269713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:41:12.270869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:41:12.276507 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:41:12.278508 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:41:12.278508 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:41:12.278508 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:41:12.279464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:12.279464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:12.330960 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:41:12.331964 [debug] [ThreadPool]: On list_dbt: Close
[0m11:41:12.360947 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:41:12.361946 [debug] [ThreadPool]: On list_dbt: Close
[0m11:41:12.363449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m11:41:12.364452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m11:41:12.368452 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:41:12.368452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m11:41:12.370452 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:41:12.370452 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m11:41:12.371452 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:41:12.372452 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m11:41:12.372452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:12.372452 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m11:41:12.373453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:12.373453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:12.422190 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.422190 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:41:12.423191 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:41:12.425516 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:41:12.426516 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m11:41:12.426516 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m11:41:12.427516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_snapshots, now list_dbt_marts)
[0m11:41:12.429517 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:41:12.429517 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m11:41:12.429517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:12.452292 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.453292 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:41:12.453292 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:41:12.456345 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:41:12.457345 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m11:41:12.457345 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m11:41:12.482032 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.483535 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:41:12.483535 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:41:12.485538 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:41:12.486540 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m11:41:12.487541 [debug] [ThreadPool]: On list_dbt_public: Close
[0m11:41:12.515977 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.515977 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:41:12.516977 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m11:41:12.518977 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:41:12.519982 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m11:41:12.520977 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m11:41:12.524172 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:12.525172 [debug] [MainThread]: On master: BEGIN
[0m11:41:12.525172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:12.570700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.570700 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:12.571702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:41:12.574209 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:41:12.576209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8ADACE0>]}
[0m11:41:12.576209 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:12.577209 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:12.577209 [debug] [MainThread]: On master: BEGIN
[0m11:41:12.577209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.578210 [debug] [MainThread]: On master: COMMIT
[0m11:41:12.578210 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:12.578210 [debug] [MainThread]: On master: COMMIT
[0m11:41:12.579209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:41:12.579209 [debug] [MainThread]: On master: Close
[0m11:41:12.580211 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m11:41:12.580211 [info ] [MainThread]: 
[0m11:41:12.581691 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m11:41:12.581691 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m11:41:12.583194 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m11:41:12.583194 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m11:41:12.588197 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m11:41:12.589197 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 11:41:12.584197 => 11:41:12.589197
[0m11:41:12.589197 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m11:41:12.613764 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m11:41:12.614771 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.615769 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m11:41:12.615769 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:12.661294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.662295 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.662295 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m11:41:12.670020 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m11:41:12.674323 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.674323 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m11:41:12.675323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:41:12.677323 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.677323 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m11:41:12.678323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:41:12.690519 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:41:12.690519 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.690519 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:41:12.691849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:41:12.695373 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m11:41:12.698373 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:41:12.699373 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m11:41:12.701372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:41:12.702373 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 11:41:12.589197 => 11:41:12.702373
[0m11:41:12.702373 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m11:41:12.703374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8EAA080>]}
[0m11:41:12.703882 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m11:41:12.703882 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m11:41:12.705258 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m11:41:12.705258 [info ] [Thread-3 (]: 2 of 4 START sql incremental model staging.stg_web__transactions ............... [RUN]
[0m11:41:12.706264 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m11:41:12.707263 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m11:41:12.711261 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m11:41:12.712262 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 11:41:12.707263 => 11:41:12.712262
[0m11:41:12.712262 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m11:41:12.730276 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.730276 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

    
  
    

  create temporary table "stg_web__transactions__dbt_tmp114112726276"
  
  
    as
  
  (
    



with source as (
    select * from "dbt"."public"."transactions"



  where _loaded_at_utc > (select max(_loaded_at_utc) from "dbt"."staging"."stg_web__transactions")



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
  
[0m11:41:12.731276 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:41:12.897909 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:41:12.901911 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.903416 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m11:41:12.903416 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:41:12.904421 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.904421 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions__dbt_tmp114112726276'
        
      order by ordinal_position

  
[0m11:41:12.908420 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:41:12.912422 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.912422 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:41:12.914931 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:41:12.919932 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.919932 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:41:12.921932 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:41:12.929446 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m11:41:12.930446 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.930446 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      insert into "dbt"."staging"."stg_web__transactions" ("id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc")
    (
        select "id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc"
        from "stg_web__transactions__dbt_tmp114112726276"
    )


  
[0m11:41:12.931447 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m11:41:12.932751 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:41:12.933316 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:41:12.933316 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:41:12.934263 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:41:12.938494 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 11:41:12.713261 => 11:41:12.938494
[0m11:41:12.939504 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m11:41:12.939504 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8EEC1F0>]}
[0m11:41:12.940506 [info ] [Thread-3 (]: 2 of 4 OK created sql incremental model staging.stg_web__transactions .......... [[32mINSERT 0 0[0m in 0.23s]
[0m11:41:12.941502 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m11:41:12.941502 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m11:41:12.942503 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m11:41:12.943502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m11:41:12.943502 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m11:41:12.945009 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m11:41:12.946009 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 11:41:12.944006 => 11:41:12.946009
[0m11:41:12.946009 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m11:41:12.958520 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m11:41:12.959521 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:41:12.959521 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m11:41:12.960524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:13.013257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:41:13.013257 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:41:13.014347 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m11:41:13.016346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:41:13.018346 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:41:13.018346 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m11:41:13.019346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:41:13.020347 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:41:13.020347 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:41:13.021346 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:41:13.022154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:41:13.023151 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m11:41:13.025154 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:41:13.026154 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m11:41:13.026154 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:41:13.027154 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 11:41:12.947010 => 11:41:13.027154
[0m11:41:13.028154 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m11:41:13.028154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8F0EFB0>]}
[0m11:41:13.029155 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.09s]
[0m11:41:13.030398 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m11:41:13.030398 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m11:41:13.031401 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m11:41:13.031401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m11:41:13.032405 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m11:41:13.035918 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m11:41:13.036917 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 11:41:13.032405 => 11:41:13.036917
[0m11:41:13.036917 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m11:41:13.039917 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m11:41:13.039917 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.040919 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m11:41:13.040919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:41:13.087573 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:41:13.088572 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.088572 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m11:41:13.096581 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m11:41:13.099584 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.099584 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m11:41:13.100585 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:41:13.102584 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.102584 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m11:41:13.102584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:41:13.104762 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:41:13.104762 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.104762 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:41:13.105761 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:41:13.108760 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m11:41:13.108760 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:41:13.109760 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m11:41:13.110761 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:41:13.111762 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 11:41:13.036917 => 11:41:13.111762
[0m11:41:13.111762 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m11:41:13.113265 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '747e5245-11ad-4982-9af4-9a59feb51a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8F0EF20>]}
[0m11:41:13.113265 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.08s]
[0m11:41:13.114269 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m11:41:13.115270 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:13.116269 [debug] [MainThread]: On master: BEGIN
[0m11:41:13.116269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:13.164288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:41:13.164288 [debug] [MainThread]: On master: COMMIT
[0m11:41:13.165289 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:13.165289 [debug] [MainThread]: On master: COMMIT
[0m11:41:13.165289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:41:13.166288 [debug] [MainThread]: On master: Close
[0m11:41:13.166288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:13.167289 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:41:13.167289 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:41:13.167289 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m11:41:13.168290 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m11:41:13.168290 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m11:41:13.168290 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m11:41:13.168290 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m11:41:13.169289 [info ] [MainThread]: 
[0m11:41:13.169289 [info ] [MainThread]: Finished running 2 table models, 1 incremental model, 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m11:41:13.170288 [debug] [MainThread]: Command end result
[0m11:41:13.176390 [info ] [MainThread]: 
[0m11:41:13.177352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:13.177352 [info ] [MainThread]: 
[0m11:41:13.178392 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:41:13.179397 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:13.179397 after 1.43 seconds
[0m11:41:13.179397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED5397220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8EFC8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED8B2A2F0>]}
[0m11:41:13.180394 [debug] [MainThread]: Flushing usage events
[0m11:43:45.762478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E55704460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E589FAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E589FA9E0>]}


============================== 11:43:45.765478 | f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c ==============================
[0m11:43:45.765478 [info ] [MainThread]: Running with dbt=1.7.2
[0m11:43:45.766478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:45.890698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E589FAC80>]}
[0m11:43:45.948701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E589F99F0>]}
[0m11:43:45.949701 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m11:43:45.959207 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m11:43:46.037207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:43:46.038207 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m11:43:46.233125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E591F9B40>]}
[0m11:43:46.241087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E58E689D0>]}
[0m11:43:46.241087 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m11:43:46.242087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E58E68C40>]}
[0m11:43:46.243087 [info ] [MainThread]: 
[0m11:43:46.243768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:46.244774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:43:46.245775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:43:46.251773 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:43:46.253773 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:43:46.253773 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:43:46.254772 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:43:46.254772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:46.254772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:46.303946 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:43:46.304944 [debug] [ThreadPool]: On list_dbt: Close
[0m11:43:46.332863 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:43:46.333863 [debug] [ThreadPool]: On list_dbt: Close
[0m11:43:46.335863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m11:43:46.336863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m11:43:46.339863 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:43:46.340863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m11:43:46.341866 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:43:46.342866 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m11:43:46.343866 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:43:46.343866 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m11:43:46.343866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:46.344866 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m11:43:46.344866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:46.345866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:46.393006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.393006 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:43:46.394005 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:43:46.396004 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:43:46.397004 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m11:43:46.397004 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m11:43:46.398005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_snapshots, now list_dbt_public)
[0m11:43:46.399986 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:43:46.399986 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m11:43:46.400984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:46.421005 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.421985 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:43:46.421985 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m11:43:46.424005 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:43:46.425005 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m11:43:46.426005 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m11:43:46.453040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.453040 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:43:46.454083 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:43:46.456092 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:43:46.456780 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m11:43:46.456780 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m11:43:46.482821 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.483823 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:43:46.483823 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:43:46.485822 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:43:46.486821 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m11:43:46.486821 [debug] [ThreadPool]: On list_dbt_public: Close
[0m11:43:46.490822 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:46.490822 [debug] [MainThread]: On master: BEGIN
[0m11:43:46.491821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:46.536163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.537164 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:46.537164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:46.540163 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:43:46.541163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5921FCD0>]}
[0m11:43:46.542166 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:46.542166 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:46.543166 [debug] [MainThread]: On master: BEGIN
[0m11:43:46.543577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.543577 [debug] [MainThread]: On master: COMMIT
[0m11:43:46.543577 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:46.544584 [debug] [MainThread]: On master: COMMIT
[0m11:43:46.544584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:43:46.544584 [debug] [MainThread]: On master: Close
[0m11:43:46.545627 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m11:43:46.545627 [info ] [MainThread]: 
[0m11:43:46.548583 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m11:43:46.548583 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m11:43:46.549584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m11:43:46.549584 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m11:43:46.554582 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m11:43:46.554582 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 11:43:46.549584 => 11:43:46.554582
[0m11:43:46.554582 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m11:43:46.579088 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m11:43:46.580088 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.581088 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m11:43:46.581088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:43:46.628088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.629089 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.629089 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m11:43:46.635925 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m11:43:46.639930 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.640928 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m11:43:46.640928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:46.642931 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.643931 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m11:43:46.643931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:46.655931 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:43:46.656434 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.656434 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:43:46.657438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:43:46.661437 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m11:43:46.664437 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:43:46.664437 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m11:43:46.666124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:46.667130 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 11:43:46.554582 => 11:43:46.667130
[0m11:43:46.668130 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m11:43:46.668130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E591BECB0>]}
[0m11:43:46.669129 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.12s]
[0m11:43:46.670130 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m11:43:46.671128 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m11:43:46.671128 [info ] [Thread-3 (]: 2 of 4 START sql incremental model staging.stg_web__transactions ............... [RUN]
[0m11:43:46.672129 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m11:43:46.672129 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m11:43:46.677130 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m11:43:46.678130 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 11:43:46.673129 => 11:43:46.677130
[0m11:43:46.678130 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m11:43:46.695128 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.696128 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

    
  
    

  create temporary table "stg_web__transactions__dbt_tmp114346691128"
  
  
    as
  
  (
    



with source as (
    select * from "dbt"."public"."transactions"



  where _loaded_at_utc > (select max(_loaded_at_utc) from "dbt"."staging"."stg_web__transactions")



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc,
        'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c' as batch_id
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
  
[0m11:43:46.696128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:43:46.745154 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:43:46.750153 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.751153 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m11:43:46.751153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.751153 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.752153 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions__dbt_tmp114346691128'
        
      order by ordinal_position

  
[0m11:43:46.756154 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.0 seconds
[0m11:43:46.759663 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.759663 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:43:46.761665 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:43:46.766663 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.766663 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:43:46.768663 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:43:46.775665 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m11:43:46.776665 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.776665 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      insert into "dbt"."staging"."stg_web__transactions" ("id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc")
    (
        select "id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc"
        from "stg_web__transactions__dbt_tmp114346691128"
    )


  
[0m11:43:46.777666 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m11:43:46.778666 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:43:46.778666 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:43:46.779665 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:43:46.779665 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:43:46.780664 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 11:43:46.678130 => 11:43:46.780664
[0m11:43:46.781665 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m11:43:46.781665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5921FCA0>]}
[0m11:43:46.782665 [info ] [Thread-3 (]: 2 of 4 OK created sql incremental model staging.stg_web__transactions .......... [[32mINSERT 0 0[0m in 0.11s]
[0m11:43:46.783665 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m11:43:46.783665 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m11:43:46.784664 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m11:43:46.785665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m11:43:46.785665 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m11:43:46.787663 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.788663 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 11:43:46.785665 => 11:43:46.787663
[0m11:43:46.788663 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m11:43:46.800664 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.801663 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.801663 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m11:43:46.802663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:46.850668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.851668 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.851668 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m11:43:46.853668 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:43:46.856175 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.856175 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m11:43:46.857180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:46.858181 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:43:46.858181 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.859180 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:43:46.859180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:43:46.861182 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m11:43:46.863181 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:43:46.864181 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m11:43:46.864181 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:43:46.865180 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 11:43:46.788663 => 11:43:46.865180
[0m11:43:46.866182 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m11:43:46.866182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E591E68C0>]}
[0m11:43:46.867180 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.08s]
[0m11:43:46.868180 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m11:43:46.868180 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m11:43:46.869180 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m11:43:46.869180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m11:43:46.870180 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m11:43:46.874179 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m11:43:46.874179 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 11:43:46.870180 => 11:43:46.874179
[0m11:43:46.875181 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m11:43:46.878181 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m11:43:46.879181 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.879181 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m11:43:46.879181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:43:46.933179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:43:46.934179 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.934179 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m11:43:46.941730 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m11:43:46.944734 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.944734 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m11:43:46.944734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:46.946734 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.947734 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m11:43:46.947734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:46.949734 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:43:46.949734 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.949734 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:43:46.950734 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:43:46.953734 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m11:43:46.953734 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:43:46.954734 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m11:43:46.956238 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:46.957242 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 11:43:46.875181 => 11:43:46.956238
[0m11:43:46.957242 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m11:43:46.958246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b0f5e5-39c3-4b5f-ade5-e99ebf4c2f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5938E200>]}
[0m11:43:46.958246 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.09s]
[0m11:43:46.959242 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m11:43:46.960242 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:46.960242 [debug] [MainThread]: On master: BEGIN
[0m11:43:46.961241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:47.008442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:47.009441 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.009441 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.009441 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.010442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:43:47.010442 [debug] [MainThread]: On master: Close
[0m11:43:47.011442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:47.011442 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:43:47.011442 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:43:47.011442 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m11:43:47.011442 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m11:43:47.012931 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m11:43:47.012931 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m11:43:47.012931 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m11:43:47.012931 [info ] [MainThread]: 
[0m11:43:47.014018 [info ] [MainThread]: Finished running 2 table models, 1 incremental model, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m11:43:47.015022 [debug] [MainThread]: Command end result
[0m11:43:47.021021 [info ] [MainThread]: 
[0m11:43:47.021021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:47.022022 [info ] [MainThread]: 
[0m11:43:47.022022 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:43:47.023023 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:47.023023 after 1.30 seconds
[0m11:43:47.024022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E55704460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E589F99F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E58E68A60>]}
[0m11:43:47.024022 [debug] [MainThread]: Flushing usage events
[0m11:45:18.423601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD5C6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B08C2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B08C2B60>]}


============================== 11:45:18.426611 | 61b6445a-23a0-4ed7-835d-eaddf90a9399 ==============================
[0m11:45:18.426611 [info ] [MainThread]: Running with dbt=1.7.2
[0m11:45:18.427610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:45:18.550441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A9542E00>]}
[0m11:45:18.608990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0876CB0>]}
[0m11:45:18.609989 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m11:45:18.619495 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m11:45:18.700073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:18.701080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:18.704725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0D62410>]}
[0m11:45:18.713308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0D24DF0>]}
[0m11:45:18.714234 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m11:45:18.715234 [info ] [MainThread]: 
[0m11:45:18.716234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:18.717233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:45:18.718233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:45:18.724746 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:45:18.725746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:45:18.727746 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:45:18.727746 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:45:18.728746 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:45:18.729746 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:45:18.729746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.729746 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:45:18.730746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.730746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.780316 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:45:18.781316 [debug] [ThreadPool]: On list_dbt: Close
[0m11:45:18.783823 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:45:18.783823 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:45:18.783823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:18.810918 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:45:18.811919 [debug] [ThreadPool]: On list_dbt: Close
[0m11:45:18.843703 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:45:18.844709 [debug] [ThreadPool]: On list_dbt: Close
[0m11:45:18.873236 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:45:18.873741 [debug] [ThreadPool]: On list_dbt: Close
[0m11:45:18.875746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m11:45:18.875746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m11:45:18.880747 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:45:18.881746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m11:45:18.883251 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:45:18.883251 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m11:45:18.885256 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:45:18.886257 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m11:45:18.886257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.886257 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m11:45:18.887257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.887257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:18.933440 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:18.933945 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:45:18.933945 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:45:18.935950 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:18.936950 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m11:45:18.937951 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m11:45:18.937951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_snapshots, now list_dbt_public)
[0m11:45:18.939950 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:45:18.940950 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m11:45:18.940950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:18.969029 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:18.970029 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:45:18.970029 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:45:18.972029 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:45:18.973598 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m11:45:18.973598 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m11:45:19.000640 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.001640 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:45:19.001640 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m11:45:19.003641 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:45:19.005205 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m11:45:19.005205 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m11:45:19.032201 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.033201 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:45:19.033201 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:19.035712 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:45:19.036711 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m11:45:19.036711 [debug] [ThreadPool]: On list_dbt_public: Close
[0m11:45:19.040711 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.040711 [debug] [MainThread]: On master: BEGIN
[0m11:45:19.040711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:19.086696 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.087697 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.087697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:19.090695 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:45:19.091695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0DBF730>]}
[0m11:45:19.093226 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:19.093293 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.093293 [debug] [MainThread]: On master: BEGIN
[0m11:45:19.094264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.094264 [debug] [MainThread]: On master: COMMIT
[0m11:45:19.094264 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.095264 [debug] [MainThread]: On master: COMMIT
[0m11:45:19.095264 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:19.095264 [debug] [MainThread]: On master: Close
[0m11:45:19.096263 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m11:45:19.096263 [info ] [MainThread]: 
[0m11:45:19.098262 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m11:45:19.099262 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m11:45:19.099262 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:45:19.099262 [info ] [Thread-1 (]: 1 of 24 START seed file public.contacts ........................................ [RUN]
[0m11:45:19.100267 [info ] [Thread-2 (]: 2 of 24 START seed file public.transactions .................................... [RUN]
[0m11:45:19.100267 [info ] [Thread-3 (]: 3 of 24 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m11:45:19.101264 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m11:45:19.102264 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m11:45:19.102264 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m11:45:19.103264 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m11:45:19.103807 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m11:45:19.103807 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:45:19.103807 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 11:45:19.103807 => 11:45:19.103807
[0m11:45:19.104846 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 11:45:19.104846 => 11:45:19.104846
[0m11:45:19.116443 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:45:19.117443 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m11:45:19.117443 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m11:45:19.128022 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 11:45:19.104846 => 11:45:19.127022
[0m11:45:19.139568 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:45:19.140567 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:45:19.144072 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:45:19.144072 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m11:45:19.153581 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:45:19.154586 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m11:45:19.154586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:45:19.155586 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:45:19.155586 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:45:19.156585 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m11:45:19.156585 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:45:19.202135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.203640 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:45:19.203640 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m11:45:19.209648 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m11:45:19.231334 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:45:19.232337 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m11:45:19.233337 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m11:45:19.236560 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m11:45:19.237562 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.238556 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:45:19.247081 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m11:45:19.248084 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m11:45:19.248084 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:45:19.249080 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m11:45:19.251081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:19.252083 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 11:45:19.118445 => 11:45:19.252083
[0m11:45:19.252083 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m11:45:19.252083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0B29330>]}
[0m11:45:19.253589 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m11:45:19.253589 [info ] [Thread-1 (]: 1 of 24 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.15s]
[0m11:45:19.302169 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.348785 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m11:45:19.356293 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:45:19.356293 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:45:19.357293 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:45:19.357293 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m11:45:19.358293 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m11:45:19.358293 [info ] [Thread-1 (]: 4 of 24 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m11:45:19.359294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m11:45:19.360294 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:45:19.364805 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:45:19.365806 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m11:45:19.365806 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m11:45:19.367311 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 11:45:19.360294 => 11:45:19.365806
[0m11:45:19.367311 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:45:19.369316 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:45:19.370316 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m11:45:19.370316 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:45:19.371316 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m11:45:19.371316 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:45:19.372316 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m11:45:19.372316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:19.373316 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:19.373821 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.373821 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 11:45:19.128022 => 11:45:19.373821
[0m11:45:19.375826 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 11:45:19.144072 => 11:45:19.375826
[0m11:45:19.375826 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m11:45:19.376826 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m11:45:19.376826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0E5AC20>]}
[0m11:45:19.377826 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m11:45:19.377826 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.28s]
[0m11:45:19.379827 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m11:45:19.378826 [info ] [Thread-3 (]: 3 of 24 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.28s]
[0m11:45:19.379827 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:45:19.380827 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:45:19.380827 [info ] [Thread-2 (]: 5 of 24 START test source_not_null_web_transactions_id ......................... [RUN]
[0m11:45:19.381827 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:45:19.381827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m11:45:19.383331 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:45:19.381827 [info ] [Thread-3 (]: 6 of 24 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m11:45:19.386336 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:45:19.387336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m11:45:19.387336 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:45:19.391336 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:45:19.392336 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 11:45:19.383331 => 11:45:19.392336
[0m11:45:19.392336 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:45:19.394848 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:45:19.394848 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 11:45:19.387336 => 11:45:19.394848
[0m11:45:19.394848 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:45:19.395848 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:45:19.397850 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:45:19.397850 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m11:45:19.398848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:19.398848 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:45:19.399870 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m11:45:19.399870 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:19.424401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.425401 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:45:19.425401 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m11:45:19.426401 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.427401 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 11:45:19.367311 => 11:45:19.427401
[0m11:45:19.428403 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m11:45:19.428403 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m11:45:19.429430 [info ] [Thread-1 (]: 4 of 24 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.07s]
[0m11:45:19.430404 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:45:19.430404 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:45:19.431403 [info ] [Thread-1 (]: 7 of 24 START test source_unique_web_transactions_id ........................... [RUN]
[0m11:45:19.432402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m11:45:19.432402 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:45:19.435912 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:45:19.435912 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 11:45:19.432402 => 11:45:19.435912
[0m11:45:19.436912 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:45:19.437911 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:45:19.438912 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:45:19.438912 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m11:45:19.439912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:19.456979 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.457980 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:45:19.457980 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m11:45:19.458979 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.459981 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 11:45:19.393337 => 11:45:19.459981
[0m11:45:19.460980 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m11:45:19.460980 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m11:45:19.461979 [info ] [Thread-2 (]: 5 of 24 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.08s]
[0m11:45:19.461979 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:45:19.519817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.520817 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:45:19.520817 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:45:19.521820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.523414 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 11:45:19.436912 => 11:45:19.523414
[0m11:45:19.524388 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m11:45:19.524388 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m11:45:19.525390 [info ] [Thread-1 (]: 7 of 24 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.09s]
[0m11:45:19.525390 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:45:19.601115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.602113 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:45:19.602113 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:45:19.603617 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.604623 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 11:45:19.395848 => 11:45:19.604623
[0m11:45:19.604623 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m11:45:19.605628 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m11:45:19.606628 [warn ] [Thread-3 (]: 6 of 24 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.22s]
[0m11:45:19.606628 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:45:19.607627 [debug] [Thread-2 (]: Began running node model.customer360.stg_sf__contacts
[0m11:45:19.608627 [info ] [Thread-2 (]: 8 of 24 START sql table model staging.stg_sf__contacts ......................... [RUN]
[0m11:45:19.608627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now model.customer360.stg_sf__contacts)
[0m11:45:19.609627 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_sf__contacts
[0m11:45:19.611626 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m11:45:19.611626 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (compile): 11:45:19.609627 => 11:45:19.611626
[0m11:45:19.612626 [debug] [Thread-2 (]: Began executing node model.customer360.stg_sf__contacts
[0m11:45:19.635155 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m11:45:19.636159 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.636159 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m11:45:19.636159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:19.684910 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.684910 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.685910 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m11:45:19.692453 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.0 seconds
[0m11:45:19.697418 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.697418 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m11:45:19.697418 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:19.699421 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.700421 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m11:45:19.700421 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:19.705935 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:45:19.706935 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.706935 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:45:19.707934 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:19.711933 [debug] [Thread-2 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m11:45:19.714438 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:45:19.715441 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m11:45:19.717441 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:45:19.718441 [debug] [Thread-2 (]: Timing info for model.customer360.stg_sf__contacts (execute): 11:45:19.612626 => 11:45:19.718441
[0m11:45:19.718441 [debug] [Thread-2 (]: On model.customer360.stg_sf__contacts: Close
[0m11:45:19.719441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0FA1F90>]}
[0m11:45:19.719441 [info ] [Thread-2 (]: 8 of 24 OK created sql table model staging.stg_sf__contacts .................... [[32mSELECT 11[0m in 0.11s]
[0m11:45:19.720441 [debug] [Thread-2 (]: Finished running node model.customer360.stg_sf__contacts
[0m11:45:19.721441 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:45:19.721441 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:45:19.722441 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m11:45:19.722441 [info ] [Thread-1 (]: 10 of 24 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m11:45:19.723943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m11:45:19.723943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m11:45:19.724947 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:45:19.724947 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:45:19.727947 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:45:19.730948 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:45:19.731947 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 11:45:19.724947 => 11:45:19.731947
[0m11:45:19.731947 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:45:19.733491 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:45:19.734497 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 11:45:19.728956 => 11:45:19.733491
[0m11:45:19.734497 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:45:19.734497 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:45:19.736496 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:45:19.736496 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m11:45:19.737496 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:19.737496 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:45:19.738496 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m11:45:19.738496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:19.786037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.786037 [debug] [Thread-3 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:45:19.786037 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."staging"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m11:45:19.787037 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.789037 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 11:45:19.731947 => 11:45:19.788036
[0m11:45:19.789037 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m11:45:19.789037 [debug] [Thread-3 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m11:45:19.790038 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m11:45:19.791038 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:45:19.818262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.818262 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:45:19.819263 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:45:19.820262 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:19.821264 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 11:45:19.735496 => 11:45:19.821264
[0m11:45:19.822262 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m11:45:19.822262 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m11:45:19.823264 [info ] [Thread-1 (]: 10 of 24 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m11:45:19.823264 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:45:19.824721 [debug] [Thread-2 (]: Began running node model.customer360.stg_web__transactions
[0m11:45:19.824721 [debug] [Thread-3 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:45:19.824721 [info ] [Thread-2 (]: 11 of 24 START sql incremental model staging.stg_web__transactions ............. [RUN]
[0m11:45:19.825722 [info ] [Thread-3 (]: 12 of 24 START snapshot snapshots.stg_sf__contacts_snapshot .................... [RUN]
[0m11:45:19.826721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m11:45:19.826721 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now snapshot.customer360.stg_sf__contacts_snapshot)
[0m11:45:19.826721 [debug] [Thread-2 (]: Began compiling node model.customer360.stg_web__transactions
[0m11:45:19.827721 [debug] [Thread-3 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:45:19.833224 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m11:45:19.836226 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 11:45:19.834227 => 11:45:19.835227
[0m11:45:19.836226 [debug] [Thread-3 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:45:19.849449 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (compile): 11:45:19.827721 => 11:45:19.849449
[0m11:45:19.860957 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:19.861957 [debug] [Thread-2 (]: Began executing node model.customer360.stg_web__transactions
[0m11:45:19.861957 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m11:45:19.879404 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.880404 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:19.880404 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

    
  
    

  create temporary table "stg_web__transactions__dbt_tmp114519875405"
  
  
    as
  
  (
    



with source as (
    select * from "dbt"."public"."transactions"



  where _loaded_at_utc > (select max(_loaded_at_utc) from "dbt"."staging"."stg_web__transactions")



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc,
        '61b6445a-23a0-4ed7-835d-eaddf90a9399' as batch_id
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
  
[0m11:45:19.881406 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:19.958986 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:45:19.961989 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.961989 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: BEGIN
[0m11:45:19.961989 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:19.963493 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.963493 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions__dbt_tmp114519875405'
        
      order by ordinal_position

  
[0m11:45:19.967496 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.0 seconds
[0m11:45:19.970897 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.971897 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:45:19.973454 [debug] [Thread-2 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:45:19.978410 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.979410 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:45:19.981410 [debug] [Thread-2 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:45:19.988927 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m11:45:19.989926 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.989926 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      insert into "dbt"."staging"."stg_web__transactions" ("id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc")
    (
        select "id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc"
        from "stg_web__transactions__dbt_tmp114519875405"
    )


  
[0m11:45:19.990925 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m11:45:19.991927 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:45:19.991927 [debug] [Thread-2 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:45:19.991927 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:45:19.993547 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:19.993547 [debug] [Thread-2 (]: Timing info for model.customer360.stg_web__transactions (execute): 11:45:19.861957 => 11:45:19.993547
[0m11:45:19.994552 [debug] [Thread-2 (]: On model.customer360.stg_web__transactions: Close
[0m11:45:19.994552 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0FC4160>]}
[0m11:45:19.995552 [info ] [Thread-2 (]: 11 of 24 OK created sql incremental model staging.stg_web__transactions ........ [[32mINSERT 0 0[0m in 0.17s]
[0m11:45:19.996551 [debug] [Thread-2 (]: Finished running node model.customer360.stg_web__transactions
[0m11:45:19.996551 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:45:19.997552 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:45:19.997552 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m11:45:19.998554 [info ] [Thread-2 (]: 14 of 24 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m11:45:19.998554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m11:45:19.999733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m11:45:19.999733 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:45:19.999733 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:45:20.003240 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:45:20.009243 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:45:20.010243 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 11:45:20.000738 => 11:45:20.010243
[0m11:45:20.010243 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:45:20.011244 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 11:45:20.004243 => 11:45:20.011244
[0m11:45:20.012244 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:45:20.013243 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:45:20.014384 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:45:20.015385 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:45:20.015385 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m11:45:20.016386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:20.016386 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:45:20.017385 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m11:45:20.017385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:20.031892 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.031892 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.033396 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:45:20.038400 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:45:20.046801 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.046801 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

        
  
    

  create temporary table "stg_sf__contacts_snapshot__dbt_tmp114520041401"
  
  
    as
  
  (
    with snapshot_query as (

        





select * from "dbt"."staging"."stg_sf__contacts"


    ),

    snapshotted_data as (

        select *,
            new_id as dbt_unique_key

        from "dbt"."snapshots"."stg_sf__contacts_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m11:45:20.050803 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.0 seconds
[0m11:45:20.051803 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.053305 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp114520041401'
        
      order by ordinal_position

  
[0m11:45:20.056314 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:45:20.059313 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.059313 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:45:20.062313 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:45:20.063815 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.064818 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp114520041401'
        
      order by ordinal_position

  
[0m11:45:20.067321 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:45:20.069323 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.070325 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:45:20.070325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.071326 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:45:20.071326 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."staging"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m11:45:20.072326 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:45:20.072326 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.076834 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.077834 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 11:45:20.011244 => 11:45:20.077834
[0m11:45:20.078835 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp114520041401'
        
      order by ordinal_position

  
[0m11:45:20.078835 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m11:45:20.079834 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m11:45:20.079834 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.08s]
[0m11:45:20.080834 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:45:20.080834 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:45:20.081835 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:45:20.086345 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.086345 [info ] [Thread-1 (]: 15 of 24 START test unique_stg_web__transactions_id ............................ [RUN]
[0m11:45:20.087344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m11:45:20.088344 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.088344 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:45:20.088344 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      update "dbt"."snapshots"."stg_sf__contacts_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_sf__contacts_snapshot__dbt_tmp114520041401" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_valid_to is null;

    insert into "dbt"."snapshots"."stg_sf__contacts_snapshot" ("id", "new_id", "user_name", "name", "gender", "address", "email_address", "birth_date", "_loaded_at_utc", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."new_id",DBT_INTERNAL_SOURCE."user_name",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."gender",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."email_address",DBT_INTERNAL_SOURCE."birth_date",DBT_INTERNAL_SOURCE."_loaded_at_utc",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_sf__contacts_snapshot__dbt_tmp114520041401" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:45:20.091345 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:45:20.092345 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 11:45:20.089345 => 11:45:20.092345
[0m11:45:20.093344 [debug] [Thread-3 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m11:45:20.093344 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:45:20.094633 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m11:45:20.096633 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:45:20.096633 [debug] [Thread-3 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:45:20.097635 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m11:45:20.097635 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:45:20.098633 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m11:45:20.098633 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.098633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:20.101634 [debug] [Thread-3 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 11:45:19.836226 => 11:45:20.101634
[0m11:45:20.101634 [debug] [Thread-3 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m11:45:20.102632 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.102632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0FBC250>]}
[0m11:45:20.103633 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:45:20.103633 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."staging"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."staging"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:45:20.103633 [info ] [Thread-3 (]: 12 of 24 OK snapshotted snapshots.stg_sf__contacts_snapshot .................... [[32mINSERT 0 11[0m in 0.28s]
[0m11:45:20.104936 [debug] [Thread-3 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:45:20.105934 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:45:20.105934 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.105934 [info ] [Thread-3 (]: 16 of 24 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m11:45:20.106935 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 11:45:20.013243 => 11:45:20.106935
[0m11:45:20.107936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.customer360.stg_sf__contacts_snapshot, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m11:45:20.107936 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m11:45:20.108936 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:45:20.111933 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:45:20.111933 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m11:45:20.114441 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 11:45:20.108936 => 11:45:20.113437
[0m11:45:20.113437 [info ] [Thread-2 (]: 14 of 24 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m11:45:20.114441 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:45:20.115445 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:45:20.116446 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:45:20.117444 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:45:20.118445 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m11:45:20.118445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:20.178700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.179700 [debug] [Thread-3 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:45:20.179700 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."staging"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m11:45:20.180700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.181700 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 11:45:20.115445 => 11:45:20.181700
[0m11:45:20.181700 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m11:45:20.183204 [debug] [Thread-3 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m11:45:20.184208 [info ] [Thread-3 (]: 16 of 24 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.08s]
[0m11:45:20.184208 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:45:20.254477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.255478 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:45:20.255478 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:45:20.257477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.258477 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 11:45:20.094633 => 11:45:20.258477
[0m11:45:20.258477 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m11:45:20.259477 [debug] [Thread-1 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m11:45:20.259477 [info ] [Thread-1 (]: 15 of 24 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.17s]
[0m11:45:20.260477 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:45:20.261572 [debug] [Thread-2 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m11:45:20.261572 [info ] [Thread-2 (]: 17 of 24 START sql view model marts.contacts_joined_with_transactions .......... [RUN]
[0m11:45:20.262576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now model.customer360.contacts_joined_with_transactions)
[0m11:45:20.262576 [debug] [Thread-2 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m11:45:20.266082 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.266082 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 11:45:20.262576 => 11:45:20.266082
[0m11:45:20.267082 [debug] [Thread-2 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m11:45:20.278105 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.279105 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.279105 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m11:45:20.280105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:20.327148 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.327148 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.328148 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m11:45:20.330148 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:20.332149 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.332149 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m11:45:20.332149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:20.333651 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:45:20.334654 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.334654 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:45:20.335654 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.337654 [debug] [Thread-2 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m11:45:20.339654 [debug] [Thread-2 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:45:20.339654 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m11:45:20.340656 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:20.341655 [debug] [Thread-2 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 11:45:20.267082 => 11:45:20.341655
[0m11:45:20.341655 [debug] [Thread-2 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m11:45:20.342654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0F5A5F0>]}
[0m11:45:20.343654 [info ] [Thread-2 (]: 17 of 24 OK created sql view model marts.contacts_joined_with_transactions ..... [[32mCREATE VIEW[0m in 0.08s]
[0m11:45:20.343654 [debug] [Thread-2 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m11:45:20.345033 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:45:20.345033 [debug] [Thread-3 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:45:20.345033 [info ] [Thread-1 (]: 18 of 24 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m11:45:20.346032 [info ] [Thread-3 (]: 19 of 24 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m11:45:20.346032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m11:45:20.347033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m11:45:20.347033 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:45:20.348032 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:45:20.351032 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:45:20.353535 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:45:20.354538 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 11:45:20.348032 => 11:45:20.354538
[0m11:45:20.354538 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 11:45:20.351032 => 11:45:20.354538
[0m11:45:20.354538 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:45:20.355538 [debug] [Thread-3 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:45:20.357538 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:45:20.358538 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:45:20.359538 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:45:20.359538 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:45:20.360538 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m11:45:20.360538 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m11:45:20.360538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:20.361538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:20.411576 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.412577 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:45:20.412577 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:45:20.414080 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.415084 [debug] [Thread-3 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 11:45:20.357538 => 11:45:20.415084
[0m11:45:20.416083 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m11:45:20.416083 [debug] [Thread-3 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m11:45:20.417084 [info ] [Thread-3 (]: 19 of 24 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.07s]
[0m11:45:20.418084 [debug] [Thread-3 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:45:20.442097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.442097 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:45:20.443600 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m11:45:20.444605 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.445609 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 11:45:20.355538 => 11:45:20.445609
[0m11:45:20.446611 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m11:45:20.446611 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m11:45:20.447608 [info ] [Thread-1 (]: 18 of 24 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.10s]
[0m11:45:20.448609 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:45:20.448609 [debug] [Thread-2 (]: Began running node model.customer360.customers
[0m11:45:20.449609 [info ] [Thread-2 (]: 20 of 24 START sql table model marts.customers ................................. [RUN]
[0m11:45:20.450608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m11:45:20.450608 [debug] [Thread-2 (]: Began compiling node model.customer360.customers
[0m11:45:20.455114 [debug] [Thread-2 (]: Writing injected SQL for node "model.customer360.customers"
[0m11:45:20.456115 [debug] [Thread-2 (]: Timing info for model.customer360.customers (compile): 11:45:20.450608 => 11:45:20.455114
[0m11:45:20.456115 [debug] [Thread-2 (]: Began executing node model.customer360.customers
[0m11:45:20.460114 [debug] [Thread-2 (]: Writing runtime sql for node "model.customer360.customers"
[0m11:45:20.460114 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.461114 [debug] [Thread-2 (]: On model.customer360.customers: BEGIN
[0m11:45:20.461114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:20.618836 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.619836 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.619836 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m11:45:20.627517 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.0 seconds
[0m11:45:20.630516 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.630516 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m11:45:20.630516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:20.632516 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.633516 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m11:45:20.633516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:20.635633 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m11:45:20.635633 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.635633 [debug] [Thread-2 (]: On model.customer360.customers: COMMIT
[0m11:45:20.636633 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.638633 [debug] [Thread-2 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m11:45:20.639633 [debug] [Thread-2 (]: Using postgres connection "model.customer360.customers"
[0m11:45:20.639633 [debug] [Thread-2 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m11:45:20.640818 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:45:20.641824 [debug] [Thread-2 (]: Timing info for model.customer360.customers (execute): 11:45:20.457116 => 11:45:20.641824
[0m11:45:20.641824 [debug] [Thread-2 (]: On model.customer360.customers: Close
[0m11:45:20.643327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b6445a-23a0-4ed7-835d-eaddf90a9399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0FE0B20>]}
[0m11:45:20.643327 [info ] [Thread-2 (]: 20 of 24 OK created sql table model marts.customers ............................ [[32mSELECT 9[0m in 0.19s]
[0m11:45:20.644333 [debug] [Thread-2 (]: Finished running node model.customer360.customers
[0m11:45:20.645332 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m11:45:20.645332 [debug] [Thread-3 (]: Began running node test.customer360.check_last_purchase_date
[0m11:45:20.645332 [debug] [Thread-2 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m11:45:20.646332 [info ] [Thread-1 (]: 21 of 24 START test check_first_purchase_date .................................. [RUN]
[0m11:45:20.646332 [info ] [Thread-3 (]: 22 of 24 START test check_last_purchase_date ................................... [RUN]
[0m11:45:20.647332 [info ] [Thread-2 (]: 23 of 24 START test check_purchase_amount_above_zero ........................... [RUN]
[0m11:45:20.647332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_first_purchase_date)
[0m11:45:20.648333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_last_purchase_date)
[0m11:45:20.648333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m11:45:20.649333 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m11:45:20.649333 [debug] [Thread-3 (]: Began compiling node test.customer360.check_last_purchase_date
[0m11:45:20.649333 [debug] [Thread-2 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m11:45:20.652333 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m11:45:20.654840 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m11:45:20.656841 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m11:45:20.656841 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 11:45:20.650333 => 11:45:20.656841
[0m11:45:20.657841 [debug] [Thread-3 (]: Timing info for test.customer360.check_last_purchase_date (compile): 11:45:20.652333 => 11:45:20.657841
[0m11:45:20.657841 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m11:45:20.657841 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 11:45:20.654840 => 11:45:20.657841
[0m11:45:20.658840 [debug] [Thread-3 (]: Began executing node test.customer360.check_last_purchase_date
[0m11:45:20.660840 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m11:45:20.660840 [debug] [Thread-2 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m11:45:20.661841 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m11:45:20.664349 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m11:45:20.664349 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m11:45:20.665351 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m11:45:20.665351 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m11:45:20.665351 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m11:45:20.665351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:20.666855 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m11:45:20.666855 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m11:45:20.667860 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:45:20.667860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:45:20.713433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.713936 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m11:45:20.713936 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m11:45:20.715940 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.716941 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 11:45:20.658840 => 11:45:20.716941
[0m11:45:20.716941 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m11:45:20.717942 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m11:45:20.717942 [info ] [Thread-1 (]: 21 of 24 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.07s]
[0m11:45:20.718941 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m11:45:20.719941 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m11:45:20.719941 [info ] [Thread-1 (]: 24 of 24 START test check_valid_customers ...................................... [RUN]
[0m11:45:20.720941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m11:45:20.720941 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m11:45:20.723444 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m11:45:20.724448 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 11:45:20.720941 => 11:45:20.724448
[0m11:45:20.724448 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m11:45:20.726452 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m11:45:20.727452 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m11:45:20.727452 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m11:45:20.727452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:20.744452 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.745452 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m11:45:20.745452 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m11:45:20.747452 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.748454 [debug] [Thread-3 (]: Timing info for test.customer360.check_last_purchase_date (execute): 11:45:20.660840 => 11:45:20.748454
[0m11:45:20.749453 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m11:45:20.749453 [debug] [Thread-3 (]: On test.customer360.check_last_purchase_date: Close
[0m11:45:20.750453 [info ] [Thread-3 (]: 22 of 24 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.10s]
[0m11:45:20.751452 [debug] [Thread-3 (]: Finished running node test.customer360.check_last_purchase_date
[0m11:45:20.778107 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.778107 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m11:45:20.779107 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m11:45:20.780108 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.781107 [debug] [Thread-2 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 11:45:20.663345 => 11:45:20.781107
[0m11:45:20.781107 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m11:45:20.782108 [debug] [Thread-2 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m11:45:20.782108 [info ] [Thread-2 (]: 23 of 24 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.13s]
[0m11:45:20.783610 [debug] [Thread-2 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m11:45:20.808439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.809438 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m11:45:20.809438 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."staging"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m11:45:20.810439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:45:20.811439 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 11:45:20.724448 => 11:45:20.811439
[0m11:45:20.812440 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m11:45:20.812440 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m11:45:20.813439 [info ] [Thread-1 (]: 24 of 24 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.09s]
[0m11:45:20.813946 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m11:45:20.814950 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.814950 [debug] [MainThread]: On master: BEGIN
[0m11:45:20.815950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:20.863495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.863495 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.864499 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.864499 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.864499 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.865499 [debug] [MainThread]: On master: Close
[0m11:45:20.865499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:20.865499 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:45:20.865499 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:45:20.867003 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:45:20.867003 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m11:45:20.867003 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m11:45:20.867003 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m11:45:20.868008 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m11:45:20.868008 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m11:45:20.868008 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m11:45:20.869008 [info ] [MainThread]: 
[0m11:45:20.869008 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 2 table models, 1 incremental model, 1 snapshot, 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m11:45:20.872007 [debug] [MainThread]: Command end result
[0m11:45:20.878512 [info ] [MainThread]: 
[0m11:45:20.879512 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m11:45:20.880513 [info ] [MainThread]: 
[0m11:45:20.880513 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m11:45:20.880513 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m11:45:20.881513 [info ] [MainThread]: 
[0m11:45:20.881513 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m11:45:20.882513 [info ] [MainThread]: 
[0m11:45:20.882513 [info ] [MainThread]: Done. PASS=23 WARN=1 ERROR=0 SKIP=0 TOTAL=24
[0m11:45:20.883514 [debug] [MainThread]: Command `dbt build` succeeded at 11:45:20.883514 after 2.50 seconds
[0m11:45:20.884546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD5C6AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0876CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0D24B50>]}
[0m11:45:20.884546 [debug] [MainThread]: Flushing usage events
[0m11:47:19.387979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572B096AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E392D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E392B00>]}


============================== 11:47:19.389977 | 073b2ca3-81b6-447f-abfd-b88331c7ff1f ==============================
[0m11:47:19.389977 [info ] [MainThread]: Running with dbt=1.7.2
[0m11:47:19.390977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile -s stg_web__transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:19.511489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015727100AC0>]}
[0m11:47:19.570197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E3493F0>]}
[0m11:47:19.571195 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m11:47:19.580328 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m11:47:19.659428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:19.659428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:19.663428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E83A3B0>]}
[0m11:47:19.671428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E800BB0>]}
[0m11:47:19.672428 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m11:47:19.672428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E800FA0>]}
[0m11:47:19.673428 [info ] [MainThread]: 
[0m11:47:19.674427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:47:19.675428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m11:47:19.676428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m11:47:19.682426 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:47:19.682426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m11:47:19.684515 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:47:19.684515 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m11:47:19.685563 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:47:19.686567 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m11:47:19.686567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:19.687530 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m11:47:19.687530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:19.687530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:19.736379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:47:19.737380 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:47:19.737380 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:47:19.739379 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:47:19.740379 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m11:47:19.741380 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m11:47:19.742380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_snapshots, now list_dbt_marts)
[0m11:47:19.743379 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:47:19.744380 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m11:47:19.744380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:19.766379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:47:19.767379 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:47:19.767379 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:47:19.769379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:47:19.770380 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m11:47:19.771379 [debug] [ThreadPool]: On list_dbt_public: Close
[0m11:47:19.797379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:47:19.797379 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:47:19.798381 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:47:19.800379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:47:19.801379 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m11:47:19.801379 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m11:47:19.827382 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:47:19.828383 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:47:19.828383 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m11:47:19.830382 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:47:19.831382 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m11:47:19.831382 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m11:47:19.835667 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:19.835667 [debug] [MainThread]: On master: BEGIN
[0m11:47:19.835667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:19.880666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:47:19.880666 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:19.881668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:47:19.884667 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:47:19.885666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '073b2ca3-81b6-447f-abfd-b88331c7ff1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E7DFB20>]}
[0m11:47:19.885666 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:19.886666 [debug] [MainThread]: On master: Close
[0m11:47:19.886666 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m11:47:19.887668 [info ] [MainThread]: 
[0m11:47:19.889667 [debug] [Thread-1 (]: Began running node model.customer360.stg_web__transactions
[0m11:47:19.890667 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m11:47:19.890667 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_web__transactions
[0m11:47:19.900666 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m11:47:19.900666 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (compile): 11:47:19.890667 => 11:47:19.900666
[0m11:47:19.901667 [debug] [Thread-1 (]: Began executing node model.customer360.stg_web__transactions
[0m11:47:19.901667 [debug] [Thread-1 (]: Timing info for model.customer360.stg_web__transactions (execute): 11:47:19.901667 => 11:47:19.901667
[0m11:47:19.902668 [debug] [Thread-1 (]: Finished running node model.customer360.stg_web__transactions
[0m11:47:19.902668 [debug] [Thread-3 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:47:19.903667 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:47:19.903667 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:47:19.904667 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.not_null_stg_web__transactions_id.7beb436b49'
[0m11:47:19.904667 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53'
[0m11:47:19.905667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m11:47:19.905667 [debug] [Thread-3 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:47:19.906668 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:47:19.906668 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:47:19.914667 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:47:19.919669 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:47:19.922670 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:47:19.924671 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 11:47:19.906668 => 11:47:19.923682
[0m11:47:19.924671 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 11:47:19.914667 => 11:47:19.924671
[0m11:47:19.925670 [debug] [Thread-3 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:47:19.925670 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 11:47:19.919669 => 11:47:19.925670
[0m11:47:19.925670 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:47:19.926670 [debug] [Thread-3 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 11:47:19.926670 => 11:47:19.926670
[0m11:47:19.926670 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:47:19.927670 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 11:47:19.926670 => 11:47:19.926670
[0m11:47:19.927670 [debug] [Thread-3 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:47:19.928669 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 11:47:19.927670 => 11:47:19.927670
[0m11:47:19.928669 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:47:19.929669 [debug] [Thread-3 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:47:19.929669 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:47:19.930669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m11:47:19.930669 [debug] [Thread-3 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:47:19.934175 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:47:19.935175 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 11:47:19.931669 => 11:47:19.934175
[0m11:47:19.935175 [debug] [Thread-3 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:47:19.935175 [debug] [Thread-3 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 11:47:19.935175 => 11:47:19.935175
[0m11:47:19.936176 [debug] [Thread-3 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:47:19.937176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:19.937176 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m11:47:19.937176 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m11:47:19.938176 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m11:47:19.938176 [debug] [MainThread]: Connection 'test.customer360.unique_stg_web__transactions_id.5518387fef' was properly closed.
[0m11:47:19.938176 [debug] [MainThread]: Connection 'test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499' was properly closed.
[0m11:47:19.939176 [debug] [MainThread]: Connection 'test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53' was properly closed.
[0m11:47:19.939176 [debug] [MainThread]: Command end result
[0m11:47:19.945176 [debug] [MainThread]: Excluded node 'not_null_stg_web__transactions_id' from results
[0m11:47:19.946176 [debug] [MainThread]: Excluded node 'relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_' from results
[0m11:47:19.946176 [debug] [MainThread]: Excluded node 'unique_stg_web__transactions_id' from results
[0m11:47:19.946176 [debug] [MainThread]: Excluded node 'value_above_zero_stg_web__transactions_amount' from results
[0m11:47:19.946176 [info ] [MainThread]: Compiled node 'stg_web__transactions' is:




with source as (
    select * from "dbt"."public"."transactions"



  where _loaded_at_utc > (select max(_loaded_at_utc) from "dbt"."staging"."stg_web__transactions")



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc,
        '073b2ca3-81b6-447f-abfd-b88331c7ff1f' as batch_id
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
[0m11:47:19.948176 [debug] [MainThread]: Command `dbt compile` succeeded at 11:47:19.948176 after 0.60 seconds
[0m11:47:19.949178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572B096AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E3493F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001572E8F81C0>]}
[0m11:47:19.949178 [debug] [MainThread]: Flushing usage events
[0m11:56:26.922671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5E8E4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF61BE2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF61BE2B00>]}


============================== 11:56:26.925250 | 6d107a1d-8a8e-4a98-b252-076e7d5bb21d ==============================
[0m11:56:26.925250 [info ] [MainThread]: Running with dbt=1.7.2
[0m11:56:26.926248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:56:27.047997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5A962E00>]}
[0m11:56:27.106031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF61B94F70>]}
[0m11:56:27.106031 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m11:56:27.116577 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m11:56:27.197314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:27.198315 [debug] [MainThread]: Partial parsing: updated file: customer360://models\staging\web\stg_web__transactions.sql
[0m11:56:27.399345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF623D9C60>]}
[0m11:56:27.407883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF62034D90>]}
[0m11:56:27.407883 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m11:56:27.410336 [info ] [MainThread]: 
[0m11:56:27.411374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:27.412372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:56:27.412372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:56:27.413372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:56:27.419633 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:56:27.421633 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:56:27.422633 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:56:27.422633 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:56:27.423633 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:56:27.423633 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:56:27.423633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.423633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.425072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.476256 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:56:27.477255 [debug] [ThreadPool]: On list_dbt: Close
[0m11:56:27.480255 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:56:27.480255 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:56:27.480255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:27.505280 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:56:27.506280 [debug] [ThreadPool]: On list_dbt: Close
[0m11:56:27.535801 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:56:27.536797 [debug] [ThreadPool]: On list_dbt: Close
[0m11:56:27.566447 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:56:27.567449 [debug] [ThreadPool]: On list_dbt: Close
[0m11:56:27.569448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m11:56:27.569448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_marts'
[0m11:56:27.570447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m11:56:27.573950 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:56:27.575955 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:56:27.576954 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:56:27.576954 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m11:56:27.577955 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m11:56:27.577955 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m11:56:27.577955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.578954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.578954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:27.624989 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.624989 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m11:56:27.624989 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:56:27.627991 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:56:27.628992 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m11:56:27.628992 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m11:56:27.629993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_staging, now list_dbt_snapshots)
[0m11:56:27.631994 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:56:27.631994 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m11:56:27.631994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:27.653513 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.654518 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m11:56:27.654518 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m11:56:27.656518 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:56:27.657517 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m11:56:27.658518 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m11:56:27.684158 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.684158 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m11:56:27.685162 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:56:27.686162 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:56:27.688670 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m11:56:27.689670 [debug] [ThreadPool]: On list_dbt_public: Close
[0m11:56:27.714197 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.714197 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m11:56:27.715201 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:56:27.717201 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:27.718202 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m11:56:27.718202 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m11:56:27.722201 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:27.722201 [debug] [MainThread]: On master: BEGIN
[0m11:56:27.722201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:27.768699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.768699 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:27.769699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:27.772700 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:56:27.774204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF62474100>]}
[0m11:56:27.774204 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:27.775209 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:27.775209 [debug] [MainThread]: On master: BEGIN
[0m11:56:27.776214 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.776214 [debug] [MainThread]: On master: COMMIT
[0m11:56:27.776214 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:27.776214 [debug] [MainThread]: On master: COMMIT
[0m11:56:27.777213 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:56:27.777213 [debug] [MainThread]: On master: Close
[0m11:56:27.778213 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m11:56:27.778213 [info ] [MainThread]: 
[0m11:56:27.780213 [debug] [Thread-1 (]: Began running node seed.integration_tests.contacts
[0m11:56:27.781214 [debug] [Thread-2 (]: Began running node seed.integration_tests.transactions
[0m11:56:27.781214 [debug] [Thread-3 (]: Began running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:56:27.781214 [info ] [Thread-1 (]: 1 of 24 START seed file public.contacts ........................................ [RUN]
[0m11:56:27.782214 [info ] [Thread-2 (]: 2 of 24 START seed file public.transactions .................................... [RUN]
[0m11:56:27.782214 [info ] [Thread-3 (]: 3 of 24 START test source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [RUN]
[0m11:56:27.782214 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.integration_tests.contacts'
[0m11:56:27.783716 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.integration_tests.transactions'
[0m11:56:27.783716 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5'
[0m11:56:27.784721 [debug] [Thread-1 (]: Began compiling node seed.integration_tests.contacts
[0m11:56:27.784721 [debug] [Thread-2 (]: Began compiling node seed.integration_tests.transactions
[0m11:56:27.784721 [debug] [Thread-3 (]: Began compiling node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:56:27.785721 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (compile): 11:56:27.785721 => 11:56:27.785721
[0m11:56:27.785721 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (compile): 11:56:27.785721 => 11:56:27.785721
[0m11:56:27.795601 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:56:27.796601 [debug] [Thread-1 (]: Began executing node seed.integration_tests.contacts
[0m11:56:27.796601 [debug] [Thread-2 (]: Began executing node seed.integration_tests.transactions
[0m11:56:27.808814 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (compile): 11:56:27.785721 => 11:56:27.807814
[0m11:56:27.819327 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:56:27.819327 [debug] [Thread-3 (]: Began executing node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:56:27.822327 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:56:27.822327 [debug] [Thread-1 (]: On seed.integration_tests.contacts: BEGIN
[0m11:56:27.832835 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:56:27.833836 [debug] [Thread-2 (]: On seed.integration_tests.transactions: BEGIN
[0m11:56:27.833836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:56:27.834884 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:56:27.834884 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:56:27.835885 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: BEGIN
[0m11:56:27.835885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:56:27.884417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.885416 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:56:27.885416 [debug] [Thread-1 (]: On seed.integration_tests.contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.contacts"} */
truncate table "dbt"."public"."contacts"
[0m11:56:27.890922 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m11:56:27.913496 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:56:27.913496 [debug] [Thread-1 (]: On seed.integration_tests.contacts: 
          insert into "dbt"."public"."contacts" ("id", "username", "name", "gender", "address", "mail", "birthdate", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m11:56:27.914448 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:27.915448 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m11:56:27.915448 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:56:27.919448 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.integration_tests.contacts"
[0m11:56:27.919448 [debug] [Thread-2 (]: On seed.integration_tests.transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "seed.integration_tests.transactions"} */
truncate table "dbt"."public"."transactions"
[0m11:56:27.929668 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m11:56:27.929668 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m11:56:27.977211 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.025244 [debug] [Thread-1 (]: Using postgres connection "seed.integration_tests.contacts"
[0m11:56:28.029245 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:56:28.030244 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"
[0m11:56:28.030244 [debug] [Thread-1 (]: On seed.integration_tests.contacts: COMMIT
[0m11:56:28.031245 [debug] [Thread-2 (]: On seed.integration_tests.transactions: 
          insert into "dbt"."public"."transactions" ("contact_id", "id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m11:56:28.031245 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt"."public"."transactions"
    group by category

)

select *
from all_values
where value_field not in (
    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'
)



      
    ) dbt_internal_test
[0m11:56:28.033476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:28.033476 [debug] [Thread-1 (]: Timing info for seed.integration_tests.contacts (execute): 11:56:27.797601 => 11:56:28.033476
[0m11:56:28.034479 [debug] [Thread-2 (]: SQL status: INSERT 0 102 in 0.0 seconds
[0m11:56:28.034479 [debug] [Thread-1 (]: On seed.integration_tests.contacts: Close
[0m11:56:28.035480 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.integration_tests.transactions"
[0m11:56:28.035480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF624E6B00>]}
[0m11:56:28.037697 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m11:56:28.038701 [debug] [Thread-2 (]: Using postgres connection "seed.integration_tests.transactions"
[0m11:56:28.037697 [info ] [Thread-1 (]: 1 of 24 OK loaded seed file public.contacts .................................... [[32mINSERT 11[0m in 0.25s]
[0m11:56:28.038701 [debug] [Thread-2 (]: On seed.integration_tests.transactions: COMMIT
[0m11:56:28.039703 [debug] [Thread-1 (]: Finished running node seed.integration_tests.contacts
[0m11:56:28.039703 [debug] [Thread-1 (]: Began running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:56:28.040702 [info ] [Thread-1 (]: 4 of 24 START test source_not_null_salesforce_contacts_id ...................... [RUN]
[0m11:56:28.040702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.integration_tests.contacts, now test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d)
[0m11:56:28.041703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:28.041703 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.041703 [debug] [Thread-1 (]: Began compiling node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:56:28.042702 [debug] [Thread-2 (]: Timing info for seed.integration_tests.transactions (execute): 11:56:27.806814 => 11:56:28.042702
[0m11:56:28.043701 [debug] [Thread-3 (]: Timing info for test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5 (execute): 11:56:27.823830 => 11:56:28.043701
[0m11:56:28.089318 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:56:28.090318 [debug] [Thread-2 (]: On seed.integration_tests.transactions: Close
[0m11:56:28.090318 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: ROLLBACK
[0m11:56:28.091319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF62404A90>]}
[0m11:56:28.092319 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (compile): 11:56:28.044778 => 11:56:28.091319
[0m11:56:28.092319 [debug] [Thread-3 (]: On test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5: Close
[0m11:56:28.092319 [info ] [Thread-2 (]: 2 of 24 OK loaded seed file public.transactions ................................ [[32mINSERT 102[0m in 0.31s]
[0m11:56:28.092319 [debug] [Thread-1 (]: Began executing node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:56:28.094827 [debug] [Thread-2 (]: Finished running node seed.integration_tests.transactions
[0m11:56:28.093823 [info ] [Thread-3 (]: 3 of 24 PASS source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen  [[32mPASS[0m in 0.31s]
[0m11:56:28.096828 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:56:28.096828 [debug] [Thread-2 (]: Began running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:56:28.097827 [debug] [Thread-3 (]: Finished running node test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5
[0m11:56:28.098827 [debug] [Thread-3 (]: Began running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:56:28.097827 [info ] [Thread-2 (]: 5 of 24 START test source_not_null_web_transactions_id ......................... [RUN]
[0m11:56:28.098827 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:56:28.099827 [info ] [Thread-3 (]: 6 of 24 START test source_unique_salesforce_contacts_id ........................ [RUN]
[0m11:56:28.099827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.integration_tests.transactions, now test.customer360.source_not_null_web_transactions_id.88a47bf7e5)
[0m11:56:28.100827 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: BEGIN
[0m11:56:28.100827 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5, now test.customer360.source_unique_salesforce_contacts_id.01cadaaf43)
[0m11:56:28.100827 [debug] [Thread-2 (]: Began compiling node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:56:28.101828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:28.101828 [debug] [Thread-3 (]: Began compiling node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:56:28.105334 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:56:28.109335 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:56:28.110335 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (compile): 11:56:28.105334 => 11:56:28.110335
[0m11:56:28.111335 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (compile): 11:56:28.101828 => 11:56:28.111335
[0m11:56:28.111335 [debug] [Thread-3 (]: Began executing node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:56:28.112335 [debug] [Thread-2 (]: Began executing node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:56:28.113840 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:56:28.114845 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:56:28.115844 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:56:28.115844 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:56:28.116845 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: BEGIN
[0m11:56:28.116845 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: BEGIN
[0m11:56:28.116845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:28.117845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:28.154630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.154630 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"
[0m11:56:28.155630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."contacts"
where id is null



      
    ) dbt_internal_test
[0m11:56:28.155630 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.157630 [debug] [Thread-1 (]: Timing info for test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d (execute): 11:56:28.094827 => 11:56:28.156631
[0m11:56:28.157630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: ROLLBACK
[0m11:56:28.157630 [debug] [Thread-1 (]: On test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d: Close
[0m11:56:28.158630 [info ] [Thread-1 (]: 4 of 24 PASS source_not_null_salesforce_contacts_id ............................ [[32mPASS[0m in 0.12s]
[0m11:56:28.159631 [debug] [Thread-1 (]: Finished running node test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d
[0m11:56:28.159631 [debug] [Thread-1 (]: Began running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:56:28.160630 [info ] [Thread-1 (]: 7 of 24 START test source_unique_web_transactions_id ........................... [RUN]
[0m11:56:28.160630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d, now test.customer360.source_unique_web_transactions_id.ba28079761)
[0m11:56:28.161631 [debug] [Thread-1 (]: Began compiling node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:56:28.164650 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:56:28.165653 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (compile): 11:56:28.161631 => 11:56:28.165653
[0m11:56:28.166653 [debug] [Thread-1 (]: Began executing node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:56:28.168654 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:56:28.169654 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:56:28.169654 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: BEGIN
[0m11:56:28.169654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:28.188542 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.188542 [debug] [Thread-3 (]: Using postgres connection "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"
[0m11:56:28.189547 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."contacts"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:28.190547 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.192548 [debug] [Thread-3 (]: Timing info for test.customer360.source_unique_salesforce_contacts_id.01cadaaf43 (execute): 11:56:28.112335 => 11:56:28.191548
[0m11:56:28.192548 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: ROLLBACK
[0m11:56:28.192548 [debug] [Thread-3 (]: On test.customer360.source_unique_salesforce_contacts_id.01cadaaf43: Close
[0m11:56:28.194053 [warn ] [Thread-3 (]: 6 of 24 WARN 1 source_unique_salesforce_contacts_id ............................ [[33mWARN 1[0m in 0.09s]
[0m11:56:28.194053 [debug] [Thread-3 (]: Finished running node test.customer360.source_unique_salesforce_contacts_id.01cadaaf43
[0m11:56:28.195068 [debug] [Thread-3 (]: Began running node model.customer360.stg_sf__contacts
[0m11:56:28.196057 [info ] [Thread-3 (]: 8 of 24 START sql table model staging.stg_sf__contacts ......................... [RUN]
[0m11:56:28.196057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_salesforce_contacts_id.01cadaaf43, now model.customer360.stg_sf__contacts)
[0m11:56:28.197057 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_sf__contacts
[0m11:56:28.199057 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m11:56:28.200056 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (compile): 11:56:28.197057 => 11:56:28.199057
[0m11:56:28.200056 [debug] [Thread-3 (]: Began executing node model.customer360.stg_sf__contacts
[0m11:56:28.222090 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m11:56:28.222090 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.223595 [debug] [Thread-2 (]: Using postgres connection "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"
[0m11:56:28.223595 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.224599 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."public"."transactions"
where id is null



      
    ) dbt_internal_test
[0m11:56:28.224599 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m11:56:28.224599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:28.225600 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.226600 [debug] [Thread-2 (]: Timing info for test.customer360.source_not_null_web_transactions_id.88a47bf7e5 (execute): 11:56:28.113840 => 11:56:28.226600
[0m11:56:28.227600 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: ROLLBACK
[0m11:56:28.227600 [debug] [Thread-2 (]: On test.customer360.source_not_null_web_transactions_id.88a47bf7e5: Close
[0m11:56:28.228601 [info ] [Thread-2 (]: 5 of 24 PASS source_not_null_web_transactions_id ............................... [[32mPASS[0m in 0.13s]
[0m11:56:28.229600 [debug] [Thread-2 (]: Finished running node test.customer360.source_not_null_web_transactions_id.88a47bf7e5
[0m11:56:28.251616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.251616 [debug] [Thread-1 (]: Using postgres connection "test.customer360.source_unique_web_transactions_id.ba28079761"
[0m11:56:28.252616 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.source_unique_web_transactions_id.ba28079761"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."public"."transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:28.253617 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.255128 [debug] [Thread-1 (]: Timing info for test.customer360.source_unique_web_transactions_id.ba28079761 (execute): 11:56:28.166653 => 11:56:28.254123
[0m11:56:28.255128 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: ROLLBACK
[0m11:56:28.255128 [debug] [Thread-1 (]: On test.customer360.source_unique_web_transactions_id.ba28079761: Close
[0m11:56:28.256128 [info ] [Thread-1 (]: 7 of 24 PASS source_unique_web_transactions_id ................................. [[32mPASS[0m in 0.10s]
[0m11:56:28.257130 [debug] [Thread-1 (]: Finished running node test.customer360.source_unique_web_transactions_id.ba28079761
[0m11:56:28.282141 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.283646 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.283646 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m11:56:28.290907 [debug] [Thread-3 (]: SQL status: SELECT 11 in 0.0 seconds
[0m11:56:28.295418 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.296419 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m11:56:28.296419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:28.299420 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.299420 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m11:56:28.300419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:28.304925 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:56:28.304925 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.305925 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m11:56:28.306924 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:28.310926 [debug] [Thread-3 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m11:56:28.314431 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m11:56:28.314431 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m11:56:28.316396 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:56:28.317400 [debug] [Thread-3 (]: Timing info for model.customer360.stg_sf__contacts (execute): 11:56:28.200056 => 11:56:28.317400
[0m11:56:28.318399 [debug] [Thread-3 (]: On model.customer360.stg_sf__contacts: Close
[0m11:56:28.318399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF623A6770>]}
[0m11:56:28.319400 [info ] [Thread-3 (]: 8 of 24 OK created sql table model staging.stg_sf__contacts .................... [[32mSELECT 11[0m in 0.12s]
[0m11:56:28.320400 [debug] [Thread-3 (]: Finished running node model.customer360.stg_sf__contacts
[0m11:56:28.321400 [debug] [Thread-2 (]: Began running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:56:28.321400 [debug] [Thread-1 (]: Began running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:56:28.321400 [info ] [Thread-2 (]: 9 of 24 START test not_null_stg_sf__contacts_new_id ............................ [RUN]
[0m11:56:28.322400 [info ] [Thread-1 (]: 10 of 24 START test unique_stg_sf__contacts_new_id ............................. [RUN]
[0m11:56:28.322400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.source_not_null_web_transactions_id.88a47bf7e5, now test.customer360.not_null_stg_sf__contacts_new_id.346de3589b)
[0m11:56:28.323401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.source_unique_web_transactions_id.ba28079761, now test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2)
[0m11:56:28.323401 [debug] [Thread-2 (]: Began compiling node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:56:28.324558 [debug] [Thread-1 (]: Began compiling node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:56:28.328559 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:56:28.330557 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:56:28.331557 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (compile): 11:56:28.324558 => 11:56:28.331557
[0m11:56:28.331557 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (compile): 11:56:28.328559 => 11:56:28.331557
[0m11:56:28.332558 [debug] [Thread-2 (]: Began executing node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:56:28.332558 [debug] [Thread-1 (]: Began executing node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:56:28.334656 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:56:28.336657 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:56:28.337657 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:56:28.337657 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:56:28.338656 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: BEGIN
[0m11:56:28.338656 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: BEGIN
[0m11:56:28.338656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:28.339657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:28.386363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.387364 [debug] [Thread-2 (]: Using postgres connection "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"
[0m11:56:28.387364 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_id
from "dbt"."staging"."stg_sf__contacts"
where new_id is null



      
    ) dbt_internal_test
[0m11:56:28.388867 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.389872 [debug] [Thread-2 (]: Timing info for test.customer360.not_null_stg_sf__contacts_new_id.346de3589b (execute): 11:56:28.332558 => 11:56:28.389872
[0m11:56:28.390871 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: ROLLBACK
[0m11:56:28.390871 [debug] [Thread-2 (]: On test.customer360.not_null_stg_sf__contacts_new_id.346de3589b: Close
[0m11:56:28.391872 [info ] [Thread-2 (]: 9 of 24 PASS not_null_stg_sf__contacts_new_id .................................. [[32mPASS[0m in 0.07s]
[0m11:56:28.391872 [debug] [Thread-2 (]: Finished running node test.customer360.not_null_stg_sf__contacts_new_id.346de3589b
[0m11:56:28.417515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.418516 [debug] [Thread-1 (]: Using postgres connection "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"
[0m11:56:28.418516 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    new_id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_sf__contacts"
where new_id is not null
group by new_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:28.420517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.421515 [debug] [Thread-1 (]: Timing info for test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2 (execute): 11:56:28.334656 => 11:56:28.421515
[0m11:56:28.421515 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: ROLLBACK
[0m11:56:28.422515 [debug] [Thread-1 (]: On test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2: Close
[0m11:56:28.422515 [info ] [Thread-1 (]: 10 of 24 PASS unique_stg_sf__contacts_new_id ................................... [[32mPASS[0m in 0.10s]
[0m11:56:28.423516 [debug] [Thread-1 (]: Finished running node test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2
[0m11:56:28.424623 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m11:56:28.424623 [debug] [Thread-2 (]: Began running node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:56:28.425627 [info ] [Thread-3 (]: 11 of 24 START sql incremental model staging.stg_web__transactions ............. [RUN]
[0m11:56:28.425627 [info ] [Thread-2 (]: 12 of 24 START snapshot snapshots.stg_sf__contacts_snapshot .................... [RUN]
[0m11:56:28.426628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.stg_web__transactions)
[0m11:56:28.426628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_sf__contacts_new_id.346de3589b, now snapshot.customer360.stg_sf__contacts_snapshot)
[0m11:56:28.427628 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m11:56:28.427628 [debug] [Thread-2 (]: Began compiling node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:56:28.430628 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m11:56:28.433628 [debug] [Thread-2 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (compile): 11:56:28.431628 => 11:56:28.433628
[0m11:56:28.434135 [debug] [Thread-2 (]: Began executing node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:56:28.442143 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 11:56:28.427628 => 11:56:28.442143
[0m11:56:28.459158 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.460157 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m11:56:28.460157 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: BEGIN
[0m11:56:28.477866 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.477866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:28.478867 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

    
  
    

  create temporary table "stg_web__transactions__dbt_tmp115628473664"
  
  
    as
  
  (
    


with source as (
    select * from "dbt"."public"."transactions"



  where _loaded_at_utc > (select max(_loaded_at_utc) from "dbt"."staging"."stg_web__transactions")



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc,
        '6d107a1d-8a8e-4a98-b252-076e7d5bb21d' as batch_id
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
  
[0m11:56:28.478867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:28.526480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.527480 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.527480 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:56:28.532481 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:56:28.540990 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.542031 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

        
  
    

  create temporary table "stg_sf__contacts_snapshot__dbt_tmp115628536995"
  
  
    as
  
  (
    with snapshot_query as (

        





select * from "dbt"."staging"."stg_sf__contacts"


    ),

    snapshotted_data as (

        select *,
            new_id as dbt_unique_key

        from "dbt"."snapshots"."stg_sf__contacts_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(new_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            new_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m11:56:28.545540 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.0 seconds
[0m11:56:28.547541 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.547541 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp115628536995'
        
      order by ordinal_position

  
[0m11:56:28.550539 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:56:28.552540 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.553540 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:56:28.555969 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:56:28.557971 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.557971 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp115628536995'
        
      order by ordinal_position

  
[0m11:56:28.560969 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:56:28.560969 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:56:28.563475 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.565479 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.566478 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:56:28.566478 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m11:56:28.567479 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.567479 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.567479 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions__dbt_tmp115628473664'
        
      order by ordinal_position

  
[0m11:56:28.568479 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m11:56:28.573480 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.573480 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.0 seconds
[0m11:56:28.573480 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sf__contacts_snapshot__dbt_tmp115628536995'
        
      order by ordinal_position

  
[0m11:56:28.575969 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.576968 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:56:28.577970 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.0 seconds
[0m11:56:28.581969 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.581969 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:56:28.590982 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.590982 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.590982 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions__dbt_tmp115628473664'
        
      order by ordinal_position

  
[0m11:56:28.591983 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "snapshot.customer360.stg_sf__contacts_snapshot"} */

      update "dbt"."snapshots"."stg_sf__contacts_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "stg_sf__contacts_snapshot__dbt_tmp115628536995" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dbt"."snapshots"."stg_sf__contacts_snapshot".dbt_valid_to is null;

    insert into "dbt"."snapshots"."stg_sf__contacts_snapshot" ("id", "new_id", "user_name", "name", "gender", "address", "email_address", "birth_date", "_loaded_at_utc", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."new_id",DBT_INTERNAL_SOURCE."user_name",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."gender",DBT_INTERNAL_SOURCE."address",DBT_INTERNAL_SOURCE."email_address",DBT_INTERNAL_SOURCE."birth_date",DBT_INTERNAL_SOURCE."_loaded_at_utc",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "stg_sf__contacts_snapshot__dbt_tmp115628536995" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:56:28.591983 [debug] [Thread-2 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m11:56:28.593486 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m11:56:28.594492 [debug] [Thread-3 (]: SQL status: SELECT 8 in 0.0 seconds
[0m11:56:28.594492 [debug] [Thread-2 (]: Using postgres connection "snapshot.customer360.stg_sf__contacts_snapshot"
[0m11:56:28.596492 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.597490 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: COMMIT
[0m11:56:28.597490 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'stg_web__transactions'
        
        and table_schema = 'staging'
        
      order by ordinal_position

  
[0m11:56:28.598492 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:28.600492 [debug] [Thread-2 (]: Timing info for snapshot.customer360.stg_sf__contacts_snapshot (execute): 11:56:28.434135 => 11:56:28.600492
[0m11:56:28.601491 [debug] [Thread-3 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:56:28.601491 [debug] [Thread-2 (]: On snapshot.customer360.stg_sf__contacts_snapshot: Close
[0m11:56:28.606999 [debug] [Thread-3 (]: 
    In "dbt"."staging"."stg_web__transactions":
        Schema changed: True
        Source columns not in target: [<Column batch_id (text)>]
        Target columns not in source: []
        New column types: []
  
[0m11:56:28.608000 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF621C1C00>]}
[0m11:56:28.615510 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.616515 [info ] [Thread-2 (]: 12 of 24 OK snapshotted snapshots.stg_sf__contacts_snapshot .................... [[32mINSERT 0 11[0m in 0.18s]
[0m11:56:28.616515 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

    alter table "dbt"."staging"."stg_web__transactions"

            
               add column batch_id text
            

            
  
[0m11:56:28.617513 [debug] [Thread-2 (]: Finished running node snapshot.customer360.stg_sf__contacts_snapshot
[0m11:56:28.617513 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:28.618514 [debug] [Thread-3 (]: 
    In "dbt"."staging"."stg_web__transactions":
        Schema change approach: append_new_columns
        Columns added: [<Column batch_id (text)>]
        Columns removed: 
        Data types changed: 
  
[0m11:56:28.629019 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m11:56:28.629019 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.630020 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      
        
            delete from "dbt"."staging"."stg_web__transactions"
            where (
                id) in (
                select (id)
                from "stg_web__transactions__dbt_tmp115628473664"
            );

        
    

    insert into "dbt"."staging"."stg_web__transactions" ("id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc", "batch_id")
    (
        select "id", "contact_id", "transaction_date", "amount", "item_count", "category", "_loaded_at_utc", "batch_id"
        from "stg_web__transactions__dbt_tmp115628473664"
    )
  
[0m11:56:28.630020 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m11:56:28.632021 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:56:28.632021 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m11:56:28.632021 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m11:56:28.633527 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:28.634531 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 11:56:28.460157 => 11:56:28.633527
[0m11:56:28.634531 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m11:56:28.635531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF624CDCC0>]}
[0m11:56:28.635531 [info ] [Thread-3 (]: 11 of 24 OK created sql incremental model staging.stg_web__transactions ........ [[32mINSERT 0 0[0m in 0.21s]
[0m11:56:28.636531 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m11:56:28.636531 [debug] [Thread-1 (]: Began running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:56:28.637531 [debug] [Thread-2 (]: Began running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:56:28.637531 [debug] [Thread-3 (]: Began running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:56:28.637531 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_web__transactions_id .......................... [RUN]
[0m11:56:28.638531 [info ] [Thread-2 (]: 14 of 24 START test relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [RUN]
[0m11:56:28.638531 [info ] [Thread-3 (]: 15 of 24 START test unique_stg_web__transactions_id ............................ [RUN]
[0m11:56:28.639530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2, now test.customer360.not_null_stg_web__transactions_id.7beb436b49)
[0m11:56:28.639530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.customer360.stg_sf__contacts_snapshot, now test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53)
[0m11:56:28.640532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now test.customer360.unique_stg_web__transactions_id.5518387fef)
[0m11:56:28.640532 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:56:28.641531 [debug] [Thread-2 (]: Began compiling node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:56:28.641531 [debug] [Thread-3 (]: Began compiling node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:56:28.646047 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:56:28.649044 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:56:28.652044 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:56:28.652044 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (compile): 11:56:28.641531 => 11:56:28.652044
[0m11:56:28.653547 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (compile): 11:56:28.646047 => 11:56:28.652044
[0m11:56:28.653547 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:56:28.653547 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (compile): 11:56:28.650044 => 11:56:28.653547
[0m11:56:28.654550 [debug] [Thread-2 (]: Began executing node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:56:28.655551 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:56:28.656552 [debug] [Thread-3 (]: Began executing node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:56:28.658550 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:56:28.659552 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:56:28.660551 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:56:28.660551 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:56:28.661551 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:56:28.661551 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: BEGIN
[0m11:56:28.661551 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: BEGIN
[0m11:56:28.662551 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: BEGIN
[0m11:56:28.662551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:28.662551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:28.663552 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:28.743537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.744039 [debug] [Thread-2 (]: Using postgres connection "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"
[0m11:56:28.744039 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select contact_id as from_field
    from "dbt"."staging"."stg_web__transactions"
    where contact_id is not null
),

parent as (
    select new_id as to_field
    from "dbt"."staging"."stg_sf__contacts"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:56:28.746044 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.747054 [debug] [Thread-2 (]: Timing info for test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53 (execute): 11:56:28.656552 => 11:56:28.747054
[0m11:56:28.748044 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: ROLLBACK
[0m11:56:28.748044 [debug] [Thread-2 (]: On test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53: Close
[0m11:56:28.749044 [info ] [Thread-2 (]: 14 of 24 PASS relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_  [[32mPASS[0m in 0.11s]
[0m11:56:28.750045 [debug] [Thread-2 (]: Finished running node test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53
[0m11:56:28.750045 [debug] [Thread-2 (]: Began running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:56:28.751044 [info ] [Thread-2 (]: 16 of 24 START test value_above_zero_stg_web__transactions_amount .............. [RUN]
[0m11:56:28.752045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53, now test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499)
[0m11:56:28.752045 [debug] [Thread-2 (]: Began compiling node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:56:28.755552 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:56:28.755552 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (compile): 11:56:28.752045 => 11:56:28.755552
[0m11:56:28.756556 [debug] [Thread-2 (]: Began executing node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:56:28.759557 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:56:28.760556 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:56:28.760556 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: BEGIN
[0m11:56:28.760556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:28.779079 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.779079 [debug] [Thread-3 (]: Using postgres connection "test.customer360.unique_stg_web__transactions_id.5518387fef"
[0m11:56:28.780077 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_stg_web__transactions_id.5518387fef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."staging"."stg_web__transactions"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:28.781076 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.782076 [debug] [Thread-3 (]: Timing info for test.customer360.unique_stg_web__transactions_id.5518387fef (execute): 11:56:28.658550 => 11:56:28.782076
[0m11:56:28.782076 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: ROLLBACK
[0m11:56:28.782076 [debug] [Thread-3 (]: On test.customer360.unique_stg_web__transactions_id.5518387fef: Close
[0m11:56:28.783579 [info ] [Thread-3 (]: 15 of 24 PASS unique_stg_web__transactions_id .................................. [[32mPASS[0m in 0.14s]
[0m11:56:28.784582 [debug] [Thread-3 (]: Finished running node test.customer360.unique_stg_web__transactions_id.5518387fef
[0m11:56:28.809895 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.810895 [debug] [Thread-2 (]: Using postgres connection "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"
[0m11:56:28.810895 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    select 
    * 
    from "dbt"."staging"."stg_web__transactions"
    where amount <= 0

      
    ) dbt_internal_test
[0m11:56:28.811895 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.813400 [debug] [Thread-2 (]: Timing info for test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499 (execute): 11:56:28.756556 => 11:56:28.813400
[0m11:56:28.813400 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: ROLLBACK
[0m11:56:28.814404 [debug] [Thread-2 (]: On test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499: Close
[0m11:56:28.815405 [info ] [Thread-2 (]: 16 of 24 PASS value_above_zero_stg_web__transactions_amount .................... [[32mPASS[0m in 0.06s]
[0m11:56:28.816405 [debug] [Thread-2 (]: Finished running node test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499
[0m11:56:28.818405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:28.818405 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_stg_web__transactions_id.7beb436b49"
[0m11:56:28.818405 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select id
from "dbt"."staging"."stg_web__transactions"
where id is null



      
    ) dbt_internal_test
[0m11:56:28.819403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:28.821403 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_stg_web__transactions_id.7beb436b49 (execute): 11:56:28.654550 => 11:56:28.820405
[0m11:56:28.821403 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: ROLLBACK
[0m11:56:28.821403 [debug] [Thread-1 (]: On test.customer360.not_null_stg_web__transactions_id.7beb436b49: Close
[0m11:56:28.822404 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_web__transactions_id ................................ [[32mPASS[0m in 0.18s]
[0m11:56:28.823404 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_stg_web__transactions_id.7beb436b49
[0m11:56:28.823404 [debug] [Thread-3 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m11:56:28.824600 [info ] [Thread-3 (]: 17 of 24 START sql view model marts.contacts_joined_with_transactions .......... [RUN]
[0m11:56:28.824600 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.customer360.unique_stg_web__transactions_id.5518387fef, now model.customer360.contacts_joined_with_transactions)
[0m11:56:28.825600 [debug] [Thread-3 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m11:56:28.827599 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m11:56:28.828599 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 11:56:28.825600 => 11:56:28.827599
[0m11:56:28.828599 [debug] [Thread-3 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m11:56:28.840631 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m11:56:28.840631 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:56:28.841632 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m11:56:28.841632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:29.007760 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.007760 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:56:29.007760 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m11:56:29.009760 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:56:29.012758 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:56:29.012758 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m11:56:29.012758 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:29.013760 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:56:29.014933 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:56:29.014933 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m11:56:29.015933 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:29.017933 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m11:56:29.019932 [debug] [Thread-3 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m11:56:29.019932 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m11:56:29.020934 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:56:29.021934 [debug] [Thread-3 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 11:56:28.828599 => 11:56:29.021934
[0m11:56:29.021934 [debug] [Thread-3 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m11:56:29.021934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF624CC790>]}
[0m11:56:29.023439 [info ] [Thread-3 (]: 17 of 24 OK created sql view model marts.contacts_joined_with_transactions ..... [[32mCREATE VIEW[0m in 0.20s]
[0m11:56:29.024443 [debug] [Thread-3 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m11:56:29.024443 [debug] [Thread-1 (]: Began running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:56:29.025442 [debug] [Thread-2 (]: Began running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:56:29.025442 [info ] [Thread-1 (]: 18 of 24 START test not_null_contacts_joined_with_transactions_transaction_id .. [RUN]
[0m11:56:29.026443 [info ] [Thread-2 (]: 19 of 24 START test unique_contacts_joined_with_transactions_transaction_id .... [RUN]
[0m11:56:29.026443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_stg_web__transactions_id.7beb436b49, now test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca)
[0m11:56:29.027442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499, now test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5)
[0m11:56:29.027442 [debug] [Thread-1 (]: Began compiling node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:56:29.027442 [debug] [Thread-2 (]: Began compiling node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:56:29.031442 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:56:29.033945 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:56:29.033945 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (compile): 11:56:29.028443 => 11:56:29.033945
[0m11:56:29.034949 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (compile): 11:56:29.031442 => 11:56:29.034949
[0m11:56:29.034949 [debug] [Thread-1 (]: Began executing node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:56:29.035949 [debug] [Thread-2 (]: Began executing node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:56:29.037949 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:56:29.039948 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:56:29.040950 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:56:29.040950 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:56:29.040950 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: BEGIN
[0m11:56:29.041949 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: BEGIN
[0m11:56:29.041949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:29.041949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:29.089196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.089196 [debug] [Thread-2 (]: Using postgres connection "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"
[0m11:56:29.090253 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:56:29.091253 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.092253 [debug] [Thread-2 (]: Timing info for test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5 (execute): 11:56:29.037949 => 11:56:29.092253
[0m11:56:29.092253 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: ROLLBACK
[0m11:56:29.093756 [debug] [Thread-2 (]: On test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5: Close
[0m11:56:29.094761 [info ] [Thread-2 (]: 19 of 24 PASS unique_contacts_joined_with_transactions_transaction_id .......... [[32mPASS[0m in 0.07s]
[0m11:56:29.094761 [debug] [Thread-2 (]: Finished running node test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5
[0m11:56:29.124840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.124840 [debug] [Thread-1 (]: Using postgres connection "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"
[0m11:56:29.125840 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca"} */
select
      count(*) as failures,
      count(*) >0 as should_warn,
      count(*) >5 as should_error
    from (
      
    
    



select transaction_id
from "dbt"."marts"."contacts_joined_with_transactions"
where transaction_id is null



      
    ) dbt_internal_test
[0m11:56:29.126840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.127839 [debug] [Thread-1 (]: Timing info for test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca (execute): 11:56:29.035949 => 11:56:29.127839
[0m11:56:29.128840 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: ROLLBACK
[0m11:56:29.128840 [debug] [Thread-1 (]: On test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca: Close
[0m11:56:29.129840 [info ] [Thread-1 (]: 18 of 24 PASS not_null_contacts_joined_with_transactions_transaction_id ........ [[32mPASS[0m in 0.10s]
[0m11:56:29.129840 [debug] [Thread-1 (]: Finished running node test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca
[0m11:56:29.131301 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m11:56:29.131301 [info ] [Thread-3 (]: 20 of 24 START sql table model marts.customers ................................. [RUN]
[0m11:56:29.132305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.contacts_joined_with_transactions, now model.customer360.customers)
[0m11:56:29.132305 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m11:56:29.136813 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m11:56:29.137811 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 11:56:29.132305 => 11:56:29.137811
[0m11:56:29.137811 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m11:56:29.140812 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m11:56:29.141812 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.141812 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m11:56:29.142812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:29.195796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.195796 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.196796 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m11:56:29.204495 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m11:56:29.206494 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.206494 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m11:56:29.207493 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:29.209493 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.209493 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m11:56:29.210494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:56:29.211495 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:56:29.211495 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.212493 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m11:56:29.213494 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:56:29.214712 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m11:56:29.215711 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m11:56:29.215711 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m11:56:29.217712 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:56:29.218712 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 11:56:29.138813 => 11:56:29.217712
[0m11:56:29.218712 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m11:56:29.219716 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d107a1d-8a8e-4a98-b252-076e7d5bb21d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF62422950>]}
[0m11:56:29.219716 [info ] [Thread-3 (]: 20 of 24 OK created sql table model marts.customers ............................ [[32mSELECT 9[0m in 0.09s]
[0m11:56:29.220712 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m11:56:29.220712 [debug] [Thread-1 (]: Began running node test.customer360.check_first_purchase_date
[0m11:56:29.221713 [debug] [Thread-2 (]: Began running node test.customer360.check_last_purchase_date
[0m11:56:29.221713 [debug] [Thread-3 (]: Began running node test.customer360.check_purchase_amount_above_zero
[0m11:56:29.221713 [info ] [Thread-1 (]: 21 of 24 START test check_first_purchase_date .................................. [RUN]
[0m11:56:29.222712 [info ] [Thread-2 (]: 22 of 24 START test check_last_purchase_date ................................... [RUN]
[0m11:56:29.222712 [info ] [Thread-3 (]: 23 of 24 START test check_purchase_amount_above_zero ........................... [RUN]
[0m11:56:29.223711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca, now test.customer360.check_first_purchase_date)
[0m11:56:29.223711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5, now test.customer360.check_last_purchase_date)
[0m11:56:29.224794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.customers, now test.customer360.check_purchase_amount_above_zero)
[0m11:56:29.225793 [debug] [Thread-1 (]: Began compiling node test.customer360.check_first_purchase_date
[0m11:56:29.225793 [debug] [Thread-2 (]: Began compiling node test.customer360.check_last_purchase_date
[0m11:56:29.225793 [debug] [Thread-3 (]: Began compiling node test.customer360.check_purchase_amount_above_zero
[0m11:56:29.227794 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_first_purchase_date"
[0m11:56:29.230794 [debug] [Thread-2 (]: Writing injected SQL for node "test.customer360.check_last_purchase_date"
[0m11:56:29.232792 [debug] [Thread-3 (]: Writing injected SQL for node "test.customer360.check_purchase_amount_above_zero"
[0m11:56:29.233793 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (compile): 11:56:29.225793 => 11:56:29.233793
[0m11:56:29.233793 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (compile): 11:56:29.228795 => 11:56:29.233793
[0m11:56:29.234808 [debug] [Thread-1 (]: Began executing node test.customer360.check_first_purchase_date
[0m11:56:29.234808 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (compile): 11:56:29.231793 => 11:56:29.234808
[0m11:56:29.234808 [debug] [Thread-2 (]: Began executing node test.customer360.check_last_purchase_date
[0m11:56:29.236808 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_first_purchase_date"
[0m11:56:29.236808 [debug] [Thread-3 (]: Began executing node test.customer360.check_purchase_amount_above_zero
[0m11:56:29.238807 [debug] [Thread-2 (]: Writing runtime sql for node "test.customer360.check_last_purchase_date"
[0m11:56:29.239808 [debug] [Thread-3 (]: Writing runtime sql for node "test.customer360.check_purchase_amount_above_zero"
[0m11:56:29.240807 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m11:56:29.240807 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m11:56:29.241807 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: BEGIN
[0m11:56:29.241807 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m11:56:29.241807 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: BEGIN
[0m11:56:29.242807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:29.242807 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: BEGIN
[0m11:56:29.243808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:56:29.243808 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:56:29.289466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.290471 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_first_purchase_date"
[0m11:56:29.290471 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_first_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	min(transaction_date::date) as first_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.first_purchase_date,
	b.first_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
first_purchase_date <> first_date
      
    ) dbt_internal_test
[0m11:56:29.292471 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.293975 [debug] [Thread-1 (]: Timing info for test.customer360.check_first_purchase_date (execute): 11:56:29.235807 => 11:56:29.293975
[0m11:56:29.293975 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: ROLLBACK
[0m11:56:29.294979 [debug] [Thread-1 (]: On test.customer360.check_first_purchase_date: Close
[0m11:56:29.294979 [info ] [Thread-1 (]: 21 of 24 PASS check_first_purchase_date ........................................ [[32mPASS[0m in 0.07s]
[0m11:56:29.295979 [debug] [Thread-1 (]: Finished running node test.customer360.check_first_purchase_date
[0m11:56:29.296979 [debug] [Thread-1 (]: Began running node test.customer360.check_valid_customers
[0m11:56:29.296979 [info ] [Thread-1 (]: 24 of 24 START test check_valid_customers ...................................... [RUN]
[0m11:56:29.297978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.customer360.check_first_purchase_date, now test.customer360.check_valid_customers)
[0m11:56:29.297978 [debug] [Thread-1 (]: Began compiling node test.customer360.check_valid_customers
[0m11:56:29.300978 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer360.check_valid_customers"
[0m11:56:29.300978 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (compile): 11:56:29.298978 => 11:56:29.300978
[0m11:56:29.301978 [debug] [Thread-1 (]: Began executing node test.customer360.check_valid_customers
[0m11:56:29.303482 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer360.check_valid_customers"
[0m11:56:29.304486 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m11:56:29.304486 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: BEGIN
[0m11:56:29.304486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:29.323506 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.324511 [debug] [Thread-2 (]: Using postgres connection "test.customer360.check_last_purchase_date"
[0m11:56:29.324511 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_last_purchase_date"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with pivot_table as (
select
	new_id,
	max(transaction_date::date) as last_date
from
	"dbt"."marts"."contacts_joined_with_transactions"
	group by 1
)
, comparing_table as (
select
	a.new_id,
	a.last_purchase_date,
	b.last_date
from
	"dbt"."marts"."customers" a 
left join 
pivot_table b
on a.new_id = b.new_id
)
select 
*
from comparing_table
where 
last_purchase_date <> last_date
      
    ) dbt_internal_test
[0m11:56:29.326512 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.327512 [debug] [Thread-2 (]: Timing info for test.customer360.check_last_purchase_date (execute): 11:56:29.236808 => 11:56:29.327512
[0m11:56:29.327512 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: ROLLBACK
[0m11:56:29.328510 [debug] [Thread-2 (]: On test.customer360.check_last_purchase_date: Close
[0m11:56:29.329511 [info ] [Thread-2 (]: 22 of 24 PASS check_last_purchase_date ......................................... [[32mPASS[0m in 0.10s]
[0m11:56:29.329511 [debug] [Thread-2 (]: Finished running node test.customer360.check_last_purchase_date
[0m11:56:29.352718 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.353719 [debug] [Thread-3 (]: Using postgres connection "test.customer360.check_purchase_amount_above_zero"
[0m11:56:29.354221 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_purchase_amount_above_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where 
    "Apps & Games_amount"+"Beauty_amount"+ "Books_amount"+ "Clothing, Shoes & Accessories_amount"+ "Movies & TV_amount"+ "Sports, Fitness & Outdoors_amount"+"Kitchen_amount" <= 0
      
    ) dbt_internal_test
[0m11:56:29.355224 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.356226 [debug] [Thread-3 (]: Timing info for test.customer360.check_purchase_amount_above_zero (execute): 11:56:29.238807 => 11:56:29.356226
[0m11:56:29.356226 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: ROLLBACK
[0m11:56:29.357226 [debug] [Thread-3 (]: On test.customer360.check_purchase_amount_above_zero: Close
[0m11:56:29.358226 [info ] [Thread-3 (]: 23 of 24 PASS check_purchase_amount_above_zero ................................. [[32mPASS[0m in 0.13s]
[0m11:56:29.358226 [debug] [Thread-3 (]: Finished running node test.customer360.check_purchase_amount_above_zero
[0m11:56:29.383753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.384757 [debug] [Thread-1 (]: Using postgres connection "test.customer360.check_valid_customers"
[0m11:56:29.384757 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "test.customer360.check_valid_customers"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
	new_id
from
	"dbt"."marts"."customers"
where
	new_id not in (
	select
		new_id
	from
		"dbt"."staging"."stg_sf__contacts"
    )
      
    ) dbt_internal_test
[0m11:56:29.385755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:29.386756 [debug] [Thread-1 (]: Timing info for test.customer360.check_valid_customers (execute): 11:56:29.301978 => 11:56:29.386756
[0m11:56:29.387756 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: ROLLBACK
[0m11:56:29.387756 [debug] [Thread-1 (]: On test.customer360.check_valid_customers: Close
[0m11:56:29.388756 [info ] [Thread-1 (]: 24 of 24 PASS check_valid_customers ............................................ [[32mPASS[0m in 0.09s]
[0m11:56:29.389758 [debug] [Thread-1 (]: Finished running node test.customer360.check_valid_customers
[0m11:56:29.390834 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:29.390834 [debug] [MainThread]: On master: BEGIN
[0m11:56:29.391832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:29.437927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:56:29.438928 [debug] [MainThread]: On master: COMMIT
[0m11:56:29.438928 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:29.439928 [debug] [MainThread]: On master: COMMIT
[0m11:56:29.439928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:56:29.439928 [debug] [MainThread]: On master: Close
[0m11:56:29.440928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:29.440928 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:56:29.441928 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:56:29.441928 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m11:56:29.441928 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m11:56:29.441928 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m11:56:29.441928 [debug] [MainThread]: Connection 'list_dbt_public' was properly closed.
[0m11:56:29.443488 [debug] [MainThread]: Connection 'test.customer360.check_valid_customers' was properly closed.
[0m11:56:29.443488 [debug] [MainThread]: Connection 'test.customer360.check_last_purchase_date' was properly closed.
[0m11:56:29.443488 [debug] [MainThread]: Connection 'test.customer360.check_purchase_amount_above_zero' was properly closed.
[0m11:56:29.444435 [info ] [MainThread]: 
[0m11:56:29.444435 [info ] [MainThread]: Finished running 2 seeds, 17 tests, 2 table models, 1 snapshot, 1 incremental model, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m11:56:29.447435 [debug] [MainThread]: Command end result
[0m11:56:29.454942 [info ] [MainThread]: 
[0m11:56:29.454942 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m11:56:29.455943 [info ] [MainThread]: 
[0m11:56:29.455943 [warn ] [MainThread]: [33mWarning in test source_unique_salesforce_contacts_id (models\staging\salesforce\_sf__sources.yaml)[0m
[0m11:56:29.456943 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m11:56:29.456943 [info ] [MainThread]: 
[0m11:56:29.457943 [info ] [MainThread]:   compiled Code at target\compiled\customer360\models\staging\salesforce\_sf__sources.yaml\source_unique_salesforce_contacts_id.sql
[0m11:56:29.457943 [info ] [MainThread]: 
[0m11:56:29.458942 [info ] [MainThread]: Done. PASS=23 WARN=1 ERROR=0 SKIP=0 TOTAL=24
[0m11:56:29.459943 [debug] [MainThread]: Command `dbt build` succeeded at 11:56:29.459943 after 2.58 seconds
[0m11:56:29.459943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5E8E4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF61B94F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF6245EBC0>]}
[0m11:56:29.459943 [debug] [MainThread]: Flushing usage events
[0m12:12:02.050658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021264CD4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267FCACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267FCAA70>]}


============================== 12:12:02.053661 | 80fa3c74-9845-4286-b629-8fef3a2a244b ==============================
[0m12:12:02.053661 [info ] [MainThread]: Running with dbt=1.7.2
[0m12:12:02.054164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:02.178257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260C82E00>]}
[0m12:12:02.236886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021267F81750>]}
[0m12:12:02.237886 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m12:12:02.247392 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m12:12:02.328370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:02.328370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:02.332369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021268476320>]}
[0m12:12:02.340875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126843CA30>]}
[0m12:12:02.340875 [info ] [MainThread]: Found 2 seeds, 4 models, 17 tests, 1 snapshot, 2 sources, 0 exposures, 0 metrics, 405 macros, 0 groups, 0 semantic models
[0m12:12:02.341875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126843CF10>]}
[0m12:12:02.342876 [info ] [MainThread]: 
[0m12:12:02.343876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:02.345952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m12:12:02.352247 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m12:12:02.352247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m12:12:02.353750 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:12:02.354754 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m12:12:02.355754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:02.355754 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:12:02.356753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:02.415340 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m12:12:02.416340 [debug] [ThreadPool]: On list_dbt: Close
[0m12:12:02.461182 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m12:12:02.462183 [debug] [ThreadPool]: On list_dbt: Close
[0m12:12:02.463685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m12:12:02.464689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m12:12:02.465690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_staging'
[0m12:12:02.468689 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m12:12:02.469933 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m12:12:02.471932 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m12:12:02.471932 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m12:12:02.471932 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m12:12:02.472931 [debug] [ThreadPool]: On list_dbt_staging: BEGIN
[0m12:12:02.472931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:02.472931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:02.473932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:02.535312 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.536316 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m12:12:02.536316 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:12:02.538333 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:12:02.539330 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m12:12:02.540311 [debug] [ThreadPool]: On list_dbt_public: Close
[0m12:12:02.540311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_public, now list_dbt_marts)
[0m12:12:02.542280 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m12:12:02.542280 [debug] [ThreadPool]: On list_dbt_marts: BEGIN
[0m12:12:02.543786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:02.562342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.562342 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m12:12:02.563911 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:12:02.565854 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:12:02.566855 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m12:12:02.567854 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m12:12:02.598960 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.598960 [debug] [ThreadPool]: Using postgres connection "list_dbt_staging"
[0m12:12:02.598960 [debug] [ThreadPool]: On list_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:12:02.601966 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:12:02.602962 [debug] [ThreadPool]: On list_dbt_staging: ROLLBACK
[0m12:12:02.602962 [debug] [ThreadPool]: On list_dbt_staging: Close
[0m12:12:02.667323 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.667323 [debug] [ThreadPool]: Using postgres connection "list_dbt_marts"
[0m12:12:02.667323 [debug] [ThreadPool]: On list_dbt_marts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "list_dbt_marts"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m12:12:02.669834 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:12:02.670834 [debug] [ThreadPool]: On list_dbt_marts: ROLLBACK
[0m12:12:02.670834 [debug] [ThreadPool]: On list_dbt_marts: Close
[0m12:12:02.675346 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:02.676354 [debug] [MainThread]: On master: BEGIN
[0m12:12:02.676354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:02.735181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.736187 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:02.736187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:02.739187 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m12:12:02.741187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212684F34C0>]}
[0m12:12:02.741187 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:02.742187 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:02.742187 [debug] [MainThread]: On master: BEGIN
[0m12:12:02.742187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.742187 [debug] [MainThread]: On master: COMMIT
[0m12:12:02.743693 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:02.743693 [debug] [MainThread]: On master: COMMIT
[0m12:12:02.743693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:12:02.744700 [debug] [MainThread]: On master: Close
[0m12:12:02.744700 [info ] [MainThread]: Concurrency: 3 threads (target='local')
[0m12:12:02.745699 [info ] [MainThread]: 
[0m12:12:02.747704 [debug] [Thread-1 (]: Began running node model.customer360.stg_sf__contacts
[0m12:12:02.747704 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_sf__contacts .......................... [RUN]
[0m12:12:02.748704 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.customer360.stg_sf__contacts'
[0m12:12:02.748704 [debug] [Thread-1 (]: Began compiling node model.customer360.stg_sf__contacts
[0m12:12:02.754210 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.stg_sf__contacts"
[0m12:12:02.754779 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (compile): 12:12:02.749704 => 12:12:02.754779
[0m12:12:02.755817 [debug] [Thread-1 (]: Began executing node model.customer360.stg_sf__contacts
[0m12:12:02.779520 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.stg_sf__contacts"
[0m12:12:02.780519 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.780519 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: BEGIN
[0m12:12:02.781520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:02.850475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.850475 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.851514 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */

  
    

  create  table "dbt"."staging"."stg_sf__contacts__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select * from "dbt"."public"."contacts"
),

renamed as (
    select
        id,
        case 
            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) 
            else id end as new_id,
        username as user_name,
        name,
        gender,
        address, 
        mail as email_address,
        birthdate as birth_date,
        _loaded_at_utc,
        now() as updated_at
    from source     
)

select * from renamed
  );
  
[0m12:12:02.858104 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m12:12:02.862102 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.863646 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts" rename to "stg_sf__contacts__dbt_backup"
[0m12:12:02.863646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:02.865687 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.866689 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
alter table "dbt"."staging"."stg_sf__contacts__dbt_tmp" rename to "stg_sf__contacts"
[0m12:12:02.866689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:02.878811 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m12:12:02.879809 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.879809 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: COMMIT
[0m12:12:02.880809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:12:02.885326 [debug] [Thread-1 (]: Applying DROP to: "dbt"."staging"."stg_sf__contacts__dbt_backup"
[0m12:12:02.888328 [debug] [Thread-1 (]: Using postgres connection "model.customer360.stg_sf__contacts"
[0m12:12:02.888328 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_sf__contacts"} */
drop table if exists "dbt"."staging"."stg_sf__contacts__dbt_backup" cascade
[0m12:12:02.890329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:12:02.891330 [debug] [Thread-1 (]: Timing info for model.customer360.stg_sf__contacts (execute): 12:12:02.755817 => 12:12:02.891330
[0m12:12:02.892324 [debug] [Thread-1 (]: On model.customer360.stg_sf__contacts: Close
[0m12:12:02.892324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126845B3A0>]}
[0m12:12:02.892324 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_sf__contacts ..................... [[32mSELECT 11[0m in 0.14s]
[0m12:12:02.893829 [debug] [Thread-1 (]: Finished running node model.customer360.stg_sf__contacts
[0m12:12:02.894837 [debug] [Thread-3 (]: Began running node model.customer360.stg_web__transactions
[0m12:12:02.894837 [info ] [Thread-3 (]: 2 of 4 START sql incremental model staging.stg_web__transactions ............... [RUN]
[0m12:12:02.895835 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.customer360.stg_web__transactions'
[0m12:12:02.895835 [debug] [Thread-3 (]: Began compiling node model.customer360.stg_web__transactions
[0m12:12:02.902834 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.stg_web__transactions"
[0m12:12:02.904339 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (compile): 12:12:02.896834 => 12:12:02.903834
[0m12:12:02.904339 [debug] [Thread-3 (]: Began executing node model.customer360.stg_web__transactions
[0m12:12:02.920853 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.stg_web__transactions"
[0m12:12:02.921852 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.921852 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: BEGIN
[0m12:12:02.922852 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:12:02.969171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:12:02.970135 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.970135 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */

      
  
    

  create  table "dbt"."staging"."stg_web__transactions__dbt_tmp"
  
  
    as
  
  (
    


with source as (
    select * from "dbt"."public"."transactions"



),

renamed as (
    select
        id,
        contact_id,
        

    

        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'

    

 as transaction_date,
        amount,
        item_count,
        category, 
        _loaded_at_utc,
        '80fa3c74-9845-4286-b629-8fef3a2a244b' as batch_id
    from source
    where contact_id in (select new_id from "dbt"."staging"."stg_sf__contacts")       
)

select * from renamed
  );
  
  
[0m12:12:02.977147 [debug] [Thread-3 (]: SQL status: SELECT 101 in 0.0 seconds
[0m12:12:02.980148 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.980148 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions" rename to "stg_web__transactions__dbt_backup"
[0m12:12:02.981148 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:02.982147 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.983650 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
alter table "dbt"."staging"."stg_web__transactions__dbt_tmp" rename to "stg_web__transactions"
[0m12:12:02.983650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:02.985655 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m12:12:02.985655 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.985655 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: COMMIT
[0m12:12:02.986654 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:12:02.988655 [debug] [Thread-3 (]: Applying DROP to: "dbt"."staging"."stg_web__transactions__dbt_backup"
[0m12:12:02.989653 [debug] [Thread-3 (]: Using postgres connection "model.customer360.stg_web__transactions"
[0m12:12:02.989653 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.stg_web__transactions"} */
drop table if exists "dbt"."staging"."stg_web__transactions__dbt_backup" cascade
[0m12:12:02.990904 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:12:02.991909 [debug] [Thread-3 (]: Timing info for model.customer360.stg_web__transactions (execute): 12:12:02.904339 => 12:12:02.991909
[0m12:12:02.992909 [debug] [Thread-3 (]: On model.customer360.stg_web__transactions: Close
[0m12:12:02.992909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212685214E0>]}
[0m12:12:02.993909 [info ] [Thread-3 (]: 2 of 4 OK created sql incremental model staging.stg_web__transactions .......... [[32mSELECT 101[0m in 0.10s]
[0m12:12:02.994413 [debug] [Thread-3 (]: Finished running node model.customer360.stg_web__transactions
[0m12:12:02.995416 [debug] [Thread-1 (]: Began running node model.customer360.contacts_joined_with_transactions
[0m12:12:02.995416 [info ] [Thread-1 (]: 3 of 4 START sql view model marts.contacts_joined_with_transactions ............ [RUN]
[0m12:12:02.996417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.customer360.stg_sf__contacts, now model.customer360.contacts_joined_with_transactions)
[0m12:12:02.996417 [debug] [Thread-1 (]: Began compiling node model.customer360.contacts_joined_with_transactions
[0m12:12:02.999416 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.000416 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (compile): 12:12:02.996417 => 12:12:02.999416
[0m12:12:03.000416 [debug] [Thread-1 (]: Began executing node model.customer360.contacts_joined_with_transactions
[0m12:12:03.012928 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.012928 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.013928 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: BEGIN
[0m12:12:03.013928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:03.062088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:12:03.063087 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.063087 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */

  create view "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp"
    
    
  as (
    SELECT 
    contacts.*,
    transactions.id as transaction_id,
    transactions.transaction_date,
    transactions.amount,
    transactions.item_count,
    transactions.category
FROM "dbt"."staging"."stg_web__transactions" as transactions
LEFT JOIN "dbt"."staging"."stg_sf__contacts" as contacts ON contacts.new_id = transactions.contact_id
  );
[0m12:12:03.064591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:12:03.067595 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.067595 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
alter table "dbt"."marts"."contacts_joined_with_transactions__dbt_tmp" rename to "contacts_joined_with_transactions"
[0m12:12:03.067595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:03.069098 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m12:12:03.070101 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.070101 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: COMMIT
[0m12:12:03.071102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:12:03.072101 [debug] [Thread-1 (]: Applying DROP to: "dbt"."marts"."contacts_joined_with_transactions__dbt_backup"
[0m12:12:03.074607 [debug] [Thread-1 (]: Using postgres connection "model.customer360.contacts_joined_with_transactions"
[0m12:12:03.074607 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.contacts_joined_with_transactions"} */
drop view if exists "dbt"."marts"."contacts_joined_with_transactions__dbt_backup" cascade
[0m12:12:03.075608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:12:03.076608 [debug] [Thread-1 (]: Timing info for model.customer360.contacts_joined_with_transactions (execute): 12:12:03.000416 => 12:12:03.076608
[0m12:12:03.076608 [debug] [Thread-1 (]: On model.customer360.contacts_joined_with_transactions: Close
[0m12:12:03.077607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021268477E50>]}
[0m12:12:03.077607 [info ] [Thread-1 (]: 3 of 4 OK created sql view model marts.contacts_joined_with_transactions ....... [[32mCREATE VIEW[0m in 0.08s]
[0m12:12:03.077607 [debug] [Thread-1 (]: Finished running node model.customer360.contacts_joined_with_transactions
[0m12:12:03.079048 [debug] [Thread-3 (]: Began running node model.customer360.customers
[0m12:12:03.080052 [info ] [Thread-3 (]: 4 of 4 START sql table model marts.customers ................................... [RUN]
[0m12:12:03.080052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.customer360.stg_web__transactions, now model.customer360.customers)
[0m12:12:03.080052 [debug] [Thread-3 (]: Began compiling node model.customer360.customers
[0m12:12:03.084554 [debug] [Thread-3 (]: Writing injected SQL for node "model.customer360.customers"
[0m12:12:03.084554 [debug] [Thread-3 (]: Timing info for model.customer360.customers (compile): 12:12:03.081051 => 12:12:03.084554
[0m12:12:03.085557 [debug] [Thread-3 (]: Began executing node model.customer360.customers
[0m12:12:03.088558 [debug] [Thread-3 (]: Writing runtime sql for node "model.customer360.customers"
[0m12:12:03.088558 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.089557 [debug] [Thread-3 (]: On model.customer360.customers: BEGIN
[0m12:12:03.089557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:12:03.135714 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:12:03.136714 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.136714 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */

  
    

  create  table "dbt"."marts"."customers__dbt_tmp"
  
  
    as
  
  (
    with intermediate as (
SELECT
    new_id,
    gender,
    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,
    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,
    

    

        date_part('year', age(current_date,birth_date))

    

 AS age,
    case when category = 'Apps & Games' then amount else 0 end as "Apps & Games_amount"
    ,case when category = 'Beauty' then amount else 0 end as "Beauty_amount"
    ,case when category = 'Books' then amount else 0 end as "Books_amount"
    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as "Clothing, Shoes & Accessories_amount"
    ,case when category = 'Movies & TV' then amount else 0 end as "Movies & TV_amount"
    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as "Sports, Fitness & Outdoors_amount"
    ,case when category = 'Kitchen' then amount else 0 end as "Kitchen_amount"
    
FROM "dbt"."marts"."contacts_joined_with_transactions"
)
, final as (
select 
    new_id,
    gender,
    first_purchase_date,
    last_purchase_date,
    age,
    sum("Apps & Games_amount") as "Apps & Games_amount"
    ,sum("Beauty_amount") as "Beauty_amount"
    ,sum("Books_amount") as "Books_amount"
    ,sum("Clothing, Shoes & Accessories_amount") as "Clothing, Shoes & Accessories_amount"
    ,sum("Movies & TV_amount") as "Movies & TV_amount"
    ,sum("Sports, Fitness & Outdoors_amount") as "Sports, Fitness & Outdoors_amount"
    ,sum("Kitchen_amount") as "Kitchen_amount"
    
FROM intermediate 
group by 
1,2,3,4,5
)
select * from final
  );
  
[0m12:12:03.144762 [debug] [Thread-3 (]: SQL status: SELECT 9 in 0.0 seconds
[0m12:12:03.147762 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.148762 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers" rename to "customers__dbt_backup"
[0m12:12:03.148762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:03.150763 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.151762 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
alter table "dbt"."marts"."customers__dbt_tmp" rename to "customers"
[0m12:12:03.151762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:03.152763 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m12:12:03.153762 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.153762 [debug] [Thread-3 (]: On model.customer360.customers: COMMIT
[0m12:12:03.155127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:12:03.156131 [debug] [Thread-3 (]: Applying DROP to: "dbt"."marts"."customers__dbt_backup"
[0m12:12:03.157132 [debug] [Thread-3 (]: Using postgres connection "model.customer360.customers"
[0m12:12:03.157132 [debug] [Thread-3 (]: On model.customer360.customers: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "integration_tests", "target_name": "local", "node_id": "model.customer360.customers"} */
drop table if exists "dbt"."marts"."customers__dbt_backup" cascade
[0m12:12:03.159131 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:12:03.160132 [debug] [Thread-3 (]: Timing info for model.customer360.customers (execute): 12:12:03.085557 => 12:12:03.160132
[0m12:12:03.160132 [debug] [Thread-3 (]: On model.customer360.customers: Close
[0m12:12:03.161131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fa3c74-9845-4286-b629-8fef3a2a244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212684D8310>]}
[0m12:12:03.161131 [info ] [Thread-3 (]: 4 of 4 OK created sql table model marts.customers .............................. [[32mSELECT 9[0m in 0.08s]
[0m12:12:03.162131 [debug] [Thread-3 (]: Finished running node model.customer360.customers
[0m12:12:03.163634 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:03.163634 [debug] [MainThread]: On master: BEGIN
[0m12:12:03.163634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:03.210630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:03.210630 [debug] [MainThread]: On master: COMMIT
[0m12:12:03.211630 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:03.211630 [debug] [MainThread]: On master: COMMIT
[0m12:12:03.211630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:12:03.212629 [debug] [MainThread]: On master: Close
[0m12:12:03.212629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:03.213630 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m12:12:03.213630 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m12:12:03.214136 [debug] [MainThread]: Connection 'list_dbt_marts' was properly closed.
[0m12:12:03.214136 [debug] [MainThread]: Connection 'list_dbt_snapshots' was properly closed.
[0m12:12:03.214136 [debug] [MainThread]: Connection 'list_dbt_staging' was properly closed.
[0m12:12:03.215140 [debug] [MainThread]: Connection 'model.customer360.contacts_joined_with_transactions' was properly closed.
[0m12:12:03.215140 [debug] [MainThread]: Connection 'model.customer360.customers' was properly closed.
[0m12:12:03.215140 [info ] [MainThread]: 
[0m12:12:03.216139 [info ] [MainThread]: Finished running 2 table models, 1 incremental model, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m12:12:03.217139 [debug] [MainThread]: Command end result
[0m12:12:03.222140 [info ] [MainThread]: 
[0m12:12:03.223644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:03.223644 [info ] [MainThread]: 
[0m12:12:03.224648 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:12:03.225648 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:03.225648 after 1.21 seconds
[0m12:12:03.225648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021264CD4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126858EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212685214E0>]}
[0m12:12:03.225648 [debug] [MainThread]: Flushing usage events
