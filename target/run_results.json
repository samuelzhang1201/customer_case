{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-17T12:11:58.884203Z", "invocation_id": "e3d479ac-5b0f-4ea4-9170-40933fae2c29", "env": {}}, "results": [{"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T12:11:58.651968Z", "completed_at": "2023-11-17T12:11:58.656930Z"}, {"name": "execute", "started_at": "2023-11-17T12:11:58.657930Z", "completed_at": "2023-11-17T12:11:58.725477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08152508735656738, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_last_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmax(transaction_date::date) as last_date\nfrom\n\t\"dbt\".\"public\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.last_purchase_date,\n\tb.last_date\nfrom\n\t\"dbt\".\"public\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nlast_purchase_date <> last_date", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T12:11:58.646951Z", "completed_at": "2023-11-17T12:11:58.657930Z"}, {"name": "execute", "started_at": "2023-11-17T12:11:58.669932Z", "completed_at": "2023-11-17T12:11:58.759476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11752748489379883, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_first_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmin(transaction_date::date) as first_date\nfrom\n\t\"dbt\".\"public\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.first_purchase_date,\n\tb.first_date\nfrom\n\t\"dbt\".\"public\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nfirst_purchase_date <> first_date", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T12:11:58.653930Z", "completed_at": "2023-11-17T12:11:58.657930Z"}, {"name": "execute", "started_at": "2023-11-17T12:11:58.670931Z", "completed_at": "2023-11-17T12:11:58.789533Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14558148384094238, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_purchase_amount_above_zero", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"public\".\"customers\"\nwhere \n    \"Apps & Games_amount\"+\"Beauty_amount\"+ \"Books_amount\"+ \"Clothing, Shoes & Accessories_amount\"+ \"Movies & TV_amount\"+ \"Sports, Fitness & Outdoors_amount\"+\"Kitchen_amount\" <= 0", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T12:11:58.729479Z", "completed_at": "2023-11-17T12:11:58.731507Z"}, {"name": "execute", "started_at": "2023-11-17T12:11:58.732500Z", "completed_at": "2023-11-17T12:11:58.826186Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09970951080322266, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_valid_customers", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"public\".\"customers\"\nwhere\n\tnew_id not in (\n\tselect\n\t\tnew_id\n\tfrom\n\t\t\"dbt\".\"public\".\"stg_sf__contacts\"\n    )", "relation_name": null}], "elapsed_time": 0.36782193183898926, "args": {"cache_selected_only": false, "static_parser": true, "partial_parse": true, "indirect_selection": "eager", "print": true, "log_format_file": "debug", "profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "quiet": false, "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "use_colors": true, "write_json": true, "favor_state": false, "macro_debugging": false, "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "show_resource_report": false, "log_level": "info", "enable_legacy_logger": false, "defer": false, "vars": {}, "send_anonymous_usage_stats": true, "invocation_command": "dbt test -s customers", "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "select": ["customers"], "strict_mode": false, "partial_parse_file_diff": true, "printer_width": 80, "exclude": [], "version_check": true, "log_format": "default", "which": "test", "populate_cache": true, "log_file_max_bytes": 10485760, "log_level_file": "debug"}}