{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-17T23:42:16.046926Z", "invocation_id": "33a5e987-dfd8-49db-9456-ccae5ba3ca7a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.902904Z", "completed_at": "2023-11-17T23:42:15.902904Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.906413Z", "completed_at": "2023-11-17T23:42:15.906413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011509895324707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.integration_tests.contacts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.904408Z", "completed_at": "2023-11-17T23:42:15.905414Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.907412Z", "completed_at": "2023-11-17T23:42:15.907412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011509895324707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.integration_tests.transactions", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.898903Z", "completed_at": "2023-11-17T23:42:15.906413Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.909413Z", "completed_at": "2023-11-17T23:42:15.909413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014508962631225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer360.stg_sf__contacts", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"contacts\"\n),\n\nrenamed as (\n    select\n        id,\n        case \n            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) \n            else id end as new_id,\n        username as user_name,\n        name,\n        gender,\n        address, \n        mail as email_address,\n        birthdate as birth_date,\n        _loaded_at_utc,\n        now() as updated_at\n    from source     \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_sf__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.913413Z", "completed_at": "2023-11-17T23:42:15.931411Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.933412Z", "completed_at": "2023-11-17T23:42:15.933412Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022997379302978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"dbt\".\"public\".\"transactions\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.922411Z", "completed_at": "2023-11-17T23:42:15.932411Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.934412Z", "completed_at": "2023-11-17T23:42:15.934412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023998498916625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.929421Z", "completed_at": "2023-11-17T23:42:15.933412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.936412Z", "completed_at": "2023-11-17T23:42:15.936412Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024000167846679688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.941413Z", "completed_at": "2023-11-17T23:42:15.951413Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.954414Z", "completed_at": "2023-11-17T23:42:15.954414Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016994953155517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.945412Z", "completed_at": "2023-11-17T23:42:15.952413Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.955412Z", "completed_at": "2023-11-17T23:42:15.955412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017996549606323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.source_unique_web_transactions_id.ba28079761", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.949413Z", "completed_at": "2023-11-17T23:42:15.953412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.956414Z", "completed_at": "2023-11-17T23:42:15.956414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016998291015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer360.stg_web__transactions", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"transactions\"\n),\n\nrenamed as (\n    select\n        id,\n        contact_id,\n        \n\n    \n\n        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'\n\n    \n\n as transaction_date,\n        amount,\n        item_count,\n        category, \n        _loaded_at_utc\n    from source\n    where contact_id in (select new_id from \"dbt\".\"staging\".\"stg_sf__contacts\")       \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_web__transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.961412Z", "completed_at": "2023-11-17T23:42:15.962412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.969413Z", "completed_at": "2023-11-17T23:42:15.969413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011998653411865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.customer360.stg_sf__contacts_snapshot", "compiled": true, "compiled_code": "\n\n\n\n\n\nselect * from \"dbt\".\"staging\".\"stg_sf__contacts\"\n", "relation_name": "\"dbt\".\"snapshots\".\"stg_sf__contacts_snapshot\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.963411Z", "completed_at": "2023-11-17T23:42:15.970413Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.972413Z", "completed_at": "2023-11-17T23:42:15.972413Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015000104904174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_id\nfrom \"dbt\".\"staging\".\"stg_sf__contacts\"\nwhere new_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.967412Z", "completed_at": "2023-11-17T23:42:15.971412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.973413Z", "completed_at": "2023-11-17T23:42:15.973413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015000343322753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    new_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"staging\".\"stg_sf__contacts\"\nwhere new_id is not null\ngroup by new_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.975413Z", "completed_at": "2023-11-17T23:42:15.979412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.989412Z", "completed_at": "2023-11-17T23:42:15.989412Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017001867294311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer360.contacts_joined_with_transactions", "compiled": true, "compiled_code": "SELECT \n    contacts.*,\n    transactions.id as transaction_id,\n    transactions.transaction_date,\n    transactions.amount,\n    transactions.item_count,\n    transactions.category\nFROM \"dbt\".\"staging\".\"stg_web__transactions\" as transactions\nLEFT JOIN \"dbt\".\"staging\".\"stg_sf__contacts\" as contacts ON contacts.new_id = transactions.contact_id", "relation_name": "\"dbt\".\"marts\".\"contacts_joined_with_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.980412Z", "completed_at": "2023-11-17T23:42:15.989412Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.992416Z", "completed_at": "2023-11-17T23:42:15.992416Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015003442764282227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"staging\".\"stg_web__transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.983411Z", "completed_at": "2023-11-17T23:42:15.990415Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:15.993416Z", "completed_at": "2023-11-17T23:42:15.993416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016003847122192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select contact_id as from_field\n    from \"dbt\".\"staging\".\"stg_web__transactions\"\n    where contact_id is not null\n),\n\nparent as (\n    select new_id as to_field\n    from \"dbt\".\"staging\".\"stg_sf__contacts\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:15.995417Z", "completed_at": "2023-11-17T23:42:15.999415Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.007924Z", "completed_at": "2023-11-17T23:42:16.007924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016509056091308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.unique_stg_web__transactions_id.5518387fef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"staging\".\"stg_web__transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.000415Z", "completed_at": "2023-11-17T23:42:16.007924Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.010926Z", "completed_at": "2023-11-17T23:42:16.010926Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013508796691894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499", "compiled": true, "compiled_code": "\n    select \n    * \n    from \"dbt\".\"staging\".\"stg_web__transactions\"\n    where amount <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.003417Z", "completed_at": "2023-11-17T23:42:16.008925Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.010926Z", "completed_at": "2023-11-17T23:42:16.010926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013509988784790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer360.customers", "compiled": true, "compiled_code": "with intermediate as (\nSELECT\n    new_id,\n    gender,\n    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,\n    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,\n    \n\n    \n\n        date_part('year', age(current_date,birth_date))\n\n    \n\n AS age,\n    case when category = 'Apps & Games' then amount else 0 end as \"Apps & Games_amount\"\n    ,case when category = 'Beauty' then amount else 0 end as \"Beauty_amount\"\n    ,case when category = 'Books' then amount else 0 end as \"Books_amount\"\n    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as \"Clothing, Shoes & Accessories_amount\"\n    ,case when category = 'Movies & TV' then amount else 0 end as \"Movies & TV_amount\"\n    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as \"Sports, Fitness & Outdoors_amount\"\n    ,case when category = 'Kitchen' then amount else 0 end as \"Kitchen_amount\"\n    \nFROM \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n)\n, final as (\nselect \n    new_id,\n    gender,\n    first_purchase_date,\n    last_purchase_date,\n    age,\n    sum(\"Apps & Games_amount\") as \"Apps & Games_amount\"\n    ,sum(\"Beauty_amount\") as \"Beauty_amount\"\n    ,sum(\"Books_amount\") as \"Books_amount\"\n    ,sum(\"Clothing, Shoes & Accessories_amount\") as \"Clothing, Shoes & Accessories_amount\"\n    ,sum(\"Movies & TV_amount\") as \"Movies & TV_amount\"\n    ,sum(\"Sports, Fitness & Outdoors_amount\") as \"Sports, Fitness & Outdoors_amount\"\n    ,sum(\"Kitchen_amount\") as \"Kitchen_amount\"\n    \nFROM intermediate \ngroup by \n1,2,3,4,5\n)\nselect * from final", "relation_name": "\"dbt\".\"marts\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.013925Z", "completed_at": "2023-11-17T23:42:16.018927Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.023925Z", "completed_at": "2023-11-17T23:42:16.023925Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014000177383422852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.021924Z", "completed_at": "2023-11-17T23:42:16.024926Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.026925Z", "completed_at": "2023-11-17T23:42:16.026925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012001991271972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.check_first_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmin(transaction_date::date) as first_date\nfrom\n\t\"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.first_purchase_date,\n\tb.first_date\nfrom\n\t\"dbt\".\"marts\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nfirst_purchase_date <> first_date", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.018927Z", "completed_at": "2023-11-17T23:42:16.024926Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.027926Z", "completed_at": "2023-11-17T23:42:16.027926Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012001991271972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.029926Z", "completed_at": "2023-11-17T23:42:16.033936Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.038926Z", "completed_at": "2023-11-17T23:42:16.038926Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012999534606933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.check_last_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmax(transaction_date::date) as last_date\nfrom\n\t\"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.last_purchase_date,\n\tb.last_date\nfrom\n\t\"dbt\".\"marts\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nlast_purchase_date <> last_date", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.034925Z", "completed_at": "2023-11-17T23:42:16.039925Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.041925Z", "completed_at": "2023-11-17T23:42:16.041925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010001659393310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.check_purchase_amount_above_zero", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"marts\".\"customers\"\nwhere \n    \"Apps & Games_amount\"+\"Beauty_amount\"+ \"Books_amount\"+ \"Clothing, Shoes & Accessories_amount\"+ \"Movies & TV_amount\"+ \"Sports, Fitness & Outdoors_amount\"+\"Kitchen_amount\" <= 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T23:42:16.036926Z", "completed_at": "2023-11-17T23:42:16.040925Z"}, {"name": "execute", "started_at": "2023-11-17T23:42:16.041925Z", "completed_at": "2023-11-17T23:42:16.041925Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011000871658325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer360.check_valid_customers", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"marts\".\"customers\"\nwhere\n\tnew_id not in (\n\tselect\n\t\tnew_id\n\tfrom\n\t\t\"dbt\".\"staging\".\"stg_sf__contacts\"\n    )", "relation_name": null}], "elapsed_time": 0.375643253326416, "args": {"invocation_command": "dbt docs generate", "printer_width": 80, "log_format": "default", "static": false, "log_level_file": "debug", "compile": true, "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "exclude": [], "partial_parse_file_diff": true, "vars": {}, "show_resource_report": false, "log_level": "info", "quiet": false, "which": "generate", "log_format_file": "debug", "log_file_max_bytes": 10485760, "macro_debugging": false, "write_json": true, "partial_parse": true, "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "cache_selected_only": false, "static_parser": true, "empty_catalog": false, "send_anonymous_usage_stats": true, "select": [], "introspect": true, "favor_state": false, "defer": false, "indirect_selection": "eager", "enable_legacy_logger": false, "use_colors": true, "use_colors_file": true, "strict_mode": false, "print": true, "version_check": true}}