{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-18T01:12:03.216139Z", "invocation_id": "80fa3c74-9845-4286-b629-8fef3a2a244b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T01:12:02.749704Z", "completed_at": "2023-11-18T01:12:02.754779Z"}, {"name": "execute", "started_at": "2023-11-18T01:12:02.755817Z", "completed_at": "2023-11-18T01:12:02.891330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14362049102783203, "adapter_response": {"_message": "SELECT 11", "code": "SELECT", "rows_affected": 11}, "message": "SELECT 11", "failures": null, "unique_id": "model.customer360.stg_sf__contacts", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"contacts\"\n),\n\nrenamed as (\n    select\n        id,\n        case \n            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) \n            else id end as new_id,\n        username as user_name,\n        name,\n        gender,\n        address, \n        mail as email_address,\n        birthdate as birth_date,\n        _loaded_at_utc,\n        now() as updated_at\n    from source     \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_sf__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T01:12:02.896834Z", "completed_at": "2023-11-18T01:12:02.903834Z"}, {"name": "execute", "started_at": "2023-11-18T01:12:02.904339Z", "completed_at": "2023-11-18T01:12:02.991909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09707427024841309, "adapter_response": {"_message": "SELECT 101", "code": "SELECT", "rows_affected": 101}, "message": "SELECT 101", "failures": null, "unique_id": "model.customer360.stg_web__transactions", "compiled": true, "compiled_code": "\n\n\nwith source as (\n    select * from \"dbt\".\"public\".\"transactions\"\n\n\n\n),\n\nrenamed as (\n    select\n        id,\n        contact_id,\n        \n\n    \n\n        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'\n\n    \n\n as transaction_date,\n        amount,\n        item_count,\n        category, \n        _loaded_at_utc,\n        '80fa3c74-9845-4286-b629-8fef3a2a244b' as batch_id\n    from source\n    where contact_id in (select new_id from \"dbt\".\"staging\".\"stg_sf__contacts\")       \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_web__transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T01:12:02.996417Z", "completed_at": "2023-11-18T01:12:02.999416Z"}, {"name": "execute", "started_at": "2023-11-18T01:12:03.000416Z", "completed_at": "2023-11-18T01:12:03.076608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08019042015075684, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.customer360.contacts_joined_with_transactions", "compiled": true, "compiled_code": "SELECT \n    contacts.*,\n    transactions.id as transaction_id,\n    transactions.transaction_date,\n    transactions.amount,\n    transactions.item_count,\n    transactions.category\nFROM \"dbt\".\"staging\".\"stg_web__transactions\" as transactions\nLEFT JOIN \"dbt\".\"staging\".\"stg_sf__contacts\" as contacts ON contacts.new_id = transactions.contact_id", "relation_name": "\"dbt\".\"marts\".\"contacts_joined_with_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T01:12:03.081051Z", "completed_at": "2023-11-18T01:12:03.084554Z"}, {"name": "execute", "started_at": "2023-11-18T01:12:03.085557Z", "completed_at": "2023-11-18T01:12:03.160132Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08107900619506836, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.customer360.customers", "compiled": true, "compiled_code": "with intermediate as (\nSELECT\n    new_id,\n    gender,\n    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,\n    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,\n    \n\n    \n\n        date_part('year', age(current_date,birth_date))\n\n    \n\n AS age,\n    case when category = 'Apps & Games' then amount else 0 end as \"Apps & Games_amount\"\n    ,case when category = 'Beauty' then amount else 0 end as \"Beauty_amount\"\n    ,case when category = 'Books' then amount else 0 end as \"Books_amount\"\n    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as \"Clothing, Shoes & Accessories_amount\"\n    ,case when category = 'Movies & TV' then amount else 0 end as \"Movies & TV_amount\"\n    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as \"Sports, Fitness & Outdoors_amount\"\n    ,case when category = 'Kitchen' then amount else 0 end as \"Kitchen_amount\"\n    \nFROM \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n)\n, final as (\nselect \n    new_id,\n    gender,\n    first_purchase_date,\n    last_purchase_date,\n    age,\n    sum(\"Apps & Games_amount\") as \"Apps & Games_amount\"\n    ,sum(\"Beauty_amount\") as \"Beauty_amount\"\n    ,sum(\"Books_amount\") as \"Books_amount\"\n    ,sum(\"Clothing, Shoes & Accessories_amount\") as \"Clothing, Shoes & Accessories_amount\"\n    ,sum(\"Movies & TV_amount\") as \"Movies & TV_amount\"\n    ,sum(\"Sports, Fitness & Outdoors_amount\") as \"Sports, Fitness & Outdoors_amount\"\n    ,sum(\"Kitchen_amount\") as \"Kitchen_amount\"\n    \nFROM intermediate \ngroup by \n1,2,3,4,5\n)\nselect * from final", "relation_name": "\"dbt\".\"marts\".\"customers\""}], "elapsed_time": 0.8712637424468994, "args": {"profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "send_anonymous_usage_stats": true, "vars": {}, "quiet": false, "static_parser": true, "write_json": true, "cache_selected_only": false, "introspect": true, "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "which": "run", "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "log_file_max_bytes": 10485760, "log_format": "default", "enable_legacy_logger": false, "populate_cache": true, "log_level_file": "debug", "version_check": true, "exclude": [], "macro_debugging": false, "log_level": "info", "indirect_selection": "eager", "defer": false, "show_resource_report": false, "print": true, "partial_parse_file_diff": true, "favor_state": false, "printer_width": 80, "full_refresh": true, "partial_parse": true, "use_colors_file": true, "select": [], "strict_mode": false, "invocation_command": "dbt run --full-refresh"}}