{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-18T03:21:06.929283Z", "invocation_id": "8aab817e-c2b2-4c76-8c60-a051c380f27c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.316513Z", "completed_at": "2023-11-18T03:21:05.316513Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.330697Z", "completed_at": "2023-11-18T03:21:05.467162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1546463966369629, "adapter_response": {"_message": "INSERT 11", "code": "INSERT", "rows_affected": 11}, "message": "INSERT 11", "failures": null, "unique_id": "seed.integration_tests.contacts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.316513Z", "completed_at": "2023-11-18T03:21:05.316513Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.340695Z", "completed_at": "2023-11-18T03:21:05.587792Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2742769718170166, "adapter_response": {"_message": "INSERT 102", "code": "INSERT", "rows_affected": 102}, "message": "INSERT 102", "failures": null, "unique_id": "seed.integration_tests.transactions", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.317514Z", "completed_at": "2023-11-18T03:21:05.340695Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.356650Z", "completed_at": "2023-11-18T03:21:05.598795Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.28828001022338867, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"dbt\".\"public\".\"transactions\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.571837Z", "completed_at": "2023-11-18T03:21:05.577793Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.578791Z", "completed_at": "2023-11-18T03:21:05.639302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09351634979248047, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.593792Z", "completed_at": "2023-11-18T03:21:05.598795Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.600795Z", "completed_at": "2023-11-18T03:21:05.671302Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08050990104675293, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.607795Z", "completed_at": "2023-11-18T03:21:05.613302Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.614303Z", "completed_at": "2023-11-18T03:21:05.705306Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09951138496398926, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "Got 1 result, configured to warn if != 0", "failures": 1, "unique_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.644302Z", "completed_at": "2023-11-18T03:21:05.647302Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.648303Z", "completed_at": "2023-11-18T03:21:05.740814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09950971603393555, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_unique_web_transactions_id.ba28079761", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.710306Z", "completed_at": "2023-11-18T03:21:05.713813Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.713813Z", "completed_at": "2023-11-18T03:21:05.820324Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11201906204223633, "adapter_response": {"_message": "SELECT 11", "code": "SELECT", "rows_affected": 11}, "message": "SELECT 11", "failures": null, "unique_id": "model.customer360.stg_sf__contacts", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"contacts\"\n),\n\nrenamed as (\n    select\n        id,\n        case \n            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) \n            else id end as new_id,\n        username as user_name,\n        name,\n        gender,\n        address, \n        mail as email_address,\n        birthdate as birth_date,\n        _loaded_at_utc,\n        now() as updated_at\n    from source     \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_sf__contacts\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.827324Z", "completed_at": "2023-11-18T03:21:05.833323Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.835323Z", "completed_at": "2023-11-18T03:21:05.892324Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0690007209777832, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_id\nfrom \"dbt\".\"staging\".\"stg_sf__contacts\"\nwhere new_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.830324Z", "completed_at": "2023-11-18T03:21:05.834325Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.836324Z", "completed_at": "2023-11-18T03:21:05.931833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10750913619995117, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    new_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"staging\".\"stg_sf__contacts\"\nwhere new_id is not null\ngroup by new_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.944833Z", "completed_at": "2023-11-18T03:21:05.946835Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.948833Z", "completed_at": "2023-11-18T03:21:06.097097Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1612710952758789, "adapter_response": {"_message": "INSERT 0 11", "code": "INSERT", "rows_affected": 11}, "message": "INSERT 0 11", "failures": null, "unique_id": "snapshot.customer360.stg_sf__contacts_snapshot", "compiled": true, "compiled_code": "\n\n\n\n\n\nselect * from \"dbt\".\"staging\".\"stg_sf__contacts\"\n", "relation_name": "\"dbt\".\"snapshots\".\"stg_sf__contacts_snapshot\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:05.938833Z", "completed_at": "2023-11-18T03:21:05.973564Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:05.975563Z", "completed_at": "2023-11-18T03:21:06.157503Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22167062759399414, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.customer360.stg_web__transactions", "compiled": true, "compiled_code": "\n\n\nwith source as (\n    select * from \"dbt\".\"public\".\"transactions\"\n\n\n\n  where _loaded_at_utc > (select max(_loaded_at_utc) from \"dbt\".\"staging\".\"stg_web__transactions\")\n\n\n\n),\n\nrenamed as (\n    select\n        id,\n        contact_id,\n        \n\n    \n\n        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'\n\n    \n\n as transaction_date,\n        amount,\n        item_count,\n        category, \n        _loaded_at_utc,\n        '8aab817e-c2b2-4c76-8c60-a051c380f27c' as batch_id\n    from source\n    where contact_id in (select new_id from \"dbt\".\"staging\".\"stg_sf__contacts\")       \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"staging\".\"stg_web__transactions\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.165783Z", "completed_at": "2023-11-18T03:21:06.177867Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.180822Z", "completed_at": "2023-11-18T03:21:06.249080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08829641342163086, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"staging\".\"stg_web__transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.168783Z", "completed_at": "2023-11-18T03:21:06.178859Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.182820Z", "completed_at": "2023-11-18T03:21:06.276079Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1132962703704834, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select contact_id as from_field\n    from \"dbt\".\"staging\".\"stg_web__transactions\"\n    where contact_id is not null\n),\n\nparent as (\n    select new_id as to_field\n    from \"dbt\".\"staging\".\"stg_sf__contacts\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.174815Z", "completed_at": "2023-11-18T03:21:06.179849Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.184819Z", "completed_at": "2023-11-18T03:21:06.308087Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14530277252197266, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_web__transactions_id.5518387fef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"staging\".\"stg_web__transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.254081Z", "completed_at": "2023-11-18T03:21:06.258081Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.259081Z", "completed_at": "2023-11-18T03:21:06.351600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10051822662353516, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499", "compiled": true, "compiled_code": "\n    select \n    * \n    from \"dbt\".\"staging\".\"stg_web__transactions\"\n    where amount <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.358600Z", "completed_at": "2023-11-18T03:21:06.363600Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.365602Z", "completed_at": "2023-11-18T03:21:06.492437Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13683819770812988, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.customer360.contacts_joined_with_transactions", "compiled": true, "compiled_code": "SELECT \n    contacts.*,\n    transactions.id as transaction_id,\n    transactions.transaction_date,\n    transactions.amount,\n    transactions.item_count,\n    transactions.category\nFROM \"dbt\".\"staging\".\"stg_web__transactions\" as transactions\nLEFT JOIN \"dbt\".\"staging\".\"stg_sf__contacts\" as contacts ON contacts.new_id = transactions.contact_id", "relation_name": "\"dbt\".\"marts\".\"contacts_joined_with_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.360603Z", "completed_at": "2023-11-18T03:21:06.363600Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.422476Z", "completed_at": "2023-11-18T03:21:06.533953Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17835426330566406, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.customer360.cross_shopping", "compiled": true, "compiled_code": "with combo as (\nselect\n\ta.contact_id,\n\ta.category as cate_01\n\t, b.category as cate_02\nfrom\n\t\"dbt\".\"staging\".\"stg_web__transactions\" a \njoin \n    \"dbt\".\"staging\".\"stg_web__transactions\" b\non a.contact_id = b.contact_id \nand a.category > b.category \n)\nselect \ncate_01\n,cate_02\n, count(distinct contact_id)\nfrom\ncombo\ngroup by 1,2\norder by 3 desc", "relation_name": "\"dbt\".\"marts\".\"cross_shopping\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.499441Z", "completed_at": "2023-11-18T03:21:06.505478Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.507445Z", "completed_at": "2023-11-18T03:21:06.564952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06951546669006348, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.502477Z", "completed_at": "2023-11-18T03:21:06.505478Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.509442Z", "completed_at": "2023-11-18T03:21:06.595953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10052180290222168, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.600961Z", "completed_at": "2023-11-18T03:21:06.605962Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.606964Z", "completed_at": "2023-11-18T03:21:06.685749Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08678960800170898, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.customer360.customers", "compiled": true, "compiled_code": "with intermediate as (\nSELECT\n    new_id,\n    gender,\n    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,\n    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,\n    \n\n    \n\n        date_part('year', age(current_date,birth_date))\n\n    \n\n AS age,\n    case when category = 'Apps & Games' then amount else 0 end as \"Apps & Games_amount\"\n    ,case when category = 'Beauty' then amount else 0 end as \"Beauty_amount\"\n    ,case when category = 'Books' then amount else 0 end as \"Books_amount\"\n    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as \"Clothing, Shoes & Accessories_amount\"\n    ,case when category = 'Movies & TV' then amount else 0 end as \"Movies & TV_amount\"\n    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as \"Sports, Fitness & Outdoors_amount\"\n    ,case when category = 'Kitchen' then amount else 0 end as \"Kitchen_amount\"\n    \nFROM \"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n)\n, final as (\nselect \n    new_id,\n    gender,\n    first_purchase_date,\n    last_purchase_date,\n    age,\n    sum(\"Apps & Games_amount\") as \"Apps & Games_amount\"\n    ,sum(\"Beauty_amount\") as \"Beauty_amount\"\n    ,sum(\"Books_amount\") as \"Books_amount\"\n    ,sum(\"Clothing, Shoes & Accessories_amount\") as \"Clothing, Shoes & Accessories_amount\"\n    ,sum(\"Movies & TV_amount\") as \"Movies & TV_amount\"\n    ,sum(\"Sports, Fitness & Outdoors_amount\") as \"Sports, Fitness & Outdoors_amount\"\n    ,sum(\"Kitchen_amount\") as \"Kitchen_amount\"\n    \nFROM intermediate \ngroup by \n1,2,3,4,5\n)\nselect * from final", "relation_name": "\"dbt\".\"marts\".\"customers\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.696260Z", "completed_at": "2023-11-18T03:21:06.700269Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.704265Z", "completed_at": "2023-11-18T03:21:06.799050Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10929298400878906, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_last_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmax(transaction_date::date) as last_date\nfrom\n\t\"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.last_purchase_date,\n\tb.last_date\nfrom\n\t\"dbt\".\"marts\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nlast_purchase_date <> last_date", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.698268Z", "completed_at": "2023-11-18T03:21:06.701265Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.706265Z", "completed_at": "2023-11-18T03:21:06.826702Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13592743873596191, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_purchase_amount_above_zero", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"marts\".\"customers\"\nwhere \n    \"Apps & Games_amount\"+\"Beauty_amount\"+ \"Books_amount\"+ \"Clothing, Shoes & Accessories_amount\"+ \"Movies & TV_amount\"+ \"Sports, Fitness & Outdoors_amount\"+\"Kitchen_amount\" <= 0", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.803996Z", "completed_at": "2023-11-18T03:21:06.807063Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.807063Z", "completed_at": "2023-11-18T03:21:06.860688Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059667348861694336, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_valid_customers", "compiled": true, "compiled_code": "select\n\tnew_id\nfrom\n\t\"dbt\".\"marts\".\"customers\"\nwhere\n\tnew_id not in (\n\tselect\n\t\tnew_id\n\tfrom\n\t\t\"dbt\".\"staging\".\"stg_sf__contacts\"\n    )", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-18T03:21:06.693749Z", "completed_at": "2023-11-18T03:21:06.700269Z"}, {"name": "execute", "started_at": "2023-11-18T03:21:06.702265Z", "completed_at": "2023-11-18T03:21:06.870688Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.18091082572937012, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.check_first_purchase_date", "compiled": true, "compiled_code": "with pivot_table as (\nselect\n\tnew_id,\n\tmin(transaction_date::date) as first_date\nfrom\n\t\"dbt\".\"marts\".\"contacts_joined_with_transactions\"\n\tgroup by 1\n)\n, comparing_table as (\nselect\n\ta.new_id,\n\ta.first_purchase_date,\n\tb.first_date\nfrom\n\t\"dbt\".\"marts\".\"customers\" a \nleft join \npivot_table b\non a.new_id = b.new_id\n)\nselect \n*\nfrom comparing_table\nwhere \nfirst_purchase_date <> first_date", "relation_name": null}], "elapsed_time": 2.0800883769989014, "args": {"log_format_file": "debug", "send_anonymous_usage_stats": true, "select": [], "vars": {}, "invocation_command": "dbt build", "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "printer_width": 80, "profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "indirect_selection": "eager", "show": false, "static_parser": true, "strict_mode": false, "show_resource_report": false, "include_saved_query": false, "log_level": "info", "macro_debugging": false, "favor_state": false, "partial_parse": true, "quiet": false, "which": "build", "print": true, "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "use_colors_file": true, "resource_types": [], "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "defer": false, "version_check": true, "exclude": [], "use_colors": true, "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "write_json": true, "introspect": true, "log_format": "default", "cache_selected_only": false, "populate_cache": true}}