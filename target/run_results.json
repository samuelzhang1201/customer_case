{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-17T11:36:23.980815Z", "invocation_id": "edf78d24-6ce6-4609-8e79-2dbb0188311b", "env": {}}, "results": [{"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.353491Z", "completed_at": "2023-11-17T11:36:22.374492Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.392491Z", "completed_at": "2023-11-17T11:36:22.553610Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2041184902191162, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"dbt\".\"public\".\"transactions\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.352492Z", "completed_at": "2023-11-17T11:36:22.352492Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.365492Z", "completed_at": "2023-11-17T11:36:22.557621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21111798286437988, "adapter_response": {"_message": "INSERT 11", "code": "INSERT", "rows_affected": 11}, "message": "INSERT 11", "failures": null, "unique_id": "seed.integration_tests.contacts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.352492Z", "completed_at": "2023-11-17T11:36:22.352492Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.375493Z", "completed_at": "2023-11-17T11:36:22.684237Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3347461223602295, "adapter_response": {"_message": "INSERT 102", "code": "INSERT", "rows_affected": 102}, "message": "INSERT 102", "failures": null, "unique_id": "seed.integration_tests.transactions", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.564611Z", "completed_at": "2023-11-17T11:36:22.656189Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.669238Z", "completed_at": "2023-11-17T11:36:22.732764Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1731581687927246, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.671275Z", "completed_at": "2023-11-17T11:36:22.675238Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.678237Z", "completed_at": "2023-11-17T11:36:22.770769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11657881736755371, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.690256Z", "completed_at": "2023-11-17T11:36:22.695256Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.695256Z", "completed_at": "2023-11-17T11:36:22.801769Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1145176887512207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "Got 1 result, configured to warn if != 0", "failures": 1, "unique_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.737769Z", "completed_at": "2023-11-17T11:36:22.740767Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.741768Z", "completed_at": "2023-11-17T11:36:22.837033Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1022653579711914, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_unique_web_transactions_id.ba28079761", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.806769Z", "completed_at": "2023-11-17T11:36:22.809768Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.810768Z", "completed_at": "2023-11-17T11:36:22.945721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14099788665771484, "adapter_response": {"_message": "SELECT 11", "code": "SELECT", "rows_affected": 11}, "message": "SELECT 11", "failures": null, "unique_id": "model.customer360.stg_sf__contacts", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"contacts\"\n),\n\nrenamed as (\n    select\n        id,\n        case \n            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) \n            else id end as new_id,\n        username as user_name,\n        name,\n        gender,\n        address, \n        mail as email_address,\n        birthdate as birth_date,\n        _loaded_at_utc\n    from source     \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"public\".\"stg_sf__contacts\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.952725Z", "completed_at": "2023-11-17T11:36:22.958725Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.960725Z", "completed_at": "2023-11-17T11:36:23.018730Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07000255584716797, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_id\nfrom \"dbt\".\"public\".\"stg_sf__contacts\"\nwhere new_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:22.955726Z", "completed_at": "2023-11-17T11:36:22.958725Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:22.961725Z", "completed_at": "2023-11-17T11:36:23.048236Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09751033782958984, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    new_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"stg_sf__contacts\"\nwhere new_id is not null\ngroup by new_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.052236Z", "completed_at": "2023-11-17T11:36:23.096237Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.097237Z", "completed_at": "2023-11-17T11:36:23.208746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15750885009765625, "adapter_response": {"_message": "SELECT 101", "code": "SELECT", "rows_affected": 101}, "message": "SELECT 101", "failures": null, "unique_id": "model.customer360.stg_web__transactions", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"transactions\"\n),\n\nrenamed as (\n    select\n        id,\n        contact_id,\n        \n\n    \n\n        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'\n\n    \n\n as transaction_date,\n        amount,\n        item_count,\n        category, \n        _loaded_at_utc\n    from source\n    where contact_id in (select new_id from \"dbt\".\"public\".\"stg_sf__contacts\")       \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"public\".\"stg_web__transactions\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.216745Z", "completed_at": "2023-11-17T11:36:23.229750Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.231749Z", "completed_at": "2023-11-17T11:36:23.289258Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07751154899597168, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"stg_web__transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.219748Z", "completed_at": "2023-11-17T11:36:23.230749Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.234260Z", "completed_at": "2023-11-17T11:36:23.320770Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1070244312286377, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select contact_id as from_field\n    from \"dbt\".\"public\".\"stg_web__transactions\"\n    where contact_id is not null\n),\n\nparent as (\n    select new_id as to_field\n    from \"dbt\".\"public\".\"stg_sf__contacts\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.225751Z", "completed_at": "2023-11-17T11:36:23.230749Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.236258Z", "completed_at": "2023-11-17T11:36:23.354228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14148521423339844, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_web__transactions_id.5518387fef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"stg_web__transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.294258Z", "completed_at": "2023-11-17T11:36:23.298258Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.299258Z", "completed_at": "2023-11-17T11:36:23.497207Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2059483528137207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499", "compiled": true, "compiled_code": "\n    select \n    * \n    from \"dbt\".\"public\".\"stg_web__transactions\"\n    where amount <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.503206Z", "completed_at": "2023-11-17T11:36:23.506205Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.506205Z", "completed_at": "2023-11-17T11:36:23.581982Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08081746101379395, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.customer360.contacts_joined_with_transactions", "compiled": true, "compiled_code": "SELECT \n    contacts.*,\n    transactions.id as transaction_id,\n    transactions.transaction_date,\n    transactions.amount,\n    transactions.item_count,\n    transactions.category\nFROM \"dbt\".\"public\".\"stg_web__transactions\" as transactions\nLEFT JOIN \"dbt\".\"public\".\"stg_sf__contacts\" as contacts ON contacts.new_id = transactions.contact_id", "relation_name": "\"dbt\".\"public\".\"contacts_joined_with_transactions\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.587980Z", "completed_at": "2023-11-17T11:36:23.593980Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.594980Z", "completed_at": "2023-11-17T11:36:23.657592Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07161116600036621, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_contacts_joined_with_transactions_transaction_id.7b97ab79ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"dbt\".\"public\".\"contacts_joined_with_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.591980Z", "completed_at": "2023-11-17T11:36:23.596980Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.597980Z", "completed_at": "2023-11-17T11:36:23.693592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10761260986328125, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_contacts_joined_with_transactions_transaction_id.84a2e9edc5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts_joined_with_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T11:36:23.698594Z", "completed_at": "2023-11-17T11:36:23.704592Z"}, {"name": "execute", "started_at": "2023-11-17T11:36:23.705593Z", "completed_at": "2023-11-17T11:36:23.921905Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2253117561340332, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.customer360.customers", "compiled": true, "compiled_code": "with intermediate as (\nSELECT\n    new_id,\n    gender,\n    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,\n    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,\n    \n\n    \n\n        date_part('year', age(current_date,birth_date))\n\n    \n\n AS age,\n    case when category = 'Apps & Games' then amount else 0 end as \"Apps & Games_amount\"\n    ,case when category = 'Beauty' then amount else 0 end as \"Beauty_amount\"\n    ,case when category = 'Books' then amount else 0 end as \"Books_amount\"\n    ,case when category = 'Clothing, Shoes & Accessories' then amount else 0 end as \"Clothing, Shoes & Accessories_amount\"\n    ,case when category = 'Movies & TV' then amount else 0 end as \"Movies & TV_amount\"\n    ,case when category = 'Sports, Fitness & Outdoors' then amount else 0 end as \"Sports, Fitness & Outdoors_amount\"\n    ,case when category = 'Kitchen' then amount else 0 end as \"Kitchen_amount\"\n    \nFROM \"dbt\".\"public\".\"contacts_joined_with_transactions\"\n)\n, final as (\nselect \n    new_id,\n    gender,\n    first_purchase_date,\n    last_purchase_date,\n    age,\n    sum(\"Apps & Games_amount\") as \"Apps & Games_amount\"\n    ,sum(\"Beauty_amount\") as \"Beauty_amount\"\n    ,sum(\"Books_amount\") as \"Books_amount\"\n    ,sum(\"Clothing, Shoes & Accessories_amount\") as \"Clothing, Shoes & Accessories_amount\"\n    ,sum(\"Movies & TV_amount\") as \"Movies & TV_amount\"\n    ,sum(\"Sports, Fitness & Outdoors_amount\") as \"Sports, Fitness & Outdoors_amount\"\n    ,sum(\"Kitchen_amount\") as \"Kitchen_amount\"\n    \nFROM intermediate \ngroup by \n1,2,3,4,5\n)\nselect * from final", "relation_name": "\"dbt\".\"public\".\"customers\""}], "elapsed_time": 1.8171114921569824, "args": {"favor_state": false, "defer": false, "show_resource_report": false, "use_colors_file": true, "partial_parse_file_diff": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "strict_mode": false, "exclude": [], "partial_parse": true, "indirect_selection": "eager", "print": true, "log_level": "info", "printer_width": 80, "introspect": true, "vars": {}, "cache_selected_only": false, "quiet": false, "which": "build", "log_level_file": "debug", "static_parser": true, "use_colors": true, "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "warn_error_options": {"include": [], "exclude": []}, "include_saved_query": false, "log_format": "default", "populate_cache": true, "resource_types": [], "write_json": true, "invocation_command": "dbt build", "log_file_max_bytes": 10485760, "macro_debugging": false, "profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "version_check": true, "enable_legacy_logger": false, "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "select": [], "show": false}}