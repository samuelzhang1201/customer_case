{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2023-11-17T10:06:31.015519Z", "invocation_id": "3bc62f33-16b1-4df6-bb89-3cc2d6f0301d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.694212Z", "completed_at": "2023-11-17T10:06:29.694212Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.708212Z", "completed_at": "2023-11-17T10:06:29.838506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14829421043395996, "adapter_response": {"_message": "INSERT 11", "code": "INSERT", "rows_affected": 11}, "message": "INSERT 11", "failures": null, "unique_id": "seed.integration_tests.contacts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.695211Z", "completed_at": "2023-11-17T10:06:29.695211Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.718211Z", "completed_at": "2023-11-17T10:06:29.958505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.26929354667663574, "adapter_response": {"_message": "INSERT 102", "code": "INSERT", "rows_affected": 102}, "message": "INSERT 102", "failures": null, "unique_id": "seed.integration_tests.transactions", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.695211Z", "completed_at": "2023-11-17T10:06:29.719212Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.734211Z", "completed_at": "2023-11-17T10:06:29.959505Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2702937126159668, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_accepted_values_web_transactions_category__Apps_Games__Beauty__Books__Clothing_Shoes_Accessories__Movies_TV__Sports_Fitness_Outdoors__Kitchen.c88cfdeee5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"dbt\".\"public\".\"transactions\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Apps & Games','Beauty','Books','Clothing, Shoes & Accessories','Movies & TV','Sports, Fitness & Outdoors','Kitchen'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.944505Z", "completed_at": "2023-11-17T10:06:29.949505Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.951506Z", "completed_at": "2023-11-17T10:06:30.007505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06800031661987305, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_salesforce_contacts_id.c732d8a00d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.967505Z", "completed_at": "2023-11-17T10:06:29.975505Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.976505Z", "completed_at": "2023-11-17T10:06:30.040817Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07631158828735352, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_not_null_web_transactions_id.88a47bf7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:29.971505Z", "completed_at": "2023-11-17T10:06:29.976505Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:29.978505Z", "completed_at": "2023-11-17T10:06:30.073817Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1083364486694336, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "Got 1 result, configured to warn if != 0", "failures": 1, "unique_id": "test.customer360.source_unique_salesforce_contacts_id.01cadaaf43", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.012506Z", "completed_at": "2023-11-17T10:06:30.016506Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.016506Z", "completed_at": "2023-11-17T10:06:30.110818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10081720352172852, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.source_unique_web_transactions_id.ba28079761", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.078818Z", "completed_at": "2023-11-17T10:06:30.081817Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.082817Z", "completed_at": "2023-11-17T10:06:30.301494Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22467684745788574, "adapter_response": {"_message": "SELECT 11", "code": "SELECT", "rows_affected": 11}, "message": "SELECT 11", "failures": null, "unique_id": "model.customer360.stg_sf__contacts", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"contacts\"\n),\n\nrenamed as (\n    select\n        id,\n        case \n            when row_number() over(partition by id)>1 then concat(id,'-',row_number() over(partition by id)) \n            else id end as new_id,\n        username as user_name,\n        name,\n        gender,\n        address, \n        mail as email_address,\n        birthdate as birth_date,\n        _loaded_at_utc\n    from source     \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"public\".\"stg_sf__contacts\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.308495Z", "completed_at": "2023-11-17T10:06:30.315495Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.316495Z", "completed_at": "2023-11-17T10:06:30.374655Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0701608657836914, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_sf__contacts_new_id.346de3589b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_id\nfrom \"dbt\".\"public\".\"stg_sf__contacts\"\nwhere new_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.311495Z", "completed_at": "2023-11-17T10:06:30.315495Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.318493Z", "completed_at": "2023-11-17T10:06:30.405657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10016298294067383, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_sf__contacts_new_id.9ef2d6e9a2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    new_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"stg_sf__contacts\"\nwhere new_id is not null\ngroup by new_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.410657Z", "completed_at": "2023-11-17T10:06:30.414655Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.414655Z", "completed_at": "2023-11-17T10:06:30.493114Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0844578742980957, "adapter_response": {"_message": "SELECT 101", "code": "SELECT", "rows_affected": 101}, "message": "SELECT 101", "failures": null, "unique_id": "model.customer360.stg_web__transactions", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt\".\"public\".\"transactions\"\n),\n\nrenamed as (\n    select\n        id,\n        contact_id,\n        \n\n    \n\n        to_timestamp(transaction_date,'YYYY-MM-DD HH24:MI:SS.MS') :: timestamp at TIME zone 'UTC'\n\n    \n\n as transaction_date,\n        amount,\n        item_count,\n        category, \n        _loaded_at_utc\n    from source\n    where contact_id in (select new_id from \"dbt\".\"public\".\"stg_sf__contacts\")       \n)\n\nselect * from renamed", "relation_name": "\"dbt\".\"public\".\"stg_web__transactions\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.501114Z", "completed_at": "2023-11-17T10:06:30.514114Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.516115Z", "completed_at": "2023-11-17T10:06:30.575113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07799935340881348, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_stg_web__transactions_id.7beb436b49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"stg_web__transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.510113Z", "completed_at": "2023-11-17T10:06:30.515114Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.520115Z", "completed_at": "2023-11-17T10:06:30.606113Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10900115966796875, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.unique_stg_web__transactions_id.5518387fef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"stg_web__transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.505115Z", "completed_at": "2023-11-17T10:06:30.514114Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.519114Z", "completed_at": "2023-11-17T10:06:30.638115Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14200043678283691, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.relationships_stg_web__transactions_contact_id__new_id__ref_stg_sf__contacts_.7b3e37fd53", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select contact_id as from_field\n    from \"dbt\".\"public\".\"stg_web__transactions\"\n    where contact_id is not null\n),\n\nparent as (\n    select new_id as to_field\n    from \"dbt\".\"public\".\"stg_sf__contacts\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.579114Z", "completed_at": "2023-11-17T10:06:30.584113Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.585114Z", "completed_at": "2023-11-17T10:06:30.677114Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09999990463256836, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.value_above_zero_stg_web__transactions_amount.1840ccd499", "compiled": true, "compiled_code": "\n    select \n    * \n    from \"dbt\".\"public\".\"stg_web__transactions\"\n    where amount <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.682114Z", "completed_at": "2023-11-17T10:06:30.684113Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.685113Z", "completed_at": "2023-11-17T10:06:30.764114Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0839993953704834, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.customer360.contacts_joined_with_transactions", "compiled": true, "compiled_code": "SELECT \n    contacts.*,\n    transactions.id as transaction_id,\n    transactions.transaction_date,\n    transactions.amount,\n    transactions.item_count,\n    transactions.category\nFROM \"dbt\".\"public\".\"stg_web__transactions\" as transactions\nLEFT JOIN \"dbt\".\"public\".\"stg_sf__contacts\" as contacts ON contacts.id = transactions.contact_id", "relation_name": "\"dbt\".\"public\".\"contacts_joined_with_transactions\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.770115Z", "completed_at": "2023-11-17T10:06:30.776113Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.778115Z", "completed_at": "2023-11-17T10:06:30.837115Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06999945640563965, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.customer360.not_null_contacts_joined_with_transactions_id.4b4c841311", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dbt\".\"public\".\"contacts_joined_with_transactions\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.773115Z", "completed_at": "2023-11-17T10:06:30.777115Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.781114Z", "completed_at": "2023-11-17T10:06:30.868114Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10100007057189941, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "Got 9 results, configured to warn if >0", "failures": 9, "unique_id": "test.customer360.unique_contacts_joined_with_transactions_id.b0269f62bb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt\".\"public\".\"contacts_joined_with_transactions\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-17T10:06:30.873114Z", "completed_at": "2023-11-17T10:06:30.876115Z"}, {"name": "execute", "started_at": "2023-11-17T10:06:30.877115Z", "completed_at": "2023-11-17T10:06:30.953130Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08201456069946289, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.customer360.customers", "compiled": true, "compiled_code": "with intermediate as (\nSELECT\n    id,\n    gender,\n    first_value (transaction_date::date) over(partition by id order by transaction_date) as first_purchase_date,\n    last_value (transaction_date::date) over(partition by id order by transaction_date rows between unbounded preceding and unbounded following) as last_purchase_date,\n    date_part('year', age(current_date, birth_date)) AS age,\n    case when category = 'Apps & Games' then amount else 0 end as Apps_and_Games_amount,\n   \tcase when category = 'Beauty' then amount else 0 end as Beauty_amount,\n   \tcase when category = 'Books' then amount else 0 end as Books_amount,\n   \tcase when category = 'Clothing' then amount else 0 end as Clothing_amount,\n   \tcase when category = 'Shoes & Accessories' then amount else 0 end as Shoes_and_Accessories_amount,\n   \tcase when category = 'Movies & TV' then amount else 0 end as Movies_and_TV_amount,\n   \tcase when category = 'Sports' then amount else 0 end as Sports_amount,\n    case when category = 'Fitness & Outdoors' then amount else 0 end as Fitness_and_Outdoors_amount,\n   \tcase when category = 'Kitchen' then amount else 0 end as Kitchen_amount\nFROM \"dbt\".\"public\".\"contacts_joined_with_transactions\"\n)\n, final as (\nselect \n    id,\n    gender,\n    first_purchase_date,\n    last_purchase_date,\n    age,\n    sum(Apps_and_Games_amount) Apps_and_Games_amount,\n   \tsum(Beauty_amount) Beauty_amount,\n   \tsum(Books_amount) Books_amount,\n   \tsum(Clothing_amount) Clothing_amount,\n   \tsum(Shoes_and_Accessories_amount) Shoes_and_Accessories_amount,\n   \tsum(Movies_and_TV_amount) Movies_and_TV_amount,\n    sum(Sports_amount) Sports_amount,\n    sum(Fitness_and_Outdoors_amount) Fitness_and_Outdoors_amount,\n   \tsum(Kitchen_amount) Kitchen_amount\nFROM intermediate \ngroup by \n1,2,3,4,5\n)\nselect * from final", "relation_name": "\"dbt\".\"public\".\"customers\""}], "elapsed_time": 1.5102241039276123, "args": {"log_format_file": "debug", "log_level": "info", "printer_width": 80, "log_level_file": "debug", "favor_state": false, "partial_parse": true, "cache_selected_only": false, "resource_types": [], "enable_legacy_logger": false, "exclude": [], "introspect": true, "vars": {}, "print": true, "send_anonymous_usage_stats": true, "static_parser": true, "select": [], "project_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "use_colors": true, "version_check": true, "partial_parse_file_diff": true, "strict_mode": false, "which": "build", "indirect_selection": "eager", "log_path": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests\\logs", "include_saved_query": false, "show_resource_report": false, "log_format": "default", "profiles_dir": "C:\\Users\\Samuel\\Desktop\\customer360\\integration_tests", "quiet": false, "show": false, "defer": false, "write_json": true, "populate_cache": true, "log_file_max_bytes": 10485760, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt build", "use_colors_file": true}}